<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>NIRVANA</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Blog of a Chinese OIer">
<meta property="og:type" content="website">
<meta property="og:title" content="NIRVANA">
<meta property="og:url" content="http://yoursite.com/page/5/index.html">
<meta property="og:site_name" content="NIRVANA">
<meta property="og:description" content="Blog of a Chinese OIer">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="NIRVANA">
<meta name="twitter:description" content="Blog of a Chinese OIer">
  
    <link rel="alternative" href="/atom.xml" title="NIRVANA" type="application/atom+xml">
  
  
    <link rel="icon" href="http://chuantu.biz/t6/89/1507626502x2728279003.jpg">
  
  <link rel="stylesheet" href="/css/style.css">
  
  

  <script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>
  <script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>

  
</head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://chuantu.biz/t6/89/1507626502x2728279003.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Azrael_Death</a></h1>
		</hgroup>

		
		<p class="header-subtitle">Veni Vidi Vici</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/AzraelDeath" title="github">github</a>
					        
								<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/azraeldeath" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/2-SAT/" style="font-size: 10.83px;">2-SAT</a> <a href="/tags/AC自动机/" style="font-size: 10.83px;">AC自动机</a> <a href="/tags/APIO/" style="font-size: 10px;">APIO</a> <a href="/tags/BZOJ/" style="font-size: 20px;">BZOJ</a> <a href="/tags/DFS序/" style="font-size: 10px;">DFS序</a> <a href="/tags/DP/" style="font-size: 15.83px;">DP</a> <a href="/tags/HDU/" style="font-size: 12.5px;">HDU</a> <a href="/tags/LCA/" style="font-size: 12.5px;">LCA</a> <a href="/tags/LG/" style="font-size: 12.5px;">LG</a> <a href="/tags/MST/" style="font-size: 12.5px;">MST</a> <a href="/tags/Manacher/" style="font-size: 10.83px;">Manacher</a> <a href="/tags/NOI/" style="font-size: 10.83px;">NOI</a> <a href="/tags/NOIp/" style="font-size: 13.33px;">NOIp</a> <a href="/tags/POI/" style="font-size: 10px;">POI</a> <a href="/tags/POJ/" style="font-size: 15px;">POJ</a> <a href="/tags/Tarjan/" style="font-size: 10.83px;">Tarjan</a> <a href="/tags/Trie/" style="font-size: 10px;">Trie</a> <a href="/tags/UVa/" style="font-size: 10px;">UVa</a> <a href="/tags/主席树/" style="font-size: 12.5px;">主席树</a> <a href="/tags/二分图/" style="font-size: 10px;">二分图</a> <a href="/tags/二分答案/" style="font-size: 10.83px;">二分答案</a> <a href="/tags/分块/" style="font-size: 10px;">分块</a> <a href="/tags/图论/" style="font-size: 17.5px;">图论</a> <a href="/tags/字符串/" style="font-size: 12.5px;">字符串</a> <a href="/tags/差分/" style="font-size: 10px;">差分</a> <a href="/tags/差分约束系统/" style="font-size: 10px;">差分约束系统</a> <a href="/tags/并查集/" style="font-size: 10.83px;">并查集</a> <a href="/tags/总结/" style="font-size: 16.67px;">总结</a> <a href="/tags/搜索/" style="font-size: 10px;">搜索</a> <a href="/tags/数位DP/" style="font-size: 10.83px;">数位DP</a> <a href="/tags/数据结构/" style="font-size: 18.33px;">数据结构</a> <a href="/tags/数论数学/" style="font-size: 11.67px;">数论数学</a> <a href="/tags/期望DP/" style="font-size: 10px;">期望DP</a> <a href="/tags/树套树/" style="font-size: 10.83px;">树套树</a> <a href="/tags/树状数组/" style="font-size: 11.67px;">树状数组</a> <a href="/tags/树链剖分/" style="font-size: 10px;">树链剖分</a> <a href="/tags/模拟/" style="font-size: 10.83px;">模拟</a> <a href="/tags/状压DP/" style="font-size: 10.83px;">状压DP</a> <a href="/tags/省选/" style="font-size: 19.17px;">省选</a> <a href="/tags/线段树/" style="font-size: 13.33px;">线段树</a> <a href="/tags/组合数学/" style="font-size: 10px;">组合数学</a> <a href="/tags/网络流/" style="font-size: 14.17px;">网络流</a> <a href="/tags/莫队/" style="font-size: 10.83px;">莫队</a> <a href="/tags/补集转换/" style="font-size: 10px;">补集转换</a> <a href="/tags/贪心/" style="font-size: 10px;">贪心</a> <a href="/tags/费用流/" style="font-size: 10px;">费用流</a> <a href="/tags/队列/" style="font-size: 10px;">队列</a> <a href="/tags/高斯消元/" style="font-size: 10px;">高斯消元</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.csdn.net/OwenOwl">OwenOwl</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.csdn.net/Joker_69">Joker</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://dangxingyu.com">DXY</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://309459245.lofter.com">YJQ</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/candy99">Candy</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/zig-zag">ZigZag</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://cxjyxx.me">cxjyxx_me</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.shuizilong.com">ShuiZiLong</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/kuangbin">KuangBin</a>
			        
			        </div>
				</section>
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Azrael_Death</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="http://chuantu.biz/t6/89/1507626502x2728279003.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">Azrael_Death</h1>
			</hgroup>
			
			<p class="header-subtitle">Veni Vidi Vici</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/AzraelDeath" title="github">github</a>
			        
						<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/azraeldeath" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-BZOJ2466【中山市选2009】树 高斯消元" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/BZOJ2466【中山市选2009】树 高斯消元/" class="article-date">
  	<time datetime="2017-10-16T16:00:00.000Z" itemprop="datePublished">2017-10-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/BZOJ2466【中山市选2009】树 高斯消元/">
        BZOJ2466 【中山市选2009】树 &lt;高斯消元&gt;
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>【中山市选2009】树</p>
<p>Time Limit: 10 Sec<br>Memory Limit: 128 MB</p>
<p>Description<br>图论中的树为一个无环的无向图。给定一棵树，每个节点有一盏指示灯和一个按钮。如果节点的按扭被按了，那么该节点的灯会从熄灭变为点亮（当按之前是熄灭的），或者从点亮到熄灭（当按之前是点亮的），并且该节点的直接邻居也发生同样的变化。开始的时候，所有的指示灯都是熄灭的。<br>请编程计算最少要按多少次按钮，才能让所有节点的指示灯变为点亮状态。</p>
<p>Input<br>输入文件有多组数据。<br>输入第一行包含一个整数n，表示树的节点数目。每个节点的编号从1到n。<br>输入接下来的n – 1行，每一行包含两个整数x，y，表示节点x和y之间有一条无向边。<br>当输入n为0时，表示输入结束。<br>Output<br>对于每组数据，输出最少要按多少次按钮，才能让所有节点的指示灯变为点亮状态。每一组数据独占一行。</p>
<p>Sample Input<br>3<br>1 2<br>1 3<br>0<br>Sample Output<br>1</p>
<p>HINT<br>对于100%的数据，满足1 &lt;= n &lt;=100。</p>
</blockquote>
<p>标签：高斯消元</p>
<p>将所有节点按的次数设为x1~xn，会得到一个线性异或方程组。<br>这时可以bitset+高消水过。不懂高消可以戳这里：<a href="http://www.cppblog.com/menjitianya/archive/2014/06/08/207226.html" target="_blank" rel="external">http://www.cppblog.com/menjitianya/archive/2014/06/08/207226.html</a></p>
<p>附上代码：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bitset&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 100</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, x[MAX_N+<span class="number">5</span>], num[MAX_N+<span class="number">5</span>], cnt;</div><div class="line"><span class="built_in">bitset</span> &lt;MAX_N+5&gt; f[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;cnt = <span class="number">0</span>;	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	f[i].reset(), f[i][i] = f[i][n+<span class="number">1</span>] = <span class="number">1</span>;&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">gauss</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> cur = <span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, tmp; i &lt;= n; i++) &#123;</div><div class="line">		<span class="keyword">for</span> (tmp = cur; tmp &lt;= n; tmp++)	<span class="keyword">if</span> (f[tmp][i] == <span class="number">1</span>)	<span class="keyword">break</span>;</div><div class="line">		<span class="keyword">if</span> (tmp &gt; n) &#123;num[cnt++] = i;	<span class="keyword">continue</span>;&#125;	swap(f[cur], f[tmp]);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)	<span class="keyword">if</span> (j != cur &amp;&amp; f[j][i])	f[j] ^= f[cur];</div><div class="line">		cur++;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> sta)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> ret = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	x[i] = f[i][n+<span class="number">1</span>];</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; i++) &#123;</div><div class="line">		<span class="keyword">if</span> (!(sta&amp;(<span class="number">1</span>&lt;&lt;i)))	<span class="keyword">continue</span>;	ret++;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)	<span class="keyword">if</span> (f[j][num[i]])	x[j] ^= <span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	ret += x[i];</div><div class="line">	<span class="keyword">return</span> ret;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) &amp;&amp; n != <span class="number">0</span>) &#123;</div><div class="line">		init();</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v; i &lt; n; i++)	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v), f[u][v] = f[v][u] = <span class="number">1</span>;</div><div class="line">		gauss();	<span class="keyword">int</span> ans = n;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> sta = <span class="number">0</span>; sta &lt; (<span class="number">1</span>&lt;&lt;cnt); sta++)	ans = min(ans, calc(sta));</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/BZOJ/">BZOJ</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数论数学/">数论数学</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/省选/">省选</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/高斯消元/">高斯消元</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-BZOJ1070【SCOI2007】修车 费用流" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/BZOJ1070【SCOI2007】修车 费用流/" class="article-date">
  	<time datetime="2017-10-16T16:00:00.000Z" itemprop="datePublished">2017-10-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/BZOJ1070【SCOI2007】修车 费用流/">
        BZOJ1070【SCOI2007】修车 &lt;费用流&gt;
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>【SCOI2007】修车</p>
<p>Time Limit: 1 Sec    Memory Limit: 128 MB</p>
<p>Description<br>同一时刻有N位车主带着他们的爱车来到了汽车维修中心。维修中心共有M位技术人员，不同的技术人员对不同<br>的车进行维修所用的时间是不同的。现在需要安排这M位技术人员所维修的车及顺序，使得顾客平均等待的时间最<br>小。<br>说明：顾客的等待时间是指从他把车送至维修中心到维修完毕所用的时间。</p>
<p>Input<br>第一行有两个m,n，表示技术人员数与顾客数。 接下来n行，每行m个整数。第i+1行第j个数表示第j位技术人<br>员维修第i辆车需要用的时间T。<br>Output<br>最小平均等待时间，答案精确到小数点后2位。</p>
<p>Sample Input<br>2 2<br>3 2<br>1 4<br>Sample Output<br>1.50</p>
<p>HINT<br>数据范围: (2&lt;=M&lt;=9,1&lt;=N&lt;=60), (1&lt;=T&lt;=1000)</p>
</blockquote>
<p>标签：费用流</p>
<p>此题建模是费用流中常见的拆点建模。<br>把每个技术人员拆成n个点，第k个点代表着此工作人员修的倒数第k辆车对答案的贡献。<br>对于每个顾客，如果他倒数第k个修车，花费t的时间，会对答案产生t<em>k的贡献。<br>因此从每个顾客向每个技术人员的n个点连边，容量为1，花费为t</em>k，然后跑费用流即可。</p>
<p>附上AC代码：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 10000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_M 200000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2147483647</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m, s, t, ans, a[<span class="number">65</span>][<span class="number">10</span>];</div><div class="line"><span class="keyword">int</span> pre[MAX_N+<span class="number">5</span>], cnt;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span><span class="keyword">int</span> v, c, w, nxt;&#125; E[MAX_M+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;s = <span class="number">0</span>, t = n*m+n+<span class="number">1</span>, cnt = <span class="number">0</span>;	<span class="built_in">memset</span>(pre, <span class="number">-1</span>, <span class="keyword">sizeof</span>(pre));&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> c, <span class="keyword">int</span> w)</span> </span>&#123;</div><div class="line">	E[cnt].v = v, E[cnt].c = c, E[cnt].w = w, E[cnt].nxt = pre[u], pre[u] = cnt++;</div><div class="line">	E[cnt].v = u, E[cnt].c = <span class="number">0</span>, E[cnt].w =-w, E[cnt].nxt = pre[v], pre[v] = cnt++;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">SPFA</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; que;	<span class="keyword">bool</span> inque[MAX_N+<span class="number">5</span>];	<span class="keyword">int</span> dis[MAX_N+<span class="number">5</span>], pree[MAX_N+<span class="number">5</span>];</div><div class="line">	<span class="built_in">memset</span>(inque, <span class="literal">false</span>, <span class="keyword">sizeof</span>(inque)), <span class="built_in">memset</span>(pree, <span class="number">-1</span>, <span class="keyword">sizeof</span>(pree));</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = s; i &lt;= t; i++)	dis[i] = INF;</div><div class="line">	dis[s] = <span class="number">0</span>, que.push(s), inque[s] = <span class="literal">true</span>;</div><div class="line">	<span class="keyword">while</span> (!que.empty()) &#123;</div><div class="line">		<span class="keyword">int</span> u = que.front();	que.pop(), inque[u] = <span class="literal">false</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = pre[u]; ~i; i = E[i].nxt) &#123;</div><div class="line">			<span class="keyword">int</span> v = E[i].v, c = E[i].c, w = E[i].w;</div><div class="line">			<span class="keyword">if</span> (c &amp;&amp; dis[u]+w &lt; dis[v]) &#123;</div><div class="line">				dis[v] = dis[u]+w, pree[v] = i;</div><div class="line">				<span class="keyword">if</span> (!inque[v])	que.push(v), inque[v] = <span class="literal">true</span>;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (dis[t] == INF)	<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	<span class="keyword">int</span> flow = INF;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = pree[t]; ~i; i = pree[E[i^<span class="number">1</span>].v])	flow = min(flow, E[i].c);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = pree[t]; ~i; i = pree[E[i^<span class="number">1</span>].v])	E[i].c -= flow, E[i^<span class="number">1</span>].c += flow;</div><div class="line">	ans += dis[t];	<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;m, &amp;n), init();</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++)	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i][j]);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	insert(s, i, <span class="number">1</span>, <span class="number">0</span>);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++)	<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= n; k++)	insert(i, j*n+k, <span class="number">1</span>, a[i][j]*k);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++)	<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= n; k++)	insert(j*n+k, t, <span class="number">1</span>, <span class="number">0</span>);</div><div class="line">	<span class="keyword">while</span> (SPFA()) ;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%.2lf"</span>, (<span class="keyword">double</span>)ans/n);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/BZOJ/">BZOJ</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/图论/">图论</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/省选/">省选</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/费用流/">费用流</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-BZOJ1972【SDOI2010】猪国杀" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/BZOJ1972【SDOI2010】猪国杀/" class="article-date">
  	<time datetime="2017-10-16T16:00:00.000Z" itemprop="datePublished">2017-10-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/BZOJ1972【SDOI2010】猪国杀/">
        BZOJ1972 【SDOI2010】 猪国杀 &lt;模拟&gt;
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>【SDOI2010】猪国杀<br>Time Limit: 1 Sec  Memory Limit: 64 MB</p>
<p>题目描述 Description</p>
<ol>
<li>概述<pre><code>《猪国杀》是一种多猪牌类回合制游戏，一共有三种角色：主猪，忠猪，反猪。
每局游戏主猪有且只有一只，忠猪和反猪可以有多只，每只猪扮演一种角色。
</code></pre></li>
<li>游戏目的：<pre><code>·主猪（MP）：自己存活的情况下消灭所有的反猪。
·忠猪（ZP）：不惜一切保护主猪，胜利条件与主猪相同。
·反猪（FP）：杀死主猪。
</code></pre></li>
<li>游戏过程：<pre><code>·游戏开始时候，每个玩家手里都会有4张牌，且体力上限和初始体力都是4。
·开始游戏时，从主猪开始，按照逆时针方向（数据中就是按照编号从1,2,3..n,1..的顺序）依次行动。
·每个玩家自己的回合可以分为2个阶段：
·摸牌阶段：
    ·从牌堆顶部摸两张牌，依次放到手牌的最右边。
·出牌阶段：
    ·你可以使用0张到任意张牌，每次使用牌的时候都使用最靠左的能够使用的牌。
    ·当然，要满足如下规则：
        ·1.如果没有猪哥连弩，每个出牌阶段只能使用一次“杀”来攻击。
        ·2.任何牌被使用后被弃置（武器是装备上）。
        ·被弃置的牌以后都不能再用，即与游戏无关。
</code></pre></li>
<li>各种牌介绍：<pre><code>·每张手牌用一个字母表示，字母代表牌的种类。
·基本牌：
    『桃(P)』：
        ·在自己的回合内，如果自己的体力值不等于体力上限，那么使用一个桃可以为自己补充一点体力，否则不能使用桃。
        ·桃只能对自己使用。
        ·在自己的回合外，如果自己的血变为0或者更低，那么也可以使用。
    『杀(K)』：
        ·在自己的回合内，对攻击范围内除自己以外的一名角色使用。
        ·如果没有被『闪』抵消，则造成1点伤害。无论有无武器，杀的攻击范围都是1。
    『闪(D)』：
        ·当你受到杀的攻击时，可以弃置一张闪来抵消杀的效果。
·锦囊牌：
    『决斗(F)』：
        ·出牌阶段，对除自己以外任意一名角色使用，由目标角色先开始，自己和目标角色轮流弃置一张杀，首先没有杀可弃的一方受到1点伤害，另一方视为此伤害的来源。
    『南猪入侵(N)』：
        ·出牌阶段，对除你以外所有角色使用，按逆时针顺序从使用者下家开始依次结算，除非弃置一张杀，否则受到1点伤害。
    『万箭齐发(W)』：
        ·和南猪入侵类似，不过要弃置的不是杀而是闪。
    『无懈可击(J)』：
        ·在目标锦囊生效前抵消其效果。
        ·每次有一张锦囊即将生效时，从使用这张锦囊的猪开始，按照逆时针顺序，依次得到使用无懈可击的机会。
        ·效果：
            ·用于决斗时，决斗无效并弃置。
            ·用于南猪入侵或万箭齐发时，当结算到某个角色时才能使用，当前角色不需弃置牌并且不会受到伤害（仅对一个角色产生效果）。
            ·用于无懈可击时，成为目标的无懈可击被无效。
·装备牌：
    『猪哥连弩(Z)』：
        ·武器，攻击范围1，出牌阶段你可以使用任意张杀。
    ·同一时刻最多只能装一个武器。
    ·如果先前已经有了一把武器，那么之后再装武器的话，会弃置以前的武器来装现在的武器。
</code></pre></li>
<li>特殊事件及概念解释：<pre><code>·伤害来源：
    ·杀、南猪入侵、万箭齐发的伤害来源均是使用该牌的猪。
    ·决斗的伤害来源如上。
·距离：
    ·两只猪的距离定义为沿着逆时针方向间隔的猪数＋1。即初始时1和2的距离为1，但是2和1的距离就是n-1。
    ·注意一个角色的死亡会导致一些猪距离的改变；
·玩家死亡：
    ·如果该玩家的体力降到0或者更低，并且自己手中没有足够的桃使得自己的体力值回到1，那么就死亡了。
    ·死亡后所有的牌（装备区，手牌区）被弃置。
·奖励与惩罚：
    ·反猪死亡时，最后一个伤害来源处（即使是反猪）立即摸三张牌。
    ·忠猪死亡时，如果最后一个伤害来源是主猪，那么主猪所有装备牌、手牌被弃置。
·注意，一旦达成胜利条件，游戏立刻结束，因此即使会摸3张牌或者还有牌可以用也不用执行了。
</code></pre></li>
<li>几种行为：<pre><code>·献殷勤：
    ·使用无懈可击挡下南猪入侵、万箭齐发、决斗。
    ·使用无懈可击抵消表敌意。
·表敌意：
    ·对某个角色使用杀、决斗。
    ·使用无懈可击抵消献殷勤。
·跳忠：
    ·即通过行动表示自己是忠猪。
    ·跳忠行动就是对主猪或对某只已经跳忠的猪献殷勤，或者对某只已经跳反的猪表敌意。
·跳反：
    ·即通过行动表示自己是反猪。
    ·跳反行动就是对主猪或对某只已经跳忠的猪表敌意，或者对某只已经跳反的猪献殷勤。
·忠猪不会跳反，反猪也不会跳忠。
·不管是忠猪还是反猪，能够跳必然跳。
</code></pre></li>
<li>行动准则：<pre><code>·共性：
    ·每个角色如果手里有桃且生命值未满，那么必然吃掉。
    ·有南猪入侵、万箭齐发、必然使用。
    ·有装备必然装上。
    ·受到杀时，有闪必然弃置。
    ·响应南猪入侵或者万箭齐发时候，有杀/闪必然弃置。
    ·不会对未表明身份的猪献殷勤（包括自己）。
·特性：
    ·主猪：
        ·主猪会认为没有跳身份，且用南猪入侵/万箭齐发对自己造成伤害的猪是类反猪（没伤害到不算，注意类反猪并没有表明身份），如果之后跳了，那么主猪会重新认识这只猪。
        ·对于每种表敌意的方式，对逆时针方向能够执行到的第一只类反猪或者已跳反猪表；如果没有，那么就不表敌意。
        ·决斗时会不遗余力弃置杀。
        ·如果能对已经跳忠的猪或自己献殷勤，那么一定献。
        ·如果能够对已经跳反的猪表敌意，那么一定表。
    ·忠猪：
        ·对于每种表敌意的方式，对逆时针方向能够执行到的第一只已经跳反的猪表，如果没有，那么就不表敌意。
        ·决斗时，如果对方是主猪，那么不会弃置杀，否则，会不遗余力弃置杀。
        ·如果有机会对主猪或者已经跳忠的猪献殷勤，那么一定献。
    ·反猪：
        ·对于每种表敌意的方式，如果有机会则对主猪表，否则，对逆时针方向能够执行到的第一只已经跳忠的猪表，如果没有，那么就不表敌意。
        ·决斗时会不遗余力弃置杀。
        ·如果有机会对已经跳反的猪献殷勤，那么一定献。
</code></pre>现在，我们已经知道每只猪的角色、手牌，还有牌堆初始情况，并且假设每个角色会按照如下的行为准则进行游戏，你需要做的就是告诉小猪iPig最后的结果。<br>限于iPig只会用P++语言写A+B，他请你用Pigcal(Pascal)、P(C)或P++(C++)语言来帮他预测最后的结果。</li>
</ol>
<p>输入描述 Input Description<br>输入文件第一行包含两个正整数n(2&lt;=n&lt;=10)和m(m&lt;=2000)，分别代表玩家数和牌堆中牌的数量。数据保证牌的数量够用。<br>接下来n行，每行5个字符串，依次表示对第i只猪的角色和初始4张手牌描述。编号为1的肯定是主猪。<br>再接下来一行，一共m个字符串，按照从牌堆顶部到牌堆底部的顺序描述每张牌。<br>所有的相邻的两个字符串都严格用1个空格隔开，行尾没有多余空格。<br>输出描述 Output Description<br>输出数据第一行包含一个字符串代表游戏结果。如果是主猪胜利，那么输出MP，否则输出FP。数据保证游戏总会结束。<br>接下来n行，第i行是对第i只猪的手牌描述（注意只需要输出手牌），按照手牌从左往右的顺序输出，相邻两张牌用一个空格隔开，行末尾没有多余空格。如果这只猪已阵亡，那么只要输出DEAD即可。注意如果要输出手牌而没有手牌的话，那么只需输出一个空行。</p>
<p>样例数据 Sample Data<br>Sample Input #1<br>3 10<br>MP D D F F<br>ZP N N N D<br>FP J J J J<br>F F D D J J F F K D<br>Sample Output #1<br>FP<br>DEAD<br>DEAD<br>J J J J J J D</p>
<p>数据范围及提示 Data Size &amp; Hint<br>样例1说明：第一回合主猪没有目标可以表敌意；接下来忠猪使用了3张南猪入侵，主猪掉了3点体力，并认为该角色为类反猪，3号角色尽管手里有无懈可击，但是因为自己未表明身份，所以同样不能对自己用，乖乖掉3点体力；下一回合反猪无牌可出；接下来主猪对着类反猪爆发，使用4张决斗，忠猪死亡，结果主猪弃掉所有牌；下来反猪摸到一张杀直接杀死主猪获胜。<br>数据说明：一共20组测试数据，每个点5分。10%的数据没有锦囊牌，另外20%的数据没有无懈可击。</p>
</blockquote>
<p>如果觉得此题面不好看，请戳这里：<a href="https://mubu.com/doc/2707815814591da4" target="_blank" rel="external">https://mubu.com/doc/2707815814591da4</a></p>
<p>标签：模拟</p>
<p>本题是大模拟，题面很恶心，又长又绕，根本无法概括，不过读懂以后按序操作还是比较容易的。<br>坑点如下：<br>1.如果牌堆中没牌了，那么需要不断的摸取最后一张牌<br>2.无懈可击的使用：可以用来帮助身份已明且和自己一伙的人抵挡南猪入侵、万箭齐发、决杀等效果，或者帮助其抵消对方无懈可击的效果。一旦使出无懈可击即可表明自己的身份，表明身份后类反猪的身份会随之消失。注意无懈可击的使用顺序是从锦囊牌的出牌者开始按照逆时针的顺序进行出牌的。<br>3.一只猪死亡后立刻退场，不会再进行任何操作，所有手牌弃置。如果此时游戏结束，那么一切操作都暂停。<br>4.出完一张牌后（除桃）需要重新扫描所有的手牌，因为每次出牌可能会导致不同的猪身份的改变，进而前面跳过的牌可能有机会打出。<br>5.寻找打出杀得下家时要跳过已经死亡的猪。<br>6.打出决斗，无论最后是否生效，即认为身份表面。对于主猪对忠猪发起的决斗，忠猪乖乖掉血。</p>
<p>奉献几组样例，可以自测：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Sample Input #1</div><div class="line">3 10</div><div class="line">MP D D F F</div><div class="line">ZP N N N D</div><div class="line">FP J J J J</div><div class="line">F F D D J J F F K D</div><div class="line">Sample Output #1</div><div class="line">FP</div><div class="line">DEAD</div><div class="line">DEAD</div><div class="line">J J J J J J D</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">Sample Input #2</div><div class="line">5 10</div><div class="line">MP W D F K</div><div class="line">ZP N N D D</div><div class="line">FP F W W K</div><div class="line">ZP K K N D</div><div class="line">FP K D P W</div><div class="line">J K W K D N N K J N</div><div class="line">Sample Output #2</div><div class="line">MP</div><div class="line">F N</div><div class="line">D</div><div class="line">DEAD</div><div class="line">DEAD</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Sample Input #3</div><div class="line">3 4</div><div class="line">MP J J K N</div><div class="line">ZP J D K W</div><div class="line">FP P N P K</div><div class="line">J J K W</div><div class="line">Sample Output #3</div><div class="line">MP</div><div class="line">K K</div><div class="line">DEAD</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Sample Input #4</div><div class="line">3 10</div><div class="line">MP W D J W</div><div class="line">ZP J P D N</div><div class="line">FP N D F F</div><div class="line">J D N N F J J D K W</div><div class="line">Sample Output #4</div><div class="line">MP</div><div class="line">D J D</div><div class="line">DEAD</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Sample Input #5</div><div class="line">3 1</div><div class="line">MP D N F K</div><div class="line">ZP F W F N</div><div class="line">FP D N N D</div><div class="line">K</div><div class="line">Sample Output #5</div><div class="line">MP</div><div class="line">K</div><div class="line">F K K</div><div class="line">DEAD</div></pre></td></tr></table></figure>
<p>附上AC代码：<br>注释版<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 10</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_M 2000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m, Type[MAX_N+<span class="number">5</span>];	<span class="comment">//真实身份（1主公 2忠臣 3反贼）</span></div><div class="line"><span class="keyword">int</span> lft;	<span class="keyword">bool</span> GameOver;	<span class="comment">//剩余反贼、游戏结束标记</span></div><div class="line"><span class="keyword">char</span> Heap[MAX_M*<span class="number">2</span>+<span class="number">5</span>];	<span class="keyword">int</span> CurPos;	<span class="comment">//牌堆</span></div><div class="line"><span class="keyword">int</span> bef[MAX_M*<span class="number">5</span>+<span class="number">5</span>], nxt[MAX_M*<span class="number">5</span>+<span class="number">5</span>], cnt;	<span class="keyword">char</span> c[MAX_M*<span class="number">5</span>+<span class="number">5</span>];	<span class="comment">//手牌</span></div><div class="line"><span class="function"><span class="keyword">char</span> <span class="title">Draw</span><span class="params">()</span> </span>&#123;CurPos = CurPos == m ? m : CurPos+<span class="number">1</span>;	<span class="keyword">return</span> Heap[CurPos];&#125;	<span class="comment">//摸牌</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Attack</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span></span>;	<span class="function"><span class="keyword">void</span> <span class="title">Duel</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span></span>;	<span class="function"><span class="keyword">void</span> <span class="title">Invade</span><span class="params">(<span class="keyword">int</span>)</span></span>;	<span class="function"><span class="keyword">void</span> <span class="title">Arrow</span><span class="params">(<span class="keyword">int</span>)</span></span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Player</span> &#123;</span></div><div class="line">	<span class="keyword">int</span> id, Sta;	<span class="comment">//编号、目前身份（0没跳 1类反 2跳忠 3跳反）</span></div><div class="line">	<span class="keyword">int</span> head, tail, now, tp;	<span class="comment">//手牌链表</span></div><div class="line">	<span class="keyword">int</span> cntWX, cntA, cntP, cntS;	<span class="comment">//手中无懈可击、杀、桃、闪的数量</span></div><div class="line">	<span class="keyword">int</span> blood, atk, pre, suc;	<span class="comment">//血量、首要攻击目标、存活的上一头猪、存活的下一头猪</span></div><div class="line">	<span class="keyword">bool</span> dead, equip;	<span class="comment">//是否死亡、是否装备连弩</span></div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Bonus</span><span class="params">()</span> </span>&#123;	<span class="comment">//奖励</span></div><div class="line">		c[++cnt] = Draw(), bef[cnt] = tail;</div><div class="line">		<span class="keyword">if</span> (head == <span class="number">0</span>)	head = tail = cnt;</div><div class="line">		<span class="keyword">else</span>	nxt[tail] = cnt, tail = cnt;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</div><div class="line">		c[++cnt] = Draw(), bef[cnt] = tail;</div><div class="line">		nxt[tail] = cnt, tail = cnt;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</div><div class="line">		c[++cnt] = Draw(), bef[cnt] = tail;</div><div class="line">		nxt[tail] = cnt, tail = cnt;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Punish</span><span class="params">()</span> </span>&#123;	<span class="comment">//惩罚</span></div><div class="line">		head = tail = now = cntWX = cntA = cntP = cntS = <span class="number">0</span>, equip = <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">DrawSession</span><span class="params">()</span> </span>&#123;	<span class="comment">//摸牌阶段</span></div><div class="line">		c[++cnt] = Draw(), bef[cnt] = tail;</div><div class="line">		<span class="keyword">if</span> (head == <span class="number">0</span>)	head = tail = cnt;</div><div class="line">		<span class="keyword">else</span>	nxt[tail] = cnt, tail = cnt;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</div><div class="line">		c[++cnt] = Draw(), bef[cnt] = tail;</div><div class="line">		nxt[tail] = cnt, tail = cnt;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Use</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;	<span class="comment">//使用一张牌</span></div><div class="line">		<span class="keyword">if</span> (c[x] == <span class="string">'J'</span>)	cntWX--;</div><div class="line">		<span class="keyword">if</span> (c[x] == <span class="string">'K'</span>)	cntA--;</div><div class="line">		<span class="keyword">if</span> (c[x] == <span class="string">'P'</span>)	cntP--;</div><div class="line">		<span class="keyword">if</span> (c[x] == <span class="string">'D'</span>)	cntS--;</div><div class="line">		<span class="keyword">if</span> (x == head &amp;&amp; x == tail)	head = tail = <span class="number">0</span>;</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (x == head)	head = nxt[x], bef[nxt[x]] = <span class="number">0</span>;</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (x == tail)	tail = bef[x], nxt[bef[x]] = <span class="number">0</span>;</div><div class="line">		<span class="keyword">else</span>	bef[nxt[x]] = bef[x], nxt[bef[x]] = nxt[x];</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">char</span> <span class="title">GetNxt</span><span class="params">()</span> </span>&#123;	<span class="comment">//返回下一张牌</span></div><div class="line">		<span class="keyword">if</span> (!now)	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">		tp = now, now = nxt[now];</div><div class="line">		<span class="keyword">return</span> c[tp];</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">findWX</span><span class="params">()</span> </span>&#123;	<span class="comment">//找下一张无懈可击</span></div><div class="line">		now = head;	<span class="keyword">char</span> tmp;</div><div class="line">		<span class="keyword">while</span> (tmp = GetNxt())	<span class="keyword">if</span> (tmp == <span class="string">'J'</span>)	<span class="keyword">return</span> tp;	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">findA</span><span class="params">()</span> </span>&#123;	<span class="comment">//找下一张杀</span></div><div class="line">		now = head;	<span class="keyword">char</span> tmp;</div><div class="line">		<span class="keyword">while</span> (tmp = GetNxt())	<span class="keyword">if</span> (tmp == <span class="string">'K'</span>)	<span class="keyword">return</span> tp;	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">findP</span><span class="params">()</span> </span>&#123;	<span class="comment">//找下一张桃</span></div><div class="line">		now = head;	<span class="keyword">char</span> tmp;</div><div class="line">		<span class="keyword">while</span> (tmp = GetNxt())	<span class="keyword">if</span> (tmp == <span class="string">'P'</span>)	<span class="keyword">return</span> tp;	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">findS</span><span class="params">()</span> </span>&#123;	<span class="comment">//找下一张闪</span></div><div class="line">		now = head;	<span class="keyword">char</span> tmp;</div><div class="line">		<span class="keyword">while</span> (tmp = GetNxt())	<span class="keyword">if</span> (tmp == <span class="string">'D'</span>)	<span class="keyword">return</span> tp;	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">tryWX</span><span class="params">()</span> </span>&#123;	<span class="comment">//尝试出无懈可击</span></div><div class="line">		<span class="keyword">if</span> (cntWX) &#123;Use(findWX());	<span class="keyword">return</span> <span class="literal">true</span>;&#125;</div><div class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">tryA</span><span class="params">()</span> </span>&#123;	<span class="comment">//尝试出杀</span></div><div class="line">		<span class="keyword">if</span> (cntA) &#123;Use(findA());	<span class="keyword">return</span> <span class="literal">true</span>;&#125;</div><div class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">tryS</span><span class="params">()</span> </span>&#123;	<span class="comment">//尝试出闪</span></div><div class="line">		<span class="keyword">if</span> (cntS) &#123;Use(findS());	<span class="keyword">return</span> <span class="literal">true</span>;&#125;</div><div class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">tryP</span><span class="params">()</span> </span>&#123;	<span class="comment">//尝试出桃</span></div><div class="line">		<span class="keyword">if</span> (cntP) &#123;Use(findP());	<span class="keyword">return</span> <span class="literal">true</span>;&#125;</div><div class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Round</span><span class="params">()</span> </span>&#123;</div><div class="line">		DrawSession();	now = head;</div><div class="line">		<span class="keyword">bool</span> atked = <span class="literal">false</span>;	<span class="keyword">char</span> tmp;</div><div class="line">		<span class="keyword">while</span> ((tmp = GetNxt()) &amp;&amp; !GameOver) &#123;</div><div class="line">			<span class="comment">//cout &lt;&lt; tmp &lt;&lt; " ";</span></div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'D'</span> || tmp == <span class="string">'J'</span>)	<span class="keyword">continue</span>;</div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'K'</span> &amp;&amp; atk == suc &amp;&amp; (!atked || equip)) &#123;</div><div class="line">				Use(tp), Attack(id, atk), now = head, atked = <span class="literal">true</span>;</div><div class="line">				<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'P'</span> &amp;&amp; blood != <span class="number">4</span>)	Use(tp), blood++;</div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'F'</span>) &#123;</div><div class="line">				<span class="keyword">if</span> (!atk)	<span class="keyword">continue</span>;</div><div class="line">				Use(tp);</div><div class="line">				<span class="keyword">if</span> (Type[id] == <span class="number">3</span>)	Duel(id, <span class="number">1</span>);</div><div class="line">				<span class="keyword">else</span>	Duel(id, atk);</div><div class="line">				now = head;</div><div class="line">				<span class="keyword">if</span> (GameOver || dead)	<span class="keyword">return</span>;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'N'</span>) &#123;</div><div class="line">				Use(tp), Invade(id), now = head;</div><div class="line">				<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'W'</span>) &#123;</div><div class="line">				Use(tp), Arrow(id), now = head;</div><div class="line">				<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'Z'</span>)	Use(tp), equip = <span class="literal">true</span>, now = head;</div><div class="line">		&#125;</div><div class="line">		<span class="comment">//cout &lt;&lt; endl;</span></div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Output</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (dead) &#123;<span class="built_in">printf</span>(<span class="string">"DEAD\n"</span>);	<span class="keyword">return</span>;&#125;</div><div class="line">		<span class="keyword">for</span> (; head; head = nxt[head])</div><div class="line">			<span class="keyword">if</span> (head == tail)	<span class="built_in">cout</span> &lt;&lt; c[head];</div><div class="line">			<span class="keyword">else</span>	<span class="built_in">cout</span> &lt;&lt; c[head] &lt;&lt; <span class="string">' '</span>;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"\n"</span>);</div><div class="line">	&#125;</div><div class="line">&#125; pig[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">FindAtk</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> y = pig[x].suc;</div><div class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">1</span>) &#123;</div><div class="line">		<span class="keyword">while</span> (y != x) &#123;</div><div class="line">			<span class="keyword">if</span> (pig[y].Sta == <span class="number">1</span> || pig[y].Sta == <span class="number">3</span>) &#123;</div><div class="line">				pig[x].atk = y;	<span class="keyword">return</span>;</div><div class="line">			&#125;</div><div class="line">			y = pig[y].suc;</div><div class="line">		&#125;</div><div class="line">		pig[x].atk = <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">2</span>) &#123;</div><div class="line">		<span class="keyword">while</span> (y != x) &#123;</div><div class="line">			<span class="keyword">if</span> (pig[y].Sta == <span class="number">3</span>) &#123;</div><div class="line">				pig[x].atk = y;	<span class="keyword">return</span>;</div><div class="line">			&#125;</div><div class="line">			y = pig[y].suc;</div><div class="line">		&#125;</div><div class="line">		pig[x].atk = <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">3</span>) &#123;</div><div class="line">		<span class="keyword">while</span> (y != x) &#123;</div><div class="line">			<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta == <span class="number">2</span>) &#123;</div><div class="line">				pig[x].atk = y;	<span class="keyword">return</span>;</div><div class="line">			&#125;</div><div class="line">			y = pig[y].suc;</div><div class="line">		&#125;</div><div class="line">		pig[x].atk = <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Maintain</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> x = pig[<span class="number">1</span>].suc;	FindAtk(<span class="number">1</span>);</div><div class="line">	<span class="keyword">while</span> (x != <span class="number">1</span>)	FindAtk(x), x = pig[x].suc;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Kill</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;	<span class="comment">//杀死对方</span></div><div class="line">	pig[y].dead = <span class="literal">true</span>;</div><div class="line">	<span class="keyword">if</span> (Type[y] == <span class="number">1</span>) &#123;GameOver = <span class="literal">true</span>;	<span class="keyword">return</span>;&#125;</div><div class="line">	<span class="keyword">if</span> (Type[y] == <span class="number">3</span>) &#123;</div><div class="line">		<span class="keyword">if</span> (--lft == <span class="number">0</span>) &#123;GameOver = <span class="literal">true</span>;	<span class="keyword">return</span>;&#125;</div><div class="line">		pig[x].Bonus();</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">1</span> &amp;&amp; Type[y] == <span class="number">2</span>)	pig[x].Punish();</div><div class="line">	<span class="keyword">int</span> PRE = pig[y].pre, SUC = pig[y].suc;</div><div class="line">	pig[PRE].suc = SUC, pig[SUC].pre = PRE;</div><div class="line">	Maintain();</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Hurt</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;	<span class="comment">//命中对方</span></div><div class="line">	<span class="keyword">if</span> (--pig[y].blood == <span class="number">0</span>)</div><div class="line">		<span class="keyword">if</span> (pig[y].tryP())	pig[y].blood++;</div><div class="line">		<span class="keyword">else</span>	Kill(x, y);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Attack</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;	<span class="comment">//杀</span></div><div class="line">	<span class="keyword">if</span> (Type[x] != <span class="number">1</span> &amp;&amp; pig[x].Sta &lt; <span class="number">2</span>) &#123;</div><div class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">3</span>)	pig[x].Sta = <span class="number">2</span>;</div><div class="line">		<span class="keyword">else</span>	pig[x].Sta = <span class="number">3</span>;</div><div class="line">		Maintain();</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (!pig[y].tryS())	Hurt(x, y);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">WXcycle</span><span class="params">(<span class="keyword">int</span> st, <span class="keyword">bool</span> YType)</span> </span>&#123;	<span class="comment">//无懈可击</span></div><div class="line">	<span class="keyword">int</span> last = st, x = st;	<span class="keyword">bool</span> ORI = YType;</div><div class="line">	<span class="keyword">if</span> (YType == (Type[x] == <span class="number">3</span>) &amp;&amp; pig[x].tryWX()) &#123;</div><div class="line">		last = x, YType ^= <span class="number">1</span>;</div><div class="line">		<span class="keyword">if</span> (pig[x].Sta &lt;= <span class="number">2</span>)	pig[x].Sta = <span class="number">3</span>-YType, Maintain();</div><div class="line">	&#125;</div><div class="line">	x = pig[x].suc;</div><div class="line">	<span class="keyword">while</span> (x != last) &#123;</div><div class="line">		<span class="keyword">if</span> (YType == (Type[x] == <span class="number">3</span>) &amp;&amp; pig[x].tryWX()) &#123;</div><div class="line">			last = x, YType ^= <span class="number">1</span>;</div><div class="line">			<span class="keyword">if</span> (pig[x].Sta &lt;= <span class="number">2</span>)	pig[x].Sta = <span class="number">3</span>-YType, Maintain();</div><div class="line">		&#125;</div><div class="line">		x = pig[x].suc;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ORI != YType;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Duel</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;	<span class="comment">//决斗</span></div><div class="line">	<span class="keyword">if</span> (Type[x] != <span class="number">1</span> &amp;&amp; pig[x].Sta &lt; <span class="number">2</span>) &#123;</div><div class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">3</span>)	pig[x].Sta = <span class="number">2</span>;</div><div class="line">		<span class="keyword">else</span>	pig[x].Sta = <span class="number">3</span>;</div><div class="line">		Maintain();</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta &gt;= <span class="number">2</span>)</div><div class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta == <span class="number">2</span>) &#123;</div><div class="line">			<span class="keyword">if</span> (WXcycle(x, <span class="number">0</span>))	<span class="keyword">return</span>;</div><div class="line">		&#125; <span class="keyword">else</span> &#123;</div><div class="line">			<span class="keyword">if</span> (WXcycle(x, <span class="number">1</span>))	<span class="keyword">return</span>;</div><div class="line">		&#125;</div><div class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">1</span> &amp;&amp; Type[y] == <span class="number">2</span>)	Hurt(x, y);</div><div class="line">	<span class="keyword">else</span>	<span class="keyword">for</span> (;;) &#123;</div><div class="line">		<span class="keyword">if</span> (!pig[y].tryA()) &#123;Hurt(x, y);	<span class="keyword">return</span>;&#125;</div><div class="line">		<span class="keyword">if</span> (!pig[x].tryA()) &#123;Hurt(y, x);	<span class="keyword">return</span>;&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Invade</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;	<span class="comment">//南猪入侵</span></div><div class="line">	<span class="keyword">int</span> y = pig[x].suc;</div><div class="line">	<span class="keyword">while</span> (y != x) &#123;</div><div class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta &gt;= <span class="number">2</span>)</div><div class="line">			<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta == <span class="number">2</span>) &#123;</div><div class="line">				<span class="keyword">if</span> (WXcycle(x, <span class="number">0</span>)) &#123;y = pig[y].suc;	<span class="keyword">continue</span>;&#125;</div><div class="line">			&#125; <span class="keyword">else</span> &#123;</div><div class="line">				<span class="keyword">if</span> (WXcycle(x, <span class="number">1</span>)) &#123;y = pig[y].suc;	<span class="keyword">continue</span>;&#125;</div><div class="line">			&#125;</div><div class="line">		<span class="keyword">if</span> (!pig[y].tryA()) &#123;</div><div class="line">			Hurt(x, y);	<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;</div><div class="line">			<span class="keyword">if</span> (y == <span class="number">1</span> &amp;&amp; pig[x].Sta == <span class="number">0</span>)	pig[x].Sta = <span class="number">1</span>, Maintain();</div><div class="line">		&#125;</div><div class="line">		y = pig[y].suc;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Arrow</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;	<span class="comment">//万箭齐发</span></div><div class="line">	<span class="keyword">int</span> y = pig[x].suc;</div><div class="line">	<span class="keyword">while</span> (y != x) &#123;</div><div class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta &gt;= <span class="number">2</span>)</div><div class="line">			<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta == <span class="number">2</span>) &#123;</div><div class="line">				<span class="keyword">if</span> (WXcycle(x, <span class="number">0</span>)) &#123;y = pig[y].suc;	<span class="keyword">continue</span>;&#125;</div><div class="line">			&#125; <span class="keyword">else</span> &#123;</div><div class="line">				<span class="keyword">if</span> (WXcycle(x, <span class="number">1</span>)) &#123;y = pig[y].suc;	<span class="keyword">continue</span>;&#125;</div><div class="line">			&#125;</div><div class="line">		<span class="keyword">if</span> (!pig[y].tryS()) &#123;</div><div class="line">			Hurt(x, y);	<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;</div><div class="line">			<span class="keyword">if</span> (y == <span class="number">1</span> &amp;&amp; pig[x].Sta == <span class="number">0</span>)	pig[x].Sta = <span class="number">1</span>, Maintain();</div><div class="line">		&#125;</div><div class="line">		y = pig[y].suc;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);	<span class="keyword">char</span> s[<span class="number">2</span>];	<span class="keyword">int</span> tot = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt; <span class="number">1</span>; i--)	pig[i].pre = i<span class="number">-1</span>;	pig[<span class="number">1</span>].pre = n;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++)	pig[i].suc = i+<span class="number">1</span>;	pig[n].suc = <span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);</div><div class="line">		<span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'M'</span>)	Type[i] = <span class="number">1</span>;</div><div class="line">		<span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'Z'</span>)	Type[i] = <span class="number">2</span>;</div><div class="line">		<span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'F'</span>)	Type[i] = <span class="number">3</span>, lft++;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);	Heap[++tot] = s[<span class="number">0</span>];</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);	Heap[++tot] = s[<span class="number">0</span>];</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);	Heap[++tot] = s[<span class="number">0</span>];</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);	Heap[++tot] = s[<span class="number">0</span>];</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)	<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s), Heap[++tot] = s[<span class="number">0</span>];	m = tot;	Maintain();</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	pig[i].id = i, pig[i].blood = <span class="number">4</span>, pig[i].DrawSession(), pig[i].DrawSession();</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> cur = <span class="number">1</span>; !GameOver; cur = pig[cur].suc)	pig[cur].Round();</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%s\n"</span>, pig[<span class="number">1</span>].dead ? <span class="string">"FP"</span> : <span class="string">"MP"</span>);	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	pig[i].Output();</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>压行版<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 10</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_M 2000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m, Type[MAX_N+<span class="number">5</span>], lft, CurPos, cnt;	<span class="keyword">bool</span> GameOver;</div><div class="line"><span class="keyword">char</span> Heap[MAX_M*<span class="number">2</span>+<span class="number">5</span>], c[MAX_M*<span class="number">5</span>+<span class="number">5</span>];	<span class="keyword">int</span> bef[MAX_M*<span class="number">5</span>+<span class="number">5</span>], nxt[MAX_M*<span class="number">5</span>+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">char</span> <span class="title">Draw</span><span class="params">()</span> </span>&#123;CurPos = CurPos == m ? m : CurPos+<span class="number">1</span>;	<span class="keyword">return</span> Heap[CurPos];&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Attack</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span></span>;	<span class="function"><span class="keyword">void</span> <span class="title">Duel</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span></span>;	<span class="function"><span class="keyword">void</span> <span class="title">Invade</span><span class="params">(<span class="keyword">int</span>)</span></span>;	<span class="function"><span class="keyword">void</span> <span class="title">Arrow</span><span class="params">(<span class="keyword">int</span>)</span></span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Player</span> &#123;</span></div><div class="line">	<span class="keyword">int</span> id, Sta, head, tail, now, tp, cntWX, cntA, cntP, cntS, blood, atk, pre, suc;	<span class="keyword">bool</span> dead, equip;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Bonus</span><span class="params">()</span> </span>&#123;</div><div class="line">		c[++cnt] = Draw(), bef[cnt] = tail;	<span class="keyword">if</span> (head == <span class="number">0</span>)	head = tail = cnt;	<span class="keyword">else</span>	nxt[tail] = cnt, tail = cnt;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</div><div class="line">		c[++cnt] = Draw(), bef[cnt] = tail;	nxt[tail] = cnt, tail = cnt;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</div><div class="line">		c[++cnt] = Draw(), bef[cnt] = tail;	nxt[tail] = cnt, tail = cnt;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Punish</span><span class="params">()</span> </span>&#123;head = tail = now = cntWX = cntA = cntP = cntS = <span class="number">0</span>, equip = <span class="literal">false</span>;&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">DrawSession</span><span class="params">()</span> </span>&#123;</div><div class="line">		c[++cnt] = Draw(), bef[cnt] = tail;	<span class="keyword">if</span> (head == <span class="number">0</span>)	head = tail = cnt;	<span class="keyword">else</span>	nxt[tail] = cnt, tail = cnt;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</div><div class="line">		c[++cnt] = Draw(), bef[cnt] = tail;	nxt[tail] = cnt, tail = cnt;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Use</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (c[x] == <span class="string">'J'</span>)	cntWX--;	<span class="keyword">if</span> (c[x] == <span class="string">'K'</span>)	cntA--;	<span class="keyword">if</span> (c[x] == <span class="string">'P'</span>)	cntP--;	<span class="keyword">if</span> (c[x] == <span class="string">'D'</span>)	cntS--;</div><div class="line">		<span class="keyword">if</span> (x == head &amp;&amp; x == tail)	head = tail = <span class="number">0</span>;	<span class="keyword">else</span> <span class="keyword">if</span> (x == head)	head = nxt[x], bef[nxt[x]] = <span class="number">0</span>;</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (x == tail)	tail = bef[x], nxt[bef[x]] = <span class="number">0</span>;	<span class="keyword">else</span>	bef[nxt[x]] = bef[x], nxt[bef[x]] = nxt[x];</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">char</span> <span class="title">GetNxt</span><span class="params">()</span> </span>&#123;<span class="keyword">if</span> (!now)	<span class="keyword">return</span> <span class="number">0</span>;	tp = now, now = nxt[now];	<span class="keyword">return</span> c[tp];&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">findWX</span><span class="params">()</span> </span>&#123;now = head;	<span class="keyword">char</span> tmp;	<span class="keyword">while</span> (tmp = GetNxt())	<span class="keyword">if</span> (tmp == <span class="string">'J'</span>)	<span class="keyword">return</span> tp;	<span class="keyword">return</span> <span class="number">0</span>;&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">findA</span><span class="params">()</span> </span>&#123;now = head;	<span class="keyword">char</span> tmp;	<span class="keyword">while</span> (tmp = GetNxt())	<span class="keyword">if</span> (tmp == <span class="string">'K'</span>)	<span class="keyword">return</span> tp;	<span class="keyword">return</span> <span class="number">0</span>;&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">findP</span><span class="params">()</span> </span>&#123;now = head;	<span class="keyword">char</span> tmp;	<span class="keyword">while</span> (tmp = GetNxt())	<span class="keyword">if</span> (tmp == <span class="string">'P'</span>)	<span class="keyword">return</span> tp;	<span class="keyword">return</span> <span class="number">0</span>;&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">findS</span><span class="params">()</span> </span>&#123;now = head;	<span class="keyword">char</span> tmp;	<span class="keyword">while</span> (tmp = GetNxt())	<span class="keyword">if</span> (tmp == <span class="string">'D'</span>)	<span class="keyword">return</span> tp;	<span class="keyword">return</span> <span class="number">0</span>;&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">tryWX</span><span class="params">()</span> </span>&#123;<span class="keyword">if</span> (cntWX) &#123;Use(findWX());	<span class="keyword">return</span> <span class="literal">true</span>;&#125;	<span class="keyword">return</span> <span class="literal">false</span>;&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">tryA</span><span class="params">()</span> </span>&#123;<span class="keyword">if</span> (cntA) &#123;Use(findA());	<span class="keyword">return</span> <span class="literal">true</span>;&#125;	<span class="keyword">return</span> <span class="literal">false</span>;&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">tryS</span><span class="params">()</span> </span>&#123;<span class="keyword">if</span> (cntS) &#123;Use(findS());	<span class="keyword">return</span> <span class="literal">true</span>;&#125;	<span class="keyword">return</span> <span class="literal">false</span>;&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">tryP</span><span class="params">()</span> </span>&#123;<span class="keyword">if</span> (cntP) &#123;Use(findP());	<span class="keyword">return</span> <span class="literal">true</span>;&#125;	<span class="keyword">return</span> <span class="literal">false</span>;&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Round</span><span class="params">()</span> </span>&#123;</div><div class="line">		DrawSession();	now = head;</div><div class="line">		<span class="keyword">bool</span> atked = <span class="literal">false</span>;	<span class="keyword">char</span> tmp;</div><div class="line">		<span class="keyword">while</span> ((tmp = GetNxt()) &amp;&amp; !GameOver) &#123;</div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'D'</span> || tmp == <span class="string">'J'</span>)	<span class="keyword">continue</span>;</div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'K'</span> &amp;&amp; atk == suc &amp;&amp; (!atked || equip))</div><div class="line">				&#123;Use(tp), Attack(id, atk), now = head, atked = <span class="literal">true</span>;	<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;&#125;</div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'P'</span> &amp;&amp; blood != <span class="number">4</span>)	Use(tp), blood++;</div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'F'</span>) &#123;</div><div class="line">				<span class="keyword">if</span> (!atk)	<span class="keyword">continue</span>;	Use(tp);</div><div class="line">				<span class="keyword">if</span> (Type[id] == <span class="number">3</span>)	Duel(id, <span class="number">1</span>);</div><div class="line">				<span class="keyword">else</span>	Duel(id, atk);	now = head;</div><div class="line">				<span class="keyword">if</span> (GameOver || dead)	<span class="keyword">return</span>;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'N'</span>) &#123;Use(tp), Invade(id), now = head;	<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;&#125;</div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'W'</span>) &#123;Use(tp), Arrow(id), now = head;	<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;&#125;</div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'Z'</span>)	Use(tp), equip = <span class="literal">true</span>, now = head;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Output</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (dead) &#123;<span class="built_in">printf</span>(<span class="string">"DEAD\n"</span>);	<span class="keyword">return</span>;&#125;</div><div class="line">		<span class="keyword">for</span> (; head; head = nxt[head])</div><div class="line">			<span class="keyword">if</span> (head == tail)	<span class="built_in">cout</span> &lt;&lt; c[head];</div><div class="line">			<span class="keyword">else</span>	<span class="built_in">cout</span> &lt;&lt; c[head] &lt;&lt; <span class="string">' '</span>;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"\n"</span>);</div><div class="line">	&#125;</div><div class="line">&#125; pig[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">FindAtk</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> y = pig[x].suc;</div><div class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">1</span>) &#123;</div><div class="line">		<span class="keyword">while</span> (y != x) &#123;<span class="keyword">if</span> (pig[y].Sta == <span class="number">1</span> || pig[y].Sta == <span class="number">3</span>) &#123;pig[x].atk = y;	<span class="keyword">return</span>;&#125;	y = pig[y].suc;&#125;</div><div class="line">		pig[x].atk = <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">2</span>) &#123;</div><div class="line">		<span class="keyword">while</span> (y != x) &#123;<span class="keyword">if</span> (pig[y].Sta == <span class="number">3</span>) &#123;pig[x].atk = y;	<span class="keyword">return</span>;&#125;	y = pig[y].suc;&#125;</div><div class="line">		pig[x].atk = <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">3</span>) &#123;</div><div class="line">		<span class="keyword">while</span> (y != x) &#123;<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta == <span class="number">2</span>) &#123;pig[x].atk = y;	<span class="keyword">return</span>;&#125;	y = pig[y].suc;&#125;</div><div class="line">		pig[x].atk = <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Maintain</span><span class="params">()</span> </span>&#123;<span class="keyword">int</span> x = pig[<span class="number">1</span>].suc;	FindAtk(<span class="number">1</span>);	<span class="keyword">while</span> (x != <span class="number">1</span>)	FindAtk(x), x = pig[x].suc;&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Kill</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">	pig[y].dead = <span class="literal">true</span>;</div><div class="line">	<span class="keyword">if</span> (Type[y] == <span class="number">1</span>) &#123;GameOver = <span class="literal">true</span>;	<span class="keyword">return</span>;&#125;</div><div class="line">	<span class="keyword">if</span> (Type[y] == <span class="number">3</span>) &#123;<span class="keyword">if</span> (--lft == <span class="number">0</span>) &#123;GameOver = <span class="literal">true</span>;	<span class="keyword">return</span>;&#125;	pig[x].Bonus();&#125;</div><div class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">1</span> &amp;&amp; Type[y] == <span class="number">2</span>)	pig[x].Punish();</div><div class="line">	<span class="keyword">int</span> PRE = pig[y].pre, SUC = pig[y].suc;	pig[PRE].suc = SUC, pig[SUC].pre = PRE;	Maintain();</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Hurt</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;<span class="keyword">if</span> (--pig[y].blood == <span class="number">0</span>)	<span class="keyword">if</span> (pig[y].tryP())	pig[y].blood++;	<span class="keyword">else</span>	Kill(x, y);&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Attack</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span> (Type[x] != <span class="number">1</span> &amp;&amp; pig[x].Sta &lt; <span class="number">2</span>) &#123;</div><div class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">3</span>)	pig[x].Sta = <span class="number">2</span>;</div><div class="line">		<span class="keyword">else</span>	pig[x].Sta = <span class="number">3</span>;</div><div class="line">		Maintain();</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (!pig[y].tryS())	Hurt(x, y);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">WXcycle</span><span class="params">(<span class="keyword">int</span> st, <span class="keyword">bool</span> YType)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> last = st, x = st;	<span class="keyword">bool</span> ORI = YType;</div><div class="line">	<span class="keyword">if</span> (YType == (Type[x] == <span class="number">3</span>) &amp;&amp; pig[x].tryWX()) &#123;last = x, YType ^= <span class="number">1</span>; <span class="keyword">if</span> (pig[x].Sta &lt;= <span class="number">2</span>) pig[x].Sta = <span class="number">3</span>-YType, Maintain();&#125;</div><div class="line">	x = pig[x].suc;</div><div class="line">	<span class="keyword">while</span> (x != last) &#123;</div><div class="line">		<span class="keyword">if</span> (YType == (Type[x] == <span class="number">3</span>) &amp;&amp; pig[x].tryWX())</div><div class="line">			&#123;last = x, YType ^= <span class="number">1</span>;	<span class="keyword">if</span> (pig[x].Sta &lt;= <span class="number">2</span>)	pig[x].Sta = <span class="number">3</span>-YType, Maintain();&#125;</div><div class="line">		x = pig[x].suc;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ORI != YType;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Duel</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span> (Type[x] != <span class="number">1</span> &amp;&amp; pig[x].Sta &lt; <span class="number">2</span>) &#123;<span class="keyword">if</span> (Type[y] == <span class="number">3</span>)	pig[x].Sta = <span class="number">2</span>;	<span class="keyword">else</span>	pig[x].Sta = <span class="number">3</span>;	Maintain();&#125;</div><div class="line">	<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta &gt;= <span class="number">2</span>)</div><div class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta == <span class="number">2</span>) &#123;<span class="keyword">if</span> (WXcycle(x, <span class="number">0</span>))	<span class="keyword">return</span>;&#125;</div><div class="line">		<span class="keyword">else</span> &#123;<span class="keyword">if</span> (WXcycle(x, <span class="number">1</span>))	<span class="keyword">return</span>;&#125;</div><div class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">1</span> &amp;&amp; Type[y] == <span class="number">2</span>)	Hurt(x, y);</div><div class="line">	<span class="keyword">else</span>	<span class="keyword">for</span> (;;) &#123;<span class="keyword">if</span> (!pig[y].tryA()) &#123;Hurt(x, y);	<span class="keyword">return</span>;&#125;	<span class="keyword">if</span> (!pig[x].tryA()) &#123;Hurt(y, x);	<span class="keyword">return</span>;&#125;&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Invade</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> y = pig[x].suc;</div><div class="line">	<span class="keyword">while</span> (y != x) &#123;</div><div class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta &gt;= <span class="number">2</span>)</div><div class="line">			<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta == <span class="number">2</span>) &#123;<span class="keyword">if</span> (WXcycle(x, <span class="number">0</span>)) &#123;y = pig[y].suc;	<span class="keyword">continue</span>;&#125;&#125;</div><div class="line">			<span class="keyword">else</span> &#123;<span class="keyword">if</span> (WXcycle(x, <span class="number">1</span>)) &#123;y = pig[y].suc;	<span class="keyword">continue</span>;&#125;&#125;</div><div class="line">		<span class="keyword">if</span> (!pig[y].tryA()) &#123;</div><div class="line">			Hurt(x, y);	<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;</div><div class="line">			<span class="keyword">if</span> (y == <span class="number">1</span> &amp;&amp; pig[x].Sta == <span class="number">0</span>)	pig[x].Sta = <span class="number">1</span>, Maintain();</div><div class="line">		&#125;</div><div class="line">		y = pig[y].suc;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Arrow</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> y = pig[x].suc;</div><div class="line">	<span class="keyword">while</span> (y != x) &#123;</div><div class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta &gt;= <span class="number">2</span>)</div><div class="line">			<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta == <span class="number">2</span>) &#123;<span class="keyword">if</span> (WXcycle(x, <span class="number">0</span>)) &#123;y = pig[y].suc;	<span class="keyword">continue</span>;&#125;&#125;</div><div class="line">			<span class="keyword">else</span> &#123;<span class="keyword">if</span> (WXcycle(x, <span class="number">1</span>)) &#123;y = pig[y].suc;	<span class="keyword">continue</span>;&#125;&#125;</div><div class="line">		<span class="keyword">if</span> (!pig[y].tryS()) &#123;</div><div class="line">			Hurt(x, y);	<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;</div><div class="line">			<span class="keyword">if</span> (y == <span class="number">1</span> &amp;&amp; pig[x].Sta == <span class="number">0</span>)	pig[x].Sta = <span class="number">1</span>, Maintain();</div><div class="line">		&#125;</div><div class="line">		y = pig[y].suc;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);	<span class="keyword">char</span> s[<span class="number">2</span>];	<span class="keyword">int</span> tot = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt; <span class="number">1</span>; i--)	pig[i].pre = i<span class="number">-1</span>;	pig[<span class="number">1</span>].pre = n;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++)	pig[i].suc = i+<span class="number">1</span>;	pig[n].suc = <span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);</div><div class="line">		<span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'M'</span>)	Type[i] = <span class="number">1</span>;	<span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'Z'</span>)	Type[i] = <span class="number">2</span>;	<span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'F'</span>)	Type[i] = <span class="number">3</span>, lft++;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);	Heap[++tot] = s[<span class="number">0</span>];	<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);	Heap[++tot] = s[<span class="number">0</span>];</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);	Heap[++tot] = s[<span class="number">0</span>];	<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);	Heap[++tot] = s[<span class="number">0</span>];</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)	<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s), Heap[++tot] = s[<span class="number">0</span>];	m = tot;	Maintain();</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	pig[i].id = i, pig[i].blood = <span class="number">4</span>, pig[i].DrawSession(), pig[i].DrawSession();</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> cur = <span class="number">1</span>; !GameOver; cur = pig[cur].suc)	pig[cur].Round();</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%s\n"</span>, pig[<span class="number">1</span>].dead ? <span class="string">"FP"</span> : <span class="string">"MP"</span>);	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	pig[i].Output();</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/BZOJ/">BZOJ</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/模拟/">模拟</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/省选/">省选</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-BZOJ1001【BJOI2006】狼抓兔子 网络流" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/BZOJ1001【BJOI2006】狼抓兔子 网络流/" class="article-date">
  	<time datetime="2017-10-15T16:00:00.000Z" itemprop="datePublished">2017-10-16</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/BZOJ1001【BJOI2006】狼抓兔子 网络流/">
        BZOJ1001【BJOI2006】狼抓兔子 &lt;网络流&gt;
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>【BJOI2006】狼抓兔子</p>
<p>Time Limit: 15 Sec<br>Memory Limit: 162 MB</p>
<p>Description<br>现在小朋友们最喜欢的”喜羊羊与灰太狼”,话说灰太狼抓羊不到，但抓兔子还是比较在行的，<br>而且现在的兔子还比较笨，它们只有两个窝，现在你做为狼王，面对一个网格的地形：<br>左上角点为(1,1),右下角点为(N,M)(上图中N=4,M=5).有以下三种类型的道路<br>1:(x,y)&lt;==&gt;(x+1,y)<br>2:(x,y)&lt;==&gt;(x,y+1)<br>3:(x,y)&lt;==&gt;(x+1,y+1)<br>道路上的权值表示这条路上最多能够通过的兔子数，道路是无向的. 左上角和右下角为兔子的两个窝，<br>开始时所有的兔子都聚集在左上角(1,1)的窝里，现在它们要跑到右下解(N,M)的窝中去，狼王开始伏击<br>这些兔子.当然为了保险起见，如果一条道路上最多通过的兔子数为K，狼王需要安排同样数量的K只狼，<br>才能完全封锁这条道路，你需要帮助狼王安排一个伏击方案，使得在将兔子一网打尽的前提下，参与的<br>狼的数量要最小。因为狼还要去找喜羊羊麻烦.</p>
<p>Input<br>第一行为N,M.表示网格的大小，N,M均小于等于1000.<br>接下来分三部分<br>第一部分共N行，每行M-1个数，表示横向道路的权值.<br>第二部分共N-1行，每行M个数，表示纵向道路的权值.<br>第三部分共N-1行，每行M-1个数，表示斜向道路的权值.<br>输入文件保证不超过10M<br>Output<br>输出一个整数，表示参与伏击的狼的最小数量. </p>
<p>Sample Input<br>3 4<br>5 6 4<br>4 3 1<br>7 5 3<br>5 6 7 8<br>8 7 6 5<br>5 5 5<br>6 6 6<br>Sample Output<br>14</p>
<p>HINT<br>2015.4.16新加数据一组，可能会卡掉从前可以过的程序。</p>
</blockquote>
<p>标签:网络流</p>
<p>此题是裸的网络流，看看数据范围，再看看时限，很容易发现直接Dinnic最小割可过。<br>其实还可以用对偶图上跑最短路做，貌似特判有点多，不太好写，但是要快一些，艹榜可用。</p>
<p>附上AC代码：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x7fffffff</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span><span class="keyword">int</span> v, c, nxt;&#125; E[<span class="number">12000005</span>];</div><div class="line"><span class="keyword">int</span> n, m, pre[<span class="number">1000005</span>], d[<span class="number">1000005</span>], cnt;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;cnt = <span class="number">0</span>, <span class="built_in">memset</span>(pre, <span class="number">-1</span>, <span class="keyword">sizeof</span>(pre));&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> c)</span> </span>&#123;</div><div class="line">	E[cnt].v = v, E[cnt].c = c, E[cnt].nxt = pre[u], pre[u] = cnt++;</div><div class="line">	E[cnt].v = u, E[cnt].c = <span class="number">0</span>, E[cnt].nxt = pre[v], pre[v] = cnt++;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">BFS</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="built_in">memset</span>(d, <span class="number">-1</span>, <span class="keyword">sizeof</span>(d));</div><div class="line">	<span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; que;	que.push(<span class="number">1</span>), d[<span class="number">1</span>] = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span> (!que.empty()) &#123;</div><div class="line">		<span class="keyword">int</span> u = que.front();	que.pop();</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = pre[u]; ~i; i = E[i].nxt) &#123;</div><div class="line">			<span class="keyword">int</span> v = E[i].v, c = E[i].c;</div><div class="line">			<span class="keyword">if</span> (~d[v] || !c)	<span class="keyword">continue</span>;</div><div class="line">			d[v] = d[u]+<span class="number">1</span>, que.push(v);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> d[n*m] != <span class="number">-1</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">DFS</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> flow)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span> (u == n*m)	<span class="keyword">return</span> flow;	<span class="keyword">int</span> ret = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = pre[u]; ~i; i = E[i].nxt) &#123;</div><div class="line">		<span class="keyword">int</span> v = E[i].v, c = E[i].c;</div><div class="line">		<span class="keyword">if</span> (d[u]+<span class="number">1</span> != d[v] || !c)	<span class="keyword">continue</span>;</div><div class="line">		<span class="keyword">int</span> tmp = DFS(v, min(flow, c));</div><div class="line">		flow -= tmp, ret += tmp, E[i].c -= tmp, E[i^<span class="number">1</span>].c += tmp;</div><div class="line">		<span class="keyword">if</span> (!flow)	<span class="keyword">break</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (!ret)	d[u] = <span class="number">-1</span>;	<span class="keyword">return</span> ret;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">Dinic</span><span class="params">()</span> </span>&#123;<span class="keyword">int</span> ret = <span class="number">0</span>;	<span class="keyword">while</span> (BFS())	ret += DFS(<span class="number">1</span>, INF);	<span class="keyword">return</span> ret;&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m), init();</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>, x; j &lt; m; j++)</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x), insert(m*(i<span class="number">-1</span>)+j, m*(i<span class="number">-1</span>)+j+<span class="number">1</span>, x), insert(m*(i<span class="number">-1</span>)+j+<span class="number">1</span>, m*(i<span class="number">-1</span>)+j, x);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++)	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>, x; j &lt;= m; j++)</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x), insert(m*(i<span class="number">-1</span>)+j, m*i+j, x), insert(m*i+j, m*(i<span class="number">-1</span>)+j, x);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++)	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>, x; j &lt; m; j++)</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x), insert(m*(i<span class="number">-1</span>)+j, m*i+j+<span class="number">1</span>, x), insert(m*i+j+<span class="number">1</span>, m*(i<span class="number">-1</span>)+j, x);</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d"</span>, Dinic());</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/BZOJ/">BZOJ</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/图论/">图论</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/省选/">省选</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/网络流/">网络流</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-BZOJ1997【HNOI2010】Planer 2-SAT" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/BZOJ1997【HNOI2010】Planer 2-SAT/" class="article-date">
  	<time datetime="2017-10-13T16:00:00.000Z" itemprop="datePublished">2017-10-14</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/BZOJ1997【HNOI2010】Planer 2-SAT/">
        BZOJ1997 Planer &lt;2-SAT&gt;
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>传送门：<a href="http://www.lydsy.com/JudgeOnline/problem.php?id=1997" target="_blank" rel="external">http://www.lydsy.com/JudgeOnline/problem.php?id=1997</a></p>
<p>标签：2-SAT，并查集</p>
<p>本题和POJ3207没什么区别…<br>只是刚做POJ3207时是复习2-SAT，所以写了tarjan，然而某天碰到这题突然想到了并查集。<br>貌似此题可以种类并查集trick过。<br>把每条线段拆成两个点，代表从里面连和外面连，对于相交线段a,b，一定有a和b不同时在里面或外面，于是merge(a, b’), merge(a’, b)。这样合并时判断是否有i,i’在同一集中即可。</p>
<p>附上AC代码（比tarjan好写多了，虽然两者都很好写）：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 200</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_M 10000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m, p[MAX_N+<span class="number">5</span>], l[MAX_M+<span class="number">5</span>], r[MAX_M+<span class="number">5</span>], fa[MAX_M*<span class="number">2</span>+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>*m; i++)	fa[i] = i;&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">getf</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;<span class="keyword">return</span> fa[x] == x ? x : fa[x] = getf(fa[x]);&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;a = getf(a), b = getf(b);	<span class="keyword">if</span> (a != b)	fa[a] = b;&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> T;	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</div><div class="line">	<span class="keyword">while</span> (T--) &#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m), init();	<span class="keyword">bool</span> flag = <span class="literal">true</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;l[i], &amp;r[i]);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, x; i &lt; n; i++)	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x), p[x] = i;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)	l[i] = p[l[i]], r[i] = p[r[i]];</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)	<span class="keyword">if</span> (l[i] &gt; r[i])	swap(l[i], r[i]);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; m; i++)	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j++)</div><div class="line">			<span class="keyword">if</span> ((l[i] &lt; l[j] &amp;&amp; r[i] &gt; l[j] &amp;&amp; r[i] &lt; r[j]) || (l[i] &gt; l[j] &amp;&amp; l[i] &lt; r[j] &amp;&amp; r[i] &gt; r[j]))</div><div class="line">				merge(i*<span class="number">2</span>, j*<span class="number">2</span>+<span class="number">1</span>), merge(i*<span class="number">2</span>+<span class="number">1</span>, j*<span class="number">2</span>);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)	flag &amp;= (getf(i*<span class="number">2</span>) != getf(i*<span class="number">2</span>+<span class="number">1</span>));</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%s\n"</span>, flag ? <span class="string">"YES"</span> : <span class="string">"NO"</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/2-SAT/">2-SAT</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/BZOJ/">BZOJ</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/图论/">图论</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/4/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><a class="extend next" rel="next" href="/page/6/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2017 Azrael_Death
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a>
        </div>
    </div>
  </div>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
  </script>
  <script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  
</footer>

    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="/js/main.js"></script>
<!--
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
-->



  </div>
</body>
</html>