<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>NIRVANA</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Blog of a Chinese OIer">
<meta property="og:type" content="website">
<meta property="og:title" content="NIRVANA">
<meta property="og:url" content="http://yoursite.com/page/4/index.html">
<meta property="og:site_name" content="NIRVANA">
<meta property="og:description" content="Blog of a Chinese OIer">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="NIRVANA">
<meta name="twitter:description" content="Blog of a Chinese OIer">
  
    <link rel="alternative" href="/atom.xml" title="NIRVANA" type="application/atom+xml">
  
  
    <link rel="icon" href="http://chuantu.biz/t6/89/1507626502x2728279003.jpg">
  
  <link rel="stylesheet" href="/css/style.css">
  
  

  <script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>
  <script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>

  
</head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://chuantu.biz/t6/89/1507626502x2728279003.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Azrael_Death</a></h1>
		</hgroup>

		
		<p class="header-subtitle">Veni Vidi Vici</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/AzraelDeath" title="github">github</a>
					        
								<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/azraeldeath" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/2-SAT/" style="font-size: 10.83px;">2-SAT</a> <a href="/tags/AC自动机/" style="font-size: 10.83px;">AC自动机</a> <a href="/tags/APIO/" style="font-size: 10px;">APIO</a> <a href="/tags/BZOJ/" style="font-size: 20px;">BZOJ</a> <a href="/tags/DFS序/" style="font-size: 10px;">DFS序</a> <a href="/tags/DP/" style="font-size: 15.83px;">DP</a> <a href="/tags/HDU/" style="font-size: 12.5px;">HDU</a> <a href="/tags/LCA/" style="font-size: 12.5px;">LCA</a> <a href="/tags/LG/" style="font-size: 12.5px;">LG</a> <a href="/tags/MST/" style="font-size: 12.5px;">MST</a> <a href="/tags/Manacher/" style="font-size: 10.83px;">Manacher</a> <a href="/tags/NOI/" style="font-size: 10.83px;">NOI</a> <a href="/tags/NOIp/" style="font-size: 13.33px;">NOIp</a> <a href="/tags/POI/" style="font-size: 10px;">POI</a> <a href="/tags/POJ/" style="font-size: 15px;">POJ</a> <a href="/tags/Tarjan/" style="font-size: 10.83px;">Tarjan</a> <a href="/tags/Trie/" style="font-size: 10px;">Trie</a> <a href="/tags/UVa/" style="font-size: 10px;">UVa</a> <a href="/tags/主席树/" style="font-size: 12.5px;">主席树</a> <a href="/tags/二分图/" style="font-size: 10px;">二分图</a> <a href="/tags/二分答案/" style="font-size: 10.83px;">二分答案</a> <a href="/tags/分块/" style="font-size: 10px;">分块</a> <a href="/tags/图论/" style="font-size: 17.5px;">图论</a> <a href="/tags/字符串/" style="font-size: 12.5px;">字符串</a> <a href="/tags/差分/" style="font-size: 10px;">差分</a> <a href="/tags/差分约束系统/" style="font-size: 10px;">差分约束系统</a> <a href="/tags/并查集/" style="font-size: 10.83px;">并查集</a> <a href="/tags/总结/" style="font-size: 16.67px;">总结</a> <a href="/tags/搜索/" style="font-size: 10px;">搜索</a> <a href="/tags/数位DP/" style="font-size: 10.83px;">数位DP</a> <a href="/tags/数据结构/" style="font-size: 18.33px;">数据结构</a> <a href="/tags/数论数学/" style="font-size: 11.67px;">数论数学</a> <a href="/tags/期望DP/" style="font-size: 10px;">期望DP</a> <a href="/tags/树套树/" style="font-size: 10.83px;">树套树</a> <a href="/tags/树状数组/" style="font-size: 11.67px;">树状数组</a> <a href="/tags/树链剖分/" style="font-size: 10px;">树链剖分</a> <a href="/tags/模拟/" style="font-size: 10.83px;">模拟</a> <a href="/tags/状压DP/" style="font-size: 10.83px;">状压DP</a> <a href="/tags/省选/" style="font-size: 19.17px;">省选</a> <a href="/tags/线段树/" style="font-size: 13.33px;">线段树</a> <a href="/tags/组合数学/" style="font-size: 10px;">组合数学</a> <a href="/tags/网络流/" style="font-size: 14.17px;">网络流</a> <a href="/tags/莫队/" style="font-size: 10.83px;">莫队</a> <a href="/tags/补集转换/" style="font-size: 10px;">补集转换</a> <a href="/tags/贪心/" style="font-size: 10px;">贪心</a> <a href="/tags/费用流/" style="font-size: 10px;">费用流</a> <a href="/tags/队列/" style="font-size: 10px;">队列</a> <a href="/tags/高斯消元/" style="font-size: 10px;">高斯消元</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.csdn.net/OwenOwl">OwenOwl</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.csdn.net/Joker_69">Joker</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://dangxingyu.com">DXY</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://309459245.lofter.com">YJQ</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/candy99">Candy</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/zig-zag">ZigZag</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://cxjyxx.me">cxjyxx_me</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.shuizilong.com">ShuiZiLong</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/kuangbin">KuangBin</a>
			        
			        </div>
				</section>
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Azrael_Death</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="http://chuantu.biz/t6/89/1507626502x2728279003.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">Azrael_Death</h1>
			</hgroup>
			
			<p class="header-subtitle">Veni Vidi Vici</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/AzraelDeath" title="github">github</a>
			        
						<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/azraeldeath" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-POJ3228 Gold Transportation MST" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/POJ3228 Gold Transportation MST/" class="article-date">
  	<time datetime="2017-10-23T16:00:00.000Z" itemprop="datePublished">2017-10-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/POJ3228 Gold Transportation MST/">
        POJ3228 Gold Transportation &lt;MST&gt;
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Gold Transportation</p>
<p>Time Limit: 2000MS  Memory Limit: 65536K</p>
<p>Description<br>Recently, a number of gold mines have been discovered in Zorroming State. To protect this treasure, we must transport this gold to the storehouses as quickly as possible. Suppose that the Zorroming State consists of N towns and there are M bidirectional roads among these towns. The gold mines are only discovered in parts of the towns, while the storehouses are also owned by parts of the towns. The storage of the gold mine and storehouse for each town is finite. The truck drivers in the Zorroming State are famous for their bad temper that they would not like to drive all the time and they need a bar and an inn available in the trip for a good rest. Therefore, your task is to minimize the maximum adjacent distance among all the possible transport routes on the condition that all the gold is safely transported to the storehouses. </p>
<p>Input<br>The input contains several test cases. For each case, the first line is integer N(1&lt;=N&lt;=200). The second line is N integers associated with the storage of the gold mine in every towns .The third line is also N integers associated with the storage of the storehouses in every towns .Next is integer M(0&lt;=M&lt;=(n-1)*n/2).Then M lines follow. Each line is three integers x y and d(1&lt;=x,y&lt;=N,0&lt;d&lt;=10000), means that there is a road between x and y for distance of d. N=0 means end of the input.<br>Output<br>For each case, output the minimum of the maximum adjacent distance on the condition that all the gold has been transported to the storehouses or &#x201C;No Solution&#x201D;.</p>
<p>Sample Input<br>4<br>3 2 0 0<br>0 0 3 3<br>6<br>1 2 4<br>1 3 10<br>1 4 12<br>2 3 6<br>2 4 8<br>3 4 5<br>0<br>Sample Output<br>6</p>
</blockquote>
<p>&#x9898;&#x76EE;&#x5927;&#x610F;&#xFF1A;&#x6709;n&#x4E2A;&#x6751;&#x5E84;&#xFF0C;&#x6BCF;&#x4E2A;&#x6751;&#x5E84;&#x6709;&#x4E00;&#x4E2A;&#x9EC4;&#x91D1;&#x77FF;&#x548C;&#x4E00;&#x4E2A;&#x4ED3;&#x5E93;&#xFF0C;&#x6C42;&#x4E00;&#x68F5;&#x751F;&#x6210;&#x6811;&#x68EE;&#x6797;&#xFF0C;&#x4F7F;&#x5F97;&#x6BCF;&#x68F5;&#x751F;&#x6210;&#x6811;&#x4E0A;&#x7684;&#x9EC4;&#x91D1;&#x77FF;&#x90FD;&#x53EF;&#x88AB;&#x8FD9;&#x68F5;&#x751F;&#x6210;&#x6811;&#x4E0A;&#x7684;&#x4ED3;&#x5E93;&#x5B58;&#x4E0B;&#xFF0C;&#x5E76;&#x4E14;&#x68EE;&#x6797;&#x4E2D;&#x6700;&#x5927;&#x8FB9;&#x6743;&#x6700;&#x5C0F;&#x3002;</p>
<p>&#x6807;&#x7B7E;&#xFF1A;MST</p>
<p>&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;MST&#x53D8;&#x5F62;&#x3002;<br>&#x7528;Kruskal&#x4ECE;&#x5927;&#x5230;&#x5C0F;&#x8D2A;&#x5FC3;&#x9009;&#x8FB9;&#xFF0C;&#x6BCF;&#x52A0;&#x4E00;&#x6761;&#x8FB9;&#x5C31;O(n)&#x5224;&#x65AD;&#x68EE;&#x6797;&#x4E2D;&#x662F;&#x5426;&#x6240;&#x6709;&#x70B9;&#x6240;&#x5728;&#x7684;&#x6811;&#x90FD;&#x53EF;&#x4EE5;&#x201C;&#x81EA;&#x7ED9;&#x81EA;&#x8DB3;&#x201D;&#x3002;&#x603B;&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;O(mn)&#xFF0C;&#x5373;O(n^3)&#x3002;</p>
<p>&#x9644;&#x4E0A;AC&#x4EE3;&#x7801;&#xFF1A;<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 200</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_M 20000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m, f[MAX_N+<span class="number">5</span>], s[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> {</span><span class="keyword">int</span> u, v, c;} E[MAX_M+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">const</span> node &amp;a, <span class="keyword">const</span> node &amp;b)</span> </span>{<span class="keyword">return</span> a.c &lt; b.c;}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">getf</span><span class="params">(<span class="keyword">int</span> x)</span> </span>{<span class="keyword">if</span> (f[x] == x)	<span class="keyword">return</span> x;	<span class="keyword">int</span> tmp = getf(f[x]);	s[tmp] += s[x], s[x] = <span class="number">0</span>;	<span class="keyword">return</span> f[x] = tmp;}</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">chk</span><span class="params">()</span> </span>{<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="keyword">if</span> (f[i] == i &amp;&amp; s[i] &lt; <span class="number">0</span>)	<span class="keyword">return</span> <span class="literal">false</span>;	<span class="keyword">return</span> <span class="literal">true</span>;}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n) &amp;&amp; n) {</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	f[i] = i, s[i] = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, x; i &lt;= n; i++)	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x), s[i] -= x;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, x; i &lt;= n; i++)	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x), s[i] += x;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;m);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;E[i].u, &amp;E[i].v, &amp;E[i].c);</div><div class="line">		sort(E, E+m, cmp);	<span class="keyword">bool</span> flag = <span class="literal">false</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) {</div><div class="line">			<span class="keyword">int</span> u = getf(E[i].u), v = getf(E[i].v);</div><div class="line">			<span class="keyword">if</span> (u != v)	f[u] = v, s[v] += s[u], s[u] = <span class="number">0</span>;</div><div class="line">			<span class="keyword">if</span> (chk()) {flag = <span class="literal">true</span>, <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, E[i].c);	<span class="keyword">break</span>;}</div><div class="line">		}</div><div class="line">		<span class="keyword">if</span> (!flag)	<span class="built_in">printf</span>(<span class="string">&quot;No Solution\n&quot;</span>);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MST/">MST</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/POJ/">POJ</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/图论/">图论</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-POJ2728 Desert King 二分+MST" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/POJ2728 Desert King 二分+MST/" class="article-date">
  	<time datetime="2017-10-23T16:00:00.000Z" itemprop="datePublished">2017-10-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/POJ2728 Desert King 二分+MST/">
        POJ728 Desert King &lt;二分+MST&gt;
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Desert King</p>
<p>David the Great has just become the king of a desert country. To win the respect of his people, he decided to build channels all over his country to bring water to every village. Villages which are connected to his capital village will be watered. As the dominate ruler and the symbol of wisdom in the country, he needs to build the channels in a most elegant way.<br>After days of study, he finally figured his plan out. He wanted the average cost of each mile of the channels to be minimized. In other words, the ratio of the overall cost of the channels to the total length must be minimized. He just needs to build the necessary channels to bring water to all the villages, which means there will be only one way to connect each village to the capital.<br>His engineers surveyed the country and recorded the position and altitude of each village. All the channels must go straight between two villages and be built horizontally. Since every two villages are at different altitudes, they concluded that each channel between two villages needed a vertical water lifter, which can lift water up or let water flow down. The length of the channel is the horizontal distance between the two villages. The cost of the channel is the height of the lifter. You should notice that each village is at a different altitude, and different channels can&#x2019;t share a lifter. Channels can intersect safely and no three villages are on the same line.<br>As King David&#x2019;s prime scientist and programmer, you are asked to find out the best solution to build the channels.</p>
<p>Input<br>There are several test cases. Each test case starts with a line containing a number N (2 &lt;= N &lt;= 1000), which is the number of villages. Each of the following N lines contains three integers, x, y and z (0 &lt;= x, y &lt; 10000, 0 &lt;= z &lt; 10000000). (x, y) is the position of the village and z is the altitude. The first village is the capital. A test case with N = 0 ends the input, and should not be processed.<br>Output<br>For each test case, output one line containing a decimal number, which is the minimum ratio of overall cost of the channels to the total length. This number should be rounded three digits after the decimal point. </p>
<p>Sample Input<br>4<br>0 0 0<br>0 1 1<br>1 1 2<br>1 0 3<br>0<br>Sample Output<br>1.000</p>
</blockquote>
<p>&#x9898;&#x76EE;&#x5927;&#x610F;&#xFF1A;&#x7ED9;&#x51FA;n&#x4E2A;&#x6751;&#x5E84;&#x548C;n^2&#x6761;&#x8DEF;&#xFF0C;&#x4EE5;&#x53CA;&#x6BCF;&#x6761;&#x8DEF;&#x7684;&#x957F;&#x5EA6;&#x548C;&#x4EE3;&#x4EF7;&#xFF0C;&#x8981;&#x6C42;&#x9009;&#x51FA;&#x4E00;&#x68F5;&#x751F;&#x6210;&#x6811;&#x4F7F;&#x5F97;&#x5176;&#x8DEF;&#x5F84;&#x603B;&#x4EE3;&#x4EF7;&#x9664;&#x4EE5;&#x8DEF;&#x5F84;&#x603B;&#x957F;&#x5EA6;&#x6700;&#x5C0F;&#x3002;</p>
<p>&#x6807;&#x7B7E;&#xFF1A;&#x6700;&#x4F18;&#x6BD4;&#x4F8B;&#x751F;&#x6210;&#x6811;&#xFF0C;&#x4E8C;&#x5206;&#x7B54;&#x6848;&#xFF0C;MST</p>
<p>&#x672C;&#x9898;&#x662F;&#x6700;&#x4F18;&#x6BD4;&#x4F8B;&#x751F;&#x6210;&#x6811;&#x7684;&#x88F8;&#x9898;&#x3002;<br>&#x719F;&#x6089;&#x4E8C;&#x5206;&#x7B54;&#x6848;&#x7684;&#x5957;&#x8DEF;&#x3002;</p>
<p>&#x6CE8;&#x610F;&#x5230;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x7B54;&#x6848;x&#x53EF;&#x4F5C;&#x4E3A;&#x5E73;&#x5747;&#x503C;&#xFF0C;&#x90A3;&#x4E48;&#x6BD4;x&#x5927;&#x7684;&#x6240;&#x6709;&#x7B54;&#x6848;&#x5747;&#x53EF;&#x4F5C;&#x4E3A;&#x5E73;&#x5747;&#x503C;&#xFF0C;&#x95EE;&#x9898;&#x5177;&#x6709;&#x4E8C;&#x5206;&#x6027;<br>&#x4E8E;&#x662F;&#x4E8C;&#x5206;&#x7B54;&#x6848;&#xFF0C;&#x5373;&#x6700;&#x540E;&#x7684;&#x5E73;&#x5747;&#x503C;&#xFF0C;&#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;&#x7B54;&#x6848;&#xFF0C;&#x6784;&#x9020;&#x6700;&#x5C0F;&#x751F;&#x6210;&#x6811;&#x5224;&#x65AD;&#x53EF;&#x884C;&#x6027;&#xFF0C;&#x5177;&#x4F53;&#x5982;&#x4E0B;&#xFF1A;<br>&#x5BF9;&#x4E8E;&#x7B2C;i&#x6761;&#x8FB9;&#xFF0C;&#x957F;&#x5EA6;&#x4E3A;li&#xFF0C;&#x4EE3;&#x4EF7;&#x4E3A;ci&#xFF0C;&#x90A3;&#x4E48;&#x5C06;&#x6B64;&#x8FB9;&#x7684;&#x6743;&#x503C;&#x8BBE;&#x4E3A;wi=ci-li*tans&#xFF0C;&#x8DD1;&#x4E00;&#x904D;&#x6700;&#x5C0F;&#x751F;&#x6210;&#x6811;&#xFF0C;&#x5982;&#x679C;&#x603B;&#x6743;&#x503C;&#x5C0F;&#x4E8E;0&#xFF0C;&#x5219;&#x6709;&#x53EF;&#x884C;&#x89E3;&#x3002;<br>&#x6CE8;&#x610F;&#x6B64;&#x9898;&#x4E3A;&#x7A20;&#x5BC6;&#x56FE;&#xFF0C;&#x5E94;&#x7528;Prime&#x3002;</p>
<p>&#x9644;&#x4E0A;AC&#x4EE3;&#x7801;&#xFF1A;<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 1000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n;</div><div class="line"><span class="keyword">double</span> <span class="built_in">map</span>[MAX_N+<span class="number">5</span>][MAX_N+<span class="number">5</span>], val[MAX_N+<span class="number">5</span>][MAX_N+<span class="number">5</span>];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span> {</span><span class="keyword">double</span> x, y, h;} p[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">calc</span><span class="params">(<span class="keyword">double</span> x1, <span class="keyword">double</span> y1, <span class="keyword">double</span> x2, <span class="keyword">double</span> y2)</span> </span>{<span class="keyword">return</span> <span class="built_in">sqrt</span>((x1-x2)*(x1-x2)+(y1-y2)*(y1-y2));}</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">double</span> t)</span> </span>{</div><div class="line">	<span class="keyword">double</span> ret = <span class="number">0</span>;</div><div class="line">	<span class="keyword">double</span> dis[MAX_N+<span class="number">5</span>];</div><div class="line">	<span class="keyword">bool</span> vis[MAX_N+<span class="number">5</span>];</div><div class="line">	<span class="built_in">memset</span>(dis, <span class="number">127</span>, <span class="keyword">sizeof</span>(dis));</div><div class="line">	<span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span>(vis));</div><div class="line">	dis[<span class="number">1</span>] = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) {</div><div class="line">		<span class="keyword">int</span> tv = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)</div><div class="line">			<span class="keyword">if</span> (!vis[j] &amp;&amp; (!tv || dis[j] &lt; dis[tv]))</div><div class="line">				tv = j;</div><div class="line">		vis[tv] = <span class="number">1</span>, ret += dis[tv];</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)</div><div class="line">			<span class="keyword">if</span> (!vis[j])</div><div class="line">				dis[j] = min(dis[j], val[tv][j]-<span class="built_in">map</span>[tv][j]*t);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> ret &lt; <span class="number">0</span>;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">bi_search</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">double</span> l = <span class="number">0</span>, r = <span class="number">1e5</span>, mid;</div><div class="line">	<span class="keyword">while</span> (<span class="built_in">abs</span>(l-r) &gt; <span class="number">1e-6</span>) {</div><div class="line">		mid = (l+r)/<span class="number">2</span>;</div><div class="line">		<span class="keyword">if</span> (check(mid))	r = mid;</div><div class="line">		<span class="keyword">else</span>	l = mid;</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> mid;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n) &amp;&amp; n) {</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="built_in">scanf</span>(<span class="string">&quot;%lf%lf%lf&quot;</span>, &amp;p[i].x, &amp;p[i].y, &amp;p[i].h);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= i; j++)</div><div class="line">				<span class="built_in">map</span>[i][j] = <span class="built_in">map</span>[j][i] = calc(p[i].x, p[i].y, p[j].x, p[j].y),</div><div class="line">				val[i][j] = val[j][i] = <span class="built_in">abs</span>(p[i].h-p[j].h);</div><div class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%.3f\n&quot;</span>, bi_search());</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MST/">MST</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/POJ/">POJ</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/二分答案/">二分答案</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/图论/">图论</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-BZOJ1821【JSOI2010】Group部落划分 MST" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/BZOJ1821【JSOI2010】Group部落划分 MST/" class="article-date">
  	<time datetime="2017-10-23T16:00:00.000Z" itemprop="datePublished">2017-10-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/BZOJ1821【JSOI2010】Group部落划分 MST/">
        BZOJ1821【JSOI2010】Group部落划分 &lt;MST&gt;
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>&#x3010;JSOI2010&#x3011;Group &#x90E8;&#x843D;&#x5212;&#x5206; Group<br>Time Limit: 10 Sec  Memory Limit: 64 MB</p>
<p>Description<br>&#x806A;&#x806A;&#x7814;&#x7A76;&#x53D1;&#x73B0;&#xFF0C;&#x8352;&#x5C9B;&#x91CE;&#x4EBA;&#x603B;&#x662F;&#x8FC7;&#x7740;&#x7FA4;&#x5C45;&#x7684;&#x751F;&#x6D3B;&#xFF0C;&#x4F46;&#x662F;&#xFF0C;&#x5E76;&#x4E0D;&#x662F;&#x6574;&#x4E2A;&#x8352;&#x5C9B;&#x4E0A;&#x7684;&#x6240;&#x6709;&#x91CE;&#x4EBA;&#x90FD;&#x5C5E;&#x4E8E;&#x540C;&#x4E00;&#x4E2A;&#x90E8;&#x843D;&#xFF0C;&#x91CE;&#x4EBA;&#x4EEC;&#x603B;&#x662F;&#x62C9;&#x5E2E;&#x7ED3;&#x6D3E;&#x5F62;&#x6210;&#x5C5E;&#x4E8E;&#x81EA;&#x5DF1;&#x7684;&#x90E8;&#x843D;&#xFF0C;&#x4E0D;&#x540C;&#x7684;&#x90E8;&#x843D;&#x4E4B;&#x95F4;&#x5219;&#x7ECF;&#x5E38;&#x53D1;&#x751F;&#x4E89;&#x6597;&#x3002;&#x53EA;&#x662F;&#xFF0C;&#x8FD9;&#x4E00;&#x5207;&#x90FD;&#x6210;&#x4E3A;&#x8C1C;&#x56E2;&#x4E86;&#x2014;&#x2014;&#x806A;&#x806A;&#x6839;&#x672C;&#x5C31;&#x4E0D;&#x77E5;&#x9053;&#x90E8;&#x843D;&#x7A76;&#x7ADF;&#x662F;&#x5982;&#x4F55;&#x5206;&#x5E03;&#x7684;&#x3002; &#x4E0D;&#x8FC7;&#x597D;&#x6D88;&#x606F;&#x662F;&#xFF0C;&#x806A;&#x806A;&#x5F97;&#x5230;&#x4E86;&#x4E00;&#x4EFD;&#x8352;&#x5C9B;&#x7684;&#x5730;&#x56FE;&#x3002;&#x5730;&#x56FE;&#x4E0A;&#x6807;&#x6CE8;&#x4E86;N&#x4E2A;&#x91CE;&#x4EBA;&#x5C45;&#x4F4F;&#x7684;&#x5730;&#x70B9;&#xFF08;&#x53EF;&#x4EE5;&#x770B;&#x4F5C;&#x662F;&#x5E73;&#x9762;&#x4E0A;&#x7684;&#x5750;&#x6807;&#xFF09;&#x3002;&#x6211;&#x4EEC;&#x77E5;&#x9053;&#xFF0C;&#x540C;&#x4E00;&#x4E2A;&#x90E8;&#x843D;&#x7684;&#x91CE;&#x4EBA;&#x603B;&#x662F;&#x751F;&#x6D3B;&#x5728;&#x9644;&#x8FD1;&#x3002;&#x6211;&#x4EEC;&#x628A;&#x4E24;&#x4E2A;&#x90E8;&#x843D;&#x7684;&#x8DDD;&#x79BB;&#xFF0C;&#x5B9A;&#x4E49;&#x4E3A;&#x90E8;&#x843D;&#x4E2D;&#x8DDD;&#x79BB;&#x6700;&#x8FD1;&#x7684;&#x90A3;&#x4E24;&#x4E2A;&#x5C45;&#x4F4F;&#x70B9;&#x7684;&#x8DDD;&#x79BB;&#x3002;&#x806A;&#x806A;&#x8FD8;&#x83B7;&#x5F97;&#x4E86;&#x4E00;&#x4E2A;&#x6709;&#x610F;&#x4E49;&#x7684;&#x4FE1;&#x606F;&#x2014;&#x2014;&#x8FD9;&#x4E9B;&#x91CE;&#x4EBA;&#x603B;&#x5171;&#x88AB;&#x5206;&#x4E3A;&#x4E86;K&#x4E2A;&#x90E8;&#x843D;&#xFF01;&#x8FD9;&#x771F;&#x662F;&#x4E2A;&#x597D;&#x6D88;&#x606F;&#x3002;&#x806A;&#x806A;&#x5E0C;&#x671B;&#x4ECE;&#x8FD9;&#x4E9B;&#x4FE1;&#x606F;&#x91CC;&#x6316;&#x6398;&#x51FA;&#x6240;&#x6709;&#x90E8;&#x843D;&#x7684;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;&#x3002;&#x4ED6;&#x6B63;&#x5728;&#x5C1D;&#x8BD5;&#x8FD9;&#x6837;&#x4E00;&#x79CD;&#x7B97;&#x6CD5;&#xFF1A; &#x5BF9;&#x4E8E;&#x4EFB;&#x610F;&#x4E00;&#x79CD;&#x90E8;&#x843D;&#x5212;&#x5206;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x90FD;&#x80FD;&#x591F;&#x6C42;&#x51FA;&#x4E24;&#x4E2A;&#x90E8;&#x843D;&#x4E4B;&#x95F4;&#x7684;&#x8DDD;&#x79BB;&#xFF0C;&#x806A;&#x806A;&#x5E0C;&#x671B;&#x6C42;&#x51FA;&#x4E00;&#x79CD;&#x90E8;&#x843D;&#x5212;&#x5206;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x4F7F;&#x9760;&#x5F97;&#x6700;&#x8FD1;&#x7684;&#x4E24;&#x4E2A;&#x90E8;&#x843D;&#x5C3D;&#x53EF;&#x80FD;&#x8FDC;&#x79BB;&#x3002; &#x4F8B;&#x5982;&#xFF0C;&#x4E0B;&#x9762;&#x7684;&#x5DE6;&#x56FE;&#x8868;&#x793A;&#x4E86;&#x4E00;&#x4E2A;&#x597D;&#x7684;&#x5212;&#x5206;&#xFF0C;&#x800C;&#x53F3;&#x56FE;&#x5219;&#x4E0D;&#x662F;&#x3002;&#x8BF7;&#x4F60;&#x7F16;&#x7A0B;&#x5E2E;&#x52A9;&#x806A;&#x806A;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x96BE;&#x9898;&#x3002; </p>
<p>Input<br>&#x7B2C;&#x4E00;&#x884C;&#x5305;&#x542B;&#x4E24;&#x4E2A;&#x6574;&#x6570;N&#x548C;K(1&lt; = N &lt; = 1000,1&lt; K &lt; = N)&#xFF0C;&#x5206;&#x522B;&#x4EE3;&#x8868;&#x4E86;&#x91CE;&#x4EBA;&#x5C45;&#x4F4F;&#x70B9;&#x7684;&#x6570;&#x91CF;&#x548C;&#x90E8;&#x843D;&#x7684;&#x6570;&#x91CF;&#x3002;<br>&#x63A5;&#x4E0B;&#x6765;N&#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x5305;&#x542B;&#x4E24;&#x4E2A;&#x6B63;&#x6574;&#x6570;x,y&#xFF0C;&#x63CF;&#x8FF0;&#x4E86;&#x4E00;&#x4E2A;&#x5C45;&#x4F4F;&#x70B9;&#x7684;&#x5750;&#x6807;(0 &lt; =x, y &lt; =10000)<br>Output<br>&#x8F93;&#x51FA;&#x4E00;&#x884C;&#xFF0C;&#x4E3A;&#x6700;&#x4F18;&#x5212;&#x5206;&#x65F6;&#xFF0C;&#x6700;&#x8FD1;&#x7684;&#x4E24;&#x4E2A;&#x90E8;&#x843D;&#x7684;&#x8DDD;&#x79BB;&#xFF0C;&#x7CBE;&#x786E;&#x5230;&#x5C0F;&#x6570;&#x70B9;&#x540E;&#x4E24;&#x4F4D;&#x3002;</p>
<p>Sample Input<br>4 2<br>0 0<br>0 1<br>1 1<br>1 0<br>Sample Output<br>1.00</p>
</blockquote>
<p>&#x6807;&#x7B7E;&#xFF1A;MST</p>
<p>&#x6B64;&#x9898;&#x662F;MST&#x7684;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x53D8;&#x5F62;&#x3002;<br>&#x672C;&#x9898;&#x8981;&#x6C42;&#x5206;&#x4E3A;k&#x4E2A;&#x90E8;&#x843D;&#xFF0C;&#x5373;&#x5728;&#x751F;&#x6210;&#x6811;&#x4E0A;&#x62C6;k-1&#x6761;&#x8FB9;&#x3002;<br>&#x4F7F;&#x5F97;&#x5176;&#x6700;&#x5C0F;&#x8DDD;&#x79BB;&#x6700;&#x5927;&#xFF0C;&#x53EF;&#x4EE5;kruskal&#x8D2A;&#x5FC3;&#x5411;&#x4E0B;&#x9009;&#xFF0C;&#x9009;&#x5230;&#x5269;k-1&#x6761;&#x8FB9;&#x4E3A;&#x6B62;&#x3002;</p>
<p>&#x9644;&#x4E0A;&#x4EE3;&#x7801;&#xFF1A;<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 1000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> dnt;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> {</span><span class="keyword">int</span> u, v;	dnt c;} E[MAX_N*MAX_N+<span class="number">50</span>];</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span> <span class="params">(<span class="keyword">const</span> node &amp;a, <span class="keyword">const</span> node &amp;b)</span> </span>{<span class="keyword">return</span> a.c &lt; b.c;}</div><div class="line"><span class="keyword">int</span> n, k, cnt, x[MAX_N+<span class="number">5</span>], y[MAX_N+<span class="number">5</span>], fa[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>{<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	fa[i] = i;}</div><div class="line"><span class="function">dnt <span class="title">dist</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>{<span class="keyword">return</span> (dnt)<span class="built_in">sqrt</span>((x[a]-x[b])*(x[a]-x[b])+(y[a]-y[b])*(y[a]-y[b]));}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">getf</span><span class="params">(<span class="keyword">int</span> c)</span> </span>{<span class="keyword">return</span> fa[c] == c ? c : fa[c] = getf(fa[c]);}</div><div class="line"><span class="function">dnt <span class="title">Kruskal</span><span class="params">()</span> </span>{</div><div class="line">	sort(E, E+cnt, cmp);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, tot = <span class="number">0</span>; i &lt; cnt; i++) {</div><div class="line">		<span class="keyword">int</span> u = getf(E[i].u), v = getf(E[i].v);</div><div class="line">		<span class="keyword">if</span> (u != v)	fa[u] = v, tot++;</div><div class="line">		<span class="keyword">if</span> (tot &gt; n-k)	<span class="keyword">return</span> E[i].c;</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;k), init();</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;x[i], &amp;y[i]);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="keyword">for</span> (<span class="keyword">int</span> j = i+<span class="number">1</span>; j &lt;= n; j++)	E[cnt++] = (node){i, j, dist(i, j)};</div><div class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%.2lf&quot;</span>, Kruskal());</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/BZOJ/">BZOJ</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MST/">MST</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/图论/">图论</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/省选/">省选</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-BZOJ3993【SDOI2015】星际战争 二分+最大流" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/BZOJ3993【SDOI2015】星际战争 二分+最大流/" class="article-date">
  	<time datetime="2017-10-23T16:00:00.000Z" itemprop="datePublished">2017-10-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/BZOJ3993【SDOI2015】星际战争 二分+最大流/">
        BZOJ3993【SDOI2015】星际战争 &lt;二分+网络流&gt;
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>&#x3010;SDOI2015&#x3011;&#x661F;&#x9645;&#x6218;&#x4E89;<br>Time Limit: 10 Sec  Memory Limit: 128 MBSec  Special Judge</p>
<p>Description<br>3333&#x5E74;&#xFF0C;&#x5728;&#x94F6;&#x6CB3;&#x7CFB;&#x7684;&#x67D0;&#x661F;&#x7403;&#x4E0A;&#xFF0C;X&#x519B;&#x56E2;&#x548C;Y&#x519B;&#x56E2;&#x6B63;&#x5728;&#x6FC0;&#x70C8;&#x5730;&#x4F5C;&#x6218;&#x3002;&#x5728;&#x6218;&#x6597;&#x7684;&#x67D0;&#x4E00;&#x9636;&#x6BB5;&#xFF0C;Y&#x519B;&#x56E2;&#x4E00;&#x5171;&#x6D3E;&#x9063;&#x4E86;N&#x4E2A;&#x5DE8;&#x578B;&#x673A;&#x5668;&#x4EBA;&#x8FDB;&#x653B;X&#x519B;&#x56E2;&#x7684;&#x9635;&#x5730;&#xFF0C;&#x5176;&#x4E2D;&#x7B2C;i&#x4E2A;&#x5DE8;&#x578B;&#x673A;&#x5668;&#x4EBA;&#x7684;&#x88C5;&#x7532;&#x503C;&#x4E3A;Ai&#x3002;&#x5F53;&#x4E00;&#x4E2A;&#x5DE8;&#x578B;&#x673A;&#x5668;&#x4EBA;&#x7684;&#x88C5;&#x7532;&#x503C;&#x51CF;&#x5C11;&#x5230;0&#x6216;&#x8005;&#x4EE5;&#x4E0B;&#x65F6;&#xFF0C;&#x8FD9;&#x4E2A;&#x5DE8;&#x578B;&#x673A;&#x5668;&#x4EBA;&#x5C31;&#x88AB;&#x6467;&#x6BC1;&#x4E86;&#x3002;X&#x519B;&#x56E2;&#x6709;M&#x4E2A;&#x6FC0;&#x5149;&#x6B66;&#x5668;&#xFF0C;&#x5176;&#x4E2D;&#x7B2C;i&#x4E2A;&#x6FC0;&#x5149;&#x6B66;&#x5668;&#x6BCF;&#x79D2;&#x53EF;&#x4EE5;&#x524A;&#x51CF;&#x4E00;&#x4E2A;&#x5DE8;&#x578B;&#x673A;&#x5668;&#x4EBA;Bi&#x7684;&#x88C5;&#x7532;&#x503C;&#x3002;&#x6FC0;&#x5149;&#x6B66;&#x5668;&#x7684;&#x653B;&#x51FB;&#x662F;&#x8FDE;&#x7EED;&#x7684;&#x3002;&#x8FD9;&#x79CD;&#x6FC0;&#x5149;&#x6B66;&#x5668;&#x975E;&#x5E38;&#x5947;&#x602A;&#xFF0C;&#x4E00;&#x4E2A;&#x6FC0;&#x5149;&#x6B66;&#x5668;&#x53EA;&#x80FD;&#x653B;&#x51FB;&#x4E00;&#x4E9B;&#x7279;&#x5B9A;&#x7684;&#x654C;&#x4EBA;&#x3002;Y&#x519B;&#x56E2;&#x770B;&#x5230;&#x81EA;&#x5DF1;&#x7684;&#x5DE8;&#x578B;&#x673A;&#x5668;&#x4EBA;&#x88AB;X&#x519B;&#x56E2;&#x4E00;&#x4E2A;&#x4E00;&#x4E2A;&#x6D88;&#x706D;&#xFF0C;&#x4ED6;&#x4EEC;&#x6025;&#x9700;&#x4E0B;&#x8FBE;&#x66F4;&#x591A;&#x7684;&#x6307;&#x4EE4;&#x3002;&#x4E3A;&#x4E86;&#x8FD9;&#x4E2A;&#x76EE;&#x6807;&#xFF0C;Y&#x519B;&#x56E2;&#x9700;&#x8981;&#x77E5;&#x9053;X&#x519B;&#x56E2;&#x6700;&#x5C11;&#x9700;&#x8981;&#x7528;&#x591A;&#x957F;&#x65F6;&#x95F4;&#x624D;&#x80FD;&#x5C06;Y&#x519B;&#x56E2;&#x7684;&#x6240;&#x6709;&#x5DE8;&#x578B;&#x673A;&#x5668;&#x4EBA;&#x6467;&#x6BC1;&#x3002;&#x4F46;&#x662F;&#x4ED6;&#x4EEC;&#x4E0D;&#x4F1A;&#x8BA1;&#x7B97;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x56E0;&#x6B64;&#x5411;&#x4F60;&#x6C42;&#x52A9;&#x3002;</p>
<p>Input<br>&#x7B2C;&#x4E00;&#x884C;&#xFF0C;&#x4E24;&#x4E2A;&#x6574;&#x6570;&#xFF0C;N&#x3001;M&#x3002;<br>&#x7B2C;&#x4E8C;&#x884C;&#xFF0C;N&#x4E2A;&#x6574;&#x6570;&#xFF0C;A1&#x3001;A2&#x2026;AN&#x3002;<br>&#x7B2C;&#x4E09;&#x884C;&#xFF0C;M&#x4E2A;&#x6574;&#x6570;&#xFF0C;B1&#x3001;B2&#x2026;BM&#x3002;<br>&#x63A5;&#x4E0B;&#x6765;&#x7684;M&#x884C;&#xFF0C;&#x6BCF;&#x884C;N&#x4E2A;&#x6574;&#x6570;&#xFF0C;&#x8FD9;&#x4E9B;&#x6574;&#x6570;&#x5747;&#x4E3A;0&#x6216;&#x8005;1&#x3002;&#x8FD9;&#x90E8;&#x5206;&#x4E2D;&#x7684;&#x7B2C;i&#x884C;&#x7684;&#x7B2C;j&#x4E2A;&#x6574;&#x6570;&#x4E3A;0&#x8868;&#x793A;&#x7B2C;i&#x4E2A;&#x6FC0;&#x5149;&#x6B66;&#x5668;&#x4E0D;&#x53EF;&#x4EE5;&#x653B;&#x51FB;&#x7B2C;j&#x4E2A;&#x5DE8;&#x578B;&#x673A;&#x5668;&#x4EBA;&#xFF0C;&#x4E3A;1&#x8868;&#x793A;&#x7B2C;i&#x4E2A;&#x6FC0;&#x5149;&#x6B66;&#x5668;&#x53EF;&#x4EE5;&#x653B;&#x51FB;&#x7B2C;j&#x4E2A;&#x5DE8;&#x578B;&#x673A;&#x5668;&#x4EBA;&#x3002;<br>Output<br>&#x4E00;&#x884C;&#xFF0C;&#x4E00;&#x4E2A;&#x5B9E;&#x6570;&#xFF0C;&#x8868;&#x793A;X&#x519B;&#x56E2;&#x8981;&#x6467;&#x6BC1;Y&#x519B;&#x56E2;&#x7684;&#x6240;&#x6709;&#x5DE8;&#x578B;&#x673A;&#x5668;&#x4EBA;&#x6700;&#x5C11;&#x9700;&#x8981;&#x7684;&#x65F6;&#x95F4;&#x3002;&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#x4E0E;&#x6807;&#x51C6;&#x7B54;&#x6848;&#x7684;&#x7EDD;&#x5BF9;&#x8BEF;&#x5DEE;&#x4E0D;&#x8D85;&#x8FC7;10-3&#x5373;&#x89C6;&#x4E3A;&#x6B63;&#x786E;&#x3002;</p>
<p>Sample Input<br>2 2<br>3 10<br>4 6<br>0 1<br>1 1<br>Sample Output<br>1.300000</p>
<p>HINT<br>&#x3010;&#x6837;&#x4F8B;&#x8BF4;&#x660E;1&#x3011;<br>&#x6218;&#x6597;&#x5F00;&#x59CB;&#x540E;&#x7684;&#x524D;0.5&#x79D2;&#xFF0C;&#x6FC0;&#x5149;&#x6B66;&#x5668;1&#x653B;&#x51FB;2&#x53F7;&#x5DE8;&#x578B;&#x673A;&#x5668;&#x4EBA;&#xFF0C;&#x6FC0;&#x5149;&#x6B66;&#x5668;2&#x653B;&#x51FB;1&#x53F7;&#x5DE8;&#x578B;&#x673A;&#x5668;&#x4EBA;&#x3002;1&#x53F7;&#x5DE8;&#x578B;&#x673A;&#x5668;&#x4EBA;&#x88AB;&#x5B8C;&#x5168;&#x6467;&#x6BC1;&#xFF0C;2&#x53F7;&#x5DE8;&#x578B;&#x673A;&#x5668;&#x4EBA;&#x8FD8;&#x5269;&#x4F59;8&#x7684;&#x88C5;&#x7532;&#x503C;&#xFF1B;<br>&#x63A5;&#x4E0B;&#x6765;&#x7684;0.8&#x79D2;&#xFF0C;&#x6FC0;&#x5149;&#x6B66;&#x5668;1&#x3001;2&#x540C;&#x65F6;&#x653B;&#x51FB;2&#x53F7;&#x5DE8;&#x578B;&#x673A;&#x5668;&#x4EBA;&#x3002;2&#x53F7;&#x5DE8;&#x578B;&#x673A;&#x5668;&#x4EBA;&#x88AB;&#x5B8C;&#x5168;&#x6467;&#x6BC1;&#x3002;<br>&#x5BF9;&#x4E8E;&#x5168;&#x90E8;&#x7684;&#x6570;&#x636E;&#xFF0C;1&lt;=N, M&lt;=50&#xFF0C;1&lt;=Ai&lt;=105&#xFF0C;1&lt;=Bi&lt;=1000&#xFF0C;&#x8F93;&#x5165;&#x6570;&#x636E;&#x4FDD;&#x8BC1;X&#x519B;&#x56E2;&#x4E00;&#x5B9A;&#x80FD;&#x6467;&#x6BC1;Y&#x519B;&#x56E2;&#x7684;&#x6240;&#x6709;&#x5DE8;&#x578B;&#x673A;&#x5668;&#x4EBA;</p>
</blockquote>
<p>&#x6807;&#x7B7E;&#xFF1A;&#x4E8C;&#x5206;&#x7B54;&#x6848;+&#x7F51;&#x7EDC;&#x6D41;</p>
<p>&#x5982;&#x679C;&#x76F4;&#x63A5;&#x5904;&#x7406;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x4F1A;&#x53D1;&#x73B0;&#x9650;&#x5236;&#x6709;&#x70B9;&#x591A;&#xFF0C;&#x4E0D;&#x592A;&#x597D;&#x5904;&#x7406;&#x3002;<br>&#x8003;&#x8651;&#x4E8C;&#x5206;&#x7B54;&#x6848;&#x3002;&#x4E8C;&#x5206;&#x6700;&#x5C11;&#x65F6;&#x95F4;&#xFF0C;&#x90A3;&#x4E48;&#x6BCF;&#x4E2A;&#x6FC0;&#x5149;&#x70AE;&#x5728;&#x6B64;&#x65F6;&#x95F4;&#x5185;&#x53EF;&#x9020;&#x6210;&#x7684;&#x4F24;&#x5BB3;&#x5C31;&#x53EF;&#x4EE5;&#x7B97;&#x51FA;&#xFF0C;&#x8FD9;&#x65F6;&#x53EA;&#x9700;&#x5224;&#x65AD;&#x5408;&#x7406;&#x5206;&#x914D;&#x8FD9;&#x4E9B;&#x4F24;&#x5BB3;&#x80FD;&#x5426;&#x4F7F;&#x654C;&#x65B9;&#x56E2;&#x706D;&#x3002;<br>&#x53D1;&#x73B0;&#x53EF;&#x4EE5;&#x5EFA;&#x56FE;&#x8DD1;&#x6700;&#x5927;&#x6D41;&#x5224;&#x65AD;&#x3002;&#x4ECE;&#x8FDC;&#x70B9;S&#x5411;&#x6240;&#x6709;&#x6FC0;&#x5149;&#x70AE;&#x8FDE;&#x8FB9;&#xFF0C;&#x5BB9;&#x91CF;&#x4E3A;&#x6B64;&#x6FC0;&#x5149;&#x70AE;&#x53EF;&#x9020;&#x6210;&#x7684;&#x603B;&#x4F24;&#x5BB3;&#x3002;&#x4ECE;&#x6240;&#x6709;&#x673A;&#x5668;&#x4EBA;&#x5411;&#x6C47;&#x70B9;T&#x8FDE;&#x8FB9;&#xFF0C;&#x5BB9;&#x91CF;&#x4E3A;&#x673A;&#x5668;&#x4EBA;&#x8840;&#x91CF;&#x3002;&#x4ECE;&#x6BCF;&#x4E2A;&#x6FC0;&#x5149;&#x70AE;&#x5411;&#x5176;&#x6240;&#x53EF;&#x4EE5;&#x9020;&#x6210;&#x4F24;&#x5BB3;&#x7684;&#x6240;&#x6709;&#x673A;&#x5668;&#x4EBA;&#x8FDE;&#x8FB9;&#xFF0C;&#x5BB9;&#x91CF;&#x4E3A;INF&#xFF0C;&#x8FD9;&#x6837;&#x8DD1;&#x4E00;&#x904D;&#x6700;&#x5927;&#x6D41;&#xFF0C;&#x5224;&#x65AD;&#x662F;&#x5426;&#x7B49;&#x4E8E;&#x6240;&#x6709;&#x673A;&#x5668;&#x4EBA;&#x7684;&#x603B;&#x8840;&#x91CF;&#x5373;&#x53EF;&#x3002;<br>&#x5EFA;&#x56FE;&#x53EF;&#x4EE5;&#x4E0D;&#x7528;&#x5168;&#x90E8;&#x65B0;&#x5EFA;&#xFF0C;&#x53EA;&#x7528;&#x5728;&#x5F00;&#x59CB;&#x7684;&#x65F6;&#x5019;&#x5EFA;&#x4E00;&#x4E2A;&#x56FE;&#xFF0C;&#x4E8C;&#x5206;&#x5224;&#x65AD;&#x65F6;&#x5C06;&#x6240;&#x6709;S&#x5230;&#x6FC0;&#x5149;&#x70AE;&#x7684;&#x8FB9;&#x5BB9;&#x91CF;&#x6539;&#x6210;b[i]*tans&#x5373;&#x53EF;&#x3002;</p>
<p>&#x9644;&#x4E0A;AC&#x4EE3;&#x7801;&#xFF1A;<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 100</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> EPS 1e-8</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mid (l+r)/2</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> dnt;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> {</span><span class="keyword">int</span> v, nxt; dnt c;} E[MAX_N*MAX_N*<span class="number">5</span>+<span class="number">500</span>];	dnt sum;</div><div class="line"><span class="keyword">int</span> n, m, s, t, a[MAX_N+<span class="number">5</span>], b[MAX_N+<span class="number">5</span>], mrk[MAX_N+<span class="number">5</span>][MAX_N+<span class="number">5</span>], pre[MAX_N+<span class="number">5</span>], d[MAX_N+<span class="number">5</span>], cnt;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>{<span class="built_in">memset</span>(pre, <span class="number">-1</span>, <span class="keyword">sizeof</span>(pre)), cnt = <span class="number">0</span>, s = <span class="number">0</span>, t = n+m+<span class="number">1</span>;}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, dnt c)</span> </span>{E[cnt].v = v, E[cnt].c = c, E[cnt].nxt = pre[u], pre[u] = cnt++;}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span> </span>{</div><div class="line">	init();</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	insert(i, t, a[i]), insert(t, i, <span class="number">0</span>), sum += a[i];</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)	insert(s, i+n, INF), insert(i+n, s, <span class="number">0</span>);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)	<span class="keyword">if</span> (mrk[i][j])	insert(i+n, j, INF), insert(j, i+n, <span class="number">0</span>);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">BFS</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; que;	<span class="built_in">memset</span>(d, <span class="number">-1</span>, <span class="keyword">sizeof</span>(d));	que.push(s), d[s] = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span> (!que.empty()) {</div><div class="line">		<span class="keyword">int</span> u = que.front();	que.pop();</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = pre[u]; ~i; i = E[i].nxt) {</div><div class="line">			<span class="keyword">int</span> v = E[i].v;	<span class="keyword">if</span> (E[i].c &lt;= EPS || ~d[v])	<span class="keyword">continue</span>;</div><div class="line">			d[v] = d[u]+<span class="number">1</span>;	que.push(v);</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> ~d[t];</div><div class="line">}</div><div class="line"><span class="function">dnt <span class="title">DFS</span><span class="params">(<span class="keyword">int</span> u, dnt flow)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (u == t)	<span class="keyword">return</span> flow;	dnt ret = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = pre[u]; ~i; i = E[i].nxt) {</div><div class="line">		<span class="keyword">int</span> v = E[i].v;	<span class="keyword">if</span> (E[i].c &lt;= EPS || d[v] != d[u]+<span class="number">1</span>)	<span class="keyword">continue</span>;</div><div class="line">		dnt tmp = DFS(v, min(flow, E[i].c));</div><div class="line">		E[i].c -= tmp, E[i^<span class="number">1</span>].c += tmp, ret += tmp, flow -= tmp;</div><div class="line">		<span class="keyword">if</span> (!flow)	<span class="keyword">break</span>;</div><div class="line">	}</div><div class="line">	<span class="keyword">if</span> (!ret)	d[u] = <span class="number">-1</span>;	<span class="keyword">return</span> ret;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">chk</span><span class="params">(dnt tans)</span> </span>{</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; i += <span class="number">2</span>)	E[i].c += E[i^<span class="number">1</span>].c, E[i^<span class="number">1</span>].c = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = pre[s]; ~i; i = E[i].nxt)	E[i].c = (dnt)b[E[i].v-n]*tans;</div><div class="line">	dnt tot = <span class="number">0</span>;	<span class="keyword">while</span> (BFS())	tot += DFS(s, INF);	<span class="keyword">return</span> <span class="built_in">fabs</span>(tot-sum) &lt;= EPS;</div><div class="line">}</div><div class="line"><span class="function">dnt <span class="title">bi_search</span><span class="params">(dnt l, dnt r)</span> </span>{</div><div class="line">	dnt ret = <span class="number">-1</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++)</div><div class="line">		<span class="keyword">if</span> (chk(mid))	ret = r = mid;</div><div class="line">		<span class="keyword">else</span>	l = mid;</div><div class="line">	<span class="keyword">return</span> ret;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, b+i);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;mrk[i][j]);</div><div class="line">	build(), <span class="built_in">printf</span>(<span class="string">&quot;%.5lf&quot;</span>, bi_search(<span class="number">0</span>, INF));</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/BZOJ/">BZOJ</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/二分答案/">二分答案</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/图论/">图论</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/省选/">省选</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/网络流/">网络流</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-HDU4757 Tree LCA+可持久化Trie" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/HDU4757 Tree LCA+可持久化Trie/" class="article-date">
  	<time datetime="2017-10-16T16:00:00.000Z" itemprop="datePublished">2017-10-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/HDU4757 Tree LCA+可持久化Trie/">
        HDU4757 Tree &lt;LCA+可持久化Trie&gt;
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>&#x3010;LCA+&#x53EF;&#x6301;&#x4E45;&#x5316;Trie&#x3011;Tree</p>
<p>Zero and One are good friends who always have fun with each other.<br>This time, they decide to do something on a tree which is a kind of<br>graph that there is only one path from node to node. First, Zero will<br>give One an tree and every node in this tree has a value. Then, Zero<br>will ask One a series of queries. Each query contains three parameters:<br>x, y, z which mean that he want to know the maximum value produced by<br>z xor each value on the path from node x to node y (include node x, node<br>y). Unfortunately, One has no idea in this question. So he need you to<br>solve it.</p>
<p>Input<br>There are several test cases and the cases end with EOF. For each case:<br>The first line contains two integers n(1&lt;=n&lt;=10^5) and m(1&lt;=m&lt;=10^5), which are the amount of tree&#x2019;s nodes and queries, respectively.<br>The second line contains n integers a[1..n] and a<a href="0&lt;=a[i]&lt;2^{16}">i</a> is the value on the ith node.<br>The next n&#x2013;1 lines contains two integers u v, which means there is an connection between u and v.<br>The next m lines contains three integers x y z, which are the parameters of Zero&#x2019;s query.<br>Output<br>For each query, output the answer. </p>
<p>Sample Input<br>3 2<br>1 2 2<br>1 2<br>2 3<br>1 3 1<br>2 3 2<br>Sample Output<br>3<br>0</p>
</blockquote>
<p>&#x9898;&#x76EE;&#x5927;&#x610F;&#xFF1A;&#x7ED9;&#x51FA;&#x4E00;&#x68F5;&#x6811;&#xFF0C;&#x6C42;&#x4E24;&#x70B9;x,y&#x95F4;&#x6811;&#x4E0A;&#x94FE;&#x8DEF;&#x4E2D;&#x7684;&#x6570;&#x5F02;&#x6216;z&#x5F97;&#x5230;&#x7684;&#x6700;&#x5927;&#x7ED3;&#x679C;&#x3002;</p>
<p>&#x6807;&#x7B7E;&#xFF1A;LCA+&#x53EF;&#x6301;&#x4E45;&#x5316;Trie</p>
<p>&#x6700;&#x5927;&#x5F02;&#x6216;&#x548C;&#x4E0A;&#x6811;&#x2026;<br>&#x6709;&#x5F02;&#x6216;&#xFF0C;&#x4E00;&#x4E2A;&#x7ECF;&#x5178;&#x7684;&#x89E3;&#x6CD5;&#x5C31;&#x662F;&#x5EFA;&#x4E00;&#x68F5;01&#x5B57;&#x5178;&#x6811;&#xFF0C;&#x7136;&#x540E;&#x8D2A;&#x5FC3;&#x8DD1;&#x4E00;&#x904D;&#xFF0C;&#x5C3D;&#x91CF;&#x9009;&#x548C;&#x7ED9;&#x51FA;&#x6570;&#x5F53;&#x524D;&#x4F4D;&#x4E0D;&#x540C;&#x7684;&#x6570;&#x3002;<br>&#x5BF9;&#x4E8E;&#x6811;&#x4E0A;&#x7684;&#x6B64;&#x7C7B;&#x95EE;&#x9898;&#xFF0C;&#x53EF;&#x4EE5;&#x628A;Trie&#x6811;&#x53EF;&#x6301;&#x4E45;&#x5316;&#xFF0C;&#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;&#x70B9;&#xFF0C;&#x5B58;&#x5B83;&#x5230;&#x6839;&#x8282;&#x70B9;&#x7684;&#x8DEF;&#x5F84;&#x4E0A;&#x6240;&#x6709;&#x6570;&#x7684;Trie&#x6811;&#xFF0C;&#x8FD9;&#x6837;&#x662F;&#x6709;&#x524D;&#x7F00;&#x548C;&#x6027;&#x8D28;&#x7684;&#xFF0C;&#x6C42;LCA&#x540E;&#x4F5C;&#x5DEE;&#x5373;&#x53EF;&#x6C42;&#x51FA;&#x94FE;&#x8DEF;&#x4E0A;&#x7684;&#x6570;&#x3002;<br>&#x53EF;&#x6301;&#x4E45;&#x5316;&#x65B9;&#x6CD5;&#x548C;&#x4E3B;&#x5E2D;&#x6811;&#x5DEE;&#x4E0D;&#x591A;&#x3002;</p>
<p>&#x9644;&#x4E0A;AC&#x4EE3;&#x7801;&#xFF1A;<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 100000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_D 15</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m, cnt, c[MAX_N+<span class="number">5</span>], root[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="keyword">int</span> anc[MAX_N+<span class="number">5</span>][MAX_D+<span class="number">5</span>], dep[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="keyword">bool</span> vis[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; G[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> {</span><span class="keyword">int</span> ls, rs, size;} trie[MAX_N*<span class="number">20</span>+<span class="number">500</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>{</div><div class="line">	root[<span class="number">0</span>] = cnt = <span class="number">0</span>;</div><div class="line">	<span class="built_in">memset</span>(root, <span class="number">0</span>, <span class="keyword">sizeof</span>(root));</div><div class="line">	<span class="built_in">memset</span>(anc, <span class="number">0</span>, <span class="keyword">sizeof</span>(anc));</div><div class="line">	<span class="built_in">memset</span>(dep, <span class="number">0</span>, <span class="keyword">sizeof</span>(dep));</div><div class="line">	<span class="built_in">memset</span>(vis, <span class="literal">false</span>, <span class="keyword">sizeof</span>(vis));</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	G[i].clear();</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span><span class="params">(<span class="keyword">int</span> u)</span> </span>{</div><div class="line">	vis[u] = <span class="literal">true</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; (<span class="number">1</span>&lt;&lt;i) &lt;= dep[u]; i++)	anc[u][i] = anc[anc[u][i<span class="number">-1</span>]][i<span class="number">-1</span>];</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[u].size(); i++)</div><div class="line">		<span class="keyword">if</span> (!vis[G[u][i]])	anc[G[u][i]][<span class="number">0</span>] = u, dep[G[u][i]] = dep[u]+<span class="number">1</span>, DFS(G[u][i]);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">LCA</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>{</div><div class="line">	<span class="keyword">int</span> i, j;</div><div class="line">	<span class="keyword">if</span> (dep[a] &lt; dep[b])	swap(a, b);</div><div class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; (<span class="number">1</span>&lt;&lt;i) &lt;= dep[a]; i++) ;	i--;</div><div class="line">	<span class="keyword">for</span> (j = i; j &gt;= <span class="number">0</span>; j--)</div><div class="line">		<span class="keyword">if</span> (dep[a]-(<span class="number">1</span>&lt;&lt;j) &gt;= dep[b])</div><div class="line">			a = anc[a][j];</div><div class="line">	<span class="keyword">if</span> (a == b)	<span class="keyword">return</span> a;</div><div class="line">	<span class="keyword">for</span> (j = i; j &gt;= <span class="number">0</span>; j--)</div><div class="line">		<span class="keyword">if</span> (anc[a][j] != anc[b][j])</div><div class="line">			a = anc[a][j], b = anc[b][j];</div><div class="line">	<span class="keyword">return</span> anc[a][<span class="number">0</span>];</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> o, <span class="keyword">int</span> val, <span class="keyword">int</span> range)</span> </span>{</div><div class="line">	trie[v] = trie[o];</div><div class="line">	<span class="keyword">if</span> (range == <span class="number">0</span>) {trie[v].size++; <span class="keyword">return</span>;}</div><div class="line">	<span class="keyword">int</span> x = val/range;</div><div class="line">	<span class="keyword">if</span> (x == <span class="number">0</span>)	insert(trie[v].ls = ++cnt, trie[o].ls, val%range, range/<span class="number">2</span>);</div><div class="line">	<span class="keyword">else</span>	insert(trie[v].rs = ++cnt, trie[o].rs, val%range, range/<span class="number">2</span>);</div><div class="line">	trie[v].size = trie[trie[v].ls].size+trie[trie[v].rs].size;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> u)</span> </span>{</div><div class="line">	root[u] = ++cnt;</div><div class="line">	insert(root[u], root[anc[u][<span class="number">0</span>]], c[u], (<span class="number">1</span>&lt;&lt;MAX_D));</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[u].size(); i++)</div><div class="line">		<span class="keyword">if</span> (G[u][i] != anc[u][<span class="number">0</span>])	build(G[u][i]);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> v1, <span class="keyword">int</span> v2, <span class="keyword">int</span> v3, <span class="keyword">int</span> v4, <span class="keyword">int</span> x, <span class="keyword">int</span> range)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (range == <span class="number">0</span>)	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	<span class="keyword">int</span> tmp1 = trie[trie[v1].ls].size+trie[trie[v2].ls].size-trie[trie[v3].ls].size-trie[trie[v4].ls].size;</div><div class="line">	<span class="keyword">int</span> tmp2 = trie[trie[v1].rs].size+trie[trie[v2].rs].size-trie[trie[v3].rs].size-trie[trie[v4].rs].size;</div><div class="line">	<span class="keyword">if</span> (x/range == <span class="number">0</span>) {</div><div class="line">		<span class="keyword">if</span> (tmp2)	<span class="keyword">return</span> range+query(trie[v1].rs, trie[v2].rs, trie[v3].rs, trie[v4].rs, x%range, range/<span class="number">2</span>);</div><div class="line">		<span class="keyword">else</span>	<span class="keyword">return</span> query(trie[v1].ls, trie[v2].ls, trie[v3].ls, trie[v4].ls, x%range, range/<span class="number">2</span>);</div><div class="line">	} <span class="keyword">else</span> {</div><div class="line">		<span class="keyword">if</span> (tmp1)	<span class="keyword">return</span> range+query(trie[v1].ls, trie[v2].ls, trie[v3].ls, trie[v4].ls, x%range, range/<span class="number">2</span>);</div><div class="line">		<span class="keyword">else</span>	<span class="keyword">return</span> query(trie[v1].rs, trie[v2].rs, trie[v3].rs, trie[v4].rs, x%range, range/<span class="number">2</span>);</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m) != EOF) {</div><div class="line">		init();</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;c[i]);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) {<span class="keyword">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v), G[u].push_back(v), G[v].push_back(u);}</div><div class="line">		DFS(<span class="number">1</span>);</div><div class="line">		build(<span class="number">1</span>);</div><div class="line">		<span class="keyword">while</span> (m--) {</div><div class="line">			<span class="keyword">int</span> u, v, x, lca;</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;x);	lca = LCA(u, v);</div><div class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, query(root[u], root[v], root[lca], root[anc[lca][<span class="number">0</span>]], x, (<span class="number">1</span>&lt;&lt;MAX_D)));</div><div class="line">		}</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= cnt; i++)	trie[i].ls = trie[i].rs = trie[i].size = <span class="number">0</span>;</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HDU/">HDU</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LCA/">LCA</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Trie/">Trie</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据结构/">数据结构</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/3/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><a class="extend next" rel="next" href="/page/5/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2017 Azrael_Death
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a>
        </div>
    </div>
  </div>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
  </script>
  <script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  
</footer>

    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="/js/main.js"></script>
<!--
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
-->



  </div>
</body>
</html>