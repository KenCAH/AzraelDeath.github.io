<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>NIRVANA</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Blog of a Chinese OIer">
<meta property="og:type" content="website">
<meta property="og:title" content="NIRVANA">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="NIRVANA">
<meta property="og:description" content="Blog of a Chinese OIer">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="NIRVANA">
<meta name="twitter:description" content="Blog of a Chinese OIer">
  
    <link rel="alternative" href="/atom.xml" title="NIRVANA" type="application/atom+xml">
  
  
    <link rel="icon" href="http://chuantu.biz/t6/89/1507626502x2728279003.jpg">
  
  <link rel="stylesheet" href="/css/style.css">
  
  

  <script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>
  <script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>

  
</head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://chuantu.biz/t6/89/1507626502x2728279003.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Azrael_Death</a></h1>
		</hgroup>

		
		<p class="header-subtitle">Veni Vidi Vici</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/AzraelDeath" title="github">github</a>
					        
								<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/azraeldeath" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/2-SAT/" style="font-size: 11.43px;">2-SAT</a> <a href="/tags/AC自动机/" style="font-size: 11.43px;">AC自动机</a> <a href="/tags/APIO/" style="font-size: 10px;">APIO</a> <a href="/tags/BZOJ/" style="font-size: 20px;">BZOJ</a> <a href="/tags/DFS序/" style="font-size: 10px;">DFS序</a> <a href="/tags/DP/" style="font-size: 11.43px;">DP</a> <a href="/tags/HDU/" style="font-size: 14.29px;">HDU</a> <a href="/tags/LCA/" style="font-size: 12.86px;">LCA</a> <a href="/tags/LG/" style="font-size: 11.43px;">LG</a> <a href="/tags/Manacher/" style="font-size: 11.43px;">Manacher</a> <a href="/tags/NOI/" style="font-size: 11.43px;">NOI</a> <a href="/tags/NOIp/" style="font-size: 10px;">NOIp</a> <a href="/tags/POI/" style="font-size: 10px;">POI</a> <a href="/tags/POJ/" style="font-size: 15.71px;">POJ</a> <a href="/tags/Tarjan/" style="font-size: 11.43px;">Tarjan</a> <a href="/tags/Trie/" style="font-size: 10px;">Trie</a> <a href="/tags/UVa/" style="font-size: 10px;">UVa</a> <a href="/tags/主席树/" style="font-size: 14.29px;">主席树</a> <a href="/tags/分块/" style="font-size: 10px;">分块</a> <a href="/tags/差分/" style="font-size: 10px;">差分</a> <a href="/tags/差分约束系统/" style="font-size: 10px;">差分约束系统</a> <a href="/tags/并查集/" style="font-size: 11.43px;">并查集</a> <a href="/tags/总结/" style="font-size: 18.57px;">总结</a> <a href="/tags/树套树/" style="font-size: 11.43px;">树套树</a> <a href="/tags/树状数组/" style="font-size: 12.86px;">树状数组</a> <a href="/tags/模拟/" style="font-size: 10px;">模拟</a> <a href="/tags/省选/" style="font-size: 17.14px;">省选</a> <a href="/tags/线段树/" style="font-size: 12.86px;">线段树</a> <a href="/tags/组合数学/" style="font-size: 10px;">组合数学</a> <a href="/tags/网络流/" style="font-size: 15.71px;">网络流</a> <a href="/tags/莫队/" style="font-size: 11.43px;">莫队</a> <a href="/tags/补集转换/" style="font-size: 10px;">补集转换</a> <a href="/tags/费用流/" style="font-size: 10px;">费用流</a> <a href="/tags/高斯消元/" style="font-size: 10px;">高斯消元</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.csdn.net/OwenOwl">OwenOwl</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.csdn.net/Joker_69">Joker</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://dangxingyu.com">DXY</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://309459245.lofter.com">YJQ</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/candy99">Candy</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/zig-zag">ZigZag</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://cxjyxx.me">cxjyxx_me</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.shuizilong.com">ShuiZiLong</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/kuangbin">KuangBin</a>
			        
			        </div>
				</section>
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Azrael_Death</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="http://chuantu.biz/t6/89/1507626502x2728279003.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">Azrael_Death</h1>
			</hgroup>
			
			<p class="header-subtitle">Veni Vidi Vici</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/AzraelDeath" title="github">github</a>
			        
						<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/azraeldeath" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-BZOJ1997 【HNOI2010】Planer 2-SAT" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/BZOJ1997 【HNOI2010】Planer 2-SAT/" class="article-date">
  	<time datetime="2017-10-13T16:00:00.000Z" itemprop="datePublished">2017-10-14</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/BZOJ1997 【HNOI2010】Planer 2-SAT/">
        BZOJ1997 Planer &lt;2-SAT&gt;
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>&#x4F20;&#x9001;&#x95E8;&#xFF1A;<a href="http://www.lydsy.com/JudgeOnline/problem.php?id=1997" target="_blank" rel="external">http://www.lydsy.com/JudgeOnline/problem.php?id=1997</a></p>
<p>&#x6807;&#x7B7E;&#xFF1A;2-SAT&#xFF0C;&#x5E76;&#x67E5;&#x96C6;</p>
<p>&#x672C;&#x9898;&#x548C;POJ3207&#x6CA1;&#x4EC0;&#x4E48;&#x533A;&#x522B;&#x2026;<br>&#x53EA;&#x662F;&#x521A;&#x505A;POJ3207&#x65F6;&#x662F;&#x590D;&#x4E60;2-SAT&#xFF0C;&#x6240;&#x4EE5;&#x5199;&#x4E86;tarjan&#xFF0C;&#x7136;&#x800C;&#x67D0;&#x5929;&#x78B0;&#x5230;&#x8FD9;&#x9898;&#x7A81;&#x7136;&#x60F3;&#x5230;&#x4E86;&#x5E76;&#x67E5;&#x96C6;&#x3002;<br>&#x8C8C;&#x4F3C;&#x6B64;&#x9898;&#x53EF;&#x4EE5;&#x79CD;&#x7C7B;&#x5E76;&#x67E5;&#x96C6;trick&#x8FC7;&#x3002;<br>&#x628A;&#x6BCF;&#x6761;&#x7EBF;&#x6BB5;&#x62C6;&#x6210;&#x4E24;&#x4E2A;&#x70B9;&#xFF0C;&#x4EE3;&#x8868;&#x4ECE;&#x91CC;&#x9762;&#x8FDE;&#x548C;&#x5916;&#x9762;&#x8FDE;&#xFF0C;&#x5BF9;&#x4E8E;&#x76F8;&#x4EA4;&#x7EBF;&#x6BB5;a,b&#xFF0C;&#x4E00;&#x5B9A;&#x6709;a&#x548C;b&#x4E0D;&#x540C;&#x65F6;&#x5728;&#x91CC;&#x9762;&#x6216;&#x5916;&#x9762;&#xFF0C;&#x4E8E;&#x662F;merge(a, b&#x2019;), merge(a&#x2019;, b)&#x3002;&#x8FD9;&#x6837;&#x5408;&#x5E76;&#x65F6;&#x5224;&#x65AD;&#x662F;&#x5426;&#x6709;i,i&#x2019;&#x5728;&#x540C;&#x4E00;&#x96C6;&#x4E2D;&#x5373;&#x53EF;&#x3002;</p>
<p>&#x9644;&#x4E0A;AC&#x4EE3;&#x7801;&#xFF08;&#x6BD4;tarjan&#x597D;&#x5199;&#x591A;&#x4E86;&#xFF0C;&#x867D;&#x7136;&#x4E24;&#x8005;&#x90FD;&#x5F88;&#x597D;&#x5199;&#xFF09;&#xFF1A;<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 200</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_M 10000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m, p[MAX_N+<span class="number">5</span>], l[MAX_M+<span class="number">5</span>], r[MAX_M+<span class="number">5</span>], fa[MAX_M*<span class="number">2</span>+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>{<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>*m; i++)	fa[i] = i;}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">getf</span><span class="params">(<span class="keyword">int</span> x)</span> </span>{<span class="keyword">return</span> fa[x] == x ? x : fa[x] = getf(fa[x]);}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>{a = getf(a), b = getf(b);	<span class="keyword">if</span> (a != b)	fa[a] = b;}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">int</span> T;	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</div><div class="line">	<span class="keyword">while</span> (T--) {</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m), init();	<span class="keyword">bool</span> flag = <span class="literal">true</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;l[i], &amp;r[i]);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, x; i &lt; n; i++)	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x), p[x] = i;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)	l[i] = p[l[i]], r[i] = p[r[i]];</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)	<span class="keyword">if</span> (l[i] &gt; r[i])	swap(l[i], r[i]);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; m; i++)	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j++)</div><div class="line">			<span class="keyword">if</span> ((l[i] &lt; l[j] &amp;&amp; r[i] &gt; l[j] &amp;&amp; r[i] &lt; r[j]) || (l[i] &gt; l[j] &amp;&amp; l[i] &lt; r[j] &amp;&amp; r[i] &gt; r[j]))</div><div class="line">				merge(i*<span class="number">2</span>, j*<span class="number">2</span>+<span class="number">1</span>), merge(i*<span class="number">2</span>+<span class="number">1</span>, j*<span class="number">2</span>);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)	flag &amp;= (getf(i*<span class="number">2</span>) != getf(i*<span class="number">2</span>+<span class="number">1</span>));</div><div class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, flag ? <span class="string">&quot;YES&quot;</span> : <span class="string">&quot;NO&quot;</span>);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/2-SAT/">2-SAT</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/BZOJ/">BZOJ</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-POJ3207 Ikki&#39;s Story IV - Panda&#39;s Trick 2-SAT" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/POJ3207 Ikki's Story IV - Panda's Trick 2-SAT/" class="article-date">
  	<time datetime="2017-10-13T16:00:00.000Z" itemprop="datePublished">2017-10-14</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/POJ3207 Ikki's Story IV - Panda's Trick 2-SAT/">
        POJ3207 Ikki&#39;s Story IV - Panda&#39;s Trick &lt;2-SAT&gt;
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Ikki&#x2019;s Story IV - Panda&#x2019;s Trick</p>
<p>liympanda, one of Ikki&#x2019;s friend, likes playing games with Ikki. Today after minesweeping with Ikki and winning so many times, he is tired of such easy games and wants to play another game with Ikki.<br>liympanda has a magic circle and he puts it on a plane, there are n points on its boundary in circular border: 0, 1, 2, &#x2026;, n-1. Evil panda claims that he is connecting m pairs of points. To connect two points, liympanda either places the link entirely inside the circle or entirely outside the circle. Now liympanda tells Ikki no two links touch inside/outside the circle, except on the boundary. He wants Ikki to figure out whether this is possible&#x2026;<br>Despaired at the minesweeping game just played, Ikki is totally at a loss, so he decides to write a program to help him.</p>
<p>Input<br>The input contains exactly one test case.<br>In the test case there will be a line consisting of of two integers: n and m (n &#x2264; 1,000, m &#x2264; 500). The following m lines each contain two integers ai and bi, which denote the endpoints of the ith wire. Every point will have at most one link.<br>Output<br>Output a line, either &#x201C;panda is telling the truth&#x2026;&#x201D; or &#x201C;the evil panda is lying again&#x201D;.</p>
<p>Sample Input<br>4 2<br>0 1<br>3 2<br>Sample Output<br>panda is telling the truth&#x2026;</p>
</blockquote>
<p>&#x6807;&#x7B7E;&#xFF1A;2-SAT</p>
<p>&#x9898;&#x76EE;&#x5927;&#x610F;&#xFF1A;n&#x4E2A;&#x6570;&#x6392;&#x6210;&#x4E00;&#x5708;&#xFF0C;&#x7ED9;&#x51FA;&#x82E5;&#x5E72;&#x6761;&#x4E24;&#x70B9;&#x95F4;&#x7684;&#x7EBF;&#x6BB5;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x5708;&#x5185;&#x8FDE;&#xFF0C;&#x4E5F;&#x53EF;&#x5728;&#x5708;&#x5916;&#x8FDE;&#xFF0C;&#x95EE;&#x80FD;&#x5426;&#x4F7F;&#x5F97;&#x65E0;&#x76F8;&#x4EA4;&#x7EBF;&#x6BB5;&#xFF08;&#x7AEF;&#x70B9;&#x76F8;&#x4EA4;&#x4E0D;&#x7B97;&#xFF09;</p>
<p>&#x672C;&#x9898;&#x662F;2-SAT&#x7684;&#x5224;&#x5B9A;&#x88F8;&#x9898;&#x3002;<br>&#x628A;&#x6BCF;&#x6761;&#x7EBF;&#x6BB5;&#x62C6;&#x6210;&#x4E24;&#x4E2A;&#x70B9;&#xFF0C;&#x5373;&#x7B2C;i&#x6761;&#x4E3A;i&#x548C;i&#x2019;&#xFF0C;&#x5206;&#x522B;&#x4EE3;&#x8868;i&#x5728;&#x5708;&#x5185;&#x548C;&#x5728;&#x5708;&#x5916;&#x3002;&#x82E5;&#x7EBF;&#x6BB5;a&#x548C;b&#x76F8;&#x4EA4;&#xFF0C;&#x5219;&#x8FDE;&#x8FB9;a-&gt;b&#x2019;&#xFF0C;a&#x2019;-&gt;b&#xFF0C;&#x8FD9;&#x6837;&#x8DD1;&#x4E00;&#x4E2A;tarjan&#x518D;&#x5224;&#x65AD;i&#x548C;i&#x2019;&#x662F;&#x5426;&#x5728;&#x4E00;&#x4E2A;&#x8054;&#x901A;&#x5757;&#x5185;&#x5373;&#x53EF;&#x5224;&#x65AD;&#x662F;&#x5426;&#x6709;&#x51B2;&#x7A81;&#x3002;</p>
<p>&#x76F4;&#x63A5;&#x4E0A;&#x4EE3;&#x7801;&#xFF1A;<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stack&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_M 500</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m, x[MAX_M+<span class="number">5</span>], y[MAX_M+<span class="number">5</span>];</div><div class="line"><span class="keyword">int</span> dfn[MAX_M*<span class="number">2</span>+<span class="number">5</span>], low[MAX_M*<span class="number">2</span>+<span class="number">5</span>], id[MAX_M*<span class="number">2</span>+<span class="number">5</span>], index, cnt;</div><div class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; G[MAX_M*<span class="number">2</span>+<span class="number">5</span>];</div><div class="line"><span class="built_in">stack</span> &lt;<span class="keyword">int</span>&gt; sta;</div><div class="line"><span class="keyword">bool</span> insta[MAX_M*<span class="number">2</span>+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> u)</span> </span>{</div><div class="line">	dfn[u] = low[u] = ++index;</div><div class="line">	sta.push(u), insta[u] = <span class="literal">true</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[u].size(); i++) {</div><div class="line">		<span class="keyword">int</span> v = G[u][i];</div><div class="line">		<span class="keyword">if</span> (!dfn[v])	tarjan(v), low[u] = min(low[u], low[v]);</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (insta[v])	low[u] = min(low[u], dfn[v]);</div><div class="line">	}</div><div class="line">	<span class="keyword">if</span> (dfn[u] == low[u]) {</div><div class="line">		cnt++;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = sta.top(); ; i = sta.top()) {</div><div class="line">			id[i] = cnt;</div><div class="line">			sta.pop();</div><div class="line">			<span class="keyword">if</span> (i == u)	<span class="keyword">break</span>;</div><div class="line">		}</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= m; i++)</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; i; j++)</div><div class="line">			<span class="keyword">if</span> ((x[i] &lt;= x[j] &amp;&amp; y[i] &gt;= x[j] &amp;&amp; y[i] &lt;= y[j]) || (x[i] &gt;= x[j] &amp;&amp; x[i] &lt;= y[j] &amp;&amp; y[i] &gt;= y[j]))</div><div class="line">				G[i].push_back(j+m), G[j].push_back(i+m), G[i+m].push_back(j), G[j+m].push_back(i);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</div><div class="line">		<span class="keyword">if</span> (id[i] == id[i+m])</div><div class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) {</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;x[i], &amp;y[i]);</div><div class="line">		<span class="keyword">if</span> (x[i] &gt; y[i])	swap(x[i], y[i]);</div><div class="line">	}</div><div class="line">	build();</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m*<span class="number">2</span>; i++)</div><div class="line">		<span class="keyword">if</span> (!dfn[i])</div><div class="line">			tarjan(i);</div><div class="line">	<span class="keyword">if</span> (check())	<span class="built_in">printf</span>(<span class="string">&quot;panda is telling the truth...\n&quot;</span>);</div><div class="line">	<span class="keyword">else</span>	<span class="built_in">printf</span>(<span class="string">&quot;the evil panda is lying again\n&quot;</span>);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/2-SAT/">2-SAT</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/POJ/">POJ</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-20171001-08总结" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/20171001-08总结/" class="article-date">
  	<time datetime="2017-10-09T16:00:00.000Z" itemprop="datePublished">2017-10-10</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/20171001-08总结/">
        201701001-08总结
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="&#x957F;&#x6C99;&#x96C5;&#x793C;&#x4E2D;&#x5B66;2017&#x56FD;&#x5E86;&#x8BAD;&#x7EC3;&#x6EDA;&#x7C97;&#x8BB0;"><a href="#&#x957F;&#x6C99;&#x96C5;&#x793C;&#x4E2D;&#x5B66;2017&#x56FD;&#x5E86;&#x8BAD;&#x7EC3;&#x6EDA;&#x7C97;&#x8BB0;" class="headerlink" title="&#x957F;&#x6C99;&#x96C5;&#x793C;&#x4E2D;&#x5B66;2017&#x56FD;&#x5E86;&#x8BAD;&#x7EC3;&#x6EDA;&#x7C97;&#x8BB0;"></a>&#x957F;&#x6C99;&#x96C5;&#x793C;&#x4E2D;&#x5B66;2017&#x56FD;&#x5E86;&#x8BAD;&#x7EC3;&#x6EDA;&#x7C97;&#x8BB0;</h1><ul>
<li>&#x5174;&#x81F4;&#x52C3;&#x52C3;&#x5730;&#x53BB;&#xFF0C;&#x904D;&#x4F53;&#x9CDE;&#x4F24;&#x5730;&#x56DE;&#x2026;&#x2026;</li>
<li>&#x516B;&#x573A;&#x8003;&#x8BD5;&#x7206;&#x516D;&#x573A;&#xFF0C;&#x6C34;&#x9898;&#x5168;&#x90FD;&#x6CA1;&#x505A;&#x8D77;&#x2026;&#x2026;</li>
</ul>
<h2 id="Day-1"><a href="#Day-1" class="headerlink" title="Day 1"></a>Day 1</h2><p>&#x4E0A;&#x5348;&#x4E09;&#x9053;&#x6C34;&#x9898;<br>T1&#x597D;&#x7B80;&#x5355;&#xFF0C;&#x6570;&#x8F74;&#x4E0A;&#x753B;&#x5706;&#xFF0C;&#x8F6C;&#x5316;&#x6210;&#x7EBF;&#x6BB5;&#x8986;&#x76D6;&#x3002;&#x7136;&#x800C;&#x6211;&#x5E76;&#x6CA1;&#x6709;&#x770B;&#x51FA;&#x6765;~,,&#x53E;&#x3142;&#x53E;,,~<br>T2T3&#x5728;&#x54EA;&#x91CC;&#x89C1;&#x8FC7;&#x4E00;&#x6837;&#x2026;&#x7A81;&#x7136;&#x610F;&#x8BC6;&#x5230;&#x662F;&#x6691;&#x5047;&#x8BB2;&#x8FC7;&#x7684;&#x9898;&#x3002;<br>T2&#x7EBF;&#x6BB5;&#x6811;&#x5957;&#x8DEF;&#x9898;&#x3002;&#x5E76;&#x6CA1;&#x6709;&#x60F3;&#x8D77;&#x6765;&#x6B63;&#x89E3;&#xFF0C;&#x8003;&#x5B8C;&#x610F;&#x8BC6;&#x5230;&#x662F;&#x50BB;&#x903C;&#x66B4;&#x529B;&#x4FEE;&#x6539;&#x3002;<br>T3&#x6570;&#x4F4D;DP&#xFF0C;&#x641E;&#x65B9;&#x7A0B;&#x4E00;&#x5C0F;&#x65F6;&#x6CA1;&#x809D;&#x51FA;&#x6765;&#x3002;</p>
<p>&#x4E2D;&#x5348;&#x9893;&#x9893;&#x9893;</p>
<p>&#x4E0B;&#x5348;&#x8BB2;YSY&#x8BB2;DP<br>&#x82B1;&#x4E86;&#x4E00;&#x4E2A;&#x534A;&#x5C0F;&#x65F6;&#x628A;&#x4E0A;&#x5348;&#x7684;&#x9898;&#x6539;&#x4E86;&#xFF0C;&#x6210;&#x529F;&#x8DF3;&#x8FC7;&#x4E86;DP&#x57FA;&#x7840;&#x90E8;&#x5206;&#x3002;<br>&#x540E;&#x9762;&#x7684;&#x9898;&#x633A;&#x6709;&#x610F;&#x601D;&#x3002;&#x53D1;&#x73B0;&#x82E5;&#x5E72;&#x9053;FindStr&#x8BB2;&#x8FC7;&#x7684;&#x9898;&#x548C;BZOJ&#x539F;&#x9898;&#x3002;&#x6700;&#x540E;&#x4E00;&#x9053;&#x6CA1;&#x542C;&#x61C2;&#x3002;</p>
<p>&#x665A;&#x4E0A;&#x8BB2;&#x4E86;&#x4E09;&#x9053;&#x96BE;&#x9898;&#xFF0C;&#x542C;&#x5F97;&#x534A;&#x61C2;&#xFF0C;&#x53E3;&#x80E1;AC</p>
<h2 id="Day-2"><a href="#Day-2" class="headerlink" title="Day 2"></a>Day 2</h2><p>&#x4E0A;&#x5348;&#x4E24;&#x9053;&#x6C34;&#x9898;+&#x4E00;&#x9053;&#x6570;&#x8BBA;<br>T1&#x663E;&#x7136;&#x662F;DP&#xFF0C;&#x64B8;&#x65B9;&#x7A0B;&#x4E00;&#x4E2A;&#x534A;&#x5C0F;&#x65F6;&#x6CA1;&#x809D;&#x51FA;&#x6765;&#xFF0C;&#x679C;&#x65AD;&#x6253;&#x4E86;BF<br>T2&#x80AF;&#x5B9A;&#x56FE;&#x8BBA;&#xFF0C;&#x6CA1;&#x60F3;&#x51FA;&#x6B63;&#x89E3;&#xFF0C;&#x6253;&#x4E86;&#x4E00;&#x4E2A;DFS&#x5206;&#x5C42;&#xFF0C;&#x52A0;&#x4E0A;&#x82E5;&#x5E72;&#x526A;&#x679D;&#x4F18;&#x5316;&#xFF0C;&#x5E76;&#x6CA1;&#x9A97;&#x5230;&#x5206;<br>T3&#x4E4D;&#x4E00;&#x770B;&#x5BB9;&#x65A5;&#x6216;&#x83AB;&#x6BD4;&#x4E4C;&#x65AF;&#x53CD;&#x6F14;&#x2026;&#x7B49;&#x7B49;&#x8FD9;&#x662F;NOIp&#x6A21;&#x62DF;&#x554A;&#x2026;&#x679C;&#x65AD;&#x653E;&#x6389;&#x63A8;&#x53CD;&#x6F14;&#xFF0C;&#x641E;&#x534A;&#x5929;&#x6253;&#x4E86;BF&#x3002;&#x7ED3;&#x679C;&#x6807;&#x89E3;&#x662F;&#x53CD;&#x6F14;&#x2026;&#x30FE;(&#x2267;&#x3078;&#x2266;)&#x3003;<br>&#x53C8;&#x6C34;&#x4E86;&#x4F4E;&#x4FDD;&#x5206;</p>
<p>&#x4E2D;&#x5348;&#x9893;&#x9893;&#x9893;</p>
<p>&#x4E0B;&#x5348;YSY&#x8BB2;&#x6570;&#x8BBA;<br>&#x5148;&#x6539;&#x4E86;&#x4E00;&#x4E2A;&#x534A;&#x5C0F;&#x65F6;&#x9898;&#xFF0C;&#x53D1;&#x73B0;YSY&#x628A;&#x6211;&#x4F1A;&#x7684;&#x90FD;&#x8BB2;&#x5B8C;&#x4E86;&#x3002;&#x63A5;&#x7740;&#x5C31;&#x5F00;&#x59CB;&#x8BB2;&#x83AB;&#x6BD4;&#x4E4C;&#x65AF;&#x53CD;&#x6F14;&#x7B49;&#x7701;&#x9009;&#x5185;&#x5BB9;&#x3002;<br>&#x51FA;&#x53D1;&#x540E;&#x7B2C;&#x4E00;&#x6B21;&#x6000;&#x7591;&#x8FD9;&#x4E0D;&#x662F;NOIp&#x96C6;&#x8BAD;&#x2026;</p>
<p>&#x665A;&#x4E0A;&#x8BB2;&#x4E86;&#x4E09;&#x9053;&#x6709;&#x610F;&#x601D;&#x7684;&#x9898;&#xFF0C;&#x53E3;&#x80E1;AC</p>
<h2 id="Day-3"><a href="#Day-3" class="headerlink" title="Day 3"></a>Day 3</h2><p>&#x4E0A;&#x5348;&#x4E00;&#x9053;&#x539F;&#x9898;+&#x4E24;&#x9053;&#x6B63;&#x5E38;&#x9898;<br>T1&#x4E00;&#x770B;&#x662F;&#x7EBF;&#x6BB5;&#x6811;&#xFF0C;&#x611F;&#x89C9;&#x597D;&#x719F;&#x6089;&#xFF0C;&#x5E94;&#x8BE5;&#x662F;&#x539F;&#x9898;&#xFF0C;&#x7136;&#x540E;&#x5C31;&#x5FD8;&#x4E86;&#x6807;&#x89E3;&#x4E86;&#x2026;<br>&#x8003;&#x5B8C;YY&#x8BF4;&#x8FD9;&#x9898;&#x6211;&#x5F53;&#x65F6;&#x7ED9;&#x4ED6;&#x8BB2;&#x8FC7;&#xFF0C;&#x4ED6;&#x5370;&#x8C61;&#x53EF;&#x6DF1;&#x4E86;&#x3002;&#x7136;&#x800C;&#x6211;&#x4F5C;&#x4E3A;&#x8BB2;&#x9898;&#x4EBA;&#x5C45;&#x7136;&#x5FD8;&#x4E86;&#x2026;&#x5BF9;&#x6211;&#x7684;&#x667A;&#x5546;&#x548C;&#x8BB0;&#x5FC6;&#x529B;&#x6DF1;&#x8868;&#x6000;&#x7591;&#x3002;<br>&#x6B64;&#x9898;&#x6B63;&#x89E3;&#xFF1A;&#x5F31;&#x667A;&#x7EBF;&#x6BB5;&#x6811;x26&#xFF0C;&#x5361;&#x5E38;&#x3002;<br>T2&#x663E;&#x7136;&#x662F;DP&#xFF0C;&#x7136;&#x800C;&#x9898;&#x76EE;&#x53D9;&#x8FF0;&#x4E0D;&#x6E05;&#x695A;&#xFF0C;&#x4E00;&#x534A;&#x7684;&#x4EBA;&#x90FD;&#x8BFB;&#x9519;&#x4E86;&#xFF08;including&#x5B54;&#x7237;&#xFF09;&#xFF0C;&#x8BFB;&#x9519;&#x4E4B;&#x540E;&#x592A;&#x590D;&#x6742;&#xFF0C;&#x6839;&#x672C;&#x65E0;&#x6CD5;&#x63A8;DP&#xFF0C;&#x6240;&#x4EE5;&#x66B4;&#x529B;&#x4E5F;&#x9519;&#x4E86;&#xFF0C;&#x6000;&#x7591;&#x6837;&#x4F8B;&#x8017;&#x6389;&#x534A;&#x5C0F;&#x65F6;&#x2026;<br>T3&#x662F;&#x4E8C;&#x8FDB;&#x5236;&#x9898;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x7528;&#x5B57;&#x5178;&#x6811;&#x6216;&#x8005;bitset&#xFF0C;&#x535A;&#x5F08;&#x903B;&#x8F91;&#x6405;&#x534A;&#x5929;&#xFF0C;&#x5E76;&#x672A;&#x53D1;&#x73B0;&#x90A3;&#x4E2A;&#x770B;&#x4F3C;&#x590D;&#x6742;&#x7684;&#x64CD;&#x4F5C;&#x5C31;&#x662F;&#x5FAA;&#x73AF;&#x79FB;&#x4F4D;&#x3002;&#x5FD8;&#x4E86;&#x5F02;&#x6216;&#x7684;&#x5957;&#x8DEF;&#xFF0C;&#x65F6;&#x95F4;&#x4E0D;&#x591F;&#x6253;&#x4E86;BF&#x3002;</p>
<p>&#x4E2D;&#x5348;&#x9893;&#x9893;&#x9893;</p>
<p>&#x4E0B;&#x5348;YSY&#x8BB2;&#x8D2A;&#x5FC3;&#x5206;&#x6CBB;<br>&#x4ECA;&#x5929;&#x5F88;&#x6B63;&#x5E38;&#xFF0C;&#x5927;&#x6982;&#x662F;NOIp&#x96BE;&#x5EA6;&#x3002;&#x53D1;&#x73B0;&#x51E0;&#x9053;&#x505A;&#x8FC7;&#x7684;&#x9898;&#x3002;&#x51FA;&#x53D1;&#x540E;&#x7B2C;&#x4E00;&#x6B21;&#x6709;&#x4E86;NOIp&#x96C6;&#x8BAD;&#x8425;&#x7684;&#x611F;&#x89C9;&#x800C;&#x975E;&#x7701;&#x9009;&#x96C6;&#x8BAD;&#x8425;&#x3002;</p>
<p>&#x665A;&#x4E0A;&#x8BB2;&#x9898;&#x4EBA;&#x7684;&#x201C;&#x6C34;&#x9898;&#x9009;&#x8BB2;&#x201D;&#x96BE;&#x5EA6;&#x5B9A;&#x4F4D;&#x5728;&#x7701;&#x9009;+<br>&#x4E09;&#x9053;&#x6570;&#x8BBA;&#x6076;&#x5FC3;&#x9898;&#xFF0C;&#x63A8;&#x516C;&#x5F0F;&#x51E0;&#x5927;&#x9875;PPT&#xFF0C;&#x5B8C;&#x5168;&#x6CA1;&#x61C2;&#x3002;<br>&#x5B89;&#x6170;&#x81EA;&#x5DF1;&#xFF0C;&#x7701;&#x9009;&#x4E4B;&#x524D;&#x4E0D;&#x4F1A;&#x6709;&#x8FD9;&#x4E9B;&#x9B3C;&#x4E1C;&#x897F;&#x3002;</p>
<h2 id="Day-4"><a href="#Day-4" class="headerlink" title="Day 4"></a>Day 4</h2><p>&#x4E0A;&#x5348;&#x4E24;&#x9053;&#x6C34;&#x9898;+&#x4E00;&#x9053;&#x539F;&#x9898;<br>T1&#x88F8;&#x7EA6;&#x745F;&#x592B;&#xFF0C;&#x7ED3;&#x679C;&#x5FD8;&#x4E86;&#x5F53;&#x65F6;&#x521D;&#x4E8C;&#x81EA;&#x5DF1;&#x662F;&#x600E;&#x4E48;&#x63A8;&#x9012;&#x63A8;&#x5F0F;&#x7684;&#x4E86;&#x2026;<br>T2&#x6811;&#x72B6;&#x6570;&#x7EC4;&#xFF0C;&#x867D;&#x7136;&#x88AB;&#x9898;&#x9762;&#x65C1;&#x8FB9;&#x7684;&#x5C11;&#x5973;&#x9A9A;&#x6270;&#x4E86;&#x534A;&#x5929;&#xFF0C;&#x8FD8;&#x662F;&#x5F88;&#x5FEB;&#x53D1;&#x73B0;&#x8FD9;&#x662F;&#x9053;&#x6C34;&#x9898;&#xFF0C;&#x6811;&#x72B6;&#x6570;&#x7EC4;&#x6253;&#x51FA;&#x6765;&#x3002;<br>&#x7ED3;&#x679C;&#x5FD8;&#x5199;IObuf&#xFF0C;&#x88AB;&#x6BD2;&#x7624;&#x51FA;&#x9898;&#x4EBA;&#x5361;&#x5E38;&#x2026;<br>T3&#x662F;&#x7ECF;&#x5178;DP&#x9898;&#xFF0C;&#x7136;&#x800C;&#x6211;&#x5E76;&#x6CA1;&#x6709;&#x505A;&#x8FC7;&#xFF0C;&#x8003;&#x8BD5;&#x4E5F;&#x6CA1;&#x60F3;&#x5230;&#xFF0C;&#x53EA;&#x4F1A;&#x6C42;&#x6700;&#x5927;&#x503C;&#x4E0D;&#x4F1A;&#x8F93;&#x51FA;&#x65B9;&#x6848;&#x3002;<br>&#x770B;&#x5230;&#x6B63;&#x89E3;&#x89C9;&#x5F97;&#x597D;&#x618B;&#x5C48;&#xFF0C;&#x65B9;&#x7A0B;&#x90FD;&#x4E00;&#x6837;&#xFF0C;&#x5C31;&#x662F;&#x6CA1;&#x65F6;&#x95F4;&#x60F3;&#x56DE;&#x6EAF;&#x8F93;&#x51FA;&#x4E86;&#x3002;</p>
<p>&#x4E2D;&#x5348;&#x9893;&#x9893;&#x9893;</p>
<p>&#x4E0B;&#x5348;&#x96C5;&#x793C;&#x5B66;&#x957F;&#x8BB2;&#x641C;&#x7D22;<br>&#x9898;&#x76EE;&#x4E5F;&#x5F88;&#x6B63;&#x5E38;&#xFF0C;&#x5927;&#x591A;&#x5C31;&#x662F;&#x526A;&#x679D;&#x542F;&#x53D1;&#x5F0F;&#x4E4B;&#x7C7B;&#x3002;&#x51FA;&#x53D1;&#x540E;&#x7B2C;&#x4E8C;&#x6B21;&#x4E5F;&#x662F;&#x6700;&#x540E;&#x4E00;&#x6B21;&#x6709;&#x4E86;NOIp&#x96C6;&#x8BAD;&#x8425;&#x7684;&#x611F;&#x89C9;&#x3002;</p>
<p>&#x665A;&#x4E0A;&#x7531;&#x4E8E;&#x7AEF;&#x5348;&#x6CA1;&#x8BB2;&#x9898;<br>&#x9893;&#x9893;&#x9893;</p>
<h2 id="Day-5"><a href="#Day-5" class="headerlink" title="Day 5"></a>Day 5</h2><p>&#x4E0A;&#x5348;&#x4E09;&#x9053;&#x6B63;&#x5E38;&#x9898;<br>T1&#x56FE;&#x4E0A;DP&#xFF0C;&#x5F88;&#x597D;&#x63A8;&#xFF0C;&#x4F46;&#x662F;&#x8F6C;&#x79FB;&#x5FD8;&#x5199;&#x4F4D;&#x8FD0;&#x7B97;&#xFF0C;&#x5F3A;&#x884C;&#x628A;&#x590D;&#x6742;&#x5EA6;&#x5199;&#x4E11;&#x4E86;&#x2026;<br>T2&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x53EF;&#x4EE5;&#x8BC1;&#x660E;&#x4E0D;&#x4F1A;&#x6709;&#x65E0;&#x89E3;&#xFF0C;&#x6240;&#x4EE5;&#x968F;&#x673A;&#x5316;&#x4E71;&#x641E;&#x3002;&#x5F53;&#x65F6;&#x5E76;&#x6CA1;&#x6709;&#x60F3;&#x5230;&#xFF0C;&#x4E8E;&#x662F;&#x5012;&#x7740;&#x66B4;&#x529B;&#x641C;&#xFF0C;&#x5C45;&#x7136;&#x8FC7;&#x4E86;&#x2026;WTF<br>T3&#x662F;&#x6811;&#x5F62;DP&#xFF0C;&#x4F46;&#x662F;&#x6BD4;&#x8F83;&#x96BE;&#x60F3;&#xFF0C;&#x800C;&#x4E14;&#x590D;&#x6742;&#x5EA6;&#x4F1A;&#x7206;&#x3002;&#x5E76;&#x6CA1;&#x6709;&#x5199;&#x51FA;&#x6765;&#x3002;&#x4E0B;&#x5348;&#x8BB2;&#x9898;&#x624D;&#x53D1;&#x73B0;&#x8FD9;&#x4E2A;DP&#x6709;&#x6700;&#x4F18;&#x7B56;&#x7565;&#xFF0C;&#x9000;&#x5316;&#x6210;&#x8D2A;&#x5FC3;&#x3002;</p>
<p>&#x4E2D;&#x5348;&#x9893;&#x9893;&#x9893;</p>
<p>&#x4E0B;&#x5348;&#x542C;WHX&#x8BB2;&#x6570;&#x8BBA;<br>&#x542C;&#x5230;&#x4E00;&#x534A;&#x679C;&#x65AD;&#x6539;&#x9898;&#x3002;&#x81F3;&#x4E8E;&#x539F;&#x56E0;&#x5417;&#x2026;&#x5B8C;&#x5168;&#x542C;&#x4E0D;&#x61C2;&#xFF0C;&#x9664;&#x4E86;&#x57FA;&#x7840;&#x80FD;&#x61C2;&#x4EE5;&#x5916;&#xFF0C;&#x5168;&#x90FD;&#x4E0D;&#x4F1A;&#x7528;&#x3002;&#x8FD9;&#x5DF2;&#x7ECF;&#x6709;&#x7701;&#x9009;+&#x7684;&#x96BE;&#x5EA6;&#x4E86;&#x3002;&#x6700;&#x540E;&#x5C45;&#x7136;&#x8BB2;&#x8D77;&#x4E86;&#x795E;&#x6280;Min-Max&#x5BB9;&#x65A5;&#x2026;<br>WHX&#x8FD8;&#x8D85;&#x65F6;&#x4E00;&#x5C0F;&#x65F6;&#xFF0C;&#x5F3A;&#x884C;&#x5360;&#x5403;&#x996D;&#x65F6;&#x95F4;&#x8BB2;&#x4E86;&#x7EBF;&#x6027;&#x4EE3;&#x6570;/(&#x3112;o&#x3112;)/~~</p>
<p>&#x665A;&#x4E0A;&#x542C;&#x6742;&#x9898;<br>&#x4ECA;&#x5929;&#x7684;&#x9898;&#x6BD4;&#x8F83;&#x6B63;&#x5E38;&#xFF0C;NOIp+&#x96BE;&#x5EA6;&#xFF0C;&#x53EF;&#x4EE5;&#x542C;&#x61C2;&#xFF0C;&#x6CA1;&#x592A;&#x5927;&#x95EE;&#x9898;</p>
<h2 id="Day-6"><a href="#Day-6" class="headerlink" title="Day 6"></a>Day 6</h2><p>&#x4E0A;&#x5348;&#x4E09;&#x9053;&#x7701;&#x9009;-&#x9898;<br>T1&#x770B;&#x5230;&#x201C;&#x6700;&#x5C0F;&#x8DDD;&#x79BB;&#x6700;&#x5927;&#x503C;&#x201D;&#x5C31;&#x53BB;&#x60F3;&#x4E8C;&#x5206;&#x7B54;&#x6848;&#xFF0C;&#x7ED3;&#x679C;&#x590D;&#x6742;&#x5EA6;&#x8FD8;&#x662F;&#x7206;&#x4E86;&#xFF0C;&#x5F3A;&#x884C;&#x52A0;&#x4E86;&#x4E2A;&#x4F18;&#x5316;&#xFF0C;&#x628A;&#x6700;&#x597D;&#x590D;&#x6742;&#x5EA6;&#x4F18;&#x5316;&#x4E86;&#x3002;&#x672C;&#x6765;&#x4EE5;&#x4E3A;&#x4F1A;GG&#xFF0C;&#x7ED3;&#x679C;&#x5C45;&#x7136;&#x8FC7;&#x4E86;&#x3002;&#x51FA;&#x9898;&#x4EBA;&#x8868;&#x793A;&#x5F88;&#x8BE7;&#x5F02;&#xFF0C;&#x6B64;&#x9898;&#x6B63;&#x89E3;prime&#x751F;&#x6210;&#x6811;<br>T2&#x77E5;&#x9053;&#x662F;DP&#xFF0C;&#x4F46;&#x5C31;&#x662F;&#x6CA1;&#x63A8;&#x51FA;&#x65B9;&#x7A0B;&#x3002;&#x65F6;&#x95F4;&#x4E0D;&#x591F;&#x4E86;&#xFF0C;&#x679C;&#x65AD;&#x6253;BF&#x3002;<br>T3&#x770B;&#x8868;&#x8FBE;&#x5F0F;&#x5E94;&#x8BE5;&#x662F;&#x659C;&#x7387;&#x51F8;&#x5305;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x6811;&#x4E0A;&#x7EF4;&#x62A4;&#x51F8;&#x5305;&#x6211;&#x53EA;&#x4F1A;&#x66B4;&#x529B;&#x5F39;&#x6808;&#xFF0C;&#x590D;&#x6742;&#x5EA6;&#x8DDF;&#x66B4;&#x529B;&#x5DEE;&#x4E0D;&#x591A;&#xFF0C;&#x4E8E;&#x662F;&#x6253;&#x4E86;BF&#x3002;&#x8003;&#x5B8C;&#x770B;&#x5230;&#x6253;&#x66B4;&#x529B;&#x5F39;&#x6808;&#x88AB;&#x5361;&#x5F97;&#x8DDF;&#x88F8;&#x66B4;&#x529B;&#x4E00;&#x6837;&#x7684;&#x540C;&#x5B66;&#x89C9;&#x5F97;&#x81EA;&#x5DF1;&#x8D5A;&#x4E86;&#x3002;</p>
<p>&#x4E2D;&#x5348;&#x9893;&#x9893;&#x9893;</p>
<p>&#x4E0B;&#x5348;&#x542C;WHX&#x8BB2;&#x6742;&#x9898;<br>&#x9898;&#x76EE;&#x5F88;&#x597D;&#xFF0C;&#x601D;&#x7EF4;&#x5F88;&#x5DE7;&#x5999;&#xFF0C;&#x6DA8;&#x59FF;&#x52BF;&#x4E86;&#x3002;<br>&#x61D2;&#x764C;&#x4E00;&#x9898;&#x6CA1;&#x542C;&#x61C2;&#xFF0C;&#x5176;&#x4ED6;&#x9898;&#x5927;&#x6982;&#x61C2;&#x4E86;&#xFF0C;&#x53E3;&#x80E1;AC&#x3002;</p>
<p>&#x665A;&#x4E0A;&#x8BB2;&#x4E09;&#x9053;AtCoder&#x9898;<br>&#x524D;&#x4E24;&#x9898;&#x80FD;&#x542C;&#x61C2;&#xFF0C;&#x6BD4;&#x8F83;&#x5DE7;&#x5999;&#x3002;<br>&#x6700;&#x540E;&#x4E00;&#x9053;&#x5206;&#x5F62;&#xFF0C;&#x5F88;&#x6709;&#x610F;&#x601D;&#xFF0C;&#x534A;&#x61C2;&#x534A;&#x61C2;&#x3002;</p>
<h2 id="Day-7"><a href="#Day-7" class="headerlink" title="Day 7"></a>Day 7</h2><p>&#x4E0A;&#x5348;&#x4E09;&#x9053;&#x6570;&#x5B66;&#x9898;&#xFF0C;&#x9884;&#x6D4B;&#x5230;&#x81EA;&#x5DF1;&#x80AF;&#x5B9A;GG<br>T1&#x671F;&#x671B;&#x9898;&#xFF0C;&#x4E0D;&#x592A;&#x597D;&#x8BC1;&#x660E;&#xFF0C;&#x4F46;&#x662F;&#x6253;&#x8868;&#x5F88;&#x597D;&#x53D1;&#x73B0;&#x89C4;&#x5F8B;&#xFF0C;&#x7136;&#x800C;&#x6211;&#x8003;&#x8BD5;&#x5E76;&#x6CA1;&#x6709;&#x6253;&#x8868;&#x3002;<br>T2DP&#x9898;&#xFF0C;&#x8003;&#x8651;&#x6F0F;&#x4E86;&#x60C5;&#x51B5;&#xFF0C;&#x6253;&#x4E86;&#x4E2A;&#x8D2A;&#x5FC3;&#xFF0C;&#x7136;&#x540E;&#x81EA;&#x5DF1;&#x628A;&#x81EA;&#x5DF1;&#x5361;&#x6389;&#x4E86;&#x2026;<br>T3&#x770B;&#x5230;&#x4E09;&#x7EF4;&#x51F8;&#x5305;+&#x671F;&#x671B;&#x5C31;&#x77E5;&#x9053;&#x6CA1;&#x641E;&#x3002;<br>&#x8003;&#x5B8C;&#x51FA;&#x9898;&#x4EBA;&#x8BF4;&#x8FD9;&#x5957;&#x9898;&#x6BD4;&#x524D;&#x4E24;&#x5929;&#x7B80;&#x5355;&#x2026;&#x86E4;&#xFF1F;</p>
<p>&#x4E2D;&#x5348;&#x9893;&#x9893;&#x9893;</p>
<p>&#x4E0B;&#x5348;&#x542C;WHX&#x8BB2;&#x56FE;&#x8BBA;<br>&#x4E00;&#x5F00;&#x59CB;&#x633A;&#x7B80;&#x5355;&#xFF0C;&#x4F46;&#x662F;&#x5F00;&#x59CB;&#x8BB2;&#x5B9A;&#x7406;&#x5C31;&#x61F5;&#x4E86;&#x3002;<br>&#x5012;&#x662F;&#x542C;&#x61C2;&#x4E86;&#x82E5;&#x5E72;&#x9053;&#x7F51;&#x7EDC;&#x6D41;&#x5EFA;&#x6A21;&#x9898;&#x3002;</p>
<p>&#x665A;&#x4E0A;&#x4E09;&#x9053;&#x6742;&#x9898;<br>&#x53D1;&#x73B0;&#x4E00;&#x9053;YJQ&#x8BB2;&#x8FC7;&#x7684;&#x535A;&#x5F08;&#x8BBA;&#x539F;&#x9898;&#xFF0C;&#x5176;&#x4ED6;&#x9898;&#x76EE;&#x6BD4;&#x8F83;&#x6B63;&#x5E38;</p>
<h2 id="Day-8"><a href="#Day-8" class="headerlink" title="Day 8"></a>Day 8</h2><p>&#x4E0A;&#x5348;&#x4E09;&#x9053;NOIp+&#x9898;&#x76EE;<br>&#x51FA;&#x9898;&#x4EBA;&#x5728;P1&#x8BF4;&#x9898;&#x76EE;&#x6309;&#x5B57;&#x5178;&#x5E8F;&#x6392;&#x5E8F;&#xFF0C;&#x7ED3;&#x679C;&#x6211;&#x4E00;&#x6765;&#x5C31;&#x6311;&#x4E86;&#x6700;&#x96BE;&#x7684;&#x9898;&#x505A;&#x2026;&#x7136;&#x540E;GG<br>T1&#x6309;&#x8FB9;DFS&#xFF0C;&#x62C6;&#x6389;&#x8FD4;&#x7956;&#x8FB9;&#xFF0C;&#x7136;&#x540E;&#x6811;&#x5F62;DP<br>T2AtCoder&#x667A;&#x5546;&#x9898;&#xFF0C;&#x5148;&#x8F6C;&#x5316;&#x7136;&#x540E;DP&#xFF0C;&#x8FDE;&#x8F6C;&#x6362;&#x90FD;&#x6CA1;&#x60F3;&#x5230;<br>T3&#x7ED3;&#x8BBA;&#x9898;&#xFF0C;&#x6CA1;&#x63A8;&#x51FA;&#x7ED3;&#x8BBA;&#xFF0C;&#x4E5F;&#x6CA1;&#x627E;&#x89C4;&#x5F8B;&#xFF0C;GG</p>
<p>&#x4E2D;&#x5348;&#x9893;&#x9893;&#x9893;</p>
<p>&#x4E0B;&#x5348;&#x542C;h10&#x8BB2;&#x51E0;&#x4F55;<br>&#x90FD;&#x61C2;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x4E0D;&#x4F1A;&#x5199;&#xFF0C;&#x800C;&#x4E14;&#x65CB;&#x8F6C;&#x5361;&#x58F3;&#x548C;&#x534A;&#x5E73;&#x9762;&#x4EA4;&#x662F;NOIp&#x5185;&#x5BB9;&#x5417;&#xFF1F;&#x61F5;&#x903C;ing</p>
<p>&#x665A;&#x4E0A;&#x542C;&#x4E86;&#x56DB;&#x9053;&#x6742;&#x9898;<br>&#x5927;&#x6982;&#x90FD;&#x61C2;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x53EA;&#x80FD;&#x53E3;&#x80E1;AC&#x3002;&#x552F;&#x4E00;&#x4E00;&#x9053;&#x80FD;&#x5199;&#x7684;&#x5728;BZOJ&#x4E0A;&#x662F;&#x6743;&#x9650;&#x9898;&#x2026;</p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>&#x516B;&#x5929;&#x7206;&#x516D;&#x5929;&#xFF0C;&#x6210;&#x529F;&#x6EDA;&#x7C97;&#x2026;<br>&#x770B;&#x6765;&#x4E5D;&#x6708;&#x4EFD;&#x6CA1;&#x505C;&#x8BFE;&#x8FD8;&#x662F;&#x5F88;&#x8981;&#x547D;&#x7684;&#xFF0C;&#x5B8C;&#x5168;&#x6CA1;&#x4E86;&#x505A;&#x9898;&#x7684;&#x611F;&#x89C9;&#xFF0C;&#x6CA1;&#x600E;&#x4E48;&#x6DF1;&#x5165;&#x5730;&#x60F3;&#x3002;<br>&#x5341;&#x6708;&#x4EFD;&#x6162;&#x6162;&#x590D;&#x4E60;&#x8C03;&#x6574;&#xFF0C;&#x628A;&#x5B66;FFT&#x548C;&#x540E;&#x7F00;&#x81EA;&#x52A8;&#x673A;&#x7684;&#x8BA1;&#x5212;&#x518D;&#x5F80;&#x540E;&#x63A8;&#x4E00;&#x63A8;&#x3002;</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/总结/">总结</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-洛谷模板汇总" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/洛谷模板汇总/" class="article-date">
  	<time datetime="2017-09-28T16:00:00.000Z" itemprop="datePublished">2017-09-29</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/洛谷模板汇总/">
        【福利】洛谷模板汇总
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Graph-Theory"><a href="#Graph-Theory" class="headerlink" title="Graph Theory"></a>Graph Theory</h1><h2 id="Disjoint-Set"><a href="#Disjoint-Set" class="headerlink" title="Disjoint Set"></a>Disjoint Set</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x5E76;&#x67E5;&#x96C6;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x5982;&#x9898;&#xFF0C;&#x73B0;&#x5728;&#x6709;&#x4E00;&#x4E2A;&#x5E76;&#x67E5;&#x96C6;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x5B8C;&#x6210;&#x5408;&#x5E76;&#x548C;&#x67E5;&#x8BE2;&#x64CD;&#x4F5C;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x5305;&#x542B;&#x4E24;&#x4E2A;&#x6574;&#x6570;N&#x3001;M&#xFF0C;&#x8868;&#x793A;&#x5171;&#x6709;N&#x4E2A;&#x5143;&#x7D20;&#x548C;M&#x4E2A;&#x64CD;&#x4F5C;&#x3002;<br>&#x63A5;&#x4E0B;&#x6765;M&#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x5305;&#x542B;&#x4E09;&#x4E2A;&#x6574;&#x6570;Zi&#x3001;Xi&#x3001;Yi<br>&#x5F53;Zi=1&#x65F6;&#xFF0C;&#x5C06;Xi&#x4E0E;Yi&#x6240;&#x5728;&#x7684;&#x96C6;&#x5408;&#x5408;&#x5E76;<br>&#x5F53;Zi=2&#x65F6;&#xFF0C;&#x8F93;&#x51FA;Xi&#x4E0E;Yi&#x662F;&#x5426;&#x5728;&#x540C;&#x4E00;&#x96C6;&#x5408;&#x5185;&#xFF0C;&#x662F;&#x7684;&#x8BDD;&#x8F93;&#x51FA;Y&#xFF1B;&#x5426;&#x5219;&#x8BDD;&#x8F93;&#x51FA;N<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x5982;&#x4E0A;&#xFF0C;&#x5BF9;&#x4E8E;&#x6BCF;&#x4E00;&#x4E2A;Zi=2&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x90FD;&#x6709;&#x4E00;&#x884C;&#x8F93;&#x51FA;&#xFF0C;&#x6BCF;&#x884C;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x5927;&#x5199;&#x5B57;&#x6BCD;&#xFF0C;&#x4E3A;Y&#x6216;&#x8005;N</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;&#xFF1A;<br>4 7<br>2 1 2<br>1 1 2<br>2 1 2<br>1 3 4<br>2 1 4<br>1 2 3<br>2 1 4<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;&#xFF1A;<br>N<br>Y<br>N<br>Y</p>
<p>&#x8BF4;&#x660E;<br>&#x65F6;&#x7A7A;&#x9650;&#x5236;&#xFF1A;1000ms,128M<br>&#x6570;&#x636E;&#x89C4;&#x6A21;&#xFF1A;<br>&#x5BF9;&#x4E8E;30%&#x7684;&#x6570;&#x636E;&#xFF0C;N&lt;=10&#xFF0C;M&lt;=20&#xFF1B;<br>&#x5BF9;&#x4E8E;70%&#x7684;&#x6570;&#x636E;&#xFF0C;N&lt;=100&#xFF0C;M&lt;=1000&#xFF1B;<br>&#x5BF9;&#x4E8E;100%&#x7684;&#x6570;&#x636E;&#xFF0C;N&lt;=10000&#xFF0C;M&lt;=200000&#x3002;<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 10000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m, f, x, y, father[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">getfather</span><span class="params">(<span class="keyword">int</span> v)</span> </span>{</div><div class="line">    <span class="keyword">if</span> (father[v] == v) {</div><div class="line">        <span class="keyword">return</span> v;</div><div class="line">    }</div><div class="line">    father[v] = getfather(father[v]);</div><div class="line">    <span class="keyword">return</span> father[v];</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) {</div><div class="line">        father[i] = i;</div><div class="line">    }</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) {</div><div class="line">        <span class="built_in">cin</span> &gt;&gt; f &gt;&gt; x &gt;&gt; y;</div><div class="line">        <span class="keyword">if</span> (f == <span class="number">1</span>) {</div><div class="line">            <span class="keyword">int</span> f1 = getfather(x);</div><div class="line">            <span class="keyword">int</span> f2 = getfather(y);</div><div class="line">            <span class="keyword">if</span> (f1 != f2) {</div><div class="line">                father[f1] = f2;</div><div class="line">            }</div><div class="line">        } <span class="keyword">else</span> {</div><div class="line">            <span class="keyword">int</span> f1 = getfather(x);</div><div class="line">            <span class="keyword">int</span> f2 = getfather(y);</div><div class="line">            <span class="keyword">if</span> (f1 != f2) {</div><div class="line">                <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;N&quot;</span> &lt;&lt; <span class="built_in">endl</span>;            } <span class="keyword">else</span> {</div><div class="line">                <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Y&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">            }</div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Minimum-Spanning-Tree-Kruskal"><a href="#Minimum-Spanning-Tree-Kruskal" class="headerlink" title="Minimum Spanning Tree (Kruskal)"></a>Minimum Spanning Tree (Kruskal)</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x6700;&#x5C0F;&#x751F;&#x6210;&#x6811;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x5982;&#x9898;&#xFF0C;&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;&#x65E0;&#x5411;&#x56FE;&#xFF0C;&#x6C42;&#x51FA;&#x6700;&#x5C0F;&#x751F;&#x6210;&#x6811;&#xFF0C;&#x5982;&#x679C;&#x8BE5;&#x56FE;&#x4E0D;&#x8FDE;&#x901A;&#xFF0C;&#x5219;&#x8F93;&#x51FA;orz</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x5305;&#x542B;&#x4E24;&#x4E2A;&#x6574;&#x6570;N&#x3001;M&#xFF0C;&#x8868;&#x793A;&#x8BE5;&#x56FE;&#x5171;&#x6709;N&#x4E2A;&#x7ED3;&#x70B9;&#x548C;M&#x6761;&#x65E0;&#x5411;&#x8FB9;&#x3002;&#xFF08;N&lt;=5000&#xFF0C;M&lt;=200000&#xFF09;<br>&#x63A5;&#x4E0B;&#x6765;M&#x884C;&#x6BCF;&#x884C;&#x5305;&#x542B;&#x4E09;&#x4E2A;&#x6574;&#x6570;Xi&#x3001;Yi&#x3001;Zi&#xFF0C;&#x8868;&#x793A;&#x6709;&#x4E00;&#x6761;&#x957F;&#x5EA6;&#x4E3A;Zi&#x7684;&#x65E0;&#x5411;&#x8FB9;&#x8FDE;&#x63A5;&#x7ED3;&#x70B9;Xi&#x3001;Yi<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x8F93;&#x51FA;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x6570;&#xFF0C;&#x5373;&#x6700;&#x5C0F;&#x751F;&#x6210;&#x6811;&#x7684;&#x5404;&#x8FB9;&#x7684;&#x957F;&#x5EA6;&#x4E4B;&#x548C;&#xFF1B;&#x5982;&#x679C;&#x8BE5;&#x56FE;&#x4E0D;&#x8FDE;&#x901A;&#x5219;&#x8F93;&#x51FA;orz</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;&#xFF1A;<br>4 5<br>1 2 2<br>1 3 2<br>1 4 3<br>2 3 4<br>3 4 3<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;&#xFF1A;<br>7</p>
<p>&#x8BF4;&#x660E;<br>&#x65F6;&#x7A7A;&#x9650;&#x5236;&#xFF1A;1000ms,128M<br>&#x6570;&#x636E;&#x89C4;&#x6A21;&#xFF1A;<br>&#x5BF9;&#x4E8E;20%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=5&#xFF0C;M&lt;=20<br>&#x5BF9;&#x4E8E;40%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=50&#xFF0C;M&lt;=2500<br>&#x5BF9;&#x4E8E;70%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=500&#xFF0C;M&lt;=10000<br>&#x5BF9;&#x4E8E;100%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=5000&#xFF0C;M&lt;=200000<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 5000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_M 200000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> {</span></div><div class="line">	<span class="keyword">int</span> u, v, l;</div><div class="line">} edge[MAX_M+<span class="number">5</span>];</div><div class="line"><span class="keyword">int</span> n, m, tot = <span class="number">0</span>;</div><div class="line"><span class="keyword">int</span> father[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span><span class="params">(<span class="keyword">const</span> node &amp;a, <span class="keyword">const</span> node &amp;b)</span> </span>{</div><div class="line">	<span class="keyword">return</span> a.l &lt; b.l;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">getfather</span><span class="params">(<span class="keyword">int</span> v)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (father[v] == v) {</div><div class="line">		<span class="keyword">return</span> v;</div><div class="line">	}</div><div class="line">	father[v] = getfather(father[v]);</div><div class="line">	<span class="keyword">return</span> father[v];</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) {</div><div class="line">		<span class="built_in">cin</span> &gt;&gt; edge[i].u &gt;&gt; edge[i].v &gt;&gt; edge[i].l;</div><div class="line">	}</div><div class="line">	sort(edge, edge+m, comp);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	father[i] = i;</div><div class="line">	<span class="keyword">int</span> flag = n<span class="number">-1</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) {</div><div class="line">		<span class="keyword">int</span> f1 = getfather(edge[i].u);</div><div class="line">		<span class="keyword">int</span> f2 = getfather(edge[i].v);</div><div class="line">		<span class="keyword">if</span> (f1 != f2) {</div><div class="line">			father[f1] = f2;</div><div class="line">			tot += edge[i].l;</div><div class="line">			flag--;</div><div class="line">		}</div><div class="line">		<span class="keyword">if</span> (flag == <span class="number">0</span>)	<span class="keyword">break</span>;</div><div class="line">	}</div><div class="line">	<span class="keyword">if</span> (flag == <span class="number">0</span>) {</div><div class="line">		<span class="built_in">cout</span> &lt;&lt; tot;</div><div class="line">	} <span class="keyword">else</span> {</div><div class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;orz&quot;</span>;</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Shortest-Path-Fastest-Algorithm"><a href="#Shortest-Path-Fastest-Algorithm" class="headerlink" title="Shortest Path Fastest Algorithm"></a>Shortest Path Fastest Algorithm</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x5355;&#x6E90;&#x6700;&#x77ED;&#x8DEF;&#x5F84;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x5982;&#x9898;&#xFF0C;&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;&#x6709;&#x5411;&#x56FE;&#xFF0C;&#x8BF7;&#x8F93;&#x51FA;&#x4ECE;&#x67D0;&#x4E00;&#x70B9;&#x51FA;&#x53D1;&#x5230;&#x6240;&#x6709;&#x70B9;&#x7684;&#x6700;&#x77ED;&#x8DEF;&#x5F84;&#x957F;&#x5EA6;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x5305;&#x542B;&#x4E09;&#x4E2A;&#x6574;&#x6570;N&#x3001;M&#x3001;S&#xFF0C;&#x5206;&#x522B;&#x8868;&#x793A;&#x70B9;&#x7684;&#x4E2A;&#x6570;&#x3001;&#x6709;&#x5411;&#x8FB9;&#x7684;&#x4E2A;&#x6570;&#x3001;&#x51FA;&#x53D1;&#x70B9;&#x7684;&#x7F16;&#x53F7;&#x3002;<br>&#x63A5;&#x4E0B;&#x6765;M&#x884C;&#x6BCF;&#x884C;&#x5305;&#x542B;&#x4E09;&#x4E2A;&#x6574;&#x6570;Fi&#x3001;Gi&#x3001;Wi&#xFF0C;&#x5206;&#x522B;&#x8868;&#x793A;&#x7B2C;i&#x6761;&#x6709;&#x5411;&#x8FB9;&#x7684;&#x51FA;&#x53D1;&#x70B9;&#x3001;&#x76EE;&#x6807;&#x70B9;&#x548C;&#x957F;&#x5EA6;&#x3002;<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x4E00;&#x884C;&#xFF0C;&#x5305;&#x542B;N&#x4E2A;&#x7528;&#x7A7A;&#x683C;&#x5206;&#x9694;&#x7684;&#x6574;&#x6570;&#xFF0C;&#x5176;&#x4E2D;&#x7B2C;i&#x4E2A;&#x6574;&#x6570;&#x8868;&#x793A;&#x4ECE;&#x70B9;S&#x51FA;&#x53D1;&#x5230;&#x70B9;i&#x7684;&#x6700;&#x77ED;&#x8DEF;&#x5F84;&#x957F;&#x5EA6;&#xFF08;&#x82E5;S=i&#x5219;&#x6700;&#x77ED;&#x8DEF;&#x5F84;&#x957F;&#x5EA6;&#x4E3A;0&#xFF0C;&#x82E5;&#x4ECE;&#x70B9;S&#x65E0;&#x6CD5;&#x5230;&#x8FBE;&#x70B9;i&#xFF0C;&#x5219;&#x6700;&#x77ED;&#x8DEF;&#x5F84;&#x957F;&#x5EA6;&#x4E3A;2147483647&#xFF09;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;&#xFF1A;<br>4 6 1<br>1 2 2<br>2 3 2<br>2 4 1<br>1 3 5<br>3 4 3<br>1 4 4<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;&#xFF1A;<br>0 2 4 3</p>
<p>&#x8BF4;&#x660E;<br>&#x65F6;&#x7A7A;&#x9650;&#x5236;&#xFF1A;1000ms,128M<br>&#x6570;&#x636E;&#x89C4;&#x6A21;&#xFF1A;<br>&#x5BF9;&#x4E8E;20%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=5&#xFF0C;M&lt;=15<br>&#x5BF9;&#x4E8E;40%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=100&#xFF0C;M&lt;=10000<br>&#x5BF9;&#x4E8E;70%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=1000&#xFF0C;M&lt;=100000<br>&#x5BF9;&#x4E8E;100%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=10000&#xFF0C;M&lt;=500000<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_M 500000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 10000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2147483647</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> {</span></div><div class="line">	<span class="keyword">int</span> v, len, next;</div><div class="line">	node() {</div><div class="line">		v = len = next = <span class="number">0</span>;</div><div class="line">	}</div><div class="line">} edge[MAX_M+<span class="number">5</span>];</div><div class="line"><span class="keyword">int</span> n, m, s;</div><div class="line"><span class="keyword">int</span> first[MAX_N+<span class="number">5</span>], cnt = <span class="number">0</span>;</div><div class="line"><span class="keyword">int</span> dis[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> l)</span> </span>{</div><div class="line">	cnt++;</div><div class="line">	edge[cnt].v = v;</div><div class="line">	edge[cnt].len = l;</div><div class="line">	edge[cnt].next = first[u];</div><div class="line">	first[u] = cnt;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">SPFA</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) {</div><div class="line">		dis[i] = INF;</div><div class="line">	}</div><div class="line">	<span class="keyword">int</span> que[MAX_N*<span class="number">20</span>+<span class="number">5</span>], mark[MAX_N+<span class="number">5</span>];</div><div class="line">	<span class="keyword">int</span> head = <span class="number">0</span>, tail = <span class="number">1</span>;</div><div class="line">	<span class="built_in">memset</span>(mark, <span class="number">0</span>, <span class="keyword">sizeof</span>(mark));</div><div class="line">	que[<span class="number">1</span>] = s;</div><div class="line">	mark[s] = <span class="number">1</span>;</div><div class="line">	dis[s] = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span> (head &lt;= tail) {</div><div class="line">		head++;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> tmp = first[que[head]]; tmp; tmp = edge[tmp].next) {</div><div class="line">			<span class="keyword">if</span> (dis[que[head]]+edge[tmp].len &lt; dis[edge[tmp].v]) {</div><div class="line">				dis[edge[tmp].v] = dis[que[head]]+edge[tmp].len;</div><div class="line">				<span class="keyword">if</span> (mark[edge[tmp].v] == <span class="number">0</span>) {</div><div class="line">					mark[edge[tmp].v] = <span class="number">1</span>;</div><div class="line">					tail++;</div><div class="line">					que[tail] = edge[tmp].v;</div><div class="line">				}</div><div class="line">			}</div><div class="line">		}</div><div class="line">		mark[que[head]] = <span class="number">0</span>;</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; s;</div><div class="line">	<span class="built_in">memset</span>(first, <span class="number">0</span>, <span class="keyword">sizeof</span>(first));</div><div class="line">	<span class="keyword">int</span> u, v, l;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) {</div><div class="line">		<span class="built_in">cin</span> &gt;&gt; u &gt;&gt; v &gt;&gt; l;</div><div class="line">		insert(u, v, l);</div><div class="line">	}</div><div class="line">	SPFA();</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) {</div><div class="line">		<span class="built_in">cout</span> &lt;&lt; dis[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Tarjan"><a href="#Tarjan" class="headerlink" title="Tarjan"></a>Tarjan</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x7F29;&#x70B9;</p>
<p>&#x9898;&#x76EE;&#x80CC;&#x666F;<br>&#x7F29;&#x70B9;+DP</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x7ED9;&#x5B9A;&#x4E00;&#x4E2A;n&#x4E2A;&#x70B9;m&#x6761;&#x8FB9;&#x6709;&#x5411;&#x56FE;&#xFF0C;&#x6BCF;&#x4E2A;&#x70B9;&#x6709;&#x4E00;&#x4E2A;&#x6743;&#x503C;&#xFF0C;&#x6C42;&#x4E00;&#x6761;&#x8DEF;&#x5F84;&#xFF0C;&#x4F7F;&#x8DEF;&#x5F84;&#x7ECF;&#x8FC7;&#x7684;&#x70B9;&#x6743;&#x503C;&#x4E4B;&#x548C;&#x6700;&#x5927;&#x3002;&#x4F60;&#x53EA;&#x9700;&#x8981;&#x6C42;&#x51FA;&#x8FD9;&#x4E2A;&#x6743;&#x503C;&#x548C;&#x3002;<br>&#x5141;&#x8BB8;&#x591A;&#x6B21;&#x7ECF;&#x8FC7;&#x4E00;&#x6761;&#x8FB9;&#x6216;&#x8005;&#x4E00;&#x4E2A;&#x70B9;&#xFF0C;&#x4F46;&#x662F;&#xFF0C;&#x91CD;&#x590D;&#x7ECF;&#x8FC7;&#x7684;&#x70B9;&#xFF0C;&#x6743;&#x503C;&#x53EA;&#x8BA1;&#x7B97;&#x4E00;&#x6B21;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#xFF0C;n,m<br>&#x7B2C;&#x4E8C;&#x884C;&#xFF0C;n&#x4E2A;&#x6574;&#x6570;&#xFF0C;&#x4F9D;&#x6B21;&#x4EE3;&#x8868;&#x70B9;&#x6743;<br>&#x7B2C;&#x4E09;&#x81F3;m+2&#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x4E24;&#x4E2A;&#x6574;&#x6570;u,v&#xFF0C;&#x8868;&#x793A;u-&gt;v&#x6709;&#x4E00;&#x6761;&#x6709;&#x5411;&#x8FB9;<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x5171;&#x4E00;&#x884C;&#xFF0C;&#x6700;&#x5927;&#x7684;&#x70B9;&#x6743;&#x4E4B;&#x548C;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;&#xFF1A;<br>2 2<br>1 1<br>1 2<br>2 1<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;&#xFF1A;<br>2</p>
<p>&#x8BF4;&#x660E;<br>n&lt;=10^4,m&lt;=10^5,|&#x70B9;&#x6743;|&lt;=1000 &#x7B97;&#x6CD5;&#xFF1A;Tarjan&#x7F29;&#x70B9;+DAGdp<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stack&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 100000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m, c[MAX_N+<span class="number">5</span>], f[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="keyword">int</span> dfn[MAX_N+<span class="number">5</span>], low[MAX_N+<span class="number">5</span>], col[MAX_N+<span class="number">5</span>], val[MAX_N+<span class="number">5</span>], ind, cnt;</div><div class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; G[MAX_N+<span class="number">5</span>], E[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="built_in">stack</span> &lt;<span class="keyword">int</span>&gt; sta;</div><div class="line"><span class="keyword">bool</span> insta[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> u)</span> </span>{</div><div class="line">	dfn[u] = low[u] = ++ind, sta.push(u), insta[u] = <span class="literal">true</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[u].size(); i++) {</div><div class="line">		<span class="keyword">int</span> v = G[u][i];</div><div class="line">		<span class="keyword">if</span> (!dfn[v])	tarjan(v), low[u] = min(low[u], low[v]);</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (insta[v])	low[u] = min(low[u], dfn[v]);</div><div class="line">	}</div><div class="line">	<span class="keyword">if</span> (dfn[u] == low[u]) {</div><div class="line">		cnt++;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = sta.top(); ; i = sta.top()) {</div><div class="line">			col[i] = cnt, val[cnt] += c[i], insta[i] = <span class="literal">false</span>;</div><div class="line">			sta.pop();	<span class="keyword">if</span> (u == i)	<span class="keyword">break</span>;</div><div class="line">		}</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">DFS</span><span class="params">(<span class="keyword">int</span> u)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (f[u])	<span class="keyword">return</span> f[u];</div><div class="line">	<span class="keyword">int</span> mx = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; E[u].size(); i++)	mx = max(mx, DFS(E[u][i]));</div><div class="line">	<span class="keyword">return</span> f[u] = val[u]+mx;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;c[i]);</div><div class="line">	<span class="keyword">while</span> (m--) {</div><div class="line">		<span class="keyword">int</span> u, v;	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</div><div class="line">		G[u].push_back(v);</div><div class="line">	}</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">		<span class="keyword">if</span> (!dfn[i])	tarjan(i);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> u = <span class="number">1</span>; u &lt;= n; u++) {</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[u].size(); i++) {</div><div class="line">			<span class="keyword">int</span> v = G[u][i];	<span class="keyword">if</span> (col[u] == col[v])	<span class="keyword">continue</span>;</div><div class="line">			E[col[u]].push_back(col[v]);</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= cnt; i++)</div><div class="line">		<span class="keyword">if</span> (!f[i])	ans = max(ans, DFS(i));</div><div class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, ans);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Cur-Vertex"><a href="#Cur-Vertex" class="headerlink" title="Cur Vertex"></a>Cur Vertex</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x5272;&#x70B9;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;n&#x4E2A;&#x70B9;&#xFF0C;m&#x6761;&#x8FB9;&#x7684;&#x65E0;&#x5411;&#x56FE;&#xFF0C;&#x6C42;&#x56FE;&#x7684;&#x5272;&#x70B9;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x8F93;&#x5165;n&#xFF0C;m<br>&#x4E0B;&#x9762;m&#x884C;&#x6BCF;&#x884C;&#x8F93;&#x5165;x&#xFF0C;y&#x8868;&#x793A;x&#x5230;y&#x6709;&#x4E00;&#x6761;&#x8FB9;<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x8F93;&#x51FA;&#x5272;&#x70B9;&#x4E2A;&#x6570;<br>&#x7B2C;&#x4E8C;&#x884C;&#x6309;&#x7167;&#x8282;&#x70B9;&#x7F16;&#x53F7;&#x4ECE;&#x5C0F;&#x5230;&#x5927;&#x8F93;&#x51FA;&#x8282;&#x70B9;&#xFF0C;&#x7528;&#x7A7A;&#x683C;&#x9694;&#x5F00;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;&#xFF1A;<br>6 7<br>1 2<br>1 3<br>1 4<br>2 5<br>3 5<br>4 5<br>5 6<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;&#xFF1A;<br>1<br>5</p>
<p>&#x8BF4;&#x660E;<br>n&#xFF0C;m&#x5747;&#x4E3A;100000<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 100000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_M 200000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> {</span></div><div class="line">    <span class="keyword">int</span> v, next;</div><div class="line">} edge[MAX_M+<span class="number">5</span>];</div><div class="line"><span class="keyword">int</span> first[MAX_N+<span class="number">5</span>], flag[MAX_N+<span class="number">5</span>], num[MAX_N+<span class="number">5</span>], low[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="keyword">int</span> n, m, cnt = <span class="number">0</span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> pos)</span> </span>{</div><div class="line">    edge[pos].next = first[u];</div><div class="line">    edge[pos].v = v;</div><div class="line">    first[u] = pos;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> cur, <span class="keyword">int</span> father)</span> </span>{</div><div class="line">    <span class="keyword">int</span> child = <span class="number">0</span>;</div><div class="line">    num[cur] = low[cur] = ++cnt;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> tmp = first[cur]; tmp; tmp = edge[tmp].next) {</div><div class="line">        <span class="keyword">if</span> (!num[edge[tmp].v]) {</div><div class="line">            child++;</div><div class="line">            dfs(edge[tmp].v, cur);</div><div class="line">            low[cur] = min(low[cur], low[edge[tmp].v]);</div><div class="line">            <span class="keyword">if</span> (low[edge[tmp].v] &gt;= num[cur]) {</div><div class="line">                flag[cur] = <span class="number">1</span>;</div><div class="line">            }</div><div class="line">        } <span class="keyword">else</span> <span class="keyword">if</span> (num[edge[tmp].v] &lt; num[cur] &amp;&amp; edge[tmp].v != father) {</div><div class="line">            low[cur] = min(low[cur], num[edge[tmp].v]);</div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keyword">if</span> (father == <span class="number">-1</span> &amp;&amp; child == <span class="number">1</span>) {</div><div class="line">        flag[cur] = <span class="number">0</span>;</div><div class="line">    }</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) {</div><div class="line">        <span class="keyword">int</span> u, v;</div><div class="line">        <span class="built_in">cin</span> &gt;&gt; u &gt;&gt; v;</div><div class="line">        insert(u, v, i*<span class="number">2</span>+<span class="number">1</span>);</div><div class="line">        insert(v, u, i*<span class="number">2</span>+<span class="number">2</span>);</div><div class="line">    }</div><div class="line">    <span class="keyword">int</span> tot = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) {</div><div class="line">        <span class="keyword">if</span> (!num[i]) {</div><div class="line">            dfs(i, <span class="number">-1</span>);</div><div class="line">        }</div><div class="line">        <span class="keyword">if</span> (flag[i]) {</div><div class="line">            tot++;</div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="built_in">cout</span> &lt;&lt; tot &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) {</div><div class="line">        <span class="keyword">if</span> (flag[i]) {</div><div class="line">            <span class="built_in">cout</span> &lt;&lt; i &lt;&lt; <span class="string">&quot; &quot;</span>;</div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Lowest-Common-Ancestor"><a href="#Lowest-Common-Ancestor" class="headerlink" title="Lowest Common Ancestor"></a>Lowest Common Ancestor</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x6700;&#x8FD1;&#x516C;&#x5171;&#x7956;&#x5148; LCA</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x5982;&#x9898;&#xFF0C;&#x7ED9;&#x5B9A;&#x4E00;&#x68F5;&#x6709;&#x6839;&#x591A;&#x53C9;&#x6811;&#xFF0C;&#x8BF7;&#x6C42;&#x51FA;&#x6307;&#x5B9A;&#x4E24;&#x4E2A;&#x70B9;&#x76F4;&#x63A5;&#x6700;&#x8FD1;&#x7684;&#x516C;&#x5171;&#x7956;&#x5148;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x5305;&#x542B;&#x4E09;&#x4E2A;&#x6B63;&#x6574;&#x6570;N&#x3001;M&#x3001;S&#xFF0C;&#x5206;&#x522B;&#x8868;&#x793A;&#x6811;&#x7684;&#x7ED3;&#x70B9;&#x4E2A;&#x6570;&#x3001;&#x8BE2;&#x95EE;&#x7684;&#x4E2A;&#x6570;&#x548C;&#x6811;&#x6839;&#x7ED3;&#x70B9;&#x7684;&#x5E8F;&#x53F7;&#x3002;<br>&#x63A5;&#x4E0B;&#x6765;N-1&#x884C;&#x6BCF;&#x884C;&#x5305;&#x542B;&#x4E24;&#x4E2A;&#x6B63;&#x6574;&#x6570;x&#x3001;y&#xFF0C;&#x8868;&#x793A;x&#x7ED3;&#x70B9;&#x548C;y&#x7ED3;&#x70B9;&#x4E4B;&#x95F4;&#x6709;&#x4E00;&#x6761;&#x76F4;&#x63A5;&#x8FDE;&#x63A5;&#x7684;&#x8FB9;&#xFF08;&#x6570;&#x636E;&#x4FDD;&#x8BC1;&#x53EF;&#x4EE5;&#x6784;&#x6210;&#x6811;&#xFF09;&#x3002;<br>&#x63A5;&#x4E0B;&#x6765;M&#x884C;&#x6BCF;&#x884C;&#x5305;&#x542B;&#x4E24;&#x4E2A;&#x6B63;&#x6574;&#x6570;a&#x3001;b&#xFF0C;&#x8868;&#x793A;&#x8BE2;&#x95EE;a&#x7ED3;&#x70B9;&#x548C;b&#x7ED3;&#x70B9;&#x7684;&#x6700;&#x8FD1;&#x516C;&#x5171;&#x7956;&#x5148;&#x3002;<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x8F93;&#x51FA;&#x5305;&#x542B;M&#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x6B63;&#x6574;&#x6570;&#xFF0C;&#x4F9D;&#x6B21;&#x4E3A;&#x6BCF;&#x4E00;&#x4E2A;&#x8BE2;&#x95EE;&#x7684;&#x7ED3;&#x679C;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;&#xFF1A;<br>5 5 4<br>3 1<br>2 4<br>5 1<br>1 4<br>2 4<br>3 2<br>3 5<br>1 2<br>4 5<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;&#xFF1A;<br>4<br>4<br>1<br>4<br>4</p>
<p>&#x8BF4;&#x660E;<br>&#x65F6;&#x7A7A;&#x9650;&#x5236;&#xFF1A;1000ms,128M<br>&#x6570;&#x636E;&#x89C4;&#x6A21;&#xFF1A;<br>&#x5BF9;&#x4E8E;30%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=10&#xFF0C;M&lt;=10<br>&#x5BF9;&#x4E8E;70%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=10000&#xFF0C;M&lt;=10000<br>&#x5BF9;&#x4E8E;100%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=500000&#xFF0C;M&lt;=500000<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 500000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> {</span></div><div class="line">	<span class="keyword">int</span> next, to;</div><div class="line">} edge[(MAX_N&lt;&lt;<span class="number">1</span>)+<span class="number">5</span>];</div><div class="line"><span class="keyword">int</span> n, m, s, x, y, cnt;</div><div class="line"><span class="keyword">int</span> d[MAX_N+<span class="number">5</span>], p[MAX_N+<span class="number">5</span>][<span class="number">25</span>], first[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="keyword">bool</span> vis[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">int</span> ret = <span class="number">0</span>;	<span class="keyword">char</span> ch = getchar();</div><div class="line">	<span class="keyword">while</span> (ch &lt; <span class="string">&apos;0&apos;</span> || ch &gt; <span class="string">&apos;9&apos;</span>)	ch = getchar();</div><div class="line">	<span class="keyword">while</span> (ch &gt;= <span class="string">&apos;0&apos;</span> &amp;&amp; ch &lt;= <span class="string">&apos;9&apos;</span>)	ret = ret*<span class="number">10</span>+ch-<span class="string">&apos;0&apos;</span>, ch = getchar();</div><div class="line">	<span class="keyword">return</span> ret;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">INSERT</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>{</div><div class="line">	edge[++cnt].next = first[a];</div><div class="line">	edge[cnt].to = b;</div><div class="line">	first[a] = cnt;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span><span class="params">(<span class="keyword">int</span> u)</span> </span>{</div><div class="line">	vis[u] = <span class="literal">true</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; (<span class="number">1</span>&lt;&lt;i) &lt;= n; i++) {</div><div class="line">		<span class="keyword">if</span> ((<span class="number">1</span>&lt;&lt;i) &lt;= d[u]) {</div><div class="line">			p[u][i] = p[p[u][i<span class="number">-1</span>]][i<span class="number">-1</span>];</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = first[u]; i; i = edge[i].next) {</div><div class="line">		<span class="keyword">int</span> v = edge[i].to;</div><div class="line">		<span class="keyword">if</span> (!vis[v]) {</div><div class="line">			d[v] = d[u]+<span class="number">1</span>;</div><div class="line">			p[v][<span class="number">0</span>] = u;</div><div class="line">			DFS(v);</div><div class="line">		}</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">LCA</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>{</div><div class="line">	<span class="keyword">int</span> i, j;</div><div class="line">	<span class="keyword">if</span> (d[a] &lt; d[b])	swap(a, b);</div><div class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; (<span class="number">1</span>&lt;&lt;i) &lt;= d[a]; i++) {}</div><div class="line">	i--;</div><div class="line">	<span class="keyword">for</span> (j = i; j &gt;= <span class="number">0</span>; j--) {</div><div class="line">		<span class="keyword">if</span> (d[a]-(<span class="number">1</span>&lt;&lt;j) &gt;= d[b]) {</div><div class="line">			a = p[a][j];</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">if</span> (a == b) {</div><div class="line">		<span class="keyword">return</span> a;</div><div class="line">	}</div><div class="line">	<span class="keyword">for</span> (j = i; j &gt;= <span class="number">0</span>; j--) {</div><div class="line">		<span class="keyword">if</span> (p[a][j] != p[b][j]) {</div><div class="line">			a = p[a][j];</div><div class="line">			b = p[b][j];</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> p[a][<span class="number">0</span>];</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	n = read(), m = read(), s = read();</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) {</div><div class="line">		x = read(), y = read();</div><div class="line">		INSERT(x, y);</div><div class="line">		INSERT(y, x);</div><div class="line">	}</div><div class="line">	DFS(s);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) {</div><div class="line">		x = read(), y = read();</div><div class="line">		<span class="built_in">cout</span> &lt;&lt; LCA(x, y) &lt;&lt; <span class="built_in">endl</span>; </div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Negative-Loop"><a href="#Negative-Loop" class="headerlink" title="Negative Loop"></a>Negative Loop</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x8D1F;&#x73AF;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x66B4;&#x529B;&#x679A;&#x4E3E;/SPFA/Bellman-ford/&#x5947;&#x602A;&#x7684;&#x8D2A;&#x5FC3;/&#x8D85;&#x795E;&#x641C;&#x7D22;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x4E00;&#x4E2A;&#x6B63;&#x6574;&#x6570;T&#x8868;&#x793A;&#x6570;&#x636E;&#x7EC4;&#x6570;&#xFF0C;&#x5BF9;&#x4E8E;&#x6BCF;&#x7EC4;&#x6570;&#x636E;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x4E24;&#x4E2A;&#x6B63;&#x6574;&#x6570;N M&#xFF0C;&#x8868;&#x793A;&#x56FE;&#x6709;N&#x4E2A;&#x9876;&#x70B9;&#xFF0C;M&#x6761;&#x8FB9;<br>&#x63A5;&#x4E0B;&#x6765;M&#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x4E09;&#x4E2A;&#x6574;&#x6570;a b w&#xFF0C;&#x8868;&#x793A;a-&gt;b&#x6709;&#x4E00;&#x6761;&#x6743;&#x503C;&#x4E3A;w&#x7684;&#x8FB9;&#xFF08;&#x82E5;w&lt;0&#x5219;&#x4E3A;&#x5355;&#x5411;&#xFF0C;&#x5426;&#x5219;&#x53CC;&#x5411;&#xFF09;<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x5171;T&#x884C;&#x3002;&#x5BF9;&#x4E8E;&#x6BCF;&#x7EC4;&#x6570;&#x636E;&#xFF0C;&#x5B58;&#x5728;&#x8D1F;&#x73AF;&#x5219;&#x8F93;&#x51FA;&#x4E00;&#x884C;&#x201D;YE5&#x201D;(&#x4E0D;&#x542B;&#x5F15;&#x53F7;)&#xFF0C;&#x5426;&#x5219;&#x8F93;&#x51FA;&#x4E00;&#x884C;&#x201D;N0&#x201D;(&#x4E0D;&#x542B;&#x5F15;&#x53F7;)&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;#1&#xFF1A;<br>2<br>3 4<br>1 2 2<br>1 3 4<br>2 3 1<br>3 1 -3<br>3 3<br>1 2 3<br>2 3 4<br>3 1 -8<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;#1&#xFF1A;<br>N0<br>YE5</p>
<p>&#x8BF4;&#x660E;<br>N,M,|w|&#x2264;200 000&#xFF1B;1&#x2264;a,b&#x2264;N&#xFF1B;T&#x2264;10 &#x5EFA;&#x8BAE;&#x590D;&#x5236;&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#x4E2D;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002;<br>&#x6B64;&#x9898;&#x666E;&#x901A;Bellman-Ford&#x6216;BFS-SPFA&#x4F1A;TLE<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 200000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> SIZE 25000000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> f;	<span class="keyword">char</span> BUF[SIZE], *buf = BUF;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(<span class="keyword">int</span> &amp;x)</span> </span>{</div><div class="line">	<span class="keyword">bool</span> flag = <span class="number">0</span>;	<span class="keyword">while</span> (*buf &lt; <span class="number">48</span>)	<span class="keyword">if</span> (*buf++ == <span class="number">45</span>)	flag = <span class="number">1</span>;</div><div class="line">	x = <span class="number">0</span>;	<span class="keyword">while</span> (*buf &gt; <span class="number">32</span>)	x = x*<span class="number">10</span>+*buf++<span class="number">-48</span>;	x = flag ? -x : x;</div><div class="line">}</div><div class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; G[MAX_N+<span class="number">5</span>], E[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="keyword">int</span> dis[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="keyword">bool</span> insta[MAX_N+<span class="number">5</span>], flag;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> n)</span> </span>{</div><div class="line">	flag = <span class="literal">false</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	G[i].clear(), E[i].clear();</div><div class="line">	<span class="built_in">memset</span>(dis, <span class="number">0</span>, <span class="keyword">sizeof</span>(dis)), <span class="built_in">memset</span>(insta, <span class="literal">false</span>, <span class="keyword">sizeof</span>(insta));</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span><span class="params">(<span class="keyword">int</span> u)</span> </span>{</div><div class="line">	insta[u] = <span class="literal">true</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[u].size(); i++) {</div><div class="line">		<span class="keyword">int</span> v = G[u][i], c = E[u][i];</div><div class="line">		<span class="keyword">if</span> (dis[u]+c &gt;= dis[v])	<span class="keyword">continue</span>;</div><div class="line">		<span class="keyword">if</span> (insta[v] || flag) {flag = <span class="literal">true</span>;	<span class="keyword">break</span>;}</div><div class="line">		dis[v] = dis[u]+c, DFS(v);</div><div class="line">	}</div><div class="line">	insta[u] = <span class="literal">false</span>;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	f = fread(BUF, <span class="number">1</span>, SIZE, <span class="built_in">stdin</span>);</div><div class="line">	<span class="keyword">int</span> T;	read(T);</div><div class="line">	<span class="keyword">while</span> (T--) {</div><div class="line">		<span class="keyword">int</span> n, m;	read(n), read(m);	init(n);</div><div class="line">		<span class="keyword">while</span> (m--) {</div><div class="line">			<span class="keyword">int</span> u, v, c;	read(u), read(v), read(c);</div><div class="line">			G[u].push_back(v), E[u].push_back(c);</div><div class="line">			<span class="keyword">if</span> (c &gt;= <span class="number">0</span>)	G[v].push_back(u), E[v].push_back(c);</div><div class="line">		}</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) {DFS(i);	<span class="keyword">if</span> (flag)	<span class="keyword">break</span>;}</div><div class="line">		<span class="keyword">if</span> (flag)	<span class="built_in">printf</span>(<span class="string">&quot;YE5\n&quot;</span>);</div><div class="line">		<span class="keyword">else</span>	<span class="built_in">printf</span>(<span class="string">&quot;N0\n&quot;</span>);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Network-Flow-Dinic"><a href="#Network-Flow-Dinic" class="headerlink" title="Network Flow (Dinic)"></a>Network Flow (Dinic)</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x7F51;&#x7EDC;&#x6700;&#x5927;&#x6D41;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;&#x7F51;&#x7EDC;&#x56FE;&#xFF0C;&#x4EE5;&#x53CA;&#x5176;&#x6E90;&#x70B9;&#x548C;&#x6C47;&#x70B9;&#xFF0C;&#x6C42;&#x51FA;&#x5176;&#x7F51;&#x7EDC;&#x6700;&#x5927;&#x6D41;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x5305;&#x542B;&#x56DB;&#x4E2A;&#x6B63;&#x6574;&#x6570;N&#x3001;M&#x3001;S&#x3001;T&#xFF0C;&#x5206;&#x522B;&#x8868;&#x793A;&#x70B9;&#x7684;&#x4E2A;&#x6570;&#x3001;&#x6709;&#x5411;&#x8FB9;&#x7684;&#x4E2A;&#x6570;&#x3001;&#x6E90;&#x70B9;&#x5E8F;&#x53F7;&#x3001;&#x6C47;&#x70B9;&#x5E8F;&#x53F7;&#x3002;<br>&#x63A5;&#x4E0B;&#x6765;M&#x884C;&#x6BCF;&#x884C;&#x5305;&#x542B;&#x4E09;&#x4E2A;&#x6B63;&#x6574;&#x6570;ui&#x3001;vi&#x3001;wi&#xFF0C;&#x8868;&#x793A;&#x7B2C;i&#x6761;&#x6709;&#x5411;&#x8FB9;&#x4ECE;ui&#x51FA;&#x53D1;&#xFF0C;&#x5230;&#x8FBE;vi&#xFF0C;&#x8FB9;&#x6743;&#x4E3A;wi&#xFF08;&#x5373;&#x8BE5;&#x8FB9;&#x6700;&#x5927;&#x6D41;&#x91CF;&#x4E3A;wi&#xFF09;</p>
<p>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x4E00;&#x884C;&#xFF0C;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x6B63;&#x6574;&#x6570;&#xFF0C;&#x5373;&#x4E3A;&#x8BE5;&#x7F51;&#x7EDC;&#x7684;&#x6700;&#x5927;&#x6D41;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;&#xFF1A;<br>4 5 4 3<br>4 2 30<br>4 3 20<br>2 3 20<br>2 1 30<br>1 3 40<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;&#xFF1A;<br>50</p>
<p>&#x8BF4;&#x660E;<br>&#x65F6;&#x7A7A;&#x9650;&#x5236;&#xFF1A;1000ms,128M<br>&#x6570;&#x636E;&#x89C4;&#x6A21;&#xFF1A;<br>&#x5BF9;&#x4E8E;30%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=10&#xFF0C;M&lt;=25<br>&#x5BF9;&#x4E8E;70%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=200&#xFF0C;M&lt;=1000<br>&#x5BF9;&#x4E8E;100%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=10000&#xFF0C;M&lt;=100000<br>&#x6837;&#x4F8B;&#x8BF4;&#x660E;&#xFF1A;<br>&#x9898;&#x76EE;&#x4E2D;&#x5B58;&#x5728;3&#x6761;&#x8DEF;&#x5F84;&#xFF1A;<br>4&#x2013;&gt;2&#x2013;&gt;3&#xFF0C;&#x8BE5;&#x8DEF;&#x7EBF;&#x53EF;&#x901A;&#x8FC7;20&#x7684;&#x6D41;&#x91CF;<br>4&#x2013;&gt;3&#xFF0C;&#x53EF;&#x901A;&#x8FC7;20&#x7684;&#x6D41;&#x91CF;<br>4&#x2013;&gt;2&#x2013;&gt;1&#x2013;&gt;3&#xFF0C;&#x53EF;&#x901A;&#x8FC7;10&#x7684;&#x6D41;&#x91CF;&#xFF08;&#x8FB9;4&#x2013;&gt;2&#x4E4B;&#x524D;&#x5DF2;&#x7ECF;&#x8017;&#x8D39;&#x4E86;20&#x7684;&#x6D41;&#x91CF;&#xFF09;<br>&#x6545;&#x6D41;&#x91CF;&#x603B;&#x8BA1;20+20+10=50&#x3002;&#x8F93;&#x51FA;50&#x3002;<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 10000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_M 100000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2147483647</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> {</span></div><div class="line">	<span class="keyword">int</span> v, c, next;</div><div class="line">} E[MAX_M*<span class="number">2</span>+<span class="number">5</span>];</div><div class="line"><span class="keyword">int</span> first[MAX_N+<span class="number">5</span>], cnt;</div><div class="line"><span class="keyword">int</span> n, m, s, t;</div><div class="line"><span class="keyword">int</span> d[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>{</div><div class="line">	cnt = <span class="number">0</span>;</div><div class="line">	<span class="built_in">memset</span>(first, <span class="number">-1</span>, <span class="keyword">sizeof</span>(first));</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> c)</span> </span>{</div><div class="line">	E[cnt].v = v, E[cnt].c = c;</div><div class="line">	E[cnt].next = first[u];</div><div class="line">	first[u] = cnt++;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">BFS</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">memset</span>(d, <span class="number">-1</span>, <span class="keyword">sizeof</span>(d));</div><div class="line">	<span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; que;</div><div class="line">	que.push(s);</div><div class="line">	d[s] = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span> (!que.empty()) {</div><div class="line">		<span class="keyword">int</span> u = que.front();</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = first[u]; i != <span class="number">-1</span>; i = E[i].next) {</div><div class="line">			<span class="keyword">int</span> v = E[i].v;</div><div class="line">			<span class="keyword">if</span> (E[i].c &amp;&amp; d[v] == <span class="number">-1</span>) {</div><div class="line">				que.push(v);</div><div class="line">				d[v] = d[u]+<span class="number">1</span>;</div><div class="line">			}</div><div class="line">		}</div><div class="line">		que.pop();</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> d[t] != <span class="number">-1</span>;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">DFS</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> flow)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (u == t) {</div><div class="line">		<span class="keyword">return</span> flow;</div><div class="line">	}</div><div class="line">	<span class="keyword">int</span> ret = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = first[u]; i != <span class="number">-1</span>; i = E[i].next) {</div><div class="line">		<span class="keyword">int</span> v = E[i].v;</div><div class="line">		<span class="keyword">if</span> (E[i].c &amp;&amp; d[u]+<span class="number">1</span> == d[v]) {</div><div class="line">			<span class="keyword">int</span> tmp = DFS(v, min(flow, E[i].c));</div><div class="line">			flow -= tmp, E[i].c -= tmp, ret += tmp;</div><div class="line">			E[i^<span class="number">1</span>].c += tmp;</div><div class="line">			<span class="keyword">if</span> (flow == <span class="number">0</span>)	<span class="keyword">break</span>;</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">if</span> (ret == <span class="number">0</span>)	d[u] = <span class="number">-1</span>;</div><div class="line">	<span class="keyword">return</span> ret;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	init();</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; s &gt;&gt; t;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) {</div><div class="line">		<span class="keyword">int</span> u, v, c;</div><div class="line">		<span class="built_in">cin</span> &gt;&gt; u &gt;&gt; v &gt;&gt; c;</div><div class="line">		insert(u, v, c);</div><div class="line">		insert(v, u, <span class="number">0</span>);</div><div class="line">	}</div><div class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span> (BFS()) {</div><div class="line">		ans += DFS(s, INF);</div><div class="line">	}</div><div class="line">	<span class="built_in">cout</span> &lt;&lt; ans;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Minimum-Cost-Maximum-Flow"><a href="#Minimum-Cost-Maximum-Flow" class="headerlink" title="Minimum Cost Maximum Flow"></a>Minimum Cost Maximum Flow</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x6700;&#x5C0F;&#x8D39;&#x7528;&#x6700;&#x5927;&#x6D41;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;&#x7F51;&#x7EDC;&#x56FE;&#xFF0C;&#x4EE5;&#x53CA;&#x5176;&#x6E90;&#x70B9;&#x548C;&#x6C47;&#x70B9;&#xFF0C;&#x6BCF;&#x6761;&#x8FB9;&#x5DF2;&#x77E5;&#x5176;&#x6700;&#x5927;&#x6D41;&#x91CF;&#x548C;&#x5355;&#x4F4D;&#x6D41;&#x91CF;&#x8D39;&#x7528;&#xFF0C;&#x6C42;&#x51FA;&#x5176;&#x7F51;&#x7EDC;&#x6700;&#x5927;&#x6D41;&#x548C;&#x5728;&#x6700;&#x5927;&#x6D41;&#x60C5;&#x51B5;&#x4E0B;&#x7684;&#x6700;&#x5C0F;&#x8D39;&#x7528;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x5305;&#x542B;&#x56DB;&#x4E2A;&#x6B63;&#x6574;&#x6570;N&#x3001;M&#x3001;S&#x3001;T&#xFF0C;&#x5206;&#x522B;&#x8868;&#x793A;&#x70B9;&#x7684;&#x4E2A;&#x6570;&#x3001;&#x6709;&#x5411;&#x8FB9;&#x7684;&#x4E2A;&#x6570;&#x3001;&#x6E90;&#x70B9;&#x5E8F;&#x53F7;&#x3001;&#x6C47;&#x70B9;&#x5E8F;&#x53F7;&#x3002;<br>&#x63A5;&#x4E0B;&#x6765;M&#x884C;&#x6BCF;&#x884C;&#x5305;&#x542B;&#x56DB;&#x4E2A;&#x6B63;&#x6574;&#x6570;ui&#x3001;vi&#x3001;wi&#x3001;fi&#xFF0C;&#x8868;&#x793A;&#x7B2C;i&#x6761;&#x6709;&#x5411;&#x8FB9;&#x4ECE;ui&#x51FA;&#x53D1;&#xFF0C;&#x5230;&#x8FBE;vi&#xFF0C;&#x8FB9;&#x6743;&#x4E3A;wi&#xFF08;&#x5373;&#x8BE5;&#x8FB9;&#x6700;&#x5927;&#x6D41;&#x91CF;&#x4E3A;wi&#xFF09;&#xFF0C;&#x5355;&#x4F4D;&#x6D41;&#x91CF;&#x7684;&#x8D39;&#x7528;&#x4E3A;fi&#x3002;<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x4E00;&#x884C;&#xFF0C;&#x5305;&#x542B;&#x4E24;&#x4E2A;&#x6574;&#x6570;&#xFF0C;&#x4F9D;&#x6B21;&#x4E3A;&#x6700;&#x5927;&#x6D41;&#x91CF;&#x548C;&#x5728;&#x6700;&#x5927;&#x6D41;&#x91CF;&#x60C5;&#x51B5;&#x4E0B;&#x7684;&#x6700;&#x5C0F;&#x8D39;&#x7528;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;&#xFF1A;<br>4 5 4 3<br>4 2 30 2<br>4 3 20 3<br>2 3 20 1<br>2 1 30 9<br>1 3 40 5<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;&#xFF1A;<br>50 280</p>
<p>&#x8BF4;&#x660E;<br>&#x65F6;&#x7A7A;&#x9650;&#x5236;&#xFF1A;1000ms,128M<br>&#xFF08;BYX&#xFF1A;&#x6700;&#x540E;&#x4E24;&#x4E2A;&#x70B9;&#x6539;&#x6210;&#x4E86;1200ms&#xFF09;<br>&#x6570;&#x636E;&#x89C4;&#x6A21;&#xFF1A;<br>&#x5BF9;&#x4E8E;30%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=10&#xFF0C;M&lt;=10<br>&#x5BF9;&#x4E8E;70%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=1000&#xFF0C;M&lt;=1000<br>&#x5BF9;&#x4E8E;100%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=5000&#xFF0C;M&lt;=50000<br>&#x6837;&#x4F8B;&#x8BF4;&#x660E;&#xFF1A;<br>&#x6700;&#x4F18;&#x65B9;&#x6848;&#x5982;&#x4E0B;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x6761;&#x6D41;&#x4E3A;4&#x2013;&gt;3&#xFF0C;&#x6D41;&#x91CF;&#x4E3A;20&#xFF0C;&#x8D39;&#x7528;&#x4E3A;3<em>20=60&#x3002;<br>&#x7B2C;&#x4E8C;&#x6761;&#x6D41;&#x4E3A;4&#x2013;&gt;2&#x2013;&gt;3&#xFF0C;&#x6D41;&#x91CF;&#x4E3A;20&#xFF0C;&#x8D39;&#x7528;&#x4E3A;&#xFF08;2+1&#xFF09;</em>20=60&#x3002;<br>&#x7B2C;&#x4E09;&#x6761;&#x6D41;&#x4E3A;4&#x2013;&gt;2&#x2013;&gt;1&#x2013;&gt;3&#xFF0C;&#x6D41;&#x91CF;&#x4E3A;10&#xFF0C;&#x8D39;&#x7528;&#x4E3A;&#xFF08;2+9+5&#xFF09;*10=160&#x3002;<br>&#x6545;&#x6700;&#x5927;&#x6D41;&#x91CF;&#x4E3A;50&#xFF0C;&#x5728;&#x6B64;&#x72B6;&#x51B5;&#x4E0B;&#x6700;&#x5C0F;&#x8D39;&#x7528;&#x4E3A;60+60+160=280&#x3002;<br>&#x6545;&#x8F93;&#x51FA;50 280&#x3002;<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 5000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_M 50000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2147483647</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m, s, t, tot, ans;</div><div class="line"><span class="keyword">int</span> pre[MAX_N+<span class="number">5</span>], match[MAX_N+<span class="number">5</span>], cnt;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> {</span><span class="keyword">int</span> u, v, c, w, nxt;} E[MAX_M*<span class="number">2</span>+MAX_N*<span class="number">2</span>+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>{cnt = <span class="number">0</span>; <span class="built_in">memset</span>(pre, <span class="number">-1</span>, <span class="keyword">sizeof</span>(pre));}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> c, <span class="keyword">int</span> w)</span> </span>{E[cnt].u = u, E[cnt].v = v, E[cnt].c = c, E[cnt].w = w, E[cnt].nxt = pre[u], pre[u] = cnt++;}</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">SPFA</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; que;</div><div class="line">	<span class="keyword">bool</span> inque[MAX_N+<span class="number">5</span>];</div><div class="line">	<span class="keyword">int</span> dis[MAX_N+<span class="number">5</span>], pree[MAX_N+<span class="number">5</span>];</div><div class="line">	<span class="built_in">memset</span>(inque, <span class="literal">false</span>, <span class="keyword">sizeof</span>(inque));</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	dis[i] = INF;</div><div class="line">	<span class="built_in">memset</span>(pree, <span class="number">-1</span>, <span class="keyword">sizeof</span>(pree));</div><div class="line">	dis[s] = <span class="number">0</span>, que.push(s), inque[s] = <span class="literal">true</span>;</div><div class="line">	<span class="keyword">while</span> (!que.empty()) {</div><div class="line">		<span class="keyword">int</span> u = que.front();</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = pre[u]; i != <span class="number">-1</span>; i = E[i].nxt) {</div><div class="line">			<span class="keyword">int</span> v = E[i].v;</div><div class="line">			<span class="keyword">if</span> (E[i].c &amp;&amp; dis[u]+E[i].w &lt; dis[v]) {</div><div class="line">				dis[v] = dis[u]+E[i].w, pree[v] = i;</div><div class="line">				<span class="keyword">if</span> (!inque[v])	que.push(v), inque[v] = <span class="literal">true</span>;</div><div class="line">			}</div><div class="line">		}</div><div class="line">		que.pop(), inque[u] = <span class="literal">false</span>;</div><div class="line">	}</div><div class="line">	<span class="keyword">if</span> (dis[t] == INF)	<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	<span class="keyword">int</span> flow = INF;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = pree[t]; i != <span class="number">-1</span>; i = pree[E[i].u])	flow = min(flow, E[i].c);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = pree[t]; i != <span class="number">-1</span>; i = pree[E[i].u])	E[i].c -= flow, E[i^<span class="number">1</span>].c += flow;</div><div class="line">	tot += flow, ans += dis[t]*flow;</div><div class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;s, &amp;t);</div><div class="line">	init();</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) {</div><div class="line">		<span class="keyword">int</span> u, v, c, w;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;c, &amp;w);</div><div class="line">		insert(u, v, c, w), insert(v, u, <span class="number">0</span>, -w);</div><div class="line">	}</div><div class="line">	<span class="keyword">while</span> (SPFA()) ;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d %d&quot;</span>, tot, ans);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Bipartite-Matching"><a href="#Bipartite-Matching" class="headerlink" title="Bipartite Matching"></a>Bipartite Matching</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x4E8C;&#x5206;&#x56FE;&#x5339;&#x914D;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x7ED9;&#x5B9A;&#x4E00;&#x4E2A;&#x4E8C;&#x5206;&#x56FE;&#xFF0C;&#x7ED3;&#x70B9;&#x4E2A;&#x6570;&#x5206;&#x522B;&#x4E3A;n&#xFF0C;m&#xFF0C;&#x8FB9;&#x6570;&#x4E3A;e&#xFF0C;&#x6C42;&#x4E8C;&#x5206;&#x56FE;&#x6700;&#x5927;&#x5339;&#x914D;&#x6570;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#xFF0C;n&#xFF0C;m&#xFF0C;e<br>&#x7B2C;&#x4E8C;&#x81F3;e+1&#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x4E24;&#x4E2A;&#x6B63;&#x6574;&#x6570;u&#xFF0C;v&#xFF0C;&#x8868;&#x793A;u,v&#x6709;&#x4E00;&#x6761;&#x8FDE;&#x8FB9;<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x5171;&#x4E00;&#x884C;&#xFF0C;&#x4E8C;&#x5206;&#x56FE;&#x6700;&#x5927;&#x5339;&#x914D;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;&#xFF1A;<br>1 1 1<br>1 1<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;&#xFF1A;<br>1</p>
<p>&#x8BF4;&#x660E;<br>n,m&lt;=1000&#xFF0C;1&lt;=u&lt;=n&#xFF0C;1&lt;=v&lt;=m</p>
<h3 id="Hungary"><a href="#Hungary" class="headerlink" title="Hungary"></a>Hungary</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 1000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m, e, match[MAX_N+<span class="number">5</span>], cnt;</div><div class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; G[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="keyword">bool</span> vis[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">DFS</span><span class="params">(<span class="keyword">int</span> u)</span> </span>{</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[u].size(); i++) {</div><div class="line">		<span class="keyword">int</span> v = G[u][i];</div><div class="line">		<span class="keyword">if</span> (!vis[v]) {</div><div class="line">			vis[v] = <span class="literal">true</span>;</div><div class="line">			<span class="keyword">if</span> (!match[v] || DFS(match[v])) {</div><div class="line">				match[v] = u;</div><div class="line">				<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">			}</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; e;</div><div class="line">	<span class="keyword">int</span> a, b;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; e; i++) {</div><div class="line">		<span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b;</div><div class="line">		<span class="keyword">if</span> (a &gt; n || b &gt; m)	<span class="keyword">continue</span>;</div><div class="line">		G[a].push_back(b);</div><div class="line">	}</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) {</div><div class="line">		<span class="built_in">memset</span>(vis, <span class="literal">false</span>, <span class="keyword">sizeof</span>(vis));</div><div class="line">		<span class="keyword">if</span> (DFS(i)) {</div><div class="line">			cnt++;</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="built_in">cout</span> &lt;&lt; cnt;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
</blockquote>
<h3 id="Dinic"><a href="#Dinic" class="headerlink" title="Dinic"></a>Dinic</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 2000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_M 1000000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2147483647</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m, s, t, n1, n2;</div><div class="line"><span class="keyword">int</span> pre[MAX_N+<span class="number">5</span>], tmp[MAX_N+<span class="number">5</span>], d[MAX_N+<span class="number">5</span>], cnt;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> {</span><span class="keyword">int</span> v, c, nxt;} E[MAX_M*<span class="number">2</span>+MAX_N*<span class="number">2</span>+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>{cnt = <span class="number">0</span>; s = <span class="number">0</span>, t = n; <span class="built_in">memset</span>(pre, <span class="number">-1</span>, <span class="keyword">sizeof</span>(pre));}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> c)</span> </span>{E[cnt].v = v, E[cnt].c = c, E[cnt].nxt = pre[u], pre[u] = cnt++;}</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">BFS</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">memset</span>(d, <span class="number">-1</span>, <span class="keyword">sizeof</span>(d));</div><div class="line">	<span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; que;</div><div class="line">	que.push(s), d[s] = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span> (!que.empty()) {</div><div class="line">		<span class="keyword">int</span> u = que.front();</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = pre[u]; i != <span class="number">-1</span>; i = E[i].nxt) {</div><div class="line">			<span class="keyword">int</span> v = E[i].v;</div><div class="line">			<span class="keyword">if</span> (E[i].c &amp;&amp; d[v] == <span class="number">-1</span>) {</div><div class="line">				d[v] = d[u]+<span class="number">1</span>;</div><div class="line">				que.push(v);</div><div class="line">			}</div><div class="line">		}</div><div class="line">		que.pop();</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> d[t] != <span class="number">-1</span>;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">DFS</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> flow)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (u == t)	<span class="keyword">return</span> flow;</div><div class="line">	<span class="keyword">int</span> ret = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> &amp;i = pre[u]; i != <span class="number">-1</span>; i = E[i].nxt) {</div><div class="line">		<span class="keyword">int</span> v = E[i].v;</div><div class="line">		<span class="keyword">if</span> (E[i].c &amp;&amp; d[u]+<span class="number">1</span> == d[v]) {</div><div class="line">			<span class="keyword">int</span> tmp = DFS(v, min(flow, E[i].c));</div><div class="line">			E[i].c -= tmp, E[i^<span class="number">1</span>].c += tmp, flow -= tmp, ret += tmp;</div><div class="line">			<span class="keyword">if</span> (!flow)	<span class="keyword">break</span>;</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">if</span> (!ret)	d[u] = <span class="number">-1</span>;</div><div class="line">	<span class="keyword">return</span> ret;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">Dinic</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">int</span> ret = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++)	tmp[i] = pre[i];</div><div class="line">	<span class="keyword">while</span> (BFS()) {</div><div class="line">		ret += DFS(s, INF);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++)	pre[i] = tmp[i];</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> ret;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n1, &amp;n2, &amp;m);	n = n1+n2+<span class="number">1</span>;</div><div class="line">	init();</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n1; i++)	insert(s, i, <span class="number">1</span>), insert(i, s, <span class="number">0</span>);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = n1+<span class="number">1</span>; i &lt;= n1+n2; i++)	insert(i, t, <span class="number">1</span>), insert(t, i, <span class="number">0</span>);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) {</div><div class="line">		<span class="keyword">int</span> u, v;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</div><div class="line">		<span class="keyword">if</span> (u &gt; n1 || v &gt; n2)	<span class="keyword">continue</span>;</div><div class="line">		insert(u, n1+v, <span class="number">1</span>), insert(n1+v, u, <span class="number">0</span>);</div><div class="line">	}</div><div class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, Dinic());</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
<h1 id="Math-Theory"><a href="#Math-Theory" class="headerlink" title="Math Theory"></a>Math Theory</h1><h2 id="Gauss-Elimination"><a href="#Gauss-Elimination" class="headerlink" title="Gauss Elimination"></a>Gauss Elimination</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x9AD8;&#x65AF;&#x6D88;&#x5143;</p>
<p>&#x9898;&#x76EE;&#x80CC;&#x666F;<br>Gauss&#x6D88;&#x5143;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x7ED9;&#x5B9A;&#x4E00;&#x4E2A;&#x7EBF;&#x6027;&#x65B9;&#x7A0B;&#x7EC4;&#xFF0C;&#x5BF9;&#x5176;&#x6C42;&#x89E3;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#xFF0C;&#x4E00;&#x4E2A;&#x6B63;&#x6574;&#x6570;n<br>&#x7B2C;&#x4E8C;&#x81F3;n+1&#x884C;&#xFF0C;&#x6BCF;&#x884C;n+1&#x4E2A;&#x6574;&#x6570;&#xFF0C;&#x4E3A;a1,a2,&#x2026;an&#x548C;b&#xFF0C;&#x4EE3;&#x8868;&#x4E00;&#x7EC4;&#x65B9;&#x7A0B;&#x3002;<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x5171;n&#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x4E00;&#x4E2A;&#x6570;&#xFF0C;&#x7B2C;i&#x884C;&#x4E3A;xi&#xFF08;&#x4FDD;&#x7559;2&#x4F4D;&#x5C0F;&#x6570;&#xFF09;<br>&#x5982;&#x679C;&#x65E0;&#x89E3;&#x6216;&#x4E0D;&#x5B58;&#x5728;&#x552F;&#x4E00;&#x89E3;&#xFF0C;&#x5728;&#x7B2C;&#x4E00;&#x884C;&#x8F93;&#x51FA;&#x201D;No Solution&#x201D;.</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;#1&#xFF1A;<br>3<br>1 3 4 5<br>1 4 7 3<br>9 3 2 2<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;#1&#xFF1A;<br>-0.97<br>5.18<br>-2.39</p>
<p>&#x8BF4;&#x660E;<br>1&#x2264;n&#x2264;100&#xFF0C;|ai|&#x2264;1e4&#xFF0C;|b|&#x2264;1e4<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 100</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> EXP 1e-7</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> fnt;</div><div class="line"><span class="keyword">int</span> n;	<span class="built_in">vector</span> &lt;fnt&gt; f[MAX_N+<span class="number">5</span>];	fnt ans[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">gauss</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, tmp; i &lt;= n; i++) {</div><div class="line">		<span class="keyword">for</span> (tmp = i; tmp &lt;= n; tmp++)	<span class="keyword">if</span> (f[tmp][i] &lt;= -EXP || f[tmp][i] &gt;= EXP)	<span class="keyword">break</span>;</div><div class="line">		<span class="keyword">if</span> (tmp &gt; n)	<span class="keyword">return</span> <span class="literal">false</span>;	swap(f[i], f[tmp]);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) {</div><div class="line">			fnt div = f[j][i]/f[i][i];	<span class="keyword">if</span> (j == i)	<span class="keyword">continue</span>;</div><div class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> k = i; k &lt;= n+<span class="number">1</span>; k++)	f[j][k] -= f[i][k]*div;</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	ans[i] = f[i][n+<span class="number">1</span>]/f[i][i];</div><div class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) {</div><div class="line">		f[i].push_back(<span class="number">0</span>);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n+<span class="number">1</span>; j++) {</div><div class="line">			fnt x;	<span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>, &amp;x);</div><div class="line">			f[i].push_back(x);</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">if</span> (gauss())	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="built_in">printf</span>(<span class="string">&quot;%.2lf\n&quot;</span>, ans[i]);</div><div class="line">	<span class="keyword">else</span>	<span class="built_in">printf</span>(<span class="string">&quot;No Solution&quot;</span>);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Inverse"><a href="#Inverse" class="headerlink" title="Inverse"></a>Inverse</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x4E58;&#x6CD5;&#x9006;&#x5143;</p>
<p>&#x9898;&#x76EE;&#x80CC;&#x666F;<br>&#x8FD9;&#x662F;&#x4E00;&#x9053;&#x6A21;&#x677F;&#x9898;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x7ED9;&#x5B9A;n,p&#x6C42;1~n&#x4E2D;&#x6240;&#x6709;&#x6574;&#x6570;&#x5728;&#x6A21;p&#x610F;&#x4E49;&#x4E0B;&#x7684;&#x4E58;&#x6CD5;&#x9006;&#x5143;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x4E00;&#x884C;n,p<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>n&#x884C;,&#x7B2C;i&#x884C;&#x8868;&#x793A;i&#x5728;&#x6A21;p&#x610F;&#x4E49;&#x4E0B;&#x7684;&#x9006;&#x5143;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;#1&#xFF1A;<br>10 13<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;#1&#xFF1A;<br>1<br>7<br>9<br>10<br>8<br>11<br>2<br>5<br>3<br>4</p>
<p>&#x8BF4;&#x660E;<br>1&#x2264;n&#x2264;3*1e6,n<p<20000528 输入保证p为质数。="" <figure="" class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 3000000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> lnt;</div><div class="line">lnt inv[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> n, lnt p)</span> </span>{inv[<span class="number">0</span>] = inv[<span class="number">1</span>] = <span class="number">1</span>;	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++)	inv[i] = (p-p/i*inv[p%i]%p)%p;}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">int</span> n;	lnt p;	<span class="built_in">scanf</span>(<span class="string">&quot;%d%lld&quot;</span>, &amp;n, &amp;p);</div><div class="line">	init(n, p);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, inv[i]);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></p<20000528></p>
</blockquote>
<h2 id="Linear-Basis"><a href="#Linear-Basis" class="headerlink" title="Linear Basis"></a>Linear Basis</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x7EBF;&#x6027;&#x57FA;</p>
<p>&#x9898;&#x76EE;&#x80CC;&#x666F;<br>&#x8FD9;&#x662F;&#x4E00;&#x9053;&#x6A21;&#x677F;&#x9898;&#x3002;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x7ED9;&#x5B9A;n&#x4E2A;&#x6574;&#x6570;&#xFF08;&#x6570;&#x5B57;&#x53EF;&#x80FD;&#x91CD;&#x590D;&#xFF09;&#xFF0C;&#x6C42;&#x5728;&#x8FD9;&#x4E9B;&#x6570;&#x4E2D;&#x9009;&#x53D6;&#x4EFB;&#x610F;&#x4E2A;&#xFF0C;&#x4F7F;&#x5F97;&#x4ED6;&#x4EEC;&#x7684;&#x5F02;&#x6216;&#x548C;&#x6700;&#x5927;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x4E00;&#x4E2A;&#x6570;n&#xFF0C;&#x8868;&#x793A;&#x5143;&#x7D20;&#x4E2A;&#x6570;<br>&#x63A5;&#x4E0B;&#x6765;&#x4E00;&#x884C;n&#x4E2A;&#x6570;<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x4EC5;&#x4E00;&#x884C;&#xFF0C;&#x8868;&#x793A;&#x7B54;&#x6848;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;#1&#xFF1A;<br>2<br>1 1<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;#1&#xFF1A;<br>1</p>
<p>&#x8BF4;&#x660E;<br>1&#x2264;n&#x2264;50&#xFF0C;0&#x2264;Si&#x2264;2^50<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 50</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> lnt;</div><div class="line"><span class="keyword">int</span> n;	lnt base[MAX_N+<span class="number">5</span>], <span class="built_in">pow</span>[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);	<span class="built_in">pow</span>[<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= MAX_N; i++)	<span class="built_in">pow</span>[i] = <span class="built_in">pow</span>[i<span class="number">-1</span>]*<span class="number">2</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) {</div><div class="line">		lnt x;	<span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;x);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = MAX_N; j &gt;= <span class="number">0</span>; j--)	<span class="keyword">if</span> (<span class="built_in">pow</span>[j]&amp;x) {</div><div class="line">			<span class="keyword">if</span> (base[j])	x ^= base[j];</div><div class="line">			<span class="keyword">else</span> {base[j] = x;	<span class="keyword">break</span>;}</div><div class="line">		}</div><div class="line">	}</div><div class="line">	lnt ans = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = MAX_N; i &gt;= <span class="number">0</span>; i--)	<span class="keyword">if</span> ((ans^<span class="built_in">pow</span>[i]) &gt; ans)	ans ^= base[i];</div><div class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>, ans);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Lucas"><a href="#Lucas" class="headerlink" title="Lucas"></a>Lucas</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x5362;&#x5361;&#x65AF;&#x5B9A;&#x7406;</p>
<p>&#x9898;&#x76EE;&#x80CC;&#x666F;<br>&#x8FD9;&#x662F;&#x4E00;&#x9053;&#x6A21;&#x677F;&#x9898;&#x3002;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x7ED9;&#x5B9A;n,m,p(1&#x2264;n,m,p&#x2264;1e5)&#xFF0C;&#x6C42;C(n+m,m)&#x3002;<br>&#x4FDD;&#x8BC1;P&#x4E3A;prime<br>&#x4E00;&#x4E2A;&#x6D4B;&#x8BD5;&#x70B9;&#x5185;&#x5305;&#x542B;&#x591A;&#x7EC4;&#x6570;&#x636E;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x4E00;&#x4E2A;&#x6574;&#x6570;T(T&#x2264;10)&#xFF0C;&#x8868;&#x793A;&#x6570;&#x636E;&#x7EC4;&#x6570;<br>&#x7B2C;&#x4E8C;&#x884C;&#x5F00;&#x59CB;&#x5171;T&#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x4E09;&#x4E2A;&#x6570;n m p&#xFF0C;&#x610F;&#x4E49;&#x5982;&#x4E0A;<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x5171;T&#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x8868;&#x793A;&#x7B54;&#x6848;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;#1&#xFF1A;<br>2<br>1 2 5<br>2 1 5<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;#1&#xFF1A;<br>3<br>3<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_P 100000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> lnt;</div><div class="line">lnt f[MAX_P+<span class="number">5</span>] = {<span class="number">1</span>};</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(lnt p)</span> </span>{<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= MAX_P; i++)	f[i] = f[i<span class="number">-1</span>]*i%p;}</div><div class="line"><span class="function">lnt <span class="title">FLT</span><span class="params">(lnt x, lnt p)</span> </span>{</div><div class="line">	lnt ret = <span class="number">1</span>;	x %= p;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> k = p<span class="number">-2</span>; k; k &gt;&gt;= <span class="number">1</span>)	ret = k%<span class="number">2</span> ? ret*x%p : ret, x = x*x%p;</div><div class="line">	<span class="keyword">return</span> ret;</div><div class="line">}</div><div class="line"><span class="function">lnt <span class="title">lucas</span><span class="params">(lnt n, lnt m, lnt p)</span> </span>{<span class="keyword">return</span> m ? (n%p &gt;= m%p ? f[n%p]*FLT(f[m%p]*f[n%p-m%p], p)*lucas(n/p, m/p, p)%p : <span class="number">0</span>) : <span class="number">1</span>;}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">int</span> T;	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</div><div class="line">	<span class="keyword">while</span> (T--) {</div><div class="line">		lnt n, m, p;	<span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld%lld&quot;</span>, &amp;n, &amp;m, &amp;p);</div><div class="line">		init(p), <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, lucas(n+m, min(n, m), p)%p);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Matrix-Fast-Power"><a href="#Matrix-Fast-Power" class="headerlink" title="Matrix Fast Power"></a>Matrix Fast Power</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x77E9;&#x9635;&#x5FEB;&#x901F;&#x5E42;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x7ED9;&#x5B9A;n*n&#x7684;&#x77E9;&#x9635;A&#xFF0C;&#x6C42;A^k</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#xFF0C;n,k<br>&#x7B2C;2&#x81F3;n+1&#x884C;&#xFF0C;&#x6BCF;&#x884C;n&#x4E2A;&#x6570;&#xFF0C;&#x7B2C;i+1&#x884C;&#x7B2C;j&#x4E2A;&#x6570;&#x8868;&#x793A;&#x77E9;&#x9635;&#x7B2C;i&#x884C;&#x7B2C;j&#x5217;&#x7684;&#x5143;&#x7D20;<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x8F93;&#x51FA;A^k<br>&#x5171;n&#x884C;&#xFF0C;&#x6BCF;&#x884C;n&#x4E2A;&#x6570;&#xFF0C;&#x7B2C;i&#x884C;&#x7B2C;j&#x4E2A;&#x6570;&#x8868;&#x793A;&#x77E9;&#x9635;&#x7B2C;i&#x884C;&#x7B2C;j&#x5217;&#x7684;&#x5143;&#x7D20;&#xFF0C;&#x6BCF;&#x4E2A;&#x5143;&#x7D20;&#x6A21;10^9+7</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;&#xFF1A;<br>2 1<br>1 1<br>1 1<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;&#xFF1A;<br>1 1<br>1 1</p>
<p>&#x8BF4;&#x660E;<br>n&lt;=100, k&lt;=10^12, |&#x77E9;&#x9635;&#x5143;&#x7D20;|&lt;=1000<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 100</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 1000000007</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Matrix</span> {</span></div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ele[MAX_N][MAX_N];</div><div class="line">    <span class="keyword">inline</span> Matrix <span class="keyword">operator</span> * (<span class="keyword">const</span> Matrix &amp;x) <span class="keyword">const</span> {</div><div class="line">        Matrix ret;</div><div class="line">        <span class="built_in">memset</span>(ret.ele, <span class="number">0</span>, <span class="keyword">sizeof</span>(ret.ele));</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++)</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; n; k++)</div><div class="line">                    ret.ele[i][j] = (ret.ele[i][j]+ele[i][k]*x.ele[k][j])%MOD;</div><div class="line">        <span class="keyword">return</span> ret;</div><div class="line">    }</div><div class="line">};</div><div class="line"><span class="function">Matrix <span class="title">Power</span><span class="params">(Matrix a, <span class="keyword">long</span> <span class="keyword">long</span> k)</span> </span>{</div><div class="line">    <span class="keyword">if</span> (k == <span class="number">1</span>)    <span class="keyword">return</span> a;</div><div class="line">    Matrix ret = Power(a, k/<span class="number">2</span>);</div><div class="line">    <span class="keyword">if</span> (k%<span class="number">2</span>)    <span class="keyword">return</span> a*ret*ret;</div><div class="line">    <span class="keyword">return</span> ret*ret;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> k;</div><div class="line">    Matrix a;</div><div class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++)</div><div class="line">            <span class="built_in">cin</span> &gt;&gt; a.ele[i][j];</div><div class="line">    a = Power(a, k);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) {</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++)</div><div class="line">            <span class="built_in">cout</span> &lt;&lt; a.ele[i][j] &lt;&lt; <span class="string">&quot; &quot;</span>;</div><div class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Prime-Sieve"><a href="#Prime-Sieve" class="headerlink" title="Prime Sieve"></a>Prime Sieve</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x7EBF;&#x6027;&#x7B5B;&#x7D20;&#x6570;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x5982;&#x9898;&#xFF0C;&#x7ED9;&#x5B9A;&#x4E00;&#x4E2A;&#x8303;&#x56F4;N&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x5904;&#x7406;M&#x4E2A;&#x67D0;&#x6570;&#x5B57;&#x662F;&#x5426;&#x4E3A;&#x8D28;&#x6570;&#x7684;&#x8BE2;&#x95EE;&#xFF08;&#x6BCF;&#x4E2A;&#x6570;&#x5B57;&#x5747;&#x5728;&#x8303;&#x56F4;1-N&#x5185;&#xFF09;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x5305;&#x542B;&#x4E24;&#x4E2A;&#x6B63;&#x6574;&#x6570;N&#x3001;M&#xFF0C;&#x5206;&#x522B;&#x8868;&#x793A;&#x67E5;&#x8BE2;&#x7684;&#x8303;&#x56F4;&#x548C;&#x67E5;&#x8BE2;&#x7684;&#x4E2A;&#x6570;&#x3002;<br>&#x63A5;&#x4E0B;&#x6765;M&#x884C;&#x6BCF;&#x884C;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x4E0D;&#x5C0F;&#x4E8E;1&#x4E14;&#x4E0D;&#x5927;&#x4E8E;N&#x7684;&#x6574;&#x6570;&#xFF0C;&#x5373;&#x8BE2;&#x95EE;&#x6982;&#x6570;&#x662F;&#x5426;&#x4E3A;&#x8D28;&#x6570;&#x3002;<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x8F93;&#x51FA;&#x5305;&#x542B;M&#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x4E3A;Yes&#x6216;No&#xFF0C;&#x5373;&#x4F9D;&#x6B21;&#x4E3A;&#x6BCF;&#x4E00;&#x4E2A;&#x8BE2;&#x95EE;&#x7684;&#x7ED3;&#x679C;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;&#xFF1A;<br>100 5<br>2<br>3<br>4<br>91<br>97<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;&#xFF1A;<br>Yes<br>Yes<br>No<br>No<br>Yes</p>
<p>&#x8BF4;&#x660E;<br>&#x65F6;&#x7A7A;&#x9650;&#x5236;&#xFF1A;500ms 128M<br>&#x6570;&#x636E;&#x89C4;&#x6A21;&#xFF1A;<br>&#x5BF9;&#x4E8E;30%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=10000&#xFF0C;M&lt;=10000<br>&#x5BF9;&#x4E8E;100%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=10000000&#xFF0C;M&lt;=100000</p>
<p>&#x6837;&#x4F8B;&#x8BF4;&#x660E;&#xFF1A;<br>N=100&#xFF0C;&#x8BF4;&#x660E;&#x63A5;&#x4E0B;&#x6765;&#x7684;&#x8BE2;&#x95EE;&#x6570;&#x5747;&#x4E0D;&#x5927;&#x4E8E;100&#x4E14;&#x5927;&#x4E8E;1&#x3002;<br>&#x6240;&#x4EE5;2&#x3001;3&#x3001;97&#x4E3A;&#x8D28;&#x6570;&#xFF0C;4&#x3001;91&#x975E;&#x8D28;&#x6570;&#x3002;<br>&#x6545;&#x4F9D;&#x6B21;&#x8F93;&#x51FA;Yes&#x3001;Yes&#x3001;No&#x3001;No&#x3001;Yes&#x3002;<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 10000000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m;</div><div class="line"><span class="keyword">bool</span> IsPrime[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="keyword">int</span> pri[MAX_N+<span class="number">5</span>], cnt = <span class="number">0</span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">FindPrime</span><span class="params">()</span> </span>{</div><div class="line">	IsPrime[<span class="number">0</span>] = IsPrime[<span class="number">1</span>] = <span class="literal">false</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) {</div><div class="line">		<span class="keyword">if</span> (IsPrime) {</div><div class="line">			pri[cnt++] = i;</div><div class="line">		}</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; cnt; j++) {</div><div class="line">			<span class="keyword">if</span> (i*pri[j] &gt; n)	<span class="keyword">break</span>;</div><div class="line">			IsPrime[i*pri[j]] = <span class="literal">false</span>;</div><div class="line">			<span class="keyword">if</span> (i%pri[j] == <span class="number">0</span>)	<span class="keyword">break</span>;</div><div class="line">		}</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">memset</span>(IsPrime, <span class="literal">true</span>, <span class="keyword">sizeof</span>(IsPrime));</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; n;</div><div class="line">	FindPrime();</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; m;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) {</div><div class="line">		<span class="keyword">int</span> x;</div><div class="line">		<span class="built_in">cin</span> &gt;&gt; x;</div><div class="line">		<span class="keyword">if</span> (IsPrime[x]) {</div><div class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Yes&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">		} <span class="keyword">else</span> {</div><div class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;No&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Trigeminal-Search"><a href="#Trigeminal-Search" class="headerlink" title="Trigeminal Search"></a>Trigeminal Search</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x4E09;&#x5206;&#x6CD5;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x5982;&#x9898;&#xFF0C;&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;N&#x6B21;&#x51FD;&#x6570;&#xFF0C;&#x4FDD;&#x8BC1;&#x5728;&#x8303;&#x56F4;[l,r]&#x5185;&#x5B58;&#x5728;&#x4E00;&#x70B9;x&#xFF0C;&#x4F7F;&#x5F97;[l,x]&#x4E0A;&#x5355;&#x8C03;&#x589E;&#xFF0C;[x,r]&#x4E0A;&#x5355;&#x8C03;&#x51CF;&#x3002;&#x8BD5;&#x6C42;&#x51FA;x&#x7684;&#x503C;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x4E00;&#x6B21;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x6B63;&#x6574;&#x6570;N&#x548C;&#x4E24;&#x4E2A;&#x5B9E;&#x6570;l&#x3001;r&#xFF0C;&#x542B;&#x4E49;&#x5982;&#x9898;&#x76EE;&#x63CF;&#x8FF0;&#x6240;&#x793A;&#x3002;<br>&#x7B2C;&#x4E8C;&#x884C;&#x5305;&#x542B;N+1&#x4E2A;&#x5B9E;&#x6570;&#xFF0C;&#x4ECE;&#x9AD8;&#x5230;&#x4F4E;&#x4F9D;&#x6B21;&#x8868;&#x793A;&#x8BE5;N&#x6B21;&#x51FD;&#x6570;&#x5404;&#x9879;&#x7684;&#x7CFB;&#x6570;&#x3002;<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x8F93;&#x51FA;&#x4E3A;&#x4E00;&#x884C;&#xFF0C;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x5B9E;&#x6570;&#xFF0C;&#x5373;&#x4E3A;x&#x7684;&#x503C;&#x3002;&#x56DB;&#x820D;&#x4E94;&#x5165;&#x4FDD;&#x7559;5&#x4F4D;&#x5C0F;&#x6570;&#x3002; </p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;&#xFF1A;<br>3 -0.9981 0.5<br>1 -3 -3 1<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;&#xFF1A;<br>-0.41421</p>
<p>&#x8BF4;&#x660E;<br>&#x65F6;&#x7A7A;&#x9650;&#x5236;&#xFF1A;50ms,128M<br>&#x6570;&#x636E;&#x89C4;&#x6A21;&#xFF1A;<br>&#x5BF9;&#x4E8E;100%&#x7684;&#x6570;&#x636E;&#xFF1A;7&lt;=N&lt;=13<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n;</div><div class="line"><span class="keyword">double</span> s, t;</div><div class="line"><span class="keyword">double</span> a[<span class="number">14</span>];</div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">calc</span><span class="params">(<span class="keyword">double</span> x)</span> </span>{</div><div class="line">    <span class="keyword">double</span> tot = <span class="number">0</span>, tmp = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++) {</div><div class="line">        tot += tmp*a[i];</div><div class="line">        tmp *= x;</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> tot;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">(<span class="keyword">double</span> l, <span class="keyword">double</span> r)</span> </span>{</div><div class="line">    <span class="keyword">if</span> (<span class="built_in">abs</span>(r-l) &lt;= <span class="number">0.000001</span>) {</div><div class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%.5f&quot;</span>, l);</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    }</div><div class="line">    <span class="keyword">double</span> ml = (<span class="number">2</span>*l+r)/<span class="number">3</span>, mr = (l+<span class="number">2</span>*r)/<span class="number">3</span>;</div><div class="line">    <span class="keyword">if</span> (calc(ml) &gt; calc(mr)) {</div><div class="line">        f(l, mr);</div><div class="line">    } <span class="keyword">else</span> {</div><div class="line">        f(ml, r);</div><div class="line">    }</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; s &gt;&gt; t;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">0</span>; i--) {</div><div class="line">        <span class="built_in">cin</span> &gt;&gt; a[i];</div><div class="line">    }</div><div class="line">    f(s, t);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h1 id="Data-Structure"><a href="#Data-Structure" class="headerlink" title="Data Structure"></a>Data Structure</h1><h2 id="Heap"><a href="#Heap" class="headerlink" title="Heap"></a>Heap</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x5806;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x5982;&#x9898;&#xFF0C;&#x521D;&#x59CB;&#x5C0F;&#x6839;&#x5806;&#x4E3A;&#x7A7A;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x652F;&#x6301;&#x4EE5;&#x4E0B;3&#x79CD;&#x64CD;&#x4F5C;&#xFF1A;<br>&#x64CD;&#x4F5C;1&#xFF1A; 1 x &#x8868;&#x793A;&#x5C06;x&#x63D2;&#x5165;&#x5230;&#x5806;&#x4E2D;<br>&#x64CD;&#x4F5C;2&#xFF1A; 2 &#x8F93;&#x51FA;&#x8BE5;&#x5C0F;&#x6839;&#x5806;&#x5185;&#x7684;&#x6700;&#x5C0F;&#x6570;<br>&#x64CD;&#x4F5C;3&#xFF1A; 3 &#x5220;&#x9664;&#x8BE5;&#x5C0F;&#x6839;&#x5806;&#x5185;&#x7684;&#x6700;&#x5C0F;&#x6570;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x6574;&#x6570;N&#xFF0C;&#x8868;&#x793A;&#x64CD;&#x4F5C;&#x7684;&#x4E2A;&#x6570;<br>&#x63A5;&#x4E0B;&#x6765;N&#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x5305;&#x542B;1&#x4E2A;&#x6216;2&#x4E2A;&#x6B63;&#x6574;&#x6570;&#xFF0C;&#x8868;&#x793A;&#x4E09;&#x79CD;&#x64CD;&#x4F5C;&#xFF0C;&#x683C;&#x5F0F;&#x5982;&#x4E0B;&#xFF1A;<br>&#x64CD;&#x4F5C;1&#xFF1A; 1 x<br>&#x64CD;&#x4F5C;2&#xFF1A; 2<br>&#x64CD;&#x4F5C;3&#xFF1A; 3<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x5305;&#x542B;&#x82E5;&#x5E72;&#x884C;&#x6B63;&#x6574;&#x6570;&#xFF0C;&#x6BCF;&#x884C;&#x4F9D;&#x6B21;&#x5BF9;&#x5E94;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;2&#x7684;&#x7ED3;&#x679C;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;&#xFF1A;<br>5<br>1 2<br>1 5<br>2<br>3<br>2<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;&#xFF1A;<br>2<br>5</p>
<p>&#x8BF4;&#x660E;<br>&#x65F6;&#x7A7A;&#x9650;&#x5236;&#xFF1A;1000ms,128M<br>&#x6570;&#x636E;&#x89C4;&#x6A21;&#xFF1A;<br>&#x5BF9;&#x4E8E;30%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=15<br>&#x5BF9;&#x4E8E;70%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=10000<br>&#x5BF9;&#x4E8E;100%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=1000000<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, heap[<span class="number">1000000</span>+<span class="number">5</span>], size = <span class="number">0</span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> x)</span> </span>{</div><div class="line">    size++;</div><div class="line">    heap[size] = x;</div><div class="line">    <span class="keyword">int</span> current = size;</div><div class="line">    <span class="keyword">int</span> father = current/<span class="number">2</span>;</div><div class="line">    <span class="keyword">while</span> (father &gt; <span class="number">0</span> &amp;&amp; heap[father] &gt; heap[current]) {</div><div class="line">        swap(heap[father], heap[current]);</div><div class="line">        current = father;</div><div class="line">        father = current/<span class="number">2</span>;</div><div class="line">    }</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">pop</span><span class="params">()</span> </span>{</div><div class="line">    heap[<span class="number">1</span>] = heap[size];</div><div class="line">    size--;</div><div class="line">    <span class="keyword">int</span> current = <span class="number">1</span>;</div><div class="line">    <span class="keyword">int</span> child = current*<span class="number">2</span>;</div><div class="line">    <span class="keyword">if</span> (child &lt; size &amp;&amp; heap[child] &gt; heap[child+<span class="number">1</span>])    child++;</div><div class="line">    <span class="keyword">while</span> (child &lt;= size &amp;&amp; heap[current] &gt; heap[child]) {</div><div class="line">        swap(heap[current], heap[child]);</div><div class="line">        current = child;</div><div class="line">        child = <span class="number">2</span>*current;</div><div class="line">        <span class="keyword">if</span> (child &lt; size &amp;&amp; heap[child] &gt; heap[child+<span class="number">1</span>])    child++;</div><div class="line">    }</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">    <span class="built_in">cin</span> &gt;&gt; n;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) {</div><div class="line">        <span class="keyword">int</span> f;</div><div class="line">        <span class="built_in">cin</span> &gt;&gt; f;</div><div class="line">        <span class="keyword">if</span> (f == <span class="number">1</span>) {</div><div class="line">            <span class="keyword">int</span> x;</div><div class="line">            <span class="built_in">cin</span> &gt;&gt; x;</div><div class="line">            insert(x);</div><div class="line">        } <span class="keyword">else</span> <span class="keyword">if</span> (f == <span class="number">2</span>) {</div><div class="line">            <span class="built_in">cout</span> &lt;&lt; heap[<span class="number">1</span>] &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">        } <span class="keyword">else</span> {</div><div class="line">            pop();</div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Mergeable-Heap"><a href="#Mergeable-Heap" class="headerlink" title="Mergeable Heap"></a>Mergeable Heap</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x5DE6;&#x504F;&#x6811;&#xFF08;&#x53EF;&#x5E76;&#x5806;&#xFF09;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x5982;&#x9898;&#xFF0C;&#x4E00;&#x5F00;&#x59CB;&#x6709;N&#x4E2A;&#x5C0F;&#x6839;&#x5806;&#xFF0C;&#x6BCF;&#x4E2A;&#x5806;&#x5305;&#x542B;&#x4E14;&#x4EC5;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x6570;&#x3002;&#x63A5;&#x4E0B;&#x6765;&#x9700;&#x8981;&#x652F;&#x6301;&#x4E24;&#x79CD;&#x64CD;&#x4F5C;&#xFF1A;<br>&#x64CD;&#x4F5C;1&#xFF1A; 1 x y &#x5C06;&#x7B2C;x&#x4E2A;&#x6570;&#x548C;&#x7B2C;y&#x4E2A;&#x6570;&#x6240;&#x5728;&#x7684;&#x5C0F;&#x6839;&#x5806;&#x5408;&#x5E76;&#xFF08;&#x82E5;&#x7B2C;x&#x6216;&#x7B2C;y&#x4E2A;&#x6570;&#x5DF2;&#x7ECF;&#x88AB;&#x5220;&#x9664;&#x6216;&#x7B2C;x&#x548C;&#x7B2C;y&#x4E2A;&#x6570;&#x5728;&#x7528;&#x4E00;&#x4E2A;&#x5806;&#x5185;&#xFF0C;&#x5219;&#x65E0;&#x89C6;&#x6B64;&#x64CD;&#x4F5C;&#xFF09;<br>&#x64CD;&#x4F5C;2&#xFF1A; 2 x &#x8F93;&#x51FA;&#x7B2C;x&#x4E2A;&#x6570;&#x6240;&#x5728;&#x7684;&#x5806;&#x6700;&#x5C0F;&#x6570;&#xFF0C;&#x5E76;&#x5C06;&#x5176;&#x5220;&#x9664;&#xFF08;&#x82E5;&#x7B2C;x&#x4E2A;&#x6570;&#x5DF2;&#x7ECF;&#x88AB;&#x5220;&#x9664;&#xFF0C;&#x5219;&#x8F93;&#x51FA;-1&#x5E76;&#x65E0;&#x89C6;&#x5220;&#x9664;&#x64CD;&#x4F5C;&#xFF09;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x5305;&#x542B;&#x4E24;&#x4E2A;&#x6B63;&#x6574;&#x6570;N&#x3001;M&#xFF0C;&#x5206;&#x522B;&#x8868;&#x793A;&#x4E00;&#x5F00;&#x59CB;&#x5C0F;&#x6839;&#x5806;&#x7684;&#x4E2A;&#x6570;&#x548C;&#x63A5;&#x4E0B;&#x6765;&#x64CD;&#x4F5C;&#x7684;&#x4E2A;&#x6570;&#x3002;<br>&#x7B2C;&#x4E8C;&#x884C;&#x5305;&#x542B;N&#x4E2A;&#x6B63;&#x6574;&#x6570;&#xFF0C;&#x5176;&#x4E2D;&#x7B2C;i&#x4E2A;&#x6B63;&#x6574;&#x6570;&#x8868;&#x793A;&#x7B2C;i&#x4E2A;&#x5C0F;&#x6839;&#x5806;&#x521D;&#x59CB;&#x65F6;&#x5305;&#x542B;&#x4E14;&#x4EC5;&#x5305;&#x542B;&#x7684;&#x6570;&#x3002;<br>&#x63A5;&#x4E0B;&#x6765;M&#x884C;&#x6BCF;&#x884C;2&#x4E2A;&#x6216;3&#x4E2A;&#x6B63;&#x6574;&#x6570;&#xFF0C;&#x8868;&#x793A;&#x4E00;&#x6761;&#x64CD;&#x4F5C;&#xFF0C;&#x683C;&#x5F0F;&#x5982;&#x4E0B;&#xFF1A;<br>&#x64CD;&#x4F5C;1 &#xFF1A; 1 x y<br>&#x64CD;&#x4F5C;2 &#xFF1A; 2 x<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x8F93;&#x51FA;&#x5305;&#x542B;&#x82E5;&#x5E72;&#x884C;&#x6574;&#x6570;&#xFF0C;&#x5206;&#x522B;&#x4F9D;&#x6B21;&#x5BF9;&#x5E94;&#x6BCF;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;2&#x6240;&#x5F97;&#x7684;&#x7ED3;&#x679C;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;#1&#xFF1A;<br>5 5<br>1 5 4 2 3<br>1 1 5<br>1 2 5<br>2 2<br>1 4 2<br>2 2<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;#1&#xFF1A;<br>1<br>2</p>
<p>&#x8BF4;&#x660E;<br>&#x5F53;&#x5806;&#x91CC;&#x6709;&#x591A;&#x4E2A;&#x6700;&#x5C0F;&#x503C;&#x65F6;&#xFF0C;&#x4F18;&#x5148;&#x5220;&#x9664;&#x539F;&#x5E8F;&#x5217;&#x7684;&#x9760;&#x524D;&#x7684;&#xFF0C;&#x5426;&#x5219;&#x4F1A;&#x5F71;&#x54CD;&#x540E;&#x7EED;&#x64CD;&#x4F5C;1&#x5BFC;&#x81F4;WA&#x3002;<br>&#x65F6;&#x7A7A;&#x9650;&#x5236;&#xFF1A;1000ms&#xFF0C;128M<br>&#x6570;&#x636E;&#x89C4;&#x6A21;&#xFF1A;<br>&#x5BF9;&#x4E8E;30%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=10&#xFF0C;M&lt;=10<br>&#x5BF9;&#x4E8E;70%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=1000&#xFF0C;M&lt;=1000<br>&#x5BF9;&#x4E8E;100%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=100000&#xFF0C;M&lt;=100000<br>&#x6837;&#x4F8B;&#x8BF4;&#x660E;&#xFF1A;<br>&#x521D;&#x59CB;&#x72B6;&#x6001;&#x4E0B;&#xFF0C;&#x4E94;&#x4E2A;&#x5C0F;&#x6839;&#x5806;&#x5206;&#x522B;&#x4E3A;:{1}&#x3001;{5}&#x3001;{4}&#x3001;{2}&#x3001;{3}&#x3002;<br>&#x7B2C;&#x4E00;&#x6B21;&#x64CD;&#x4F5C;&#xFF0C;&#x5C06;&#x7B2C;1&#x4E2A;&#x6570;&#x6240;&#x5728;&#x7684;&#x5C0F;&#x6839;&#x5806;&#x4E0E;&#x7B2C;5&#x4E2A;&#x6570;&#x6240;&#x5728;&#x7684;&#x5C0F;&#x6839;&#x5806;&#x5408;&#x5E76;&#xFF0C;&#x6545;&#x53D8;&#x4E3A;&#x56DB;&#x4E2A;&#x5C0F;&#x6839;&#x5806;&#xFF1A;{1,3}&#x3001;{5}&#x3001;{4}&#x3001;{2}&#x3002;<br>&#x7B2C;&#x4E8C;&#x6B21;&#x64CD;&#x4F5C;&#xFF0C;&#x5C06;&#x7B2C;2&#x4E2A;&#x6570;&#x6240;&#x5728;&#x7684;&#x5C0F;&#x6839;&#x5806;&#x4E0E;&#x7B2C;5&#x4E2A;&#x6570;&#x6240;&#x5728;&#x7684;&#x5C0F;&#x6839;&#x5806;&#x5408;&#x5E76;&#xFF0C;&#x6545;&#x53D8;&#x4E3A;&#x4E09;&#x4E2A;&#x5C0F;&#x6839;&#x5806;&#xFF1A;{1,3,5}&#x3001;{4}&#x3001;{2}&#x3002;<br>&#x7B2C;&#x4E09;&#x6B21;&#x64CD;&#x4F5C;&#xFF0C;&#x5C06;&#x7B2C;2&#x4E2A;&#x6570;&#x6240;&#x5728;&#x7684;&#x5C0F;&#x6839;&#x5806;&#x7684;&#x6700;&#x5C0F;&#x503C;&#x8F93;&#x51FA;&#x5E76;&#x5220;&#x9664;&#xFF0C;&#x6545;&#x8F93;&#x51FA;1&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x6570;&#x88AB;&#x5220;&#x9664;&#xFF0C;&#x4E09;&#x4E2A;&#x5C0F;&#x6839;&#x5806;&#x4E3A;&#xFF1A;{3,5}&#x3001;{4}&#x3001;{2}&#x3002;<br>&#x7B2C;&#x56DB;&#x6B21;&#x64CD;&#x4F5C;&#xFF0C;&#x5C06;&#x7B2C;4&#x4E2A;&#x6570;&#x6240;&#x5728;&#x7684;&#x5C0F;&#x6839;&#x5806;&#x4E0E;&#x7B2C;2&#x4E2A;&#x6570;&#x6240;&#x5728;&#x7684;&#x5C0F;&#x6839;&#x5806;&#x5408;&#x5E76;&#xFF0C;&#x6545;&#x53D8;&#x4E3A;&#x4E24;&#x4E2A;&#x5C0F;&#x6839;&#x5806;&#xFF1A;{2,3,5}&#x3001;{4}&#x3002;<br>&#x7B2C;&#x4E94;&#x6B21;&#x64CD;&#x4F5C;&#xFF0C;&#x5C06;&#x7B2C;2&#x4E2A;&#x6570;&#x6240;&#x5728;&#x7684;&#x5C0F;&#x6839;&#x5806;&#x7684;&#x6700;&#x5C0F;&#x503C;&#x8F93;&#x51FA;&#x5E76;&#x5220;&#x9664;&#xFF0C;&#x6545;&#x8F93;&#x51FA;2&#xFF0C;&#x7B2C;&#x56DB;&#x4E2A;&#x6570;&#x88AB;&#x5220;&#x9664;&#xFF0C;&#x4E24;&#x4E2A;&#x5C0F;&#x6839;&#x5806;&#x4E3A;&#xFF1A;{3,5}&#x3001;{4}&#x3002;<br>&#x6545;&#x8F93;&#x51FA;&#x4F9D;&#x6B21;&#x4E3A;1&#x3001;2&#x3002;<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 100000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> {</span><span class="keyword">int</span> val, dis, ls, rs;} heap[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="keyword">int</span> n, m, fa[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">getf</span><span class="params">(<span class="keyword">int</span> x)</span> </span>{<span class="keyword">return</span> fa[x] == x ? fa[x] : getf(fa[x]);}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (!a || !b)	<span class="keyword">return</span> a^b;</div><div class="line">	<span class="keyword">if</span> (heap[a].val &gt; heap[b].val || (heap[a].val == heap[b].val &amp;&amp; a &gt; b))	swap(a, b);</div><div class="line">	heap[a].rs = merge(heap[a].rs, b), fa[heap[a].rs] = a;</div><div class="line">	<span class="keyword">if</span> (heap[heap[a].rs].dis &gt; heap[heap[a].ls].dis)	swap(heap[a].ls, heap[a].rs);</div><div class="line">	heap[a].dis = heap[a].rs == <span class="number">0</span> ? <span class="number">0</span> : heap[heap[a].rs].dis+<span class="number">1</span>;	<span class="keyword">return</span> a;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">pop</span><span class="params">(<span class="keyword">int</span> a)</span> </span>{</div><div class="line">	<span class="keyword">int</span> l = heap[a].ls, r = heap[a].rs;</div><div class="line">	heap[a].ls = heap[a].rs = heap[a].val = <span class="number">0</span>, fa[l] = l, fa[r] = r;</div><div class="line">	<span class="keyword">return</span> merge(l, r);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;heap[i].val), fa[i] = i;</div><div class="line">	<span class="keyword">while</span> (m--) {</div><div class="line">		<span class="keyword">int</span> opt;	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;opt);</div><div class="line">		<span class="keyword">if</span> (opt == <span class="number">1</span>) {</div><div class="line">			<span class="keyword">int</span> x, y;	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;x, &amp;y), x = getf(x), y = getf(y);</div><div class="line">			<span class="keyword">if</span> (heap[x].val &amp;&amp; heap[y].val &amp;&amp; x != y)	merge(x, y);</div><div class="line">		}</div><div class="line">		<span class="keyword">if</span> (opt == <span class="number">2</span>) {</div><div class="line">			<span class="keyword">int</span> x;	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x), x = getf(x);</div><div class="line">			<span class="keyword">if</span> (!heap[x].val)	<span class="built_in">printf</span>(<span class="string">&quot;-1\n&quot;</span>);</div><div class="line">			<span class="keyword">else</span>	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, heap[x].val), pop(x);</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Binary-Indexed-Tree"><a href="#Binary-Indexed-Tree" class="headerlink" title="Binary Indexed Tree"></a>Binary Indexed Tree</h2><h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x6811;&#x72B6;&#x6570;&#x7EC4; 1</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x5982;&#x9898;&#xFF0C;&#x5DF2;&#x77E5;&#x4E00;&#x4E2A;&#x6570;&#x5217;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x4E0B;&#x9762;&#x4E24;&#x79CD;&#x64CD;&#x4F5C;&#xFF1A;<br>1.&#x5C06;&#x67D0;&#x4E00;&#x4E2A;&#x6570;&#x52A0;&#x4E0A;x<br>2.&#x6C42;&#x51FA;&#x67D0;&#x533A;&#x95F4;&#x6BCF;&#x4E00;&#x4E2A;&#x6570;&#x7684;&#x548C;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x5305;&#x542B;&#x4E24;&#x4E2A;&#x6574;&#x6570;N&#x3001;M&#xFF0C;&#x5206;&#x522B;&#x8868;&#x793A;&#x8BE5;&#x6570;&#x5217;&#x6570;&#x5B57;&#x7684;&#x4E2A;&#x6570;&#x548C;&#x64CD;&#x4F5C;&#x7684;&#x603B;&#x4E2A;&#x6570;&#x3002;<br>&#x7B2C;&#x4E8C;&#x884C;&#x5305;&#x542B;N&#x4E2A;&#x7528;&#x7A7A;&#x683C;&#x5206;&#x9694;&#x7684;&#x6574;&#x6570;&#xFF0C;&#x5176;&#x4E2D;&#x7B2C;i&#x4E2A;&#x6570;&#x5B57;&#x8868;&#x793A;&#x6570;&#x5217;&#x7B2C;i&#x9879;&#x7684;&#x521D;&#x59CB;&#x503C;&#x3002;<br>&#x63A5;&#x4E0B;&#x6765;M&#x884C;&#x6BCF;&#x884C;&#x5305;&#x542B;3&#x6216;4&#x4E2A;&#x6574;&#x6570;&#xFF0C;&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;&#xFF0C;&#x5177;&#x4F53;&#x5982;&#x4E0B;&#xFF1A;<br>&#x64CD;&#x4F5C;1&#xFF1A; &#x683C;&#x5F0F;&#xFF1A;1 x k &#x542B;&#x4E49;&#xFF1A;&#x5C06;&#x7B2C;x&#x4E2A;&#x6570;&#x52A0;&#x4E0A;k<br>&#x64CD;&#x4F5C;2&#xFF1A; &#x683C;&#x5F0F;&#xFF1A;2 x y &#x542B;&#x4E49;&#xFF1A;&#x8F93;&#x51FA;&#x533A;&#x95F4;[x,y]&#x5185;&#x6BCF;&#x4E2A;&#x6570;&#x7684;&#x548C;<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x8F93;&#x51FA;&#x5305;&#x542B;&#x82E5;&#x5E72;&#x884C;&#x6574;&#x6570;&#xFF0C;&#x5373;&#x4E3A;&#x6240;&#x6709;&#x64CD;&#x4F5C;2&#x7684;&#x7ED3;&#x679C;&#x3002; </p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;&#xFF1A;<br>5 5<br>1 5 4 2 3<br>1 1 3<br>2 2 5<br>1 3 -1<br>1 4 2<br>2 1 4<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;&#xFF1A;<br>14<br>16</p>
<p>&#x8BF4;&#x660E;<br>&#x65F6;&#x7A7A;&#x9650;&#x5236;&#xFF1A;1000ms,128M<br>&#x6570;&#x636E;&#x89C4;&#x6A21;&#xFF1A;<br>&#x5BF9;&#x4E8E;30%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=8&#xFF0C;M&lt;=10<br>&#x5BF9;&#x4E8E;70%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=10000&#xFF0C;M&lt;=10000<br>&#x5BF9;&#x4E8E;100%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=500000&#xFF0C;M&lt;=500000<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 500000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m;</div><div class="line"><span class="keyword">int</span> tree[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> x)</span> </span>{</div><div class="line">	<span class="keyword">return</span> x&amp;(-x);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> pos, <span class="keyword">int</span> x)</span> </span>{</div><div class="line">	<span class="keyword">while</span> (pos &lt;= n) {</div><div class="line">		tree[pos] += x;</div><div class="line">		pos += lowbit(pos);</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> t)</span> </span>{</div><div class="line">	<span class="keyword">long</span> <span class="keyword">long</span> tot = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span> (t &gt; <span class="number">0</span>) {</div><div class="line">		tot += tree[t];</div><div class="line">		t -= lowbit(t);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> tot;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">memset</span>(tree, <span class="number">0</span>, <span class="keyword">sizeof</span>(tree));</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) {</div><div class="line">		<span class="keyword">int</span> tmp;</div><div class="line">		<span class="built_in">cin</span> &gt;&gt; tmp;</div><div class="line">		modify(i, tmp);</div><div class="line">	}</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) {</div><div class="line">		<span class="keyword">int</span> f, a, b;</div><div class="line">		<span class="built_in">cin</span> &gt;&gt; f &gt;&gt; a &gt;&gt; b;</div><div class="line">		<span class="keyword">if</span> (f == <span class="number">1</span>) {</div><div class="line">			modify(a, b);</div><div class="line">		} <span class="keyword">else</span> {</div><div class="line">			<span class="built_in">cout</span> &lt;&lt; query(b)-query(a<span class="number">-1</span>) &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="2"><a href="#2" class="headerlink" title="2"></a>2</h3><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x6811;&#x72B6;&#x6570;&#x7EC4; 2</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x5982;&#x9898;&#xFF0C;&#x5DF2;&#x77E5;&#x4E00;&#x4E2A;&#x6570;&#x5217;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x4E0B;&#x9762;&#x4E24;&#x79CD;&#x64CD;&#x4F5C;&#xFF1A;<br>1.&#x5C06;&#x67D0;&#x533A;&#x95F4;&#x6BCF;&#x4E00;&#x4E2A;&#x6570;&#x6570;&#x52A0;&#x4E0A;x<br>2.&#x6C42;&#x51FA;&#x67D0;&#x4E00;&#x4E2A;&#x6570;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x5305;&#x542B;&#x4E24;&#x4E2A;&#x6574;&#x6570;N&#x3001;M&#xFF0C;&#x5206;&#x522B;&#x8868;&#x793A;&#x8BE5;&#x6570;&#x5217;&#x6570;&#x5B57;&#x7684;&#x4E2A;&#x6570;&#x548C;&#x64CD;&#x4F5C;&#x7684;&#x603B;&#x4E2A;&#x6570;&#x3002;<br>&#x7B2C;&#x4E8C;&#x884C;&#x5305;&#x542B;N&#x4E2A;&#x7528;&#x7A7A;&#x683C;&#x5206;&#x9694;&#x7684;&#x6574;&#x6570;&#xFF0C;&#x5176;&#x4E2D;&#x7B2C;i&#x4E2A;&#x6570;&#x5B57;&#x8868;&#x793A;&#x6570;&#x5217;&#x7B2C;i&#x9879;&#x7684;&#x521D;&#x59CB;&#x503C;&#x3002;<br>&#x63A5;&#x4E0B;&#x6765;M&#x884C;&#x6BCF;&#x884C;&#x5305;&#x542B;3&#x6216;4&#x4E2A;&#x6574;&#x6570;&#xFF0C;&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;&#xFF0C;&#x5177;&#x4F53;&#x5982;&#x4E0B;&#xFF1A;<br>&#x64CD;&#x4F5C;1&#xFF1A; &#x683C;&#x5F0F;&#xFF1A;1 x y k &#x542B;&#x4E49;&#xFF1A;&#x5C06;&#x533A;&#x95F4;[x,y]&#x5185;&#x6BCF;&#x4E2A;&#x6570;&#x52A0;&#x4E0A;k<br>&#x64CD;&#x4F5C;2&#xFF1A; &#x683C;&#x5F0F;&#xFF1A;2 x &#x542B;&#x4E49;&#xFF1A;&#x8F93;&#x51FA;&#x7B2C;x&#x4E2A;&#x6570;&#x7684;&#x503C;<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x8F93;&#x51FA;&#x5305;&#x542B;&#x82E5;&#x5E72;&#x884C;&#x6574;&#x6570;&#xFF0C;&#x5373;&#x4E3A;&#x6240;&#x6709;&#x64CD;&#x4F5C;2&#x7684;&#x7ED3;&#x679C;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;&#xFF1A;<br>5 5<br>1 5 4 2 3<br>1 2 4 2<br>2 3<br>1 1 5 -1<br>1 3 5 7<br>2 4<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;&#xFF1A;<br>6<br>10</p>
<p>&#x8BF4;&#x660E;<br>&#x65F6;&#x7A7A;&#x9650;&#x5236;&#xFF1A;1000ms,128M<br>&#x6570;&#x636E;&#x89C4;&#x6A21;&#xFF1A;<br>&#x5BF9;&#x4E8E;30%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=8&#xFF0C;M&lt;=10<br>&#x5BF9;&#x4E8E;70%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=10000&#xFF0C;M&lt;=10000<br>&#x5BF9;&#x4E8E;100%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=500000&#xFF0C;M&lt;=500000<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 500000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m;</div><div class="line"><span class="keyword">int</span> tree[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> x)</span> </span>{</div><div class="line">	<span class="keyword">return</span> x&amp;(-x);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> pos, <span class="keyword">int</span> x)</span> </span>{</div><div class="line">	<span class="keyword">while</span> (pos &lt;= n) {</div><div class="line">		tree[pos] += x;</div><div class="line">		pos += lowbit(pos);</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> pos)</span> </span>{</div><div class="line">	<span class="keyword">long</span> <span class="keyword">long</span> tot = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span> (pos &gt; <span class="number">0</span>) {</div><div class="line">		tot += tree[pos];</div><div class="line">		pos -= lowbit(pos);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> tot;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">memset</span>(tree, <span class="number">0</span>, <span class="keyword">sizeof</span>(tree));</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) {</div><div class="line">		<span class="keyword">int</span> x;</div><div class="line">		<span class="built_in">cin</span> &gt;&gt; x;</div><div class="line">		modify(i, x);</div><div class="line">		modify(i+<span class="number">1</span>, -x);</div><div class="line">	}</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) {</div><div class="line">		<span class="keyword">int</span> f;</div><div class="line">		<span class="built_in">cin</span> &gt;&gt; f;</div><div class="line">		<span class="keyword">if</span> (f == <span class="number">1</span>) {</div><div class="line">			<span class="keyword">int</span> l, r, x;</div><div class="line">			<span class="built_in">cin</span> &gt;&gt; l &gt;&gt; r &gt;&gt; x;</div><div class="line">			modify(l, x);</div><div class="line">			modify(r+<span class="number">1</span>, -x);</div><div class="line">		} <span class="keyword">else</span> {</div><div class="line">			<span class="keyword">int</span> x;</div><div class="line">			<span class="built_in">cin</span> &gt;&gt; x;</div><div class="line">			<span class="built_in">cout</span> &lt;&lt; query(x) &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Segment-Tree"><a href="#Segment-Tree" class="headerlink" title="Segment Tree"></a>Segment Tree</h2><h3 id="1-1"><a href="#1-1" class="headerlink" title="1"></a>1</h3><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x7EBF;&#x6BB5;&#x6811; 1</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x5982;&#x9898;&#xFF0C;&#x5DF2;&#x77E5;&#x4E00;&#x4E2A;&#x6570;&#x5217;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x4E0B;&#x9762;&#x4E24;&#x79CD;&#x64CD;&#x4F5C;&#xFF1A;<br>1.&#x5C06;&#x67D0;&#x533A;&#x95F4;&#x6BCF;&#x4E00;&#x4E2A;&#x6570;&#x52A0;&#x4E0A;x<br>2.&#x6C42;&#x51FA;&#x67D0;&#x533A;&#x95F4;&#x6BCF;&#x4E00;&#x4E2A;&#x6570;&#x7684;&#x548C;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x5305;&#x542B;&#x4E24;&#x4E2A;&#x6574;&#x6570;N&#x3001;M&#xFF0C;&#x5206;&#x522B;&#x8868;&#x793A;&#x8BE5;&#x6570;&#x5217;&#x6570;&#x5B57;&#x7684;&#x4E2A;&#x6570;&#x548C;&#x64CD;&#x4F5C;&#x7684;&#x603B;&#x4E2A;&#x6570;&#x3002;<br>&#x7B2C;&#x4E8C;&#x884C;&#x5305;&#x542B;N&#x4E2A;&#x7528;&#x7A7A;&#x683C;&#x5206;&#x9694;&#x7684;&#x6574;&#x6570;&#xFF0C;&#x5176;&#x4E2D;&#x7B2C;i&#x4E2A;&#x6570;&#x5B57;&#x8868;&#x793A;&#x6570;&#x5217;&#x7B2C;i&#x9879;&#x7684;&#x521D;&#x59CB;&#x503C;&#x3002;<br>&#x63A5;&#x4E0B;&#x6765;M&#x884C;&#x6BCF;&#x884C;&#x5305;&#x542B;3&#x6216;4&#x4E2A;&#x6574;&#x6570;&#xFF0C;&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;&#xFF0C;&#x5177;&#x4F53;&#x5982;&#x4E0B;&#xFF1A;<br>&#x64CD;&#x4F5C;1&#xFF1A; &#x683C;&#x5F0F;&#xFF1A;1 x y k &#x542B;&#x4E49;&#xFF1A;&#x5C06;&#x533A;&#x95F4;[x,y]&#x5185;&#x6BCF;&#x4E2A;&#x6570;&#x52A0;&#x4E0A;k<br>&#x64CD;&#x4F5C;2&#xFF1A; &#x683C;&#x5F0F;&#xFF1A;2 x y &#x542B;&#x4E49;&#xFF1A;&#x8F93;&#x51FA;&#x533A;&#x95F4;[x,y]&#x5185;&#x6BCF;&#x4E2A;&#x6570;&#x7684;&#x548C;<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x8F93;&#x51FA;&#x5305;&#x542B;&#x82E5;&#x5E72;&#x884C;&#x6574;&#x6570;&#xFF0C;&#x5373;&#x4E3A;&#x6240;&#x6709;&#x64CD;&#x4F5C;2&#x7684;&#x7ED3;&#x679C;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;&#xFF1A;<br>5 5<br>1 5 4 2 3<br>2 2 4<br>1 2 3 2<br>2 3 4<br>1 1 5 1<br>2 1 4<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;&#xFF1A;<br>11<br>8<br>20</p>
<p>&#x8BF4;&#x660E;<br>&#x65F6;&#x7A7A;&#x9650;&#x5236;&#xFF1A;1000ms,128M<br>&#x6570;&#x636E;&#x89C4;&#x6A21;&#xFF1A;<br>&#x5BF9;&#x4E8E;30%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=8&#xFF0C;M&lt;=10<br>&#x5BF9;&#x4E8E;70%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=1000&#xFF0C;M&lt;=10000<br>&#x5BF9;&#x4E8E;100%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=100000&#xFF0C;M&lt;=100000<br>&#xFF08;&#x6570;&#x636E;&#x4FDD;&#x8BC1;&#x5728;int64/long long&#x6570;&#x636E;&#x8303;&#x56F4;&#x5185;&#xFF09;<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 100000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, k;</div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> tree[MAX_N*<span class="number">4</span>+<span class="number">50</span>], tag[MAX_N*<span class="number">4</span>+<span class="number">50</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">updata</span><span class="params">(<span class="keyword">int</span> v)</span> </span>{</div><div class="line">    tree[v] = tree[v*<span class="number">2</span>]+tree[v*<span class="number">2</span>+<span class="number">1</span>];</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">downtag</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>{</div><div class="line">    tag[v*<span class="number">2</span>] += tag[v];</div><div class="line">    tag[v*<span class="number">2</span>+<span class="number">1</span>] += tag[v];</div><div class="line">    <span class="keyword">int</span> m = (s+t)/<span class="number">2</span>;</div><div class="line">    tree[v*<span class="number">2</span>] += tag[v]*(m-s+<span class="number">1</span>);</div><div class="line">    tree[v*<span class="number">2</span>+<span class="number">1</span>] += tag[v]*(t-m);</div><div class="line">    tag[v] = <span class="number">0</span>;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x)</span> </span>{</div><div class="line">    <span class="keyword">if</span> (s &gt;= l &amp;&amp; t &lt;= r) {</div><div class="line">        tree[v] += x*(t-s+<span class="number">1</span>);</div><div class="line">        tag[v] += x;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    }</div><div class="line">    <span class="keyword">int</span> m = (s+t)/<span class="number">2</span>;</div><div class="line">    downtag(v, s, t);</div><div class="line">    <span class="keyword">if</span> (l &lt;= m) {</div><div class="line">        modify(v*<span class="number">2</span>, s, m, l, r, x);</div><div class="line">    }</div><div class="line">    <span class="keyword">if</span> (r &gt;= m+<span class="number">1</span>) {</div><div class="line">        modify(v*<span class="number">2</span>+<span class="number">1</span>, m+<span class="number">1</span>, t, l, r, x);</div><div class="line">    }</div><div class="line">    updata(v);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>{</div><div class="line">    <span class="keyword">if</span> (s == t) {</div><div class="line">        <span class="built_in">cin</span> &gt;&gt; tree[v];</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    }</div><div class="line">    <span class="keyword">int</span> m = (s+t)/<span class="number">2</span>;</div><div class="line">    build(v*<span class="number">2</span>, s, m);</div><div class="line">    build(v*<span class="number">2</span>+<span class="number">1</span>, m+<span class="number">1</span>, t);</div><div class="line">    updata(v);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>{</div><div class="line">    <span class="keyword">if</span> (s &gt;= l &amp;&amp; t &lt;= r) {</div><div class="line">        <span class="keyword">return</span> tree[v];</div><div class="line">    }</div><div class="line">    <span class="keyword">int</span> m = (s+t)/<span class="number">2</span>;</div><div class="line">    downtag(v, s, t);</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ret = <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span> (l &lt;= m) {</div><div class="line">        ret += query(v*<span class="number">2</span>, s, m, l, r);</div><div class="line">    }</div><div class="line">    <span class="keyword">if</span> (r &gt;= m+<span class="number">1</span>) {</div><div class="line">        ret += query(v*<span class="number">2</span>+<span class="number">1</span>, m+<span class="number">1</span>, t, l, r);</div><div class="line">    }</div><div class="line">    updata(v);</div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k;</div><div class="line">    build(<span class="number">1</span>, <span class="number">1</span>, n);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++) {</div><div class="line">        <span class="keyword">int</span> f, l, r, x;</div><div class="line">        <span class="built_in">cin</span> &gt;&gt; f;</div><div class="line">        <span class="keyword">if</span> (f == <span class="number">1</span>) {</div><div class="line">            <span class="built_in">cin</span> &gt;&gt; l &gt;&gt; r &gt;&gt; x;</div><div class="line">            modify(<span class="number">1</span>, <span class="number">1</span>, n, l, r, x);</div><div class="line">        } <span class="keyword">else</span> {</div><div class="line">            <span class="built_in">cin</span> &gt;&gt; l &gt;&gt; r;</div><div class="line">            <span class="built_in">cout</span> &lt;&lt; query(<span class="number">1</span>, <span class="number">1</span>, n, l, r) &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="2-1"><a href="#2-1" class="headerlink" title="2"></a>2</h3><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x7EBF;&#x6BB5;&#x6811; 2</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x5982;&#x9898;&#xFF0C;&#x5DF2;&#x77E5;&#x4E00;&#x4E2A;&#x6570;&#x5217;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x4E0B;&#x9762;&#x4E24;&#x79CD;&#x64CD;&#x4F5C;&#xFF1A;<br>1.&#x5C06;&#x67D0;&#x533A;&#x95F4;&#x6BCF;&#x4E00;&#x4E2A;&#x6570;&#x52A0;&#x4E0A;x<br>2.&#x5C06;&#x67D0;&#x533A;&#x95F4;&#x6BCF;&#x4E00;&#x4E2A;&#x6570;&#x4E58;&#x4E0A;x<br>3.&#x6C42;&#x51FA;&#x67D0;&#x533A;&#x95F4;&#x6BCF;&#x4E00;&#x4E2A;&#x6570;&#x7684;&#x548C;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x5305;&#x542B;&#x4E09;&#x4E2A;&#x6574;&#x6570;N&#x3001;M&#x3001;P&#xFF0C;&#x5206;&#x522B;&#x8868;&#x793A;&#x8BE5;&#x6570;&#x5217;&#x6570;&#x5B57;&#x7684;&#x4E2A;&#x6570;&#x3001;&#x64CD;&#x4F5C;&#x7684;&#x603B;&#x4E2A;&#x6570;&#x548C;&#x6A21;&#x6570;&#x3002;<br>&#x7B2C;&#x4E8C;&#x884C;&#x5305;&#x542B;N&#x4E2A;&#x7528;&#x7A7A;&#x683C;&#x5206;&#x9694;&#x7684;&#x6574;&#x6570;&#xFF0C;&#x5176;&#x4E2D;&#x7B2C;i&#x4E2A;&#x6570;&#x5B57;&#x8868;&#x793A;&#x6570;&#x5217;&#x7B2C;i&#x9879;&#x7684;&#x521D;&#x59CB;&#x503C;&#x3002;<br>&#x63A5;&#x4E0B;&#x6765;M&#x884C;&#x6BCF;&#x884C;&#x5305;&#x542B;3&#x6216;4&#x4E2A;&#x6574;&#x6570;&#xFF0C;&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;&#xFF0C;&#x5177;&#x4F53;&#x5982;&#x4E0B;&#xFF1A;<br>&#x64CD;&#x4F5C;1&#xFF1A; &#x683C;&#x5F0F;&#xFF1A;1 x y k &#x542B;&#x4E49;&#xFF1A;&#x5C06;&#x533A;&#x95F4;[x,y]&#x5185;&#x6BCF;&#x4E2A;&#x6570;&#x4E58;&#x4E0A;k<br>&#x64CD;&#x4F5C;2&#xFF1A; &#x683C;&#x5F0F;&#xFF1A;2 x y k &#x542B;&#x4E49;&#xFF1A;&#x5C06;&#x533A;&#x95F4;[x,y]&#x5185;&#x6BCF;&#x4E2A;&#x6570;&#x52A0;&#x4E0A;k<br>&#x64CD;&#x4F5C;3&#xFF1A; &#x683C;&#x5F0F;&#xFF1A;3 x y &#x542B;&#x4E49;&#xFF1A;&#x8F93;&#x51FA;&#x533A;&#x95F4;[x,y]&#x5185;&#x6BCF;&#x4E2A;&#x6570;&#x7684;&#x548C;&#x5BF9;P&#x53D6;&#x6A21;&#x6240;&#x5F97;&#x7684;&#x7ED3;&#x679C;<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x8F93;&#x51FA;&#x5305;&#x542B;&#x82E5;&#x5E72;&#x884C;&#x6574;&#x6570;&#xFF0C;&#x5373;&#x4E3A;&#x6240;&#x6709;&#x64CD;&#x4F5C;3&#x7684;&#x7ED3;&#x679C;&#x3002; </p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;&#xFF1A;<br>5 5 38<br>1 5 4 2 3<br>2 1 4 1<br>3 2 5<br>1 2 4 2<br>2 3 5 5<br>3 1 4<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;&#xFF1A;<br>17<br>2</p>
<p>&#x8BF4;&#x660E;<br>&#x65F6;&#x7A7A;&#x9650;&#x5236;&#xFF1A;1000ms,128M<br>&#x6570;&#x636E;&#x89C4;&#x6A21;&#xFF1A;<br>&#x5BF9;&#x4E8E;30%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=8&#xFF0C;M&lt;=10<br>&#x5BF9;&#x4E8E;70%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=1000&#xFF0C;M&lt;=10000<br>&#x5BF9;&#x4E8E;100%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=100000&#xFF0C;M&lt;=100000<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 100000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m;</div><div class="line">ll p;</div><div class="line">ll tree[MAX_N*<span class="number">4</span>+<span class="number">5</span>], mul[MAX_N*<span class="number">4</span>+<span class="number">5</span>], add[MAX_N*<span class="number">4</span>+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">updata</span><span class="params">(<span class="keyword">int</span> v)</span> </span>{</div><div class="line">	tree[v] = (tree[v*<span class="number">2</span>]+tree[v*<span class="number">2</span>+<span class="number">1</span>])%p;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">downtag</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> mid)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (mul[v] == <span class="number">1</span> &amp;&amp; add[v] == <span class="number">0</span>)	<span class="keyword">return</span>;</div><div class="line">	mul[v*<span class="number">2</span>] = mul[v*<span class="number">2</span>]*mul[v]%p;</div><div class="line">	add[v*<span class="number">2</span>] = (add[v*<span class="number">2</span>]*mul[v]%p+add[v])%p;</div><div class="line">	tree[v*<span class="number">2</span>] = (tree[v*<span class="number">2</span>]*mul[v]%p+add[v]*(ll)(mid-s+<span class="number">1</span>)%p)%p;</div><div class="line">	mul[v*<span class="number">2</span>+<span class="number">1</span>] = mul[v*<span class="number">2</span>+<span class="number">1</span>]*mul[v]%p;</div><div class="line">	add[v*<span class="number">2</span>+<span class="number">1</span>] = (add[v*<span class="number">2</span>+<span class="number">1</span>]*mul[v]%p+add[v])%p;</div><div class="line">	tree[v*<span class="number">2</span>+<span class="number">1</span>] = (tree[v*<span class="number">2</span>+<span class="number">1</span>]*mul[v]%p+add[v]*(ll)(t-mid)%p)%p;</div><div class="line">	mul[v] = <span class="number">1</span>;</div><div class="line">	add[v] = <span class="number">0</span>;</div><div class="line">	<span class="keyword">return</span>;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">create</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>{</div><div class="line">	mul[v] = <span class="number">1</span>;</div><div class="line">	add[v] = <span class="number">0</span>;</div><div class="line">	<span class="keyword">if</span> (s == t) {</div><div class="line">		<span class="built_in">cin</span> &gt;&gt; tree[v];</div><div class="line">		tree[v] %= p;</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	}</div><div class="line">	<span class="keyword">int</span> mid = (s+t)/<span class="number">2</span>;</div><div class="line">	create(v*<span class="number">2</span>, s, mid);</div><div class="line">	create(v*<span class="number">2</span>+<span class="number">1</span>, mid+<span class="number">1</span>, t);</div><div class="line">	updata(v);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify1</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (s &gt;= l &amp;&amp; t &lt;= r) {</div><div class="line">		add[v] = (add[v]+(ll)x)%p;</div><div class="line">		tree[v] = (tree[v]+(ll)x*(ll)(t-s+<span class="number">1</span>)%p)%p;</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	}</div><div class="line">	<span class="keyword">int</span> mid = (s+t)/<span class="number">2</span>;</div><div class="line">	downtag(v, s, t, mid);</div><div class="line">	<span class="keyword">if</span> (l &lt;= mid) {</div><div class="line">		modify1(v*<span class="number">2</span>, s, mid, l, r, x);</div><div class="line">	}</div><div class="line">	<span class="keyword">if</span> (r &gt;= mid+<span class="number">1</span>) {</div><div class="line">		modify1(v*<span class="number">2</span>+<span class="number">1</span>, mid+<span class="number">1</span>, t, l, r, x);</div><div class="line">	}</div><div class="line">	updata(v);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify2</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (s &gt;= l &amp;&amp; t &lt;= r) {</div><div class="line">		mul[v] = mul[v]*(ll)x%p;</div><div class="line">		add[v] = add[v]*(ll)x%p;</div><div class="line">		tree[v] = tree[v]*(ll)x%p;</div><div class="line">		<span class="keyword">return</span>; </div><div class="line">	}</div><div class="line">	<span class="keyword">int</span> mid = (s+t)/<span class="number">2</span>;</div><div class="line">	downtag(v, s, t, mid);</div><div class="line">	<span class="keyword">if</span> (l &lt;= mid) {</div><div class="line">		modify2(v*<span class="number">2</span>, s, mid, l, r, x);</div><div class="line">	}</div><div class="line">	<span class="keyword">if</span> (r &gt;= mid+<span class="number">1</span>) {</div><div class="line">		modify2(v*<span class="number">2</span>+<span class="number">1</span>, mid+<span class="number">1</span>, t, l, r, x);</div><div class="line">	}</div><div class="line">	updata(v);</div><div class="line">}</div><div class="line"><span class="function">ll <span class="title">query</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (s &gt;= l &amp;&amp; t &lt;= r) {</div><div class="line">		<span class="keyword">return</span> tree[v];</div><div class="line">	}</div><div class="line">	<span class="keyword">int</span> mid = (s+t)/<span class="number">2</span>;</div><div class="line">	ll ret = <span class="number">0</span>;</div><div class="line">	downtag(v, s, t, mid);</div><div class="line">	<span class="keyword">if</span> (l &lt;= mid) {</div><div class="line">		ret = (ret+query(v*<span class="number">2</span>, s, mid, l, r))%p;</div><div class="line">	}</div><div class="line">	<span class="keyword">if</span> (r &gt;= mid+<span class="number">1</span>) {</div><div class="line">		ret = (ret+query(v*<span class="number">2</span>+<span class="number">1</span>, mid+<span class="number">1</span>, t, l, r))%p;</div><div class="line">	}</div><div class="line">	updata(v);</div><div class="line">	<span class="keyword">return</span> ret;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; p;</div><div class="line">	create(<span class="number">1</span>, <span class="number">1</span>, n);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) {</div><div class="line">		<span class="keyword">int</span> f;</div><div class="line">		<span class="built_in">cin</span> &gt;&gt; f;</div><div class="line">		<span class="keyword">if</span> (f == <span class="number">1</span>) {</div><div class="line">			<span class="keyword">int</span> l, r, x;</div><div class="line">			<span class="built_in">cin</span> &gt;&gt; l &gt;&gt; r &gt;&gt; x;</div><div class="line">			modify2(<span class="number">1</span>, <span class="number">1</span>, n, l, r, x%p);</div><div class="line">		} <span class="keyword">else</span> <span class="keyword">if</span> (f == <span class="number">2</span>) {</div><div class="line">			<span class="keyword">int</span> l, r, x;</div><div class="line">			<span class="built_in">cin</span> &gt;&gt; l &gt;&gt; r &gt;&gt; x;</div><div class="line">			modify1(<span class="number">1</span>, <span class="number">1</span>, n, l, r, x%p);</div><div class="line">		} <span class="keyword">else</span> {</div><div class="line">			<span class="keyword">int</span> l, r;</div><div class="line">			<span class="built_in">cin</span> &gt;&gt; l &gt;&gt; r;</div><div class="line">			<span class="built_in">cout</span> &lt;&lt; query(<span class="number">1</span>, <span class="number">1</span>, n, l, r) &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Sparse-Table"><a href="#Sparse-Table" class="headerlink" title="Sparse Table"></a>Sparse Table</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;ST&#x8868;</p>
<p>&#x9898;&#x76EE;&#x80CC;&#x666F;<br>&#x8FD9;&#x662F;&#x4E00;&#x9053;ST&#x8868;&#x7ECF;&#x5178;&#x9898;&#x2014;&#x2014;&#x9759;&#x6001;&#x533A;&#x95F4;&#x6700;&#x5927;&#x503C;<br>&#x8BF7;&#x6CE8;&#x610F;&#x6700;&#x5927;&#x6570;&#x636E;&#x65F6;&#x9650;&#x53EA;&#x6709;0.8s&#xFF0C;&#x6570;&#x636E;&#x5F3A;&#x5EA6;&#x4E0D;&#x4F4E;&#xFF0C;&#x8BF7;&#x52A1;&#x5FC5;&#x4FDD;&#x8BC1;&#x4F60;&#x7684;&#x6BCF;&#x6B21;&#x67E5;&#x8BE2;&#x590D;&#x6742;&#x5EA6;&#x4E3A;O(1)</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x7ED9;&#x5B9A;&#x4E00;&#x4E2A;&#x957F;&#x5EA6;&#x4E3A;N&#x7684;&#x6570;&#x5217;&#xFF0C;&#x548C;M&#x6B21;&#x8BE2;&#x95EE;&#xFF0C;&#x6C42;&#x51FA;&#x6BCF;&#x4E00;&#x6B21;&#x8BE2;&#x95EE;&#x7684;&#x533A;&#x95F4;&#x5185;&#x6570;&#x5B57;&#x7684;&#x6700;&#x5927;&#x503C;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x5305;&#x542B;&#x4E24;&#x4E2A;&#x6574;&#x6570;N,M&#xFF0C;&#x5206;&#x522B;&#x8868;&#x793A;&#x6570;&#x5217;&#x7684;&#x957F;&#x5EA6;&#x548C;&#x8BE2;&#x95EE;&#x7684;&#x4E2A;&#x6570;&#x3002;<br>&#x7B2C;&#x4E8C;&#x884C;&#x5305;&#x542B;N&#x4E2A;&#x6574;&#x6570;&#xFF08;&#x8BB0;&#x4E3A;ai&#xFF09;&#xFF0C;&#x4F9D;&#x6B21;&#x8868;&#x793A;&#x6570;&#x5217;&#x7684;&#x7B2C;i&#x9879;&#x3002;<br>&#x63A5;&#x4E0B;&#x6765;M&#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x5305;&#x542B;&#x4E24;&#x4E2A;&#x6574;&#x6570;li,ri&#xFF0C;&#x8868;&#x793A;&#x67E5;&#x8BE2;&#x7684;&#x533A;&#x95F4;&#x4E3A;[li,ri]&#x3002;<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x8F93;&#x51FA;&#x5305;&#x542B;M&#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#xFF0C;&#x4F9D;&#x6B21;&#x8868;&#x793A;&#x6BCF;&#x4E00;&#x6B21;&#x8BE2;&#x95EE;&#x7684;&#x7ED3;&#x679C;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;#1&#xFF1A;<br>8 8<br>9 3 1 7 5 6 0 8<br>1 6<br>1 5<br>2 7<br>2 6<br>1 8<br>4 8<br>3 7<br>1 8<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;#1&#xFF1A;<br>9<br>9<br>7<br>7<br>9<br>8<br>7<br>9</p>
<p>&#x8BF4;&#x660E;<br>&#x5BF9;&#x4E8E;30%&#x7684;&#x6570;&#x636E;&#xFF0C;&#x6EE1;&#x8DB3;&#xFF1A;1&#x2264;N,M&#x2264;10<br>&#x5BF9;&#x4E8E;70%&#x7684;&#x6570;&#x636E;&#xFF0C;&#x6EE1;&#x8DB3;&#xFF1A;1&#x2264;N,M&#x2264;1e5<br>&#x5BF9;&#x4E8E;100%&#x7684;&#x6570;&#x636E;&#xFF0C;&#x6EE1;&#x8DB3;&#xFF1A;1&#x2264;N&#x2264;1e5&#xFF0C;1&#x2264;M&#x2264;1e6&#xFF0C;ai&#x2208;[0,1e9]&#xFF0C;1&#x2264;li&#x2264;ri&#x2264;N<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 100000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m, num[MAX_N+<span class="number">5</span>], mx[MAX_N+<span class="number">5</span>][<span class="number">20</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">setTable</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	mx[i][<span class="number">0</span>] = num[i];</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; (<span class="number">1</span>&lt;&lt;j) &lt;= n; j++)</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i+(<span class="number">1</span>&lt;&lt;j)<span class="number">-1</span> &lt;= n; i++)</div><div class="line">			mx[i][j] = max(mx[i][j<span class="number">-1</span>], mx[i+(<span class="number">1</span>&lt;&lt;j<span class="number">-1</span>)][j<span class="number">-1</span>]);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>{</div><div class="line">	<span class="keyword">int</span> range = (<span class="keyword">int</span>)(<span class="built_in">log</span>(r-l+<span class="number">1</span>)/<span class="built_in">log</span>(<span class="number">2</span>));</div><div class="line">	<span class="keyword">return</span> max(mx[l][range], mx[r-(<span class="number">1</span>&lt;&lt;range)+<span class="number">1</span>][range]);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;num[i]);</div><div class="line">	setTable();</div><div class="line">	<span class="keyword">while</span> (m--) {</div><div class="line">		<span class="keyword">int</span> l, r;	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;l, &amp;r);</div><div class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, query(l, r));</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Chairman-Tree"><a href="#Chairman-Tree" class="headerlink" title="Chairman Tree"></a>Chairman Tree</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x53EF;&#x6301;&#x4E45;&#x5316;&#x7EBF;&#x6BB5;&#x6811;/&#x4E3B;&#x5E2D;&#x6811;</p>
<p>&#x9898;&#x76EE;&#x80CC;&#x666F;<br>&#x8FD9;&#x662F;&#x4E2A;&#x975E;&#x5E38;&#x7ECF;&#x5178;&#x7684;&#x4E3B;&#x5E2D;&#x6811;&#x5165;&#x95E8;&#x9898;&#x2014;&#x2014;&#x9759;&#x6001;&#x533A;&#x95F4;&#x7B2C;K&#x5C0F;<br>&#x6570;&#x636E;&#x5DF2;&#x7ECF;&#x8FC7;&#x52A0;&#x5F3A;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;&#x4E3B;&#x5E2D;&#x6811;&#x3002;&#x540C;&#x65F6;&#x8BF7;&#x6CE8;&#x610F;&#x5E38;&#x6570;&#x4F18;&#x5316;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x5982;&#x9898;&#xFF0C;&#x7ED9;&#x5B9A;N&#x4E2A;&#x6B63;&#x6574;&#x6570;&#x6784;&#x6210;&#x7684;&#x5E8F;&#x5217;&#xFF0C;&#x5C06;&#x5BF9;&#x4E8E;&#x6307;&#x5B9A;&#x7684;&#x95ED;&#x533A;&#x95F4;&#x67E5;&#x8BE2;&#x5176;&#x533A;&#x95F4;&#x5185;&#x7684;&#x7B2C;K&#x5C0F;&#x503C;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x5305;&#x542B;&#x4E24;&#x4E2A;&#x6B63;&#x6574;&#x6570;N&#x3001;M&#xFF0C;&#x5206;&#x522B;&#x8868;&#x793A;&#x5E8F;&#x5217;&#x7684;&#x957F;&#x5EA6;&#x548C;&#x67E5;&#x8BE2;&#x7684;&#x4E2A;&#x6570;&#x3002;<br>&#x7B2C;&#x4E8C;&#x884C;&#x5305;&#x542B;N&#x4E2A;&#x6B63;&#x6574;&#x6570;&#xFF0C;&#x8868;&#x793A;&#x8FD9;&#x4E2A;&#x5E8F;&#x5217;&#x5404;&#x9879;&#x7684;&#x6570;&#x5B57;&#x3002;<br>&#x63A5;&#x4E0B;&#x6765;M&#x884C;&#x6BCF;&#x884C;&#x5305;&#x542B;&#x4E09;&#x4E2A;&#x6574;&#x6570;l,r,k&#xFF0C;&#x8868;&#x793A;&#x67E5;&#x8BE2;&#x533A;&#x95F4;[l,r]&#x5185;&#x7684;&#x7B2C;k&#x5C0F;&#x503C;&#x3002;<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x8F93;&#x51FA;&#x5305;&#x542B;k&#x884C;&#xFF0C;&#x6BCF;&#x884C;1&#x4E2A;&#x6B63;&#x6574;&#x6570;&#xFF0C;&#x4F9D;&#x6B21;&#x8868;&#x793A;&#x6BCF;&#x4E00;&#x6B21;&#x67E5;&#x8BE2;&#x7684;&#x7ED3;&#x679C;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;#1&#xFF1A;<br>5 5<br>25957 6405 15770 26287 26465<br>2 2 1<br>3 4 1<br>4 5 1<br>1 2 2<br>4 4 1<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;#1&#xFF1A;<br>6405<br>15770<br>26287<br>25957<br>26287</p>
<p>&#x8BF4;&#x660E;<br>&#x6570;&#x636E;&#x8303;&#x56F4;&#xFF1A;<br>&#x5BF9;&#x4E8E;20%&#x7684;&#x6570;&#x636E;&#x6EE1;&#x8DB3;&#xFF1A;1&#x2264;N,M&#x2264;10<br>&#x5BF9;&#x4E8E;50%&#x7684;&#x6570;&#x636E;&#x6EE1;&#x8DB3;&#xFF1A;1&#x2264;N,M&#x2264;1000<br>&#x5BF9;&#x4E8E;80%&#x7684;&#x6570;&#x636E;&#x6EE1;&#x8DB3;&#xFF1A;1&#x2264;N,M&#x2264;1e5<br>&#x5BF9;&#x4E8E;100%&#x7684;&#x6570;&#x636E;&#x6EE1;&#x8DB3;&#xFF1A;1&#x2264;N,M&#x2264;2e5<br>&#x5BF9;&#x4E8E;&#x6570;&#x5217;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x6570;ai&#xFF0C;&#x5747;&#x6EE1;&#x8DB3;-1e9&#x2264;ai&#x2264;1e9<br>&#x6837;&#x4F8B;&#x6570;&#x636E;&#x8BF4;&#x660E;&#xFF1A;<br>N=5&#xFF0C;&#x6570;&#x5217;&#x957F;&#x5EA6;&#x4E3A;5&#xFF0C;&#x6570;&#x5217;&#x4ECE;&#x7B2C;&#x4E00;&#x9879;&#x5F00;&#x59CB;&#x4F9D;&#x6B21;&#x4E3A;[25957,6405,15770,26287,26465]<br>&#x7B2C;&#x4E00;&#x6B21;&#x67E5;&#x8BE2;&#x4E3A;[2,2]&#x533A;&#x95F4;&#x5185;&#x7684;&#x7B2C;&#x4E00;&#x5C0F;&#x503C;&#xFF0C;&#x5373;&#x4E3A;6405<br>&#x7B2C;&#x4E8C;&#x6B21;&#x67E5;&#x8BE2;&#x4E3A;[3,4]&#x533A;&#x95F4;&#x5185;&#x7684;&#x7B2C;&#x4E00;&#x5C0F;&#x503C;&#xFF0C;&#x5373;&#x4E3A;15770<br>&#x7B2C;&#x4E09;&#x6B21;&#x67E5;&#x8BE2;&#x4E3A;[4,5]&#x533A;&#x95F4;&#x5185;&#x7684;&#x7B2C;&#x4E00;&#x5C0F;&#x503C;&#xFF0C;&#x5373;&#x4E3A;26287<br>&#x7B2C;&#x56DB;&#x6B21;&#x67E5;&#x8BE2;&#x4E3A;[1,2]&#x533A;&#x95F4;&#x5185;&#x7684;&#x7B2C;&#x4E8C;&#x5C0F;&#x503C;&#xFF0C;&#x5373;&#x4E3A;25957<br>&#x7B2C;&#x4E94;&#x6B21;&#x67E5;&#x8BE2;&#x4E3A;[4,4]&#x533A;&#x95F4;&#x5185;&#x7684;&#x7B2C;&#x4E00;&#x5C0F;&#x503C;&#xFF0C;&#x5373;&#x4E3A;26287<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 200000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m, num[MAX_N+<span class="number">5</span>], hash[MAX_N+<span class="number">5</span>], tot, root[MAX_N+<span class="number">5</span>], cnt;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">pre</span> {</span><span class="keyword">int</span> id, val;} p[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span> <span class="params">(<span class="keyword">const</span> pre &amp;a, <span class="keyword">const</span> pre &amp;b)</span> </span>{<span class="keyword">return</span> a.val &lt; b.val;}</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> {</span><span class="keyword">int</span> ls, rs, val;} tr[MAX_N*<span class="number">50</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">updata</span><span class="params">(<span class="keyword">int</span> v)</span> </span>{tr[v].val = tr[tr[v].ls].val+tr[tr[v].rs].val;}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (s == t)	<span class="keyword">return</span>;	<span class="keyword">int</span> mid = s+t&gt;&gt;<span class="number">1</span>;</div><div class="line">	tr[v].ls = ++cnt, tr[v].rs = ++cnt;</div><div class="line">	build(tr[v].ls, s, mid), build(tr[v].rs, mid+<span class="number">1</span>, t);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> o, <span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> x)</span> </span>{</div><div class="line">	tr[v] = tr[o];	<span class="keyword">if</span> (s == t) {tr[v].val++;	<span class="keyword">return</span>;}</div><div class="line">	<span class="keyword">int</span> mid = s+t&gt;&gt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span> (x &lt;= mid)	modify(tr[v].ls = ++cnt, tr[o].ls, s, mid, x);</div><div class="line">	<span class="keyword">else</span>	modify(tr[v].rs = ++cnt, tr[o].rs, mid+<span class="number">1</span>, t, x);</div><div class="line">	updata(v);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> v1, <span class="keyword">int</span> v2, <span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> k)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (s == t)	<span class="keyword">return</span> s;</div><div class="line">	<span class="keyword">int</span> mid = s+t&gt;&gt;<span class="number">1</span>, tmp = tr[tr[v2].ls].val-tr[tr[v1].ls].val;</div><div class="line">	<span class="keyword">if</span> (k &lt;= tmp)	<span class="keyword">return</span> query(tr[v1].ls, tr[v2].ls, s, mid, k);</div><div class="line">	<span class="keyword">else</span>	<span class="keyword">return</span> query(tr[v1].rs, tr[v2].rs, mid+<span class="number">1</span>, t, k-tmp);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	p[i].id = i, <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;p[i].val);</div><div class="line">	sort(p+<span class="number">1</span>, p+n+<span class="number">1</span>, cmp);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) {<span class="keyword">if</span> (p[i].val != p[i<span class="number">-1</span>].val || i == <span class="number">1</span>)	hash[++tot] = p[i].val;	num[p[i].id] = tot;}</div><div class="line">	root[<span class="number">0</span>] = ++cnt, build(root[<span class="number">0</span>], <span class="number">1</span>, tot);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	root[i] = ++cnt, modify(root[i], root[i<span class="number">-1</span>], <span class="number">1</span>, tot, num[i]);</div><div class="line">	<span class="keyword">while</span> (m--) {</div><div class="line">		<span class="keyword">int</span> l, r, k;	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;l, &amp;r, &amp;k);</div><div class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, hash[query(root[l<span class="number">-1</span>], root[r], <span class="number">1</span>, tot, k)]);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Treap"><a href="#Treap" class="headerlink" title="Treap"></a>Treap</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x666E;&#x901A;&#x5E73;&#x8861;&#x6811;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x60A8;&#x9700;&#x8981;&#x5199;&#x4E00;&#x79CD;&#x6570;&#x636E;&#x7ED3;&#x6784;&#xFF08;&#x53EF;&#x53C2;&#x8003;&#x9898;&#x76EE;&#x6807;&#x9898;&#xFF09;&#xFF0C;&#x6765;&#x7EF4;&#x62A4;&#x4E00;&#x4E9B;&#x6570;&#xFF0C;&#x5176;&#x4E2D;&#x9700;&#x8981;&#x63D0;&#x4F9B;&#x4EE5;&#x4E0B;&#x64CD;&#x4F5C;&#xFF1A;<br>&#x63D2;&#x5165;x&#x6570;<br>&#x5220;&#x9664;x&#x6570;(&#x82E5;&#x6709;&#x591A;&#x4E2A;&#x76F8;&#x540C;&#x7684;&#x6570;&#xFF0C;&#x56E0;&#x53EA;&#x5220;&#x9664;&#x4E00;&#x4E2A;)<br>&#x67E5;&#x8BE2;x&#x6570;&#x7684;&#x6392;&#x540D;(&#x82E5;&#x6709;&#x591A;&#x4E2A;&#x76F8;&#x540C;&#x7684;&#x6570;&#xFF0C;&#x56E0;&#x8F93;&#x51FA;&#x6700;&#x5C0F;&#x7684;&#x6392;&#x540D;)<br>&#x67E5;&#x8BE2;&#x6392;&#x540D;&#x4E3A;x&#x7684;&#x6570;<br>&#x6C42;x&#x7684;&#x524D;&#x9A71;(&#x524D;&#x9A71;&#x5B9A;&#x4E49;&#x4E3A;&#x5C0F;&#x4E8E;x&#xFF0C;&#x4E14;&#x6700;&#x5927;&#x7684;&#x6570;)<br>&#x6C42;x&#x7684;&#x540E;&#x7EE7;(&#x540E;&#x7EE7;&#x5B9A;&#x4E49;&#x4E3A;&#x5927;&#x4E8E;x&#xFF0C;&#x4E14;&#x6700;&#x5C0F;&#x7684;&#x6570;)</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x4E3A;n&#xFF0C;&#x8868;&#x793A;&#x64CD;&#x4F5C;&#x7684;&#x4E2A;&#x6570;,&#x4E0B;&#x9762;n&#x884C;&#x6BCF;&#x884C;&#x6709;&#x4E24;&#x4E2A;&#x6570;opt&#x548C;x&#xFF0C;opt&#x8868;&#x793A;&#x64CD;&#x4F5C;&#x7684;&#x5E8F;&#x53F7;(1&lt;=opt&lt;=6)<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x5BF9;&#x4E8E;&#x64CD;&#x4F5C;3,4,5,6&#x6BCF;&#x884C;&#x8F93;&#x51FA;&#x4E00;&#x4E2A;&#x6570;&#xFF0C;&#x8868;&#x793A;&#x5BF9;&#x5E94;&#x7B54;&#x6848;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;&#xFF1A;<br>10<br>1 106465<br>4 1<br>1 317721<br>1 460929<br>1 644985<br>1 84185<br>1 89851<br>6 81968<br>1 492737<br>5 493598<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;&#xFF1A;<br>106465<br>84185<br>492737</p>
<p>&#x8BF4;&#x660E;<br>&#x65F6;&#x7A7A;&#x9650;&#x5236;&#xFF1A;1000ms,128M<br>1.n&#x7684;&#x6570;&#x636E;&#x8303;&#x56F4;&#xFF1A;n&lt;=100000<br>2.&#x6BCF;&#x4E2A;&#x6570;&#x7684;&#x6570;&#x636E;&#x8303;&#x56F4;&#xFF1A;[-1e7,1e7]<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 100000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TNode</span> {</span></div><div class="line">    TNode* s[<span class="number">2</span>];</div><div class="line">    <span class="keyword">int</span> val, k, size;</div><div class="line">    TNode() {}</div><div class="line">    TNode(<span class="keyword">int</span> _val, TNode* _s) {val = _val, s[<span class="number">0</span>] = s[<span class="number">1</span>] = _s, k = rand(), size = <span class="number">1</span>;}</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">updata</span><span class="params">()</span> </span>{size = s[<span class="number">0</span>]-&gt;size+s[<span class="number">1</span>]-&gt;size+<span class="number">1</span>;}</div><div class="line">} nil, tr[MAX_N+<span class="number">5</span>], *null, *root, *cnt;</div><div class="line"><span class="keyword">typedef</span> TNode* P_TNode;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>{</div><div class="line">    srand(<span class="number">19260817</span>);</div><div class="line">    nil = TNode(<span class="number">0</span>, <span class="literal">NULL</span>), null = &amp;nil;</div><div class="line">    null-&gt;s[<span class="number">0</span>] = null-&gt;s[<span class="number">1</span>] = null, null-&gt;size = <span class="number">0</span>;</div><div class="line">    cnt = tr, root = null;</div><div class="line">}</div><div class="line"><span class="function">P_TNode <span class="title">newnode</span><span class="params">(<span class="keyword">int</span> val)</span> </span>{</div><div class="line">    *cnt = TNode(val, null);</div><div class="line">    <span class="keyword">return</span> cnt++;</div><div class="line">}</div><div class="line"><span class="function">P_TNode <span class="title">merge</span><span class="params">(P_TNode a, P_TNode b)</span> </span>{</div><div class="line">    <span class="keyword">if</span> (a == null)    <span class="keyword">return</span> b;</div><div class="line">    <span class="keyword">if</span> (b == null)    <span class="keyword">return</span> a;</div><div class="line">    <span class="keyword">if</span> (a-&gt;k &gt; b-&gt;k) {a-&gt;s[<span class="number">1</span>] = merge(a-&gt;s[<span class="number">1</span>], b), a-&gt;updata(); <span class="keyword">return</span> a;}</div><div class="line">    <span class="keyword">if</span> (a-&gt;k &lt;= b-&gt;k) {b-&gt;s[<span class="number">0</span>] = merge(a, b-&gt;s[<span class="number">0</span>]), b-&gt;updata(); <span class="keyword">return</span> b;}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">split</span><span class="params">(P_TNode v, <span class="keyword">int</span> val, P_TNode &amp;ls, P_TNode &amp;rs)</span> </span>{</div><div class="line">    <span class="keyword">if</span> (v == null) {ls = rs = null; <span class="keyword">return</span>;}</div><div class="line">    <span class="keyword">if</span> (val &lt; v-&gt;val) {rs = v; split(rs-&gt;s[<span class="number">0</span>], val, ls, rs-&gt;s[<span class="number">0</span>]);}</div><div class="line">    <span class="keyword">if</span> (val &gt;= v-&gt;val) {ls = v;    split(ls-&gt;s[<span class="number">1</span>], val, ls-&gt;s[<span class="number">1</span>], rs);}</div><div class="line">    v-&gt;updata();</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> val)</span> </span>{</div><div class="line">    P_TNode ls, rs;</div><div class="line">    split(root, val, ls, rs);</div><div class="line">    root = merge(merge(ls, newnode(val)), rs);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">remove</span><span class="params">(<span class="keyword">int</span> val)</span> </span>{</div><div class="line">    P_TNode ls, mids, rs;</div><div class="line">    split(root, val<span class="number">-1</span>, ls, rs);</div><div class="line">    split(rs, val, mids, rs);</div><div class="line">    root = merge(ls, merge(merge(mids-&gt;s[<span class="number">0</span>], mids-&gt;s[<span class="number">1</span>]), rs));</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_rank</span><span class="params">(<span class="keyword">int</span> val)</span> </span>{</div><div class="line">    P_TNode ls, rs;</div><div class="line">    split(root, val<span class="number">-1</span>, ls, rs);</div><div class="line">    <span class="keyword">int</span> ret = ls-&gt;size+<span class="number">1</span>;</div><div class="line">    root = merge(ls, rs);</div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_kth</span><span class="params">(P_TNode v, <span class="keyword">int</span> k)</span> </span>{</div><div class="line">    <span class="keyword">if</span> (k &lt;= v-&gt;s[<span class="number">0</span>]-&gt;size)    <span class="keyword">return</span> get_kth(v-&gt;s[<span class="number">0</span>], k);</div><div class="line">    <span class="keyword">if</span> (k &gt; v-&gt;s[<span class="number">0</span>]-&gt;size+<span class="number">1</span>)    <span class="keyword">return</span> get_kth(v-&gt;s[<span class="number">1</span>], k-v-&gt;s[<span class="number">0</span>]-&gt;size<span class="number">-1</span>);</div><div class="line">    <span class="keyword">return</span> v-&gt;val;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_nearest</span><span class="params">(P_TNode v, <span class="keyword">int</span> sn)</span> </span>{</div><div class="line">    <span class="keyword">while</span> (v-&gt;s[sn] != null)    v = v-&gt;s[sn];</div><div class="line">    <span class="keyword">return</span> v-&gt;val;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">predecessor</span><span class="params">(<span class="keyword">int</span> val)</span> </span>{</div><div class="line">    P_TNode ls, rs;</div><div class="line">    split(root, val<span class="number">-1</span>, ls, rs);</div><div class="line">	<span class="keyword">int</span> ret = get_nearest(ls, <span class="number">1</span>);</div><div class="line">    root = merge(ls, rs);</div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">successor</span><span class="params">(<span class="keyword">int</span> val)</span> </span>{</div><div class="line">    P_TNode ls, rs;</div><div class="line">    split(root, val, ls, rs);</div><div class="line">    <span class="keyword">int</span> ret = get_nearest(rs, <span class="number">0</span>);</div><div class="line">	root = merge(ls, rs);</div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">    init();</div><div class="line">    <span class="keyword">int</span> n, opt, x;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</div><div class="line">    <span class="keyword">while</span> (n--) {</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;opt, &amp;x);</div><div class="line">        <span class="keyword">if</span> (opt == <span class="number">1</span>)    insert(x);</div><div class="line">        <span class="keyword">if</span> (opt == <span class="number">2</span>)    remove(x);</div><div class="line">        <span class="keyword">if</span> (opt == <span class="number">3</span>)    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, get_rank(x));</div><div class="line">        <span class="keyword">if</span> (opt == <span class="number">4</span>)    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, get_kth(root, x));</div><div class="line">        <span class="keyword">if</span> (opt == <span class="number">5</span>)    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, predecessor(x));</div><div class="line">        <span class="keyword">if</span> (opt == <span class="number">6</span>)    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, successor(x));</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Splay"><a href="#Splay" class="headerlink" title="Splay"></a>Splay</h2><h3 id="Normal"><a href="#Normal" class="headerlink" title="Normal"></a>Normal</h3><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x666E;&#x901A;&#x5E73;&#x8861;&#x6811;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x60A8;&#x9700;&#x8981;&#x5199;&#x4E00;&#x79CD;&#x6570;&#x636E;&#x7ED3;&#x6784;&#xFF08;&#x53EF;&#x53C2;&#x8003;&#x9898;&#x76EE;&#x6807;&#x9898;&#xFF09;&#xFF0C;&#x6765;&#x7EF4;&#x62A4;&#x4E00;&#x4E9B;&#x6570;&#xFF0C;&#x5176;&#x4E2D;&#x9700;&#x8981;&#x63D0;&#x4F9B;&#x4EE5;&#x4E0B;&#x64CD;&#x4F5C;&#xFF1A;<br>&#x63D2;&#x5165;x&#x6570;<br>&#x5220;&#x9664;x&#x6570;(&#x82E5;&#x6709;&#x591A;&#x4E2A;&#x76F8;&#x540C;&#x7684;&#x6570;&#xFF0C;&#x56E0;&#x53EA;&#x5220;&#x9664;&#x4E00;&#x4E2A;)<br>&#x67E5;&#x8BE2;x&#x6570;&#x7684;&#x6392;&#x540D;(&#x82E5;&#x6709;&#x591A;&#x4E2A;&#x76F8;&#x540C;&#x7684;&#x6570;&#xFF0C;&#x56E0;&#x8F93;&#x51FA;&#x6700;&#x5C0F;&#x7684;&#x6392;&#x540D;)<br>&#x67E5;&#x8BE2;&#x6392;&#x540D;&#x4E3A;x&#x7684;&#x6570;<br>&#x6C42;x&#x7684;&#x524D;&#x9A71;(&#x524D;&#x9A71;&#x5B9A;&#x4E49;&#x4E3A;&#x5C0F;&#x4E8E;x&#xFF0C;&#x4E14;&#x6700;&#x5927;&#x7684;&#x6570;)<br>&#x6C42;x&#x7684;&#x540E;&#x7EE7;(&#x540E;&#x7EE7;&#x5B9A;&#x4E49;&#x4E3A;&#x5927;&#x4E8E;x&#xFF0C;&#x4E14;&#x6700;&#x5C0F;&#x7684;&#x6570;)</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x4E3A;n&#xFF0C;&#x8868;&#x793A;&#x64CD;&#x4F5C;&#x7684;&#x4E2A;&#x6570;,&#x4E0B;&#x9762;n&#x884C;&#x6BCF;&#x884C;&#x6709;&#x4E24;&#x4E2A;&#x6570;opt&#x548C;x&#xFF0C;opt&#x8868;&#x793A;&#x64CD;&#x4F5C;&#x7684;&#x5E8F;&#x53F7;(1&lt;=opt&lt;=6)<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x5BF9;&#x4E8E;&#x64CD;&#x4F5C;3,4,5,6&#x6BCF;&#x884C;&#x8F93;&#x51FA;&#x4E00;&#x4E2A;&#x6570;&#xFF0C;&#x8868;&#x793A;&#x5BF9;&#x5E94;&#x7B54;&#x6848;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;&#xFF1A;<br>10<br>1 106465<br>4 1<br>1 317721<br>1 460929<br>1 644985<br>1 84185<br>1 89851<br>6 81968<br>1 492737<br>5 493598<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;&#xFF1A;<br>106465<br>84185<br>492737</p>
<p>&#x8BF4;&#x660E;<br>&#x65F6;&#x7A7A;&#x9650;&#x5236;&#xFF1A;1000ms,128M<br>1.n&#x7684;&#x6570;&#x636E;&#x8303;&#x56F4;&#xFF1A;n&lt;=100000<br>2.&#x6BCF;&#x4E2A;&#x6570;&#x7684;&#x6570;&#x636E;&#x8303;&#x56F4;&#xFF1A;[-1e7,1e7]<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 100000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2147483647</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SplayNode</span> {</span></div><div class="line">	SplayNode *s[<span class="number">2</span>], *fa;</div><div class="line">	<span class="keyword">int</span> val, w, size;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">updata</span><span class="params">()</span></span>;</div><div class="line">} nil;</div><div class="line">SplayNode* null = &amp;nil;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Splay</span> {</span></div><div class="line">	SplayNode tr[MAX_N+<span class="number">5</span>];</div><div class="line">	SplayNode* root;</div><div class="line">	<span class="keyword">int</span> cnt;</div><div class="line">	Splay();</div><div class="line">	<span class="function">SplayNode* <span class="title">newnode</span><span class="params">(<span class="keyword">int</span> _val)</span></span>;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(SplayNode* v, <span class="keyword">bool</span> sn)</span></span>;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(SplayNode* &amp;v)</span></span>;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">splay</span><span class="params">(SplayNode* now, SplayNode* &amp;to)</span></span>;</div><div class="line">	<span class="function">SplayNode* <span class="title">predecessor</span><span class="params">(<span class="keyword">int</span> _val)</span></span>;</div><div class="line">	<span class="function">SplayNode* <span class="title">successor</span><span class="params">(<span class="keyword">int</span> _val)</span></span>;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> _val)</span></span>;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">remove</span><span class="params">(<span class="keyword">int</span> _val)</span></span>;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">get_rank</span><span class="params">(<span class="keyword">int</span> _val)</span></span>;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">get_kth</span><span class="params">(<span class="keyword">int</span> rank)</span></span>;</div><div class="line">} BBST;</div><div class="line"><span class="keyword">void</span> SplayNode::updata() {</div><div class="line">	<span class="keyword">if</span> (!s[<span class="number">1</span>])	<span class="keyword">return</span>;</div><div class="line">	size = s[<span class="number">0</span>]-&gt;size+s[<span class="number">1</span>]-&gt;size+w;</div><div class="line">}</div><div class="line">Splay::Splay() {</div><div class="line">	cnt = <span class="number">0</span>;</div><div class="line">	root = newnode(-INF);</div><div class="line">	root-&gt;s[<span class="number">1</span>] = newnode(INF);</div><div class="line">	root-&gt;s[<span class="number">1</span>]-&gt;fa = root;</div><div class="line">}</div><div class="line">SplayNode* Splay::newnode(<span class="keyword">int</span> _val) {</div><div class="line">	cnt++;</div><div class="line">	tr[cnt].s[<span class="number">0</span>] = null, tr[cnt].s[<span class="number">1</span>] = null, tr[cnt].fa = null;</div><div class="line">	tr[cnt].val = _val, tr[cnt].w = tr[cnt].size = <span class="number">1</span>;</div><div class="line">	<span class="keyword">return</span> &amp;tr[cnt];</div><div class="line">}</div><div class="line"><span class="keyword">void</span> Splay::rotate(SplayNode* v, <span class="keyword">bool</span> sn) {</div><div class="line">	SplayNode* tmp = v-&gt;s[sn^<span class="number">1</span>];</div><div class="line">	v-&gt;s[sn^<span class="number">1</span>] = tmp-&gt;s[sn];</div><div class="line">	tmp-&gt;s[sn] = v;</div><div class="line">	v-&gt;s[sn^<span class="number">1</span>]-&gt;fa = v;</div><div class="line">	tmp-&gt;fa = v-&gt;fa;</div><div class="line">	<span class="keyword">if</span> (tmp-&gt;fa != null)	tmp-&gt;fa-&gt;s[tmp-&gt;fa-&gt;s[<span class="number">1</span>] == v] = tmp;</div><div class="line">	<span class="keyword">else</span>	root = tmp;</div><div class="line">	v-&gt;fa = tmp;</div><div class="line">	v-&gt;updata();</div><div class="line">	tmp-&gt;updata();</div><div class="line">}</div><div class="line"><span class="keyword">void</span> Splay::rotate(SplayNode* &amp;v) {</div><div class="line">	<span class="keyword">bool</span> sn = (v-&gt;fa-&gt;s[<span class="number">0</span>] == v) ? <span class="number">1</span> : <span class="number">0</span>;</div><div class="line">	rotate(v-&gt;fa, sn);</div><div class="line">}</div><div class="line"><span class="keyword">void</span> Splay::splay(SplayNode* now, SplayNode* &amp;to) {</div><div class="line">	<span class="keyword">while</span> (now != to) {</div><div class="line">		<span class="keyword">if</span> (now-&gt;fa == to) {</div><div class="line">			rotate(now);</div><div class="line">		} <span class="keyword">else</span> {</div><div class="line">			<span class="keyword">if</span> ((now-&gt;fa-&gt;s[<span class="number">0</span>] == now) == (now-&gt;fa-&gt;fa-&gt;s[<span class="number">0</span>] == now-&gt;fa))	rotate(now-&gt;fa);</div><div class="line">			<span class="keyword">else</span>	rotate(now);</div><div class="line">			rotate(now);</div><div class="line">		}</div><div class="line">	}</div><div class="line">}</div><div class="line">SplayNode* Splay::predecessor(<span class="keyword">int</span> _val) {</div><div class="line">	SplayNode* now = root;</div><div class="line">	SplayNode* save = root;</div><div class="line">	<span class="keyword">int</span> maxv = -INF;</div><div class="line">	<span class="keyword">for</span> (;;) {</div><div class="line">		<span class="keyword">if</span> (now-&gt;val &lt; _val &amp;&amp; maxv &lt; _val)	maxv = now-&gt;val, save = now;</div><div class="line">		SplayNode* nxt = now-&gt;s[(_val &lt;= now-&gt;val) ? <span class="number">0</span> : <span class="number">1</span>];</div><div class="line">		<span class="keyword">if</span> (nxt == null)	<span class="keyword">return</span> save;</div><div class="line">		now = nxt;</div><div class="line">	}</div><div class="line">}</div><div class="line">SplayNode* Splay::successor(<span class="keyword">int</span> _val) {</div><div class="line">	SplayNode* now = root;</div><div class="line">	SplayNode* save = root;</div><div class="line">	<span class="keyword">int</span> minv = INF;</div><div class="line">	<span class="keyword">for</span> (;;) {</div><div class="line">		<span class="keyword">if</span> (now-&gt;val &gt; _val &amp;&amp; minv &gt; _val)	minv = now-&gt;val, save = now;</div><div class="line">		SplayNode* nxt = now-&gt;s[(_val &lt; now-&gt;val) ? <span class="number">0</span> : <span class="number">1</span>];</div><div class="line">		<span class="keyword">if</span> (nxt == null)	<span class="keyword">return</span> save;</div><div class="line">		now = nxt;</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="keyword">void</span> Splay::insert(<span class="keyword">int</span> _val) {</div><div class="line">	SplayNode* pre = predecessor(_val);</div><div class="line">	SplayNode* suc = successor(_val);</div><div class="line">	splay(pre, root), splay(suc, root-&gt;s[<span class="number">1</span>]);</div><div class="line">	<span class="keyword">if</span> (root-&gt;s[<span class="number">1</span>]-&gt;s[<span class="number">0</span>] == null) {</div><div class="line">		root-&gt;s[<span class="number">1</span>]-&gt;s[<span class="number">0</span>] = newnode(_val);</div><div class="line">		root-&gt;s[<span class="number">1</span>]-&gt;s[<span class="number">0</span>]-&gt;fa = root-&gt;s[<span class="number">1</span>];</div><div class="line">	} <span class="keyword">else</span> {</div><div class="line">		root-&gt;s[<span class="number">1</span>]-&gt;s[<span class="number">0</span>]-&gt;w++;</div><div class="line">		root-&gt;s[<span class="number">1</span>]-&gt;s[<span class="number">0</span>]-&gt;size++;</div><div class="line">	}</div><div class="line">	root-&gt;s[<span class="number">1</span>]-&gt;updata();</div><div class="line">	root-&gt;updata();</div><div class="line">}</div><div class="line"><span class="keyword">void</span> Splay::remove(<span class="keyword">int</span> _val) {</div><div class="line">	SplayNode* pre = predecessor(_val);</div><div class="line">	SplayNode* suc = successor(_val);</div><div class="line">	splay(pre, root), splay(suc, root-&gt;s[<span class="number">1</span>]);</div><div class="line">	root-&gt;s[<span class="number">1</span>]-&gt;s[<span class="number">0</span>]-&gt;w--, root-&gt;s[<span class="number">1</span>]-&gt;s[<span class="number">0</span>]-&gt;size--;</div><div class="line">	<span class="keyword">if</span> (!root-&gt;s[<span class="number">1</span>]-&gt;s[<span class="number">0</span>]-&gt;w)	root-&gt;s[<span class="number">1</span>]-&gt;s[<span class="number">0</span>] = null;</div><div class="line">	root-&gt;s[<span class="number">1</span>]-&gt;updata();</div><div class="line">	root-&gt;updata();</div><div class="line">}</div><div class="line"><span class="keyword">int</span> Splay::get_rank(<span class="keyword">int</span> _val) {</div><div class="line">	SplayNode* pre = predecessor(_val);</div><div class="line">	SplayNode* suc = successor(_val);</div><div class="line">	splay(pre, root), splay(suc, root-&gt;s[<span class="number">1</span>]);</div><div class="line">	<span class="keyword">return</span> root-&gt;size-root-&gt;s[<span class="number">1</span>]-&gt;size;</div><div class="line">}</div><div class="line"><span class="keyword">int</span> Splay::get_kth(<span class="keyword">int</span> rank) {</div><div class="line">	rank++;</div><div class="line">	SplayNode* now = root;</div><div class="line">	<span class="keyword">for</span> (;;) {</div><div class="line">		<span class="keyword">if</span> (rank &lt;= now-&gt;s[<span class="number">0</span>]-&gt;size) {</div><div class="line">			now = now-&gt;s[<span class="number">0</span>];</div><div class="line">		} <span class="keyword">else</span> {</div><div class="line">			rank -= now-&gt;s[<span class="number">0</span>]-&gt;size;</div><div class="line">			<span class="keyword">if</span> (rank &lt;= now-&gt;w)	<span class="keyword">return</span> now-&gt;val;</div><div class="line">			rank -= now-&gt;w;</div><div class="line">			now = now-&gt;s[<span class="number">1</span>];</div><div class="line">		}</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">int</span> n, opt, x;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</div><div class="line">	<span class="keyword">while</span> (n--) {</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;opt, &amp;x);</div><div class="line">		<span class="keyword">if</span> (opt == <span class="number">1</span>)	BBST.insert(x);</div><div class="line">		<span class="keyword">if</span> (opt == <span class="number">2</span>)	BBST.remove(x);</div><div class="line">		<span class="keyword">if</span> (opt == <span class="number">3</span>)	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, BBST.get_rank(x));</div><div class="line">		<span class="keyword">if</span> (opt == <span class="number">4</span>)	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, BBST.get_kth(x));</div><div class="line">		<span class="keyword">if</span> (opt == <span class="number">5</span>)	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, BBST.predecessor(x)-&gt;val);</div><div class="line">		<span class="keyword">if</span> (opt == <span class="number">6</span>)	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, BBST.successor(x)-&gt;val);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h3><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x6587;&#x827A;&#x5E73;&#x8861;&#x6811;</p>
<p>&#x9898;&#x76EE;&#x80CC;&#x666F;<br>&#x8FD9;&#x662F;&#x4E00;&#x9053;&#x7ECF;&#x5178;&#x7684;Splay&#x6A21;&#x677F;&#x9898;&#x2014;&#x2014;&#x6587;&#x827A;&#x5E73;&#x8861;&#x6811;&#x3002;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x60A8;&#x9700;&#x8981;&#x5199;&#x4E00;&#x79CD;&#x6570;&#x636E;&#x7ED3;&#x6784;&#xFF08;&#x53EF;&#x53C2;&#x8003;&#x9898;&#x76EE;&#x6807;&#x9898;&#xFF09;&#xFF0C;&#x6765;&#x7EF4;&#x62A4;&#x4E00;&#x4E2A;&#x6709;&#x5E8F;&#x6570;&#x5217;&#xFF0C;&#x5176;&#x4E2D;&#x9700;&#x8981;&#x63D0;&#x4F9B;&#x4EE5;&#x4E0B;&#x64CD;&#x4F5C;&#xFF1A;&#x7FFB;&#x8F6C;&#x4E00;&#x4E2A;&#x533A;&#x95F4;&#x3002;<br>&#x4F8B;&#x5982;&#x539F;&#x6709;&#x5E8F;&#x5E8F;&#x5217;&#x662F;5 4 3 2 1&#xFF0C;&#x7FFB;&#x8F6C;&#x533A;&#x95F4;&#x662F;[2,4]&#x7684;&#x8BDD;&#xFF0C;&#x7ED3;&#x679C;&#x662F;5 2 3 4 1</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x4E3A;n,m&#xFF0C;n&#x8868;&#x793A;&#x521D;&#x59CB;&#x5E8F;&#x5217;&#x6709;n&#x4E2A;&#x6570;&#xFF0C;&#x8FD9;&#x4E2A;&#x5E8F;&#x5217;&#x4F9D;&#x6B21;&#x662F;(1,2&#x2026;n-1,n)&#xFF0C;m&#x8868;&#x793A;&#x7FFB;&#x8F6C;&#x64CD;&#x4F5C;&#x6B21;&#x6570;<br>&#x63A5;&#x4E0B;&#x6765;m&#x884C;&#x6BCF;&#x884C;&#x4E24;&#x4E2A;&#x6570;[l,r]&#xFF0C;&#x6570;&#x636E;&#x4FDD;&#x8BC1; 1&#x2264;l&#x2264;r&#x2264;n</p>
<p>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x8F93;&#x51FA;&#x4E00;&#x884C;n&#x4E2A;&#x6570;&#x5B57;&#xFF0C;&#x8868;&#x793A;&#x539F;&#x59CB;&#x5E8F;&#x5217;&#x7ECF;&#x8FC7;m&#x6B21;&#x53D8;&#x6362;&#x540E;&#x7684;&#x7ED3;&#x679C;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;#1&#xFF1A;<br>5 3<br>1 3<br>1 3<br>1 4<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;#1&#xFF1A;<br>4 3 2 1 5</p>
<p>&#x8BF4;&#x660E;<br>n,m&#x2264;100000<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 100000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SplayNode</span> {</span>SplayNode *s[<span class="number">2</span>], *fa;	<span class="keyword">int</span> val, size;	<span class="keyword">bool</span> rev;	<span class="function"><span class="keyword">void</span> <span class="title">updata</span><span class="params">()</span></span>;	<span class="function"><span class="keyword">void</span> <span class="title">downtag</span><span class="params">()</span></span>;};</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SplayTree</span> {</span></div><div class="line">	SplayNode* root;	<span class="function">SplayNode* <span class="title">newnode</span><span class="params">(<span class="keyword">int</span> _val)</span></span>;	<span class="function">SplayNode* <span class="title">build</span><span class="params">(SplayNode* v, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(SplayNode* v, <span class="keyword">bool</span> sn)</span></span>;	<span class="function"><span class="keyword">void</span> <span class="title">splay</span><span class="params">(SplayNode* now, SplayNode* to)</span></span>;</div><div class="line">	<span class="function">SplayNode* <span class="title">find_kth</span><span class="params">(SplayNode* v, <span class="keyword">int</span> k)</span></span>;	<span class="function"><span class="keyword">void</span> <span class="title">reverse</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>;	<span class="function"><span class="keyword">void</span> <span class="title">output</span><span class="params">(SplayNode* v, <span class="keyword">int</span> n)</span></span>;</div><div class="line">} BBST;</div><div class="line"><span class="keyword">void</span> SplayNode::updata() {size = (s[<span class="number">0</span>] == <span class="literal">NULL</span> ? <span class="number">0</span> : s[<span class="number">0</span>]-&gt;size)+(s[<span class="number">1</span>] == <span class="literal">NULL</span> ? <span class="number">0</span> : s[<span class="number">1</span>]-&gt;size)+<span class="number">1</span>;}</div><div class="line"><span class="keyword">void</span> SplayNode::downtag() {</div><div class="line">	<span class="keyword">if</span> (!rev)	<span class="keyword">return</span>;	rev = <span class="literal">false</span>, swap(s[<span class="number">0</span>], s[<span class="number">1</span>]);</div><div class="line">	<span class="keyword">if</span> (s[<span class="number">0</span>])	s[<span class="number">0</span>]-&gt;rev ^= <span class="number">1</span>;	<span class="keyword">if</span> (s[<span class="number">1</span>])	s[<span class="number">1</span>]-&gt;rev ^= <span class="number">1</span>;</div><div class="line">}</div><div class="line">SplayNode* SplayTree::newnode(<span class="keyword">int</span> _val) {</div><div class="line">	SplayNode* v = <span class="keyword">new</span> SplayNode;</div><div class="line">	v-&gt;s[<span class="number">0</span>] = v-&gt;s[<span class="number">1</span>] = v-&gt;fa = <span class="literal">NULL</span>;</div><div class="line">	v-&gt;val = _val, v-&gt;size = <span class="number">1</span>, v-&gt;rev = <span class="literal">false</span>;</div><div class="line">	<span class="keyword">return</span> v;</div><div class="line">}</div><div class="line">SplayNode* SplayTree::build(SplayNode* fa, <span class="keyword">int</span> l, <span class="keyword">int</span> r) {</div><div class="line">	<span class="keyword">if</span> (l &gt; r)	<span class="keyword">return</span> <span class="literal">NULL</span>;	<span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>, val = mid<span class="number">-1</span>;</div><div class="line">	SplayNode* v = newnode(val);	v-&gt;fa = fa;</div><div class="line">	v-&gt;s[<span class="number">0</span>] = build(v, l, mid<span class="number">-1</span>), v-&gt;s[<span class="number">1</span>] = build(v, mid+<span class="number">1</span>, r);</div><div class="line">	v-&gt;updata();	<span class="keyword">return</span> v;</div><div class="line">}</div><div class="line"><span class="keyword">void</span> SplayTree::rotate(SplayNode* v, <span class="keyword">bool</span> sn) {</div><div class="line">	SplayNode* tmp = v-&gt;fa;</div><div class="line">	tmp-&gt;s[sn^<span class="number">1</span>] = v-&gt;s[sn], v-&gt;fa = tmp-&gt;fa;</div><div class="line">	<span class="keyword">if</span> (v-&gt;s[sn])	v-&gt;s[sn]-&gt;fa = tmp;</div><div class="line">	<span class="keyword">if</span> (tmp-&gt;fa != <span class="literal">NULL</span>)	tmp-&gt;fa-&gt;s[tmp == tmp-&gt;fa-&gt;s[<span class="number">1</span>]] = v;</div><div class="line">	v-&gt;s[sn] = tmp, tmp-&gt;fa = v, tmp-&gt;updata(), v-&gt;updata();</div><div class="line">}</div><div class="line"><span class="keyword">void</span> SplayTree::splay(SplayNode* now, SplayNode* to) {</div><div class="line">	<span class="keyword">while</span> (now-&gt;fa != to)</div><div class="line">		<span class="keyword">if</span> (now-&gt;fa-&gt;s[<span class="number">0</span>] == now) {</div><div class="line">			<span class="keyword">if</span> (now-&gt;fa-&gt;fa != to &amp;&amp; now-&gt;fa == now-&gt;fa-&gt;fa-&gt;s[<span class="number">0</span>])	rotate(now-&gt;fa, <span class="number">1</span>);</div><div class="line">			rotate(now, <span class="number">1</span>);</div><div class="line">		} <span class="keyword">else</span> {</div><div class="line">			<span class="keyword">if</span> (now-&gt;fa-&gt;fa != to &amp;&amp; now-&gt;fa == now-&gt;fa-&gt;fa-&gt;s[<span class="number">1</span>])	rotate(now-&gt;fa, <span class="number">0</span>);</div><div class="line">			rotate(now, <span class="number">0</span>);</div><div class="line">		}</div><div class="line">	<span class="keyword">if</span> (to == <span class="literal">NULL</span>)	root = now;</div><div class="line">}</div><div class="line">SplayNode* SplayTree::find_kth(SplayNode* v, <span class="keyword">int</span> k) {</div><div class="line">	v-&gt;downtag();	<span class="keyword">int</span> size = v-&gt;s[<span class="number">0</span>] == <span class="literal">NULL</span> ? <span class="number">0</span> : v-&gt;s[<span class="number">0</span>]-&gt;size;</div><div class="line">	<span class="keyword">if</span> (size+<span class="number">1</span> == k)	<span class="keyword">return</span> v;</div><div class="line">	<span class="keyword">if</span> (size &gt;= k)	<span class="keyword">return</span> find_kth(v-&gt;s[<span class="number">0</span>], k);</div><div class="line">	<span class="keyword">return</span> find_kth(v-&gt;s[<span class="number">1</span>], k-size<span class="number">-1</span>);</div><div class="line">}</div><div class="line"><span class="keyword">void</span> SplayTree::reverse(<span class="keyword">int</span> l, <span class="keyword">int</span> r) {</div><div class="line">	SplayNode *nl = find_kth(root, l), *nr = find_kth(root, r+<span class="number">2</span>);</div><div class="line">	splay(nl, <span class="literal">NULL</span>), splay(nr, root);	nr-&gt;s[<span class="number">0</span>]-&gt;rev ^= <span class="number">1</span>;</div><div class="line">}</div><div class="line"><span class="keyword">void</span> SplayTree::output(SplayNode* v, <span class="keyword">int</span> n) {</div><div class="line">	<span class="keyword">if</span> (v == <span class="literal">NULL</span>)	<span class="keyword">return</span>;</div><div class="line">	v-&gt;downtag(), output(v-&gt;s[<span class="number">0</span>], n);</div><div class="line">	<span class="keyword">if</span> (v-&gt;val &gt;= <span class="number">1</span> &amp;&amp; v-&gt;val &lt;= n)	<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, v-&gt;val);</div><div class="line">	output(v-&gt;s[<span class="number">1</span>], n);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">int</span> n, m;	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);	BBST.root = BBST.build(<span class="literal">NULL</span>, <span class="number">1</span>, n+<span class="number">2</span>);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, l, r; i &lt;= m; i++)	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;l, &amp;r), BBST.reverse(l, r);</div><div class="line">	BBST.output(BBST.root, n);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Tree-Chain-Division"><a href="#Tree-Chain-Division" class="headerlink" title="Tree Chain Division"></a>Tree Chain Division</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x6811;&#x94FE;&#x5256;&#x5206;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x5982;&#x9898;&#xFF0C;&#x5DF2;&#x77E5;&#x4E00;&#x68F5;&#x5305;&#x542B;N&#x4E2A;&#x7ED3;&#x70B9;&#x7684;&#x6811;&#xFF08;&#x8FDE;&#x901A;&#x4E14;&#x65E0;&#x73AF;&#xFF09;&#xFF0C;&#x6BCF;&#x4E2A;&#x8282;&#x70B9;&#x4E0A;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x6570;&#x503C;&#xFF0C;&#x9700;&#x8981;&#x652F;&#x6301;&#x4EE5;&#x4E0B;&#x64CD;&#x4F5C;&#xFF1A;<br>&#x64CD;&#x4F5C;1&#xFF1A; &#x683C;&#x5F0F;&#xFF1A; 1 x y z &#x8868;&#x793A;&#x5C06;&#x6811;&#x4ECE;x&#x5230;y&#x7ED3;&#x70B9;&#x6700;&#x77ED;&#x8DEF;&#x5F84;&#x4E0A;&#x6240;&#x6709;&#x8282;&#x70B9;&#x7684;&#x503C;&#x90FD;&#x52A0;&#x4E0A;z<br>&#x64CD;&#x4F5C;2&#xFF1A; &#x683C;&#x5F0F;&#xFF1A; 2 x y &#x8868;&#x793A;&#x6C42;&#x6811;&#x4ECE;x&#x5230;y&#x7ED3;&#x70B9;&#x6700;&#x77ED;&#x8DEF;&#x5F84;&#x4E0A;&#x6240;&#x6709;&#x8282;&#x70B9;&#x7684;&#x503C;&#x4E4B;&#x548C;<br>&#x64CD;&#x4F5C;3&#xFF1A; &#x683C;&#x5F0F;&#xFF1A; 3 x z &#x8868;&#x793A;&#x5C06;&#x4EE5;x&#x4E3A;&#x6839;&#x8282;&#x70B9;&#x7684;&#x5B50;&#x6811;&#x5185;&#x6240;&#x6709;&#x8282;&#x70B9;&#x503C;&#x90FD;&#x52A0;&#x4E0A;z<br>&#x64CD;&#x4F5C;4&#xFF1A; &#x683C;&#x5F0F;&#xFF1A; 4 x &#x8868;&#x793A;&#x6C42;&#x4EE5;x&#x4E3A;&#x6839;&#x8282;&#x70B9;&#x7684;&#x5B50;&#x6811;&#x5185;&#x6240;&#x6709;&#x8282;&#x70B9;&#x503C;&#x4E4B;&#x548C;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x5305;&#x542B;4&#x4E2A;&#x6B63;&#x6574;&#x6570;N&#x3001;M&#x3001;R&#x3001;P&#xFF0C;&#x5206;&#x522B;&#x8868;&#x793A;&#x6811;&#x7684;&#x7ED3;&#x70B9;&#x4E2A;&#x6570;&#x3001;&#x64CD;&#x4F5C;&#x4E2A;&#x6570;&#x3001;&#x6839;&#x8282;&#x70B9;&#x5E8F;&#x53F7;&#x548C;&#x53D6;&#x6A21;&#x6570;&#xFF08;&#x5373;&#x6240;&#x6709;&#x7684;&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#x5747;&#x5BF9;&#x6B64;&#x53D6;&#x6A21;&#xFF09;&#x3002;<br>&#x63A5;&#x4E0B;&#x6765;&#x4E00;&#x884C;&#x5305;&#x542B;N&#x4E2A;&#x975E;&#x8D1F;&#x6574;&#x6570;&#xFF0C;&#x5206;&#x522B;&#x4F9D;&#x6B21;&#x8868;&#x793A;&#x5404;&#x4E2A;&#x8282;&#x70B9;&#x4E0A;&#x521D;&#x59CB;&#x7684;&#x6570;&#x503C;&#x3002;<br>&#x63A5;&#x4E0B;&#x6765;N-1&#x884C;&#x6BCF;&#x884C;&#x5305;&#x542B;&#x4E24;&#x4E2A;&#x6574;&#x6570;x&#x3001;y&#xFF0C;&#x8868;&#x793A;&#x70B9;x&#x548C;&#x70B9;y&#x4E4B;&#x95F4;&#x8FDE;&#x6709;&#x4E00;&#x6761;&#x8FB9;&#xFF08;&#x4FDD;&#x8BC1;&#x65E0;&#x73AF;&#x4E14;&#x8FDE;&#x901A;&#xFF09;<br>&#x63A5;&#x4E0B;&#x6765;M&#x884C;&#x6BCF;&#x884C;&#x5305;&#x542B;&#x82E5;&#x5E72;&#x4E2A;&#x6B63;&#x6574;&#x6570;&#xFF0C;&#x6BCF;&#x884C;&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;&#xFF0C;&#x683C;&#x5F0F;&#x5982;&#x4E0B;&#xFF1A;<br>&#x64CD;&#x4F5C;1&#xFF1A; 1 x y z<br>&#x64CD;&#x4F5C;2&#xFF1A; 2 x y<br>&#x64CD;&#x4F5C;3&#xFF1A; 3 x z<br>&#x64CD;&#x4F5C;4&#xFF1A; 4 x<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x8F93;&#x51FA;&#x5305;&#x542B;&#x82E5;&#x5E72;&#x884C;&#xFF0C;&#x5206;&#x522B;&#x4F9D;&#x6B21;&#x8868;&#x793A;&#x6BCF;&#x4E2A;&#x64CD;&#x4F5C;2&#x6216;&#x64CD;&#x4F5C;4&#x6240;&#x5F97;&#x7684;&#x7ED3;&#x679C;&#xFF08;&#x5BF9;P&#x53D6;&#x6A21;&#xFF09;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;&#xFF1A;<br>5 5 2 24<br>7 3 7 8 0<br>1 2<br>1 5<br>3 1<br>4 1<br>3 4 2<br>3 2 2<br>4 5<br>1 5 1 3<br>2 1 3<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;&#xFF1A;<br>2<br>21<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 100000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m, r, p, ind;</div><div class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; G[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="keyword">int</span> c[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="keyword">int</span> dep[MAX_N+<span class="number">5</span>], fa[MAX_N+<span class="number">5</span>], size[MAX_N+<span class="number">5</span>], son[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="keyword">int</span> top[MAX_N+<span class="number">5</span>], dfn[MAX_N+<span class="number">5</span>], last[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="keyword">int</span> seg[(MAX_N&lt;&lt;<span class="number">2</span>)+<span class="number">5</span>], tag[(MAX_N&lt;&lt;<span class="number">2</span>)+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS1</span><span class="params">(<span class="keyword">int</span> u)</span> </span>{</div><div class="line">	size[u] = <span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[u].size(); i++) {</div><div class="line">		<span class="keyword">int</span> v = G[u][i];</div><div class="line">		<span class="keyword">if</span> (v == fa[u])	<span class="keyword">continue</span>;</div><div class="line">		dep[v] = dep[u]+<span class="number">1</span>;</div><div class="line">		fa[v] = u;</div><div class="line">		DFS1(v);</div><div class="line">		size[u] += size[v];</div><div class="line">		<span class="keyword">if</span> (!son[u] || size[son[u]] &lt; size[v])	son[u] = v;</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS2</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> tp)</span> </span>{</div><div class="line">	top[u] = tp, dfn[u] = ++ind;</div><div class="line">	<span class="keyword">if</span> (son[u])	DFS2(son[u], tp);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[u].size(); i++) {</div><div class="line">		<span class="keyword">int</span> v = G[u][i];</div><div class="line">		<span class="keyword">if</span> (v == fa[u] || v == son[u])	<span class="keyword">continue</span>;</div><div class="line">		DFS2(v, v);</div><div class="line">	}</div><div class="line">	last[u] = ind;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">updata</span><span class="params">(<span class="keyword">int</span> v)</span> </span>{seg[v] = (seg[v&lt;&lt;<span class="number">1</span>]+seg[v&lt;&lt;<span class="number">1</span>|<span class="number">1</span>])%p;}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">downtag</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (!tag[v])	<span class="keyword">return</span>;</div><div class="line">	<span class="keyword">int</span> mid = s+t&gt;&gt;<span class="number">1</span>;</div><div class="line">	seg[v&lt;&lt;<span class="number">1</span>] = (seg[v&lt;&lt;<span class="number">1</span>]+tag[v]*(mid-s+<span class="number">1</span>))%p;</div><div class="line">	seg[v&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = (seg[v&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]+tag[v]*(t-mid))%p;</div><div class="line">	tag[v&lt;&lt;<span class="number">1</span>] = (tag[v&lt;&lt;<span class="number">1</span>]+tag[v])%p;</div><div class="line">	tag[v&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = (tag[v&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]+tag[v])%p;</div><div class="line">	tag[v] = <span class="number">0</span>;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (s &gt;= l &amp;&amp; t &lt;= r) {seg[v] = (seg[v]+x*(t-s+<span class="number">1</span>))%p, tag[v] = (tag[v]+x)%p;	<span class="keyword">return</span>;}</div><div class="line">	downtag(v, s, t);</div><div class="line">	<span class="keyword">int</span> mid = s+t&gt;&gt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span> (l &lt;= mid)	modify(v&lt;&lt;<span class="number">1</span>, s, mid, l, r, x);</div><div class="line">	<span class="keyword">if</span> (r &gt;= mid+<span class="number">1</span>)	modify(v&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, t, l, r, x);</div><div class="line">	updata(v);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (s &gt;= l &amp;&amp; t &lt;= r)	<span class="keyword">return</span> seg[v];</div><div class="line">	downtag(v, s, t);</div><div class="line">	<span class="keyword">int</span> mid = s+t&gt;&gt;<span class="number">1</span>, ret = <span class="number">0</span>;</div><div class="line">	<span class="keyword">if</span> (l &lt;= mid)	ret = (ret+query(v&lt;&lt;<span class="number">1</span>, s, mid, l, r))%p;</div><div class="line">	<span class="keyword">if</span> (r &gt;= mid+<span class="number">1</span>)	ret = (ret+query(v&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, t, l, r))%p;</div><div class="line">	updata(v);</div><div class="line">	<span class="keyword">return</span> ret;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve1</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span> </span>{</div><div class="line">	<span class="keyword">while</span> (top[x] != top[y]) {</div><div class="line">		<span class="keyword">if</span> (dep[top[x]] &lt; dep[top[y]])	swap(x, y);</div><div class="line">		modify(<span class="number">1</span>, <span class="number">1</span>, n, dfn[top[x]], dfn[x], z);</div><div class="line">		x = fa[top[x]];</div><div class="line">	}</div><div class="line">	modify(<span class="number">1</span>, <span class="number">1</span>, n, min(dfn[x], dfn[y]), max(dfn[x], dfn[y]), z);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve2</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>{</div><div class="line">	<span class="keyword">int</span> ret = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span> (top[x] != top[y]) {</div><div class="line">		<span class="keyword">if</span> (dep[top[x]] &lt; dep[top[y]])	swap(x, y);</div><div class="line">		ret = (ret+query(<span class="number">1</span>, <span class="number">1</span>, n, dfn[top[x]], dfn[x]))%p;</div><div class="line">		x = fa[top[x]];</div><div class="line">	}</div><div class="line">	ret = (ret+query(<span class="number">1</span>, <span class="number">1</span>, n, min(dfn[x], dfn[y]), max(dfn[x], dfn[y])))%p;</div><div class="line">	<span class="keyword">return</span> ret;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve3</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> z)</span> </span>{modify(<span class="number">1</span>, <span class="number">1</span>, n, dfn[x], last[x], z);}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve4</span><span class="params">(<span class="keyword">int</span> x)</span> </span>{<span class="keyword">return</span> query(<span class="number">1</span>, <span class="number">1</span>, n, dfn[x], last[x]);}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;r, &amp;p);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;c[i]);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) {</div><div class="line">		<span class="keyword">int</span> u, v;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</div><div class="line">		G[u].push_back(v);</div><div class="line">		G[v].push_back(u);</div><div class="line">	}</div><div class="line">	DFS1(r);</div><div class="line">	DFS2(r, r);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	modify(<span class="number">1</span>, <span class="number">1</span>, n, dfn[i], dfn[i], c[i]);</div><div class="line">	<span class="keyword">while</span> (m--) {</div><div class="line">		<span class="keyword">int</span> opt;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;opt);</div><div class="line">		<span class="keyword">if</span> (opt == <span class="number">1</span>) {</div><div class="line">			<span class="keyword">int</span> x, y, z;</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;x, &amp;y, &amp;z);</div><div class="line">			solve1(x, y, z);</div><div class="line">		}</div><div class="line">		<span class="keyword">if</span> (opt == <span class="number">2</span>) {</div><div class="line">			<span class="keyword">int</span> x, y;</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;x, &amp;y);</div><div class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, solve2(x, y));</div><div class="line">		}</div><div class="line">		<span class="keyword">if</span> (opt == <span class="number">3</span>) {</div><div class="line">			<span class="keyword">int</span> x, z;</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;x, &amp;z);</div><div class="line">			solve3(x, z);</div><div class="line">		}</div><div class="line">		<span class="keyword">if</span> (opt == <span class="number">4</span>) {</div><div class="line">			<span class="keyword">int</span> x;</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</div><div class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, solve4(x));</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h1 id="String"><a href="#String" class="headerlink" title="String"></a>String</h1><h2 id="KMP"><a href="#KMP" class="headerlink" title="KMP"></a>KMP</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;KMP&#x5B57;&#x7B26;&#x4E32;&#x5339;&#x914D;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x5982;&#x9898;&#xFF0C;&#x7ED9;&#x51FA;&#x4E24;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;s1&#x548C;s2&#xFF0C;&#x5176;&#x4E2D;s2&#x4E3A;s1&#x7684;&#x5B50;&#x4E32;&#xFF0C;&#x6C42;&#x51FA;s2&#x5728;s1&#x4E2D;&#x6240;&#x6709;&#x51FA;&#x73B0;&#x7684;&#x4F4D;&#x7F6E;&#x3002;<br>&#x4E3A;&#x4E86;&#x51CF;&#x5C11;&#x9A97;&#x5206;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x8FD8;&#x8981;&#x8F93;&#x51FA;&#x5B50;&#x4E32;&#x7684;&#x524D;&#x7F00;&#x6570;&#x7EC4;next&#x3002; </p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x4E3A;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5373;&#x4E3A;s1&#xFF08;&#x4EC5;&#x5305;&#x542B;&#x5927;&#x5199;&#x5B57;&#x6BCD;&#xFF09;<br>&#x7B2C;&#x4E8C;&#x884C;&#x4E3A;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5373;&#x4E3A;s2&#xFF08;&#x4EC5;&#x5305;&#x542B;&#x5927;&#x5199;&#x5B57;&#x6BCD;&#xFF09;<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x82E5;&#x5E72;&#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#xFF0C;&#x8868;&#x793A;s2&#x5728;s1&#x4E2D;&#x51FA;&#x73B0;&#x7684;&#x4F4D;&#x7F6E;<br>&#x63A5;&#x4E0B;&#x6765;1&#x884C;&#xFF0C;&#x5305;&#x62EC;length(s2)&#x4E2A;&#x6574;&#x6570;&#xFF0C;&#x8868;&#x793A;&#x524D;&#x7F00;&#x6570;&#x7EC4;next[i]&#x7684;&#x503C;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;&#xFF1A;<br>ABABABC<br>ABA<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;&#xFF1A;<br>1<br>3<br>0 0 1 </p>
<p>&#x8BF4;&#x660E;<br>&#x65F6;&#x7A7A;&#x9650;&#x5236;&#xFF1A;1000ms&#xFF0C;128M<br>&#x6570;&#x636E;&#x89C4;&#x6A21;&#xFF1A;<br>&#x8BBE;s1&#x957F;&#x5EA6;&#x4E3A;N&#xFF0C;s2&#x957F;&#x5EA6;&#x4E3A;M<br>&#x5BF9;&#x4E8E;30%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=15&#xFF0C;M&lt;=5<br>&#x5BF9;&#x4E8E;70%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=10000&#xFF0C;M&lt;=100<br>&#x5BF9;&#x4E8E;100%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=1000000&#xFF0C;M&lt;=1000<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_M 1000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> next[MAX_M];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">CalcNext</span><span class="params">(<span class="built_in">string</span>&amp; s)</span> </span>{</div><div class="line">	<span class="keyword">int</span> m = s.length();</div><div class="line">	<span class="keyword">int</span> begin = <span class="number">1</span>, matched = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span> (begin+matched &lt; m) {</div><div class="line">		<span class="keyword">if</span> (s[begin+matched] == s[matched]) {</div><div class="line">			matched++;</div><div class="line">			next[begin+matched<span class="number">-1</span>] = matched;</div><div class="line">		} <span class="keyword">else</span> {</div><div class="line">			<span class="keyword">if</span> (matched == <span class="number">0</span>) {</div><div class="line">				begin++;</div><div class="line">			} <span class="keyword">else</span> {</div><div class="line">				begin += matched-next[matched<span class="number">-1</span>];</div><div class="line">				matched = next[matched<span class="number">-1</span>];</div><div class="line">			}</div><div class="line">		}</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">KMP</span><span class="params">(<span class="built_in">string</span>&amp; T, <span class="built_in">string</span>&amp; P)</span> </span>{</div><div class="line">	<span class="keyword">int</span> n = T.length(), m = P.length();</div><div class="line">	<span class="keyword">int</span> begin = <span class="number">0</span>, matched = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span> (begin &lt;= n-m) {</div><div class="line">		<span class="keyword">if</span> (matched &lt; m &amp;&amp; T[begin+matched] == P[matched]) {</div><div class="line">			matched++;</div><div class="line">			<span class="keyword">if</span> (matched == m) {</div><div class="line">				<span class="built_in">cout</span> &lt;&lt; begin+<span class="number">1</span> &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">			}</div><div class="line">		} <span class="keyword">else</span> {</div><div class="line">			<span class="keyword">if</span> (matched == <span class="number">0</span>) {</div><div class="line">				begin++;</div><div class="line">			} <span class="keyword">else</span> {</div><div class="line">				begin += matched-next[matched<span class="number">-1</span>];</div><div class="line">				matched = next[matched<span class="number">-1</span>];</div><div class="line">			}</div><div class="line">		}</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">string</span> s1, s2;</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; s1 &gt;&gt; s2;</div><div class="line">	CalcNext(s2);</div><div class="line">	KMP(s1, s2);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s2.length(); i++) {</div><div class="line">		<span class="built_in">cout</span> &lt;&lt; next[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Manacher"><a href="#Manacher" class="headerlink" title="Manacher"></a>Manacher</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;manacher&#x7B97;&#x6CD5;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;&#x53EA;&#x7531;&#x5C0F;&#x5199;&#x82F1;&#x6587;&#x5B57;&#x7B26;a,b,c&#x2026;y,z&#x7EC4;&#x6210;&#x7684;&#x5B57;&#x7B26;&#x4E32;S,&#x6C42;S&#x4E2D;&#x6700;&#x957F;&#x56DE;&#x6587;&#x4E32;&#x7684;&#x957F;&#x5EA6;.<br>&#x5B57;&#x7B26;&#x4E32;&#x957F;&#x5EA6;&#x4E3A;n</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x4E00;&#x884C;&#x5C0F;&#x5199;&#x82F1;&#x6587;&#x5B57;&#x7B26;a,b,c&#x2026;y,z&#x7EC4;&#x6210;&#x7684;&#x5B57;&#x7B26;&#x4E32;S</p>
<p>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x8868;&#x793A;&#x7B54;&#x6848;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;#1&#xFF1A;<br>aaa<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;#1&#xFF1A;<br>3</p>
<p>&#x8BF4;&#x660E;<br>&#x5B57;&#x7B26;&#x4E32;&#x957F;&#x5EA6;len &lt;= 11000000<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_L 11000000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">char</span> s[MAX_L*<span class="number">2</span>+<span class="number">5</span>];</div><div class="line"><span class="keyword">int</span> f[MAX_L*<span class="number">2</span>+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">manacher</span> <span class="params">(<span class="keyword">char</span>* s0)</span> </span>{</div><div class="line">	<span class="keyword">int</span> len = <span class="built_in">strlen</span>(s0);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++)	s[i*<span class="number">2</span>+<span class="number">1</span>] = <span class="string">&apos;#&apos;</span>, s[i*<span class="number">2</span>+<span class="number">2</span>] = s0[i];</div><div class="line">	s[len = len*<span class="number">2</span>+<span class="number">1</span>] = <span class="string">&apos;#&apos;</span>;</div><div class="line">	<span class="keyword">int</span> pos = <span class="number">0</span>, r = <span class="number">0</span>, ret = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len; i++) {</div><div class="line">		f[i] = (i &lt; r) ? min(f[<span class="number">2</span>*pos-i], r-i) : <span class="number">1</span>;</div><div class="line">		<span class="keyword">while</span> (i-f[i] &gt;= <span class="number">1</span> &amp;&amp; i+f[i] &lt;= len &amp;&amp; s[i-f[i]] == s[i+f[i]])	f[i]++;</div><div class="line">		<span class="keyword">if</span> (i+f[i] &gt; r)	pos = i, r = i+f[i];</div><div class="line">		ret = max(ret, f[i]<span class="number">-1</span>);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> ret;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">char</span> s0[MAX_L+<span class="number">5</span>];	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s0);</div><div class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, manacher(s0));</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Aho-Corasick-Automation"><a href="#Aho-Corasick-Automation" class="headerlink" title="Aho-Corasick Automation"></a>Aho-Corasick Automation</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;AC&#x81EA;&#x52A8;&#x673A;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x6709;N&#x4E2A;&#x7531;&#x5C0F;&#x5199;&#x5B57;&#x6BCD;&#x7EC4;&#x6210;&#x7684;&#x6A21;&#x5F0F;&#x4E32;&#x4EE5;&#x53CA;&#x4E00;&#x4E2A;&#x6587;&#x672C;&#x4E32;T&#x3002;&#x6BCF;&#x4E2A;&#x6A21;&#x5F0F;&#x4E32;&#x53EF;&#x80FD;&#x4F1A;&#x5728;&#x6587;&#x672C;&#x4E32;&#x4E2D;&#x51FA;&#x73B0;&#x591A;&#x6B21;&#x3002;&#x4F60;&#x9700;&#x8981;&#x627E;&#x51FA;&#x54EA;&#x4E9B;&#x6A21;&#x5F0F;&#x4E32;&#x5728;&#x6587;&#x672C;&#x4E32;T&#x4E2D;&#x51FA;&#x73B0;&#x7684;&#x6B21;&#x6570;&#x6700;&#x591A;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x8F93;&#x5165;&#x542B;&#x591A;&#x7EC4;&#x6570;&#x636E;&#x3002;<br>&#x6BCF;&#x7EC4;&#x6570;&#x636E;&#x7684;&#x7B2C;&#x4E00;&#x884C;&#x4E3A;&#x4E00;&#x4E2A;&#x6B63;&#x6574;&#x6570;N&#xFF0C;&#x8868;&#x793A;&#x5171;&#x6709;N&#x4E2A;&#x6A21;&#x5F0F;&#x4E32;&#xFF0C;1&#x2264;N&#x2264;150&#x3002;<br>&#x63A5;&#x4E0B;&#x53BB;N&#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x4E00;&#x4E2A;&#x957F;&#x5EA6;&#x5C0F;&#x4E8E;&#x7B49;&#x4E8E;70&#x7684;&#x6A21;&#x5F0F;&#x4E32;&#x3002;<br>&#x4E0B;&#x4E00;&#x884C;&#x662F;&#x4E00;&#x4E2A;&#x957F;&#x5EA6;&#x5C0F;&#x4E8E;&#x7B49;&#x4E8E;1e6&#x7684;&#x6587;&#x672C;&#x4E32;T&#x3002;<br>&#x8F93;&#x5165;&#x7ED3;&#x675F;&#x6807;&#x5FD7;&#x4E3A;N=0&#x3002;<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x5BF9;&#x4E8E;&#x6BCF;&#x7EC4;&#x6570;&#x636E;&#xFF0C;&#x7B2C;&#x4E00;&#x884C;&#x8F93;&#x51FA;&#x6A21;&#x5F0F;&#x4E32;&#x6700;&#x591A;&#x51FA;&#x73B0;&#x7684;&#x6B21;&#x6570;&#xFF0C;&#x63A5;&#x4E0B;&#x53BB;&#x82E5;&#x5E72;&#x884C;&#x6BCF;&#x884C;&#x8F93;&#x51FA;&#x4E00;&#x4E2A;&#x51FA;&#x73B0;&#x6B21;&#x6570;&#x6700;&#x591A;&#x7684;&#x6A21;&#x5F0F;&#x4E32;&#xFF0C;&#x6309;&#x8F93;&#x5165;&#x987A;&#x5E8F;&#x6392;&#x5217;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;#1&#xFF1A;<br>2<br>aba<br>bab<br>ababababac<br>6<br>beta<br>alpha<br>haha<br>delta<br>dede<br>tata<br>dedeltalphahahahototatalpha<br>0<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;#1&#xFF1A;<br>4<br>aba<br>2<br>alpha<br>haha<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> DICNUM 26</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_LETTER 10500</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_LENGTH 1000000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">char</span> P[<span class="number">155</span>][<span class="number">75</span>], T[MAX_LENGTH+<span class="number">5</span>];</div><div class="line"><span class="keyword">int</span> root = <span class="number">1</span>, cnt, trie[MAX_LETTER+<span class="number">5</span>][DICNUM], fail[MAX_LETTER+<span class="number">5</span>], end[MAX_LETTER+<span class="number">5</span>], tot[<span class="number">155</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">memset</span>(P, <span class="number">0</span>, <span class="keyword">sizeof</span>(P)), <span class="built_in">memset</span>(T, <span class="number">0</span>, <span class="keyword">sizeof</span>(T)), <span class="built_in">memset</span>(tot, <span class="number">0</span>, <span class="keyword">sizeof</span>(tot));</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= cnt; i++)	<span class="built_in">memset</span>(trie[i], <span class="number">0</span>, <span class="keyword">sizeof</span>(trie[i])), fail[i] = end[i] = <span class="number">0</span>;	cnt = <span class="number">1</span>;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">char</span> s[])</span> </span>{</div><div class="line">	<span class="keyword">int</span> cur = <span class="number">1</span>, len = <span class="built_in">strlen</span>(s);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; cur = trie[cur][s[i++]-<span class="string">&apos;a&apos;</span>])</div><div class="line">		<span class="keyword">if</span> (!trie[cur][s[i]-<span class="string">&apos;a&apos;</span>])	trie[cur][s[i]-<span class="string">&apos;a&apos;</span>] = ++cnt;</div><div class="line">	end[cur] = id;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">SetFail</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; que;	que.push(root);</div><div class="line">	<span class="keyword">while</span> (!que.empty()) {</div><div class="line">		<span class="keyword">int</span> u = que.front();	que.pop();</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; DICNUM; i++)</div><div class="line">			<span class="keyword">if</span> (trie[u][i])	fail[trie[u][i]] = trie[fail[u]][i], que.push(trie[u][i]);</div><div class="line">			<span class="keyword">else</span> trie[u][i] = trie[fail[u]][i];</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">query</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">int</span> cur = root, index, len = <span class="built_in">strlen</span>(T);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) {</div><div class="line">		index = T[i]-<span class="string">&apos;a&apos;</span>;</div><div class="line">		<span class="keyword">while</span> (!trie[cur][index])	cur = fail[cur];</div><div class="line">		cur = trie[cur][index];</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = cur; j; j = fail[j])	tot[end[j]]++;</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">int</span> n;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; DICNUM; i++)	trie[<span class="number">0</span>][i] = root;</div><div class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n) &amp;&amp; n) {</div><div class="line">		init();</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, P[i]), insert(i, P[i]);</div><div class="line">		SetFail(), <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, T), query();</div><div class="line">		<span class="keyword">int</span> ans = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	ans = max(ans, tot[i]);</div><div class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="keyword">if</span> (tot[i] == ans)	<span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, P[i]);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Hash-Table"><a href="#Hash-Table" class="headerlink" title="Hash Table"></a>Hash Table</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x5B57;&#x7B26;&#x4E32;&#x54C8;&#x5E0C;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x5982;&#x9898;&#xFF0C;&#x7ED9;&#x5B9A;N&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF08;&#x7B2C;i&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x957F;&#x5EA6;&#x4E3A;Mi&#xFF0C;&#x5B57;&#x7B26;&#x4E32;&#x5185;&#x5305;&#x542B;&#x6570;&#x5B57;&#x3001;&#x5927;&#x5C0F;&#x5199;&#x5B57;&#x6BCD;&#xFF0C;&#x5927;&#x5C0F;&#x5199;&#x654F;&#x611F;&#xFF09;&#xFF0C;&#x8BF7;&#x6C42;&#x51FA;N&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x5171;&#x6709;&#x591A;&#x5C11;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x6574;&#x6570;N&#xFF0C;&#x4E3A;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x4E2A;&#x6570;&#x3002;<br>&#x63A5;&#x4E0B;&#x6765;N&#x884C;&#x6BCF;&#x884C;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x4E3A;&#x6240;&#x63D0;&#x4F9B;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002;<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x8F93;&#x51FA;&#x5305;&#x542B;&#x4E00;&#x884C;&#xFF0C;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#xFF0C;&#x4E3A;&#x4E0D;&#x540C;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x4E2A;&#x6570;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;&#xFF1A;<br>5<br>abc<br>aaaa<br>abc<br>abcc<br>12345<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;&#xFF1A;<br>4</p>
<p>&#x8BF4;&#x660E;<br>&#x65F6;&#x7A7A;&#x9650;&#x5236;&#xFF1A;1000ms,128M<br>&#x6570;&#x636E;&#x89C4;&#x6A21;&#xFF1A;<br>&#x5BF9;&#x4E8E;30%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=10&#xFF0C;Mi&#x2248;6&#xFF0C;Mmax&lt;=15;<br>&#x5BF9;&#x4E8E;70%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=1000&#xFF0C;Mi&#x2248;100&#xFF0C;Mmax&lt;=150<br>&#x5BF9;&#x4E8E;100%&#x7684;&#x6570;&#x636E;&#xFF1A;N&lt;=10000&#xFF0C;Mi&#x2248;1000&#xFF0C;Mmax&lt;=1500</p>
<p>&#x6837;&#x4F8B;&#x8BF4;&#x660E;&#xFF1A;<br>&#x6837;&#x4F8B;&#x4E2D;&#x7B2C;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;(abc)&#x548C;&#x7B2C;&#x4E09;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;(abc)&#x662F;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x6240;&#x63D0;&#x4F9B;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x96C6;&#x5408;&#x4E3A;{aaaa,abc,abcc,12345}&#xFF0C;&#x6545;&#x5171;&#x8BA1;4&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002;<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> size 15000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, cnt = <span class="number">0</span>;</div><div class="line"><span class="built_in">string</span> tmp;</div><div class="line"><span class="built_in">string</span> hash[size];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="built_in">string</span>&amp; index)</span> </span>{</div><div class="line">	<span class="keyword">int</span> ret = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; index.length(); i++) {</div><div class="line">		ret = (ret*<span class="number">256</span>+index[i]+<span class="number">128</span>)%size;</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> ret;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">search</span><span class="params">(<span class="built_in">string</span>&amp; index, <span class="keyword">int</span>&amp; pos)</span> </span>{</div><div class="line">	pos = calc(index);</div><div class="line">	<span class="keyword">while</span> (hash[pos] != <span class="string">&quot;&quot;</span> &amp;&amp; hash[pos] != index) {</div><div class="line">		pos = (pos+<span class="number">1</span>)%size;</div><div class="line">	}</div><div class="line">	<span class="keyword">if</span> (hash[pos] == index) {</div><div class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">	} <span class="keyword">else</span> {</div><div class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">insert</span><span class="params">(<span class="built_in">string</span>&amp; index)</span> </span>{</div><div class="line">	<span class="keyword">int</span> pos;</div><div class="line">	<span class="keyword">if</span> (search(index, pos)) {</div><div class="line">		<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	} <span class="keyword">else</span> {</div><div class="line">		hash[pos] = index;</div><div class="line">		<span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; n;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) {</div><div class="line">		<span class="built_in">cin</span> &gt;&gt; tmp;</div><div class="line">		cnt += insert(tmp);</div><div class="line">	}</div><div class="line">	<span class="built_in">cout</span> &lt;&lt; cnt &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Suffix-Array"><a href="#Suffix-Array" class="headerlink" title="Suffix Array"></a>Suffix Array</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x540E;&#x7F00;&#x6392;&#x5E8F;</p>
<p>&#x9898;&#x76EE;&#x80CC;&#x666F;<br>&#x8FD9;&#x662F;&#x4E00;&#x9053;&#x6A21;&#x677F;&#x9898;&#x3002;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x8BFB;&#x5165;&#x4E00;&#x4E2A;&#x957F;&#x5EA6;&#x4E3A;n&#x7684;&#x7531;&#x5927;&#x5C0F;&#x5199;&#x82F1;&#x6587;&#x5B57;&#x6BCD;&#x6216;&#x6570;&#x5B57;&#x7EC4;&#x6210;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x8BF7;&#x628A;&#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x6240;&#x6709;&#x975E;&#x7A7A;&#x540E;&#x7F00;&#x6309;&#x5B57;&#x5178;&#x5E8F;&#x4ECE;&#x5C0F;&#x5230;&#x5927;&#x6392;&#x5E8F;&#xFF0C;&#x7136;&#x540E;&#x6309;&#x987A;&#x5E8F;&#x8F93;&#x51FA;&#x540E;&#x7F00;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x5728;&#x539F;&#x4E32;&#x4E2D;&#x7684;&#x4F4D;&#x7F6E;&#x3002;&#x4F4D;&#x7F6E;&#x7F16;&#x53F7;&#x4E3A;1&#x5230;n&#x3002;<br>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x4E00;&#x884C;&#x4E00;&#x4E2A;&#x957F;&#x5EA6;&#x4E3A;n&#x7684;&#x4EC5;&#x5305;&#x542B;&#x5927;&#x5C0F;&#x5199;&#x82F1;&#x6587;&#x5B57;&#x6BCD;&#x6216;&#x6570;&#x5B57;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002;<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x4E00;&#x884C;&#xFF0C;&#x5171;n&#x4E2A;&#x6574;&#x6570;&#xFF0C;&#x8868;&#x793A;&#x7B54;&#x6848;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;#1&#xFF1A;<br>ababa<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;#1&#xFF1A;<br>5 3 1 4 2</p>
<p>&#x8BF4;&#x660E;<br>n&lt;=1e6<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 1000000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n;	<span class="keyword">char</span> ch[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="keyword">int</span> s[MAX_N+<span class="number">5</span>], sa[MAX_N+<span class="number">5</span>], tx[MAX_N+<span class="number">5</span>], ty[MAX_N+<span class="number">5</span>], cnt[MAX_N+<span class="number">5</span>], rank[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">trans</span><span class="params">(<span class="keyword">char</span> c)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (c &gt;= <span class="string">&apos;0&apos;</span> &amp;&amp; c &lt;= <span class="string">&apos;9&apos;</span>)	<span class="keyword">return</span> c-<span class="string">&apos;0&apos;</span>+<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span> (c &gt;= <span class="string">&apos;A&apos;</span> &amp;&amp; c &lt;= <span class="string">&apos;Z&apos;</span>)	<span class="keyword">return</span> c-<span class="string">&apos;A&apos;</span>+<span class="number">11</span>;</div><div class="line">	<span class="keyword">if</span> (c &gt;= <span class="string">&apos;a&apos;</span> &amp;&amp; c &lt;= <span class="string">&apos;z&apos;</span>)	<span class="keyword">return</span> c-<span class="string">&apos;a&apos;</span>+<span class="number">37</span>;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">getSA</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">int</span> *x = tx, *y = ty;	<span class="keyword">int</span> DICNUM = <span class="number">63</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	cnt[x[i] = s[i]]++;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= DICNUM; i++)	cnt[i] += cnt[i<span class="number">-1</span>];</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = n; i; i--)	sa[cnt[x[i]]--] = i;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> h = <span class="number">1</span>; h &lt;= n; h &lt;&lt;= <span class="number">1</span>) {</div><div class="line">		<span class="keyword">int</span> c = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = n-h+<span class="number">1</span>; i &lt;= n; i++)	y[++c] = i;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="keyword">if</span> (sa[i] &gt; h)	y[++c] = sa[i]-h;</div><div class="line">		<span class="built_in">memset</span>(cnt, <span class="number">0</span>, <span class="keyword">sizeof</span>(cnt));</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	cnt[x[i]]++;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= DICNUM; i++)	cnt[i] += cnt[i<span class="number">-1</span>];</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = n; i; i--)	sa[cnt[x[y[i]]]--] = y[i];</div><div class="line">		swap(x, y), c = <span class="number">0</span>, x[sa[<span class="number">1</span>]] = ++c;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++)	x[sa[i]] = (y[sa[i]] == y[sa[i<span class="number">-1</span>]] &amp;&amp; y[sa[i]+h] == y[sa[i<span class="number">-1</span>]+h]) ? c : ++c;</div><div class="line">		DICNUM = c;	<span class="keyword">if</span> (c == n)	<span class="keyword">break</span>;</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, ch);	n = <span class="built_in">strlen</span>(ch);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)	s[i+<span class="number">1</span>] = trans(ch[i]);</div><div class="line">	getSA();</div><div class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, sa[<span class="number">1</span>]);	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++)	<span class="built_in">printf</span>(<span class="string">&quot; %d&quot;</span>, sa[i]);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Suffix-Automation"><a href="#Suffix-Automation" class="headerlink" title="Suffix Automation"></a>Suffix Automation</h2><blockquote>
<p>&#x3010;&#x6A21;&#x677F;&#x3011;&#x540E;&#x7F00;&#x81EA;&#x52A8;&#x673A;</p>
<p>&#x9898;&#x76EE;&#x63CF;&#x8FF0;<br>&#x7ED9;&#x5B9A;&#x4E00;&#x4E2A;&#x53EA;&#x5305;&#x542B;&#x5C0F;&#x5199;&#x5B57;&#x6BCD;&#x7684;&#x5B57;&#x7B26;&#x4E32;S&#xFF0C;&#x8BF7;&#x4F60;&#x6C42;&#x51FA;S&#x7684;&#x6240;&#x6709;&#x51FA;&#x73B0;&#x6B21;&#x6570;&#x4E0D;&#x4E3A;1&#x7684;&#x5B50;&#x4E32;&#x7684;&#x51FA;&#x73B0;&#x6B21;&#x6570;&#x4E58;&#x4E0A;&#x8BE5;&#x5B50;&#x4E32;&#x957F;&#x5EA6;&#x7684;&#x6700;&#x5927;&#x503C;&#x3002;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;<br>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x4E00;&#x884C;&#x4E00;&#x4E2A;&#x4EC5;&#x5305;&#x542B;&#x5C0F;&#x5199;&#x5B57;&#x6BCD;&#x7684;&#x5B57;&#x7B26;&#x4E32;S<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x4E00;&#x4E2A;&#x6574;&#x6570;&#xFF0C;&#x4E3A;&#x6240;&#x6C42;&#x7B54;&#x6848;</p>
<p>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;<br>&#x8F93;&#x5165;&#x6837;&#x4F8B;#1&#xFF1A;<br>abab<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;#1&#xFF1A;<br>4</p>
<p>&#x8BF4;&#x660E;<br>&#x5BF9;&#x4E8E;10%&#x7684;&#x6570;&#x636E;&#xFF0C;|S|&lt;=1000<br>&#x5BF9;&#x4E8E;100%&#x7684;&#x6570;&#x636E;&#xFF0C;|S|&lt;=1e6<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 1000000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> lnt;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> {</span><span class="keyword">int</span> ch[<span class="number">26</span>], par, len;} SAM[MAX_N*<span class="number">2</span>+<span class="number">500</span>];</div><div class="line"><span class="keyword">int</span> sz, root, last, cnt[MAX_N*<span class="number">2</span>+<span class="number">500</span>], dfn[MAX_N*<span class="number">2</span>+<span class="number">500</span>], f[MAX_N*<span class="number">2</span>+<span class="number">500</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">newnode</span><span class="params">(<span class="keyword">int</span> _len)</span> </span>{SAM[++sz].len = _len;	<span class="keyword">return</span> sz;}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>{sz = <span class="number">0</span>, root = last = newnode(<span class="number">0</span>);}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">extend</span><span class="params">(<span class="keyword">int</span> c)</span> </span>{</div><div class="line">	<span class="keyword">int</span> p = last, np = newnode(SAM[p].len+<span class="number">1</span>);	last = np, f[np] = <span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span> (; p &amp;&amp; !SAM[p].ch[c]; p = SAM[p].par)	SAM[p].ch[c] = np;</div><div class="line">	<span class="keyword">if</span> (!p)	SAM[np].par = root;</div><div class="line">	<span class="keyword">else</span> {</div><div class="line">		<span class="keyword">int</span> q = SAM[p].ch[c];</div><div class="line">		<span class="keyword">if</span> (SAM[q].len == SAM[p].len+<span class="number">1</span>)	SAM[np].par = q;</div><div class="line">		<span class="keyword">else</span> {</div><div class="line">			<span class="keyword">int</span> nq = newnode(SAM[p].len+<span class="number">1</span>);</div><div class="line">			<span class="built_in">memcpy</span>(SAM[nq].ch, SAM[q].ch, <span class="keyword">sizeof</span>(SAM[q].ch));</div><div class="line">			SAM[nq].par = SAM[q].par, SAM[q].par = SAM[np].par = nq;</div><div class="line">			<span class="keyword">for</span> (; p &amp;&amp; SAM[p].ch[c] == q; p = SAM[p].par)	SAM[p].ch[c] = nq;</div><div class="line">		}</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">char</span> s[MAX_N+<span class="number">5</span>];	init(), <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s);	<span class="keyword">int</span> l = <span class="built_in">strlen</span>(s);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; l; i++)	extend(s[i]-<span class="string">&apos;a&apos;</span>);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= sz; i++)	cnt[SAM[i].len]++;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= l; i++)	cnt[i] += cnt[i<span class="number">-1</span>];</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= sz; i++)	dfn[cnt[SAM[i].len]--] = i;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= sz; i++)	<span class="built_in">cout</span> &lt;&lt; dfn[i] &lt;&lt; <span class="string">&quot; &quot;</span>;	<span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">	lnt ans = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = sz; i &gt;= <span class="number">1</span>; i--) {</div><div class="line">		<span class="keyword">int</span> p = dfn[i];	f[SAM[p].par] += f[p];</div><div class="line">		<span class="keyword">if</span> (f[p] &gt; <span class="number">1</span>)	ans = max(ans, (lnt)f[p]*SAM[p].len);</div><div class="line">	}</div><div class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>, ans);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
</blockquote>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LG/">LG</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-BZOJ1787【AHOI2008】Meet紧急集合 LCA" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/BZOJ1787【AHOI2008】Meet紧急集合 LCA/" class="article-date">
  	<time datetime="2017-09-26T16:00:00.000Z" itemprop="datePublished">2017-09-27</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/BZOJ1787【AHOI2008】Meet紧急集合 LCA/">
        BZOJ1787【AHOI2008】Meet紧急集合 &lt;LCA&gt;
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>&#x3010;AHOI2008&#x3011;Meet &#x7D27;&#x6025;&#x96C6;&#x5408;</p>
<p>Description<br>&#x6B22;&#x4E50;&#x5C9B;&#x4E0A;&#x6709;&#x4E2A;&#x975E;&#x5E38;&#x597D;&#x73A9;&#x7684;&#x6E38;&#x620F;&#xFF0C;&#x53EB;&#x505A;&#x201C;&#x7D27;&#x6025;&#x96C6;&#x5408;&#x201D;&#x3002;&#x5728;&#x5C9B;&#x4E0A;&#x5206;&#x6563;&#x6709;N&#x4E2A;&#x7B49;&#x5F85;&#x70B9;&#xFF0C;&#x6709;N-1&#x6761;&#x9053;&#x8DEF;&#x8FDE;&#x63A5;&#x7740;&#x5B83;&#x4EEC;&#xFF0C;&#x6BCF;&#x6761;&#x9053;&#x8DEF;&#x90FD;&#x8FDE;&#x63A5;&#x67D0;&#x4E24;&#x4E2A;&#x7B49;&#x5F85;&#x70B9;&#xFF0C;&#x4E14;&#x901A;&#x8FC7;&#x8FD9;&#x4E9B;&#x9053;&#x8DEF;&#x53EF;&#x4EE5;&#x8D70;&#x904D;&#x6240;&#x6709;&#x7684;&#x7B49;&#x5F85;&#x70B9;&#xFF0C;&#x901A;&#x8FC7;&#x9053;&#x8DEF;&#x4ECE;&#x4E00;&#x70B9;&#x5230;&#x53E6;&#x4E00;&#x70B9;&#x8981;&#x82B1;&#x8D39;&#x4E00;&#x4E2A;&#x6E38;&#x620F;&#x5E01;&#x3002;&#x53C2;&#x52A0;&#x6E38;&#x620F;&#x7684;&#x4E09;&#x4EBA;&#x4E00;&#x7EC4;&#xFF0C;&#x5F00;&#x59CB;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6240;&#x6709;&#x4EBA;&#x5458;&#x5747;&#x4EFB;&#x610F;&#x5206;&#x6563;&#x5728;&#x5404;&#x4E2A;&#x7B49;&#x5F85;&#x70B9;&#x4E0A;&#xFF08;&#x6BCF;&#x4E2A;&#x70B9;&#x540C;&#x65F6;&#x5141;&#x8BB8;&#x591A;&#x4E2A;&#x4EBA;&#x7B49;&#x5F85;&#xFF09;&#xFF0C;&#x6BCF;&#x4E2A;&#x4EBA;&#x5747;&#x5E26;&#x6709;&#x8DB3;&#x591F;&#x591A;&#x7684;&#x6E38;&#x620F;&#x5E01;&#xFF08;&#x7528;&#x4E8E;&#x652F;&#x4ED8;&#x4F7F;&#x7528;&#x9053;&#x8DEF;&#x7684;&#x82B1;&#x8D39;&#xFF09;&#x3001;&#x5730;&#x56FE;&#xFF08;&#x6807;&#x660E;&#x7B49;&#x5F85;&#x70B9;&#x4E4B;&#x95F4;&#x9053;&#x8DEF;&#x8FDE;&#x63A5;&#x7684;&#x60C5;&#x51B5;&#xFF09;&#x4EE5;&#x53CA;&#x5BF9;&#x8BB2;&#x673A;&#xFF08;&#x7528;&#x4E8E;&#x548C;&#x540C;&#x7EC4;&#x7684;&#x6210;&#x5458;&#x8054;&#x7CFB;&#xFF09;&#x3002;&#x5F53;&#x96C6;&#x5408;&#x53F7;&#x5439;&#x54CD;&#x540E;&#xFF0C;&#x6BCF;&#x4E2A;&#x6210;&#x5458;&#x4E4B;&#x95F4;&#x8FC5;&#x901F;&#x8054;&#x7CFB;&#xFF0C;&#x4E86;&#x89E3;&#x5230;&#x81EA;&#x5DF1;&#x7EC4;&#x6240;&#x6709;&#x6210;&#x5458;&#x6240;&#x5728;&#x7684;&#x7B49;&#x5F85;&#x70B9;&#x540E;&#xFF0C;&#x8FC5;&#x901F;&#x5728;N&#x4E2A;&#x7B49;&#x5F85;&#x70B9;&#x4E2D;&#x786E;&#x5B9A;&#x4E00;&#x4E2A;&#x96C6;&#x5408;&#x70B9;&#xFF0C;&#x7EC4;&#x5185;&#x6240;&#x6709;&#x6210;&#x5458;&#x5C06;&#x5728;&#x8BE5;&#x96C6;&#x5408;&#x70B9;&#x96C6;&#x5408;&#xFF0C;&#x96C6;&#x5408;&#x6240;&#x7528;&#x82B1;&#x8D39;&#x6700;&#x5C11;&#x7684;&#x7EC4;&#x5C06;&#x662F;&#x6E38;&#x620F;&#x7684;&#x8D62;&#x5BB6;&#x3002;<br>&#x5C0F;&#x53EF;&#x53EF;&#x548C;&#x4ED6;&#x7684;&#x670B;&#x53CB;&#x9080;&#x8BF7;&#x4F60;&#x4E00;&#x8D77;&#x53C2;&#x52A0;&#x8FD9;&#x4E2A;&#x6E38;&#x620F;&#xFF0C;&#x6709;&#x4F60;&#x6765;&#x9009;&#x62E9;&#x96C6;&#x5408;&#x70B9;&#xFF0C;&#x806A;&#x660E;&#x7684;&#x4F60;&#x80FD;&#x591F;&#x5B8C;&#x6210;&#x8FD9;&#x4E2A;&#x4EFB;&#x52A1;&#xFF0C;&#x5E2E;&#x52A9;&#x5C0F;&#x53EF;&#x53EF;&#x8D62;&#x5F97;&#x6E38;&#x620F;&#x5417;&#xFF1F;</p>
<p>Input<br>&#x7B2C;&#x4E00;&#x884C;&#x4E24;&#x4E2A;&#x6B63;&#x6574;&#x6570;N&#x548C;M&#xFF08;N&lt;=500000&#xFF0C;M&lt;=500000&#xFF09;&#xFF0C;&#x4E4B;&#x95F4;&#x7528;&#x4E00;&#x4E2A;&#x7A7A;&#x683C;&#x9694;&#x5F00;&#x3002;&#x5206;&#x522B;&#x8868;&#x793A;&#x7B49;&#x5F85;&#x70B9;&#x7684;&#x4E2A;&#x6570;&#xFF08;&#x7B49;&#x5F85;&#x70B9;&#x4E5F;&#x4ECE;1&#x5230;N&#x8FDB;&#x884C;&#x7F16;&#x53F7;&#xFF09;&#x548C;&#x83B7;&#x5956;&#x6240;&#x9700;&#x5B8C;&#x6210;&#x7684;&#x96C6;&#x5408;&#x6B21;&#x6570;&#x3002;<br>&#x968F;&#x540E;&#x6709;N-1&#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x4E24;&#x4E2A;&#x6B63;&#x6574;&#x6570;A&#x548C;B&#xFF0C;&#x4E4B;&#x95F4;&#x7528;&#x7A7A;&#x683C;&#x9694;&#x5F00;&#xFF0C;&#x8868;&#x793A;&#x7F16;&#x53F7;&#x4E3A;A&#x548C;&#x7F16;&#x53F7;&#x4E3A;B&#x7684;&#x7B49;&#x5F85;&#x70B9;&#x4E4B;&#x95F4;&#x6709;&#x4E00;&#x6761;&#x8DEF;&#x3002;<br>&#x63A5;&#x7740;&#x8FD8;&#x6709;M&#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x7528;&#x4E09;&#x4E2A;&#x6B63;&#x6574;&#x6570;&#x8868;&#x793A;&#x67D0;&#x6B21;&#x96C6;&#x5408;&#x524D;&#x5C0F;&#x53EF;&#x53EF;&#x3001;&#x5C0F;&#x53EF;&#x53EF;&#x7684;&#x670B;&#x53CB;&#x4EE5;&#x53CA;&#x4F60;&#x6240;&#x5728;&#x7684;&#x7B49;&#x5F85;&#x70B9;&#x7684;&#x7F16;&#x53F7;&#x3002;</p>
<p>Output<br>&#x4E00;&#x5171;&#x6709;M&#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x4E24;&#x4E2A;&#x6570;P&#x548C;C&#xFF0C;&#x7528;&#x4E00;&#x4E2A;&#x7A7A;&#x683C;&#x9694;&#x5F00;&#x3002;&#x5176;&#x4E2D;&#x7B2C;i&#x884C;&#x8868;&#x793A;&#x7B2C;i&#x6B21;&#x96C6;&#x5408;&#x70B9;&#x9009;&#x62E9;&#x5728;&#x7F16;&#x53F7;&#x4E3A;P&#x7684;&#x7B49;&#x5F85;&#x70B9;&#xFF0C;&#x96C6;&#x5408;&#x603B;&#x5171;&#x7684;&#x82B1;&#x8D39;&#x662F;C&#x4E2A;&#x6E38;&#x620F;&#x5E01;&#x3002;</p>
<p>Sample Input<br>6 4<br>1 2<br>2 3<br>2 4<br>4 5<br>5 6<br>4 5 6<br>6 3 1<br>2 4 4<br>6 6 6<br>Sample Output<br>5 2<br>2 5<br>4 1<br>6 0</p>
<p>HINT<br>40%&#x7684;&#x6570;&#x636E;&#x4E2D;&#xFF0C;N&lt;=2000&#xFF0C;M&lt;=2000<br>100%&#x7684;&#x6570;&#x636E;&#x4E2D;&#xFF0C;N&lt;=500000&#xFF0C;M&lt;=500000</p>
</blockquote>
<p>&#x6807;&#x7B7E;&#xFF1A;LCA</p>
<p>&#x5BF9;&#x4E8E;&#x6BCF;&#x7EC4;&#x8BE2;&#x95EE;&#xFF0C;&#x627E;&#x51FA;&#x4E09;&#x4E2A;&#x70B9;&#x4E2D;&#x4E24;&#x4E24;&#x7684;lca&#xFF0C;&#x8FD9;&#x4E09;&#x4E2A;lca&#x4E2D;&#x5FC5;&#x7136;&#x81F3;&#x5C11;&#x6709;&#x4E24;&#x4E2A;&#x76F8;&#x540C;&#x3002;&#x627E;&#x51FA;&#x90A3;&#x4E2A;&#x4E0D;&#x540C;&#x7684;lca&#xFF0C;&#x4EE5;&#x5B83;&#x4E3A;&#x96C6;&#x5408;&#x70B9;&#xFF0C;&#x7B97;&#x51FA;&#x8DDD;&#x79BB;&#xFF0C;&#x4E00;&#x5B9A;&#x6700;&#x5C0F;&#x3002;<br>&#x539F;&#x7406;&#x53EF;&#x89C1;zhber&#x535A;&#x5BA2;&#xFF1A;<a href="http://www.cnblogs.com/zhber/p/4116388.html" target="_blank" rel="external">http://www.cnblogs.com/zhber/p/4116388.html</a></p>
<p>&#x9644;&#x4E0A;AC&#x4EE3;&#x7801;&#xFF1A;<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 500000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m, fa[MAX_N+<span class="number">5</span>][<span class="number">35</span>], dep[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; G[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span><span class="params">(<span class="keyword">int</span> u)</span> </span>{</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">30</span>; i++)	<span class="keyword">if</span> (dep[u] &gt;= (<span class="number">1</span>&lt;&lt;i))	fa[u][i] = fa[fa[u][i<span class="number">-1</span>]][i<span class="number">-1</span>];</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[u].size(); i++) {</div><div class="line">		<span class="keyword">int</span> v = G[u][i];	<span class="keyword">if</span> (v == fa[u][<span class="number">0</span>])	<span class="keyword">continue</span>;</div><div class="line">		fa[v][<span class="number">0</span>] = u, dep[v] = dep[u]+<span class="number">1</span>, DFS(v);</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">LCA</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (dep[a] &lt; dep[b])	swap(a, b);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">30</span>; i &gt;= <span class="number">0</span>; i--)	<span class="keyword">if</span> (dep[a]-(<span class="number">1</span>&lt;&lt;i) &gt;= dep[b])	a = fa[a][i];</div><div class="line">	<span class="keyword">if</span> (a == b)	<span class="keyword">return</span> a;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">30</span>; i &gt;= <span class="number">0</span>; i--)	<span class="keyword">if</span> (fa[a][i] != fa[b][i])	a = fa[a][i], b = fa[b][i];</div><div class="line">	<span class="keyword">return</span> fa[a][<span class="number">0</span>];</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>{<span class="keyword">int</span> c = LCA(a, b);	<span class="keyword">return</span> dep[a]+dep[b]<span class="number">-2</span>*dep[c];}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v; i &lt; n; i++)	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v), G[u].push_back(v), G[v].push_back(u);	DFS(<span class="number">1</span>);</div><div class="line">	<span class="keyword">while</span> (m--) {</div><div class="line">		<span class="keyword">int</span> a, b, c;	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c);</div><div class="line">		<span class="keyword">int</span> lca = LCA(a, b)^LCA(a, c)^LCA(b, c);</div><div class="line">		<span class="keyword">int</span> dis = calc(a, lca)+calc(b, lca)+calc(c, lca);</div><div class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, lca, dis);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/BZOJ/">BZOJ</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LCA/">LCA</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2017 Azrael_Death
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a>
        </div>
    </div>
  </div>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
  </script>
  <script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  
</footer>

    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="/js/main.js"></script>



  </div>
</body>
</html>