<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>NIRVANA</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Blog of a Chinese OIer">
<meta property="og:type" content="website">
<meta property="og:title" content="NIRVANA">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="NIRVANA">
<meta property="og:description" content="Blog of a Chinese OIer">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="NIRVANA">
<meta name="twitter:description" content="Blog of a Chinese OIer">
  
    <link rel="alternative" href="/atom.xml" title="NIRVANA" type="application/atom+xml">
  
  
    <link rel="icon" href="http://chuantu.biz/t6/89/1507626502x2728279003.jpg">
  
  <link rel="stylesheet" href="/css/style.css">
  
  

  <script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>
  <script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>

  
</head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://chuantu.biz/t6/89/1507626502x2728279003.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Azrael_Death</a></h1>
		</hgroup>

		
		<p class="header-subtitle">Veni Vidi Vici</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/AzraelDeath" title="github">github</a>
					        
								<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/azraeldeath" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/2-SAT/" style="font-size: 11.25px;">2-SAT</a> <a href="/tags/AC自动机/" style="font-size: 11.25px;">AC自动机</a> <a href="/tags/APIO/" style="font-size: 10px;">APIO</a> <a href="/tags/BZOJ/" style="font-size: 20px;">BZOJ</a> <a href="/tags/DFS序/" style="font-size: 10px;">DFS序</a> <a href="/tags/DP/" style="font-size: 11.25px;">DP</a> <a href="/tags/HDU/" style="font-size: 13.75px;">HDU</a> <a href="/tags/LCA/" style="font-size: 12.5px;">LCA</a> <a href="/tags/LG/" style="font-size: 11.25px;">LG</a> <a href="/tags/MST/" style="font-size: 12.5px;">MST</a> <a href="/tags/Manacher/" style="font-size: 11.25px;">Manacher</a> <a href="/tags/NOI/" style="font-size: 11.25px;">NOI</a> <a href="/tags/NOIp/" style="font-size: 10px;">NOIp</a> <a href="/tags/POI/" style="font-size: 10px;">POI</a> <a href="/tags/POJ/" style="font-size: 16.25px;">POJ</a> <a href="/tags/Tarjan/" style="font-size: 11.25px;">Tarjan</a> <a href="/tags/Trie/" style="font-size: 10px;">Trie</a> <a href="/tags/UVa/" style="font-size: 10px;">UVa</a> <a href="/tags/主席树/" style="font-size: 13.75px;">主席树</a> <a href="/tags/二分答案/" style="font-size: 11.25px;">二分答案</a> <a href="/tags/分块/" style="font-size: 10px;">分块</a> <a href="/tags/差分/" style="font-size: 10px;">差分</a> <a href="/tags/差分约束系统/" style="font-size: 10px;">差分约束系统</a> <a href="/tags/并查集/" style="font-size: 11.25px;">并查集</a> <a href="/tags/总结/" style="font-size: 18.75px;">总结</a> <a href="/tags/树套树/" style="font-size: 11.25px;">树套树</a> <a href="/tags/树状数组/" style="font-size: 12.5px;">树状数组</a> <a href="/tags/模拟/" style="font-size: 10px;">模拟</a> <a href="/tags/省选/" style="font-size: 17.5px;">省选</a> <a href="/tags/线段树/" style="font-size: 12.5px;">线段树</a> <a href="/tags/组合数学/" style="font-size: 10px;">组合数学</a> <a href="/tags/网络流/" style="font-size: 15px;">网络流</a> <a href="/tags/莫队/" style="font-size: 11.25px;">莫队</a> <a href="/tags/补集转换/" style="font-size: 10px;">补集转换</a> <a href="/tags/费用流/" style="font-size: 10px;">费用流</a> <a href="/tags/高斯消元/" style="font-size: 10px;">高斯消元</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.csdn.net/OwenOwl">OwenOwl</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.csdn.net/Joker_69">Joker</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://dangxingyu.com">DXY</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://309459245.lofter.com">YJQ</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/candy99">Candy</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/zig-zag">ZigZag</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://cxjyxx.me">cxjyxx_me</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.shuizilong.com">ShuiZiLong</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/kuangbin">KuangBin</a>
			        
			        </div>
				</section>
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Azrael_Death</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="http://chuantu.biz/t6/89/1507626502x2728279003.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">Azrael_Death</h1>
			</hgroup>
			
			<p class="header-subtitle">Veni Vidi Vici</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/AzraelDeath" title="github">github</a>
			        
						<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/azraeldeath" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-POJ3228 Gold Transportation MST" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/POJ3228 Gold Transportation MST/" class="article-date">
  	<time datetime="2017-10-23T16:00:00.000Z" itemprop="datePublished">2017-10-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/POJ3228 Gold Transportation MST/">
        POJ3228 Gold Transportation &lt;MST&gt;
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Gold Transportation</p>
<p>Time Limit: 2000MS  Memory Limit: 65536K</p>
<p>Description<br>Recently, a number of gold mines have been discovered in Zorroming State. To protect this treasure, we must transport this gold to the storehouses as quickly as possible. Suppose that the Zorroming State consists of N towns and there are M bidirectional roads among these towns. The gold mines are only discovered in parts of the towns, while the storehouses are also owned by parts of the towns. The storage of the gold mine and storehouse for each town is finite. The truck drivers in the Zorroming State are famous for their bad temper that they would not like to drive all the time and they need a bar and an inn available in the trip for a good rest. Therefore, your task is to minimize the maximum adjacent distance among all the possible transport routes on the condition that all the gold is safely transported to the storehouses. </p>
<p>Input<br>The input contains several test cases. For each case, the first line is integer N(1&lt;=N&lt;=200). The second line is N integers associated with the storage of the gold mine in every towns .The third line is also N integers associated with the storage of the storehouses in every towns .Next is integer M(0&lt;=M&lt;=(n-1)*n/2).Then M lines follow. Each line is three integers x y and d(1&lt;=x,y&lt;=N,0&lt;d&lt;=10000), means that there is a road between x and y for distance of d. N=0 means end of the input.<br>Output<br>For each case, output the minimum of the maximum adjacent distance on the condition that all the gold has been transported to the storehouses or “No Solution”.</p>
<p>Sample Input<br>4<br>3 2 0 0<br>0 0 3 3<br>6<br>1 2 4<br>1 3 10<br>1 4 12<br>2 3 6<br>2 4 8<br>3 4 5<br>0<br>Sample Output<br>6</p>
</blockquote>
<p>题目大意：有n个村庄，每个村庄有一个黄金矿和一个仓库，求一棵生成树森林，使得每棵生成树上的黄金矿都可被这棵生成树上的仓库存下，并且森林中最大边权最小。</p>
<p>标签：MST</p>
<p>一个简单的MST变形。<br>用Kruskal从大到小贪心选边，每加一条边就O(n)判断森林中是否所有点所在的树都可以“自给自足”。总时间复杂度O(mn)，即O(n^3)。</p>
<p>附上AC代码：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 200</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_M 20000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m, f[MAX_N+<span class="number">5</span>], s[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span><span class="keyword">int</span> u, v, c;&#125; E[MAX_M+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">const</span> node &amp;a, <span class="keyword">const</span> node &amp;b)</span> </span>&#123;<span class="keyword">return</span> a.c &lt; b.c;&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">getf</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;<span class="keyword">if</span> (f[x] == x)	<span class="keyword">return</span> x;	<span class="keyword">int</span> tmp = getf(f[x]);	s[tmp] += s[x], s[x] = <span class="number">0</span>;	<span class="keyword">return</span> f[x] = tmp;&#125;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">chk</span><span class="params">()</span> </span>&#123;<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="keyword">if</span> (f[i] == i &amp;&amp; s[i] &lt; <span class="number">0</span>)	<span class="keyword">return</span> <span class="literal">false</span>;	<span class="keyword">return</span> <span class="literal">true</span>;&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) &amp;&amp; n) &#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	f[i] = i, s[i] = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, x; i &lt;= n; i++)	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x), s[i] -= x;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, x; i &lt;= n; i++)	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x), s[i] += x;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;m);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)	<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;E[i].u, &amp;E[i].v, &amp;E[i].c);</div><div class="line">		sort(E, E+m, cmp);	<span class="keyword">bool</span> flag = <span class="literal">false</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</div><div class="line">			<span class="keyword">int</span> u = getf(E[i].u), v = getf(E[i].v);</div><div class="line">			<span class="keyword">if</span> (u != v)	f[u] = v, s[v] += s[u], s[u] = <span class="number">0</span>;</div><div class="line">			<span class="keyword">if</span> (chk()) &#123;flag = <span class="literal">true</span>, <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, E[i].c);	<span class="keyword">break</span>;&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> (!flag)	<span class="built_in">printf</span>(<span class="string">"No Solution\n"</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MST/">MST</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/POJ/">POJ</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-POJ2728 Desert King 二分+MST" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/POJ2728 Desert King 二分+MST/" class="article-date">
  	<time datetime="2017-10-23T16:00:00.000Z" itemprop="datePublished">2017-10-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/POJ2728 Desert King 二分+MST/">
        POJ728 Desert King &lt;二分+MST&gt;
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>Desert King</p>
<p>David the Great has just become the king of a desert country. To win the respect of his people, he decided to build channels all over his country to bring water to every village. Villages which are connected to his capital village will be watered. As the dominate ruler and the symbol of wisdom in the country, he needs to build the channels in a most elegant way.<br>After days of study, he finally figured his plan out. He wanted the average cost of each mile of the channels to be minimized. In other words, the ratio of the overall cost of the channels to the total length must be minimized. He just needs to build the necessary channels to bring water to all the villages, which means there will be only one way to connect each village to the capital.<br>His engineers surveyed the country and recorded the position and altitude of each village. All the channels must go straight between two villages and be built horizontally. Since every two villages are at different altitudes, they concluded that each channel between two villages needed a vertical water lifter, which can lift water up or let water flow down. The length of the channel is the horizontal distance between the two villages. The cost of the channel is the height of the lifter. You should notice that each village is at a different altitude, and different channels can’t share a lifter. Channels can intersect safely and no three villages are on the same line.<br>As King David’s prime scientist and programmer, you are asked to find out the best solution to build the channels.</p>
<p>Input<br>There are several test cases. Each test case starts with a line containing a number N (2 &lt;= N &lt;= 1000), which is the number of villages. Each of the following N lines contains three integers, x, y and z (0 &lt;= x, y &lt; 10000, 0 &lt;= z &lt; 10000000). (x, y) is the position of the village and z is the altitude. The first village is the capital. A test case with N = 0 ends the input, and should not be processed.<br>Output<br>For each test case, output one line containing a decimal number, which is the minimum ratio of overall cost of the channels to the total length. This number should be rounded three digits after the decimal point. </p>
<p>Sample Input<br>4<br>0 0 0<br>0 1 1<br>1 1 2<br>1 0 3<br>0<br>Sample Output<br>1.000</p>
</blockquote>
<p>题目大意：给出n个村庄和n^2条路，以及每条路的长度和代价，要求选出一棵生成树使得其路径总代价除以路径总长度最小。</p>
<p>标签：最优比例生成树，二分答案，MST</p>
<p>本题是最优比例生成树的裸题。<br>熟悉二分答案的套路。</p>
<p>注意到如果一个答案x可作为平均值，那么比x大的所有答案均可作为平均值，问题具有二分性<br>于是二分答案，即最后的平均值，对于每个答案，构造最小生成树判断可行性，具体如下：<br>对于第i条边，长度为li，代价为ci，那么将此边的权值设为wi=ci-li*tans，跑一遍最小生成树，如果总权值小于0，则有可行解。<br>注意此题为稠密图，应用Prime。</p>
<p>附上AC代码：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 1000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n;</div><div class="line"><span class="keyword">double</span> <span class="built_in">map</span>[MAX_N+<span class="number">5</span>][MAX_N+<span class="number">5</span>], val[MAX_N+<span class="number">5</span>][MAX_N+<span class="number">5</span>];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span> &#123;</span><span class="keyword">double</span> x, y, h;&#125; p[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">calc</span><span class="params">(<span class="keyword">double</span> x1, <span class="keyword">double</span> y1, <span class="keyword">double</span> x2, <span class="keyword">double</span> y2)</span> </span>&#123;<span class="keyword">return</span> <span class="built_in">sqrt</span>((x1-x2)*(x1-x2)+(y1-y2)*(y1-y2));&#125;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">double</span> t)</span> </span>&#123;</div><div class="line">	<span class="keyword">double</span> ret = <span class="number">0</span>;</div><div class="line">	<span class="keyword">double</span> dis[MAX_N+<span class="number">5</span>];</div><div class="line">	<span class="keyword">bool</span> vis[MAX_N+<span class="number">5</span>];</div><div class="line">	<span class="built_in">memset</span>(dis, <span class="number">127</span>, <span class="keyword">sizeof</span>(dis));</div><div class="line">	<span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span>(vis));</div><div class="line">	dis[<span class="number">1</span>] = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">		<span class="keyword">int</span> tv = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)</div><div class="line">			<span class="keyword">if</span> (!vis[j] &amp;&amp; (!tv || dis[j] &lt; dis[tv]))</div><div class="line">				tv = j;</div><div class="line">		vis[tv] = <span class="number">1</span>, ret += dis[tv];</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)</div><div class="line">			<span class="keyword">if</span> (!vis[j])</div><div class="line">				dis[j] = min(dis[j], val[tv][j]-<span class="built_in">map</span>[tv][j]*t);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ret &lt; <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">bi_search</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">double</span> l = <span class="number">0</span>, r = <span class="number">1e5</span>, mid;</div><div class="line">	<span class="keyword">while</span> (<span class="built_in">abs</span>(l-r) &gt; <span class="number">1e-6</span>) &#123;</div><div class="line">		mid = (l+r)/<span class="number">2</span>;</div><div class="line">		<span class="keyword">if</span> (check(mid))	r = mid;</div><div class="line">		<span class="keyword">else</span>	l = mid;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> mid;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) &amp;&amp; n) &#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="built_in">scanf</span>(<span class="string">"%lf%lf%lf"</span>, &amp;p[i].x, &amp;p[i].y, &amp;p[i].h);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= i; j++)</div><div class="line">				<span class="built_in">map</span>[i][j] = <span class="built_in">map</span>[j][i] = calc(p[i].x, p[i].y, p[j].x, p[j].y),</div><div class="line">				val[i][j] = val[j][i] = <span class="built_in">abs</span>(p[i].h-p[j].h);</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%.3f\n"</span>, bi_search());</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MST/">MST</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/POJ/">POJ</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/二分答案/">二分答案</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-BZOJ1821【JSOI2010】Group部落划分 MST" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/BZOJ1821【JSOI2010】Group部落划分 MST/" class="article-date">
  	<time datetime="2017-10-23T16:00:00.000Z" itemprop="datePublished">2017-10-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/BZOJ1821【JSOI2010】Group部落划分 MST/">
        BZOJ1821【JSOI2010】Group部落划分 &lt;MST&gt;
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>【JSOI2010】Group 部落划分 Group<br>Time Limit: 10 Sec  Memory Limit: 64 MB</p>
<p>Description<br>聪聪研究发现，荒岛野人总是过着群居的生活，但是，并不是整个荒岛上的所有野人都属于同一个部落，野人们总是拉帮结派形成属于自己的部落，不同的部落之间则经常发生争斗。只是，这一切都成为谜团了——聪聪根本就不知道部落究竟是如何分布的。 不过好消息是，聪聪得到了一份荒岛的地图。地图上标注了N个野人居住的地点（可以看作是平面上的坐标）。我们知道，同一个部落的野人总是生活在附近。我们把两个部落的距离，定义为部落中距离最近的那两个居住点的距离。聪聪还获得了一个有意义的信息——这些野人总共被分为了K个部落！这真是个好消息。聪聪希望从这些信息里挖掘出所有部落的详细信息。他正在尝试这样一种算法： 对于任意一种部落划分的方法，都能够求出两个部落之间的距离，聪聪希望求出一种部落划分的方法，使靠得最近的两个部落尽可能远离。 例如，下面的左图表示了一个好的划分，而右图则不是。请你编程帮助聪聪解决这个难题。 </p>
<p>Input<br>第一行包含两个整数N和K(1&lt; = N &lt; = 1000,1&lt; K &lt; = N)，分别代表了野人居住点的数量和部落的数量。<br>接下来N行，每行包含两个正整数x,y，描述了一个居住点的坐标(0 &lt; =x, y &lt; =10000)<br>Output<br>输出一行，为最优划分时，最近的两个部落的距离，精确到小数点后两位。</p>
<p>Sample Input<br>4 2<br>0 0<br>0 1<br>1 1<br>1 0<br>Sample Output<br>1.00</p>
</blockquote>
<p>标签：MST</p>
<p>此题是MST的一个简单变形。<br>本题要求分为k个部落，即在生成树上拆k-1条边。<br>使得其最小距离最大，可以kruskal贪心向下选，选到剩k-1条边为止。</p>
<p>附上代码：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 1000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> dnt;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span><span class="keyword">int</span> u, v;	dnt c;&#125; E[MAX_N*MAX_N+<span class="number">50</span>];</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span> <span class="params">(<span class="keyword">const</span> node &amp;a, <span class="keyword">const</span> node &amp;b)</span> </span>&#123;<span class="keyword">return</span> a.c &lt; b.c;&#125;</div><div class="line"><span class="keyword">int</span> n, k, cnt, x[MAX_N+<span class="number">5</span>], y[MAX_N+<span class="number">5</span>], fa[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	fa[i] = i;&#125;</div><div class="line"><span class="function">dnt <span class="title">dist</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;<span class="keyword">return</span> (dnt)<span class="built_in">sqrt</span>((x[a]-x[b])*(x[a]-x[b])+(y[a]-y[b])*(y[a]-y[b]));&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">getf</span><span class="params">(<span class="keyword">int</span> c)</span> </span>&#123;<span class="keyword">return</span> fa[c] == c ? c : fa[c] = getf(fa[c]);&#125;</div><div class="line"><span class="function">dnt <span class="title">Kruskal</span><span class="params">()</span> </span>&#123;</div><div class="line">	sort(E, E+cnt, cmp);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, tot = <span class="number">0</span>; i &lt; cnt; i++) &#123;</div><div class="line">		<span class="keyword">int</span> u = getf(E[i].u), v = getf(E[i].v);</div><div class="line">		<span class="keyword">if</span> (u != v)	fa[u] = v, tot++;</div><div class="line">		<span class="keyword">if</span> (tot &gt; n-k)	<span class="keyword">return</span> E[i].c;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;k), init();</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x[i], &amp;y[i]);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="keyword">for</span> (<span class="keyword">int</span> j = i+<span class="number">1</span>; j &lt;= n; j++)	E[cnt++] = (node)&#123;i, j, dist(i, j)&#125;;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%.2lf"</span>, Kruskal());</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/BZOJ/">BZOJ</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MST/">MST</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/省选/">省选</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-BZOJ3993【SDOI2015】星际战争 二分+最大流" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/BZOJ3993【SDOI2015】星际战争 二分+最大流/" class="article-date">
  	<time datetime="2017-10-23T16:00:00.000Z" itemprop="datePublished">2017-10-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/BZOJ3993【SDOI2015】星际战争 二分+最大流/">
        BZOJ3993【SDOI2015】星际战争 &lt;二分+网络流&gt;
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>【SDOI2015】星际战争<br>Time Limit: 10 Sec  Memory Limit: 128 MBSec  Special Judge</p>
<p>Description<br>3333年，在银河系的某星球上，X军团和Y军团正在激烈地作战。在战斗的某一阶段，Y军团一共派遣了N个巨型机器人进攻X军团的阵地，其中第i个巨型机器人的装甲值为Ai。当一个巨型机器人的装甲值减少到0或者以下时，这个巨型机器人就被摧毁了。X军团有M个激光武器，其中第i个激光武器每秒可以削减一个巨型机器人Bi的装甲值。激光武器的攻击是连续的。这种激光武器非常奇怪，一个激光武器只能攻击一些特定的敌人。Y军团看到自己的巨型机器人被X军团一个一个消灭，他们急需下达更多的指令。为了这个目标，Y军团需要知道X军团最少需要用多长时间才能将Y军团的所有巨型机器人摧毁。但是他们不会计算这个问题，因此向你求助。</p>
<p>Input<br>第一行，两个整数，N、M。<br>第二行，N个整数，A1、A2…AN。<br>第三行，M个整数，B1、B2…BM。<br>接下来的M行，每行N个整数，这些整数均为0或者1。这部分中的第i行的第j个整数为0表示第i个激光武器不可以攻击第j个巨型机器人，为1表示第i个激光武器可以攻击第j个巨型机器人。<br>Output<br>一行，一个实数，表示X军团要摧毁Y军团的所有巨型机器人最少需要的时间。输出结果与标准答案的绝对误差不超过10-3即视为正确。</p>
<p>Sample Input<br>2 2<br>3 10<br>4 6<br>0 1<br>1 1<br>Sample Output<br>1.300000</p>
<p>HINT<br>【样例说明1】<br>战斗开始后的前0.5秒，激光武器1攻击2号巨型机器人，激光武器2攻击1号巨型机器人。1号巨型机器人被完全摧毁，2号巨型机器人还剩余8的装甲值；<br>接下来的0.8秒，激光武器1、2同时攻击2号巨型机器人。2号巨型机器人被完全摧毁。<br>对于全部的数据，1&lt;=N, M&lt;=50，1&lt;=Ai&lt;=105，1&lt;=Bi&lt;=1000，输入数据保证X军团一定能摧毁Y军团的所有巨型机器人</p>
</blockquote>
<p>标签：二分答案+网络流</p>
<p>如果直接处理这个问题，会发现限制有点多，不太好处理。<br>考虑二分答案。二分最少时间，那么每个激光炮在此时间内可造成的伤害就可以算出，这时只需判断合理分配这些伤害能否使敌方团灭。<br>发现可以建图跑最大流判断。从远点S向所有激光炮连边，容量为此激光炮可造成的总伤害。从所有机器人向汇点T连边，容量为机器人血量。从每个激光炮向其所可以造成伤害的所有机器人连边，容量为INF，这样跑一遍最大流，判断是否等于所有机器人的总血量即可。<br>建图可以不用全部新建，只用在开始的时候建一个图，二分判断时将所有S到激光炮的边容量改成b[i]*tans即可。</p>
<p>附上AC代码：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 100</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> EPS 1e-8</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mid (l+r)/2</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> dnt;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span><span class="keyword">int</span> v, nxt; dnt c;&#125; E[MAX_N*MAX_N*<span class="number">5</span>+<span class="number">500</span>];	dnt sum;</div><div class="line"><span class="keyword">int</span> n, m, s, t, a[MAX_N+<span class="number">5</span>], b[MAX_N+<span class="number">5</span>], mrk[MAX_N+<span class="number">5</span>][MAX_N+<span class="number">5</span>], pre[MAX_N+<span class="number">5</span>], d[MAX_N+<span class="number">5</span>], cnt;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;<span class="built_in">memset</span>(pre, <span class="number">-1</span>, <span class="keyword">sizeof</span>(pre)), cnt = <span class="number">0</span>, s = <span class="number">0</span>, t = n+m+<span class="number">1</span>;&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, dnt c)</span> </span>&#123;E[cnt].v = v, E[cnt].c = c, E[cnt].nxt = pre[u], pre[u] = cnt++;&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span> </span>&#123;</div><div class="line">	init();</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	insert(i, t, a[i]), insert(t, i, <span class="number">0</span>), sum += a[i];</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)	insert(s, i+n, INF), insert(i+n, s, <span class="number">0</span>);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)	<span class="keyword">if</span> (mrk[i][j])	insert(i+n, j, INF), insert(j, i+n, <span class="number">0</span>);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">BFS</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; que;	<span class="built_in">memset</span>(d, <span class="number">-1</span>, <span class="keyword">sizeof</span>(d));	que.push(s), d[s] = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span> (!que.empty()) &#123;</div><div class="line">		<span class="keyword">int</span> u = que.front();	que.pop();</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = pre[u]; ~i; i = E[i].nxt) &#123;</div><div class="line">			<span class="keyword">int</span> v = E[i].v;	<span class="keyword">if</span> (E[i].c &lt;= EPS || ~d[v])	<span class="keyword">continue</span>;</div><div class="line">			d[v] = d[u]+<span class="number">1</span>;	que.push(v);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ~d[t];</div><div class="line">&#125;</div><div class="line"><span class="function">dnt <span class="title">DFS</span><span class="params">(<span class="keyword">int</span> u, dnt flow)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span> (u == t)	<span class="keyword">return</span> flow;	dnt ret = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = pre[u]; ~i; i = E[i].nxt) &#123;</div><div class="line">		<span class="keyword">int</span> v = E[i].v;	<span class="keyword">if</span> (E[i].c &lt;= EPS || d[v] != d[u]+<span class="number">1</span>)	<span class="keyword">continue</span>;</div><div class="line">		dnt tmp = DFS(v, min(flow, E[i].c));</div><div class="line">		E[i].c -= tmp, E[i^<span class="number">1</span>].c += tmp, ret += tmp, flow -= tmp;</div><div class="line">		<span class="keyword">if</span> (!flow)	<span class="keyword">break</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (!ret)	d[u] = <span class="number">-1</span>;	<span class="keyword">return</span> ret;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">chk</span><span class="params">(dnt tans)</span> </span>&#123;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; i += <span class="number">2</span>)	E[i].c += E[i^<span class="number">1</span>].c, E[i^<span class="number">1</span>].c = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = pre[s]; ~i; i = E[i].nxt)	E[i].c = (dnt)b[E[i].v-n]*tans;</div><div class="line">	dnt tot = <span class="number">0</span>;	<span class="keyword">while</span> (BFS())	tot += DFS(s, INF);	<span class="keyword">return</span> <span class="built_in">fabs</span>(tot-sum) &lt;= EPS;</div><div class="line">&#125;</div><div class="line"><span class="function">dnt <span class="title">bi_search</span><span class="params">(dnt l, dnt r)</span> </span>&#123;</div><div class="line">	dnt ret = <span class="number">-1</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++)</div><div class="line">		<span class="keyword">if</span> (chk(mid))	ret = r = mid;</div><div class="line">		<span class="keyword">else</span>	l = mid;</div><div class="line">	<span class="keyword">return</span> ret;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, a+i);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, b+i);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;mrk[i][j]);</div><div class="line">	build(), <span class="built_in">printf</span>(<span class="string">"%.5lf"</span>, bi_search(<span class="number">0</span>, INF));</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/BZOJ/">BZOJ</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/二分答案/">二分答案</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/省选/">省选</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/网络流/">网络流</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-BZOJ1972【SDOI2010】猪国杀" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/BZOJ1972【SDOI2010】猪国杀/" class="article-date">
  	<time datetime="2017-10-16T16:00:00.000Z" itemprop="datePublished">2017-10-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/BZOJ1972【SDOI2010】猪国杀/">
        BZOJ1972 【SDOI2010】 猪国杀 &lt;模拟&gt;
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>【SDOI2010】猪国杀<br>Time Limit: 1 Sec  Memory Limit: 64 MB</p>
<p>题目描述 Description<br>◎概述<br>    《猪国杀》是一种多猪牌类回合制游戏，一共有三种角色：主猪，忠猪，反猪。<br>    每局游戏主猪有且只有一只，忠猪和反猪可以有多只，每只猪扮演一种角色。<br>◎游戏目的：<br>    ·主猪（MP）：自己存活的情况下消灭所有的反猪。<br>    ·忠猪（ZP）：不惜一切保护主猪，胜利条件与主猪相同。<br>    ·反猪（FP）：杀死主猪。<br>◎游戏过程：<br>    ·游戏开始时候，每个玩家手里都会有4张牌，且体力上限和初始体力都是4。<br>    ·开始游戏时，从主猪开始，按照逆时针方向（数据中就是按照编号从1,2,3..n,1..的顺序）依次行动。<br>    ·每个玩家自己的回合可以分为2个阶段：<br>        ·摸牌阶段：<br>            ·从牌堆顶部摸两张牌，依次放到手牌的最右边。<br>·出牌阶段：<br>            ·你可以使用0张到任意张牌，每次使用牌的时候都使用最靠左的能够使用的牌。<br>            ·当然，要满足如下规则：<br>                ·1.如果没有猪哥连弩，每个出牌阶段只能使用一次“杀”来攻击。<br>                ·2.任何牌被使用后被弃置（武器是装备上）。<br>                ·被弃置的牌以后都不能再用，即与游戏无关。<br>◎各种牌介绍：<br>    ·每张手牌用一个字母表示，字母代表牌的种类。<br>·基本牌：<br>        『桃(P)』：<br>·在自己的回合内，如果自己的体力值不等于体力上限，那么使用一个桃可以为自己补充一点体力，否则不能使用桃。<br>            ·桃只能对自己使用。<br>            ·在自己的回合外，如果自己的血变为0或者更低，那么也可以使用。<br>        『杀(K)』：<br>            ·在自己的回合内，对攻击范围内除自己以外的一名角色使用。<br>            ·如果没有被『闪』抵消，则造成1点伤害。无论有无武器，杀的攻击范围都是1。<br>        『闪(D)』：<br>            ·当你受到杀的攻击时，可以弃置一张闪来抵消杀的效果。<br>·锦囊牌：<br>        『决斗(F)』：<br>·出牌阶段，对除自己以外任意一名角色使用，由目标角色先开始，自己和目标角色轮流弃置一张杀，首先没有杀可弃的一方受到1点伤害，另一方视为此伤害的来源。<br>        『南猪入侵(N)』：<br>·出牌阶段，对除你以外所有角色使用，按逆时针顺序从使用者下家开始依次结算，除非弃置一张杀，否则受到1点伤害。<br>        『万箭齐发(W)』：<br>            ·和南猪入侵类似，不过要弃置的不是杀而是闪。<br>        『无懈可击(J)』：<br>            ·在目标锦囊生效前抵消其效果。<br>·每次有一张锦囊即将生效时，从使用这张锦囊的猪开始，按照逆时针顺序，依次得到使用无懈可击的机会。<br>            ·效果：<br>                ·用于决斗时，决斗无效并弃置。<br>·用于南猪入侵或万箭齐发时，当结算到某个角色时才能使用，当前角色不需弃置牌并且不会受到伤害（仅对一个角色产生效果）。<br>                ·用于无懈可击时，成为目标的无懈可击被无效。<br>    ·装备牌：<br>        『猪哥连弩(Z)』：<br>            ·武器，攻击范围1，出牌阶段你可以使用任意张杀。<br>        ·同一时刻最多只能装一个武器。<br>        ·如果先前已经有了一把武器，那么之后再装武器的话，会弃置以前的武器来装现在的武器。<br>◎特殊事件及概念解释：<br>    ·伤害来源：<br>        ·杀、南猪入侵、万箭齐发的伤害来源均是使用该牌的猪。<br>        ·决斗的伤害来源如上。<br>    ·距离：<br>·两只猪的距离定义为沿着逆时针方向间隔的猪数＋1。即初始时1和2的距离为1，但是2和1的距离就是n-1。<br>        ·注意一个角色的死亡会导致一些猪距离的改变；<br>    ·玩家死亡：<br>·如果该玩家的体力降到0或者更低，并且自己手中没有足够的桃使得自己的体力值回到1，那么就死亡了。<br>        ·死亡后所有的牌（装备区，手牌区）被弃置。<br>    ·奖励与惩罚：<br>        ·反猪死亡时，最后一个伤害来源处（即使是反猪）立即摸三张牌。<br>        ·忠猪死亡时，如果最后一个伤害来源是主猪，那么主猪所有装备牌、手牌被弃置。<br>    ·注意，一旦达成胜利条件，游戏立刻结束，因此即使会摸3张牌或者还有牌可以用也不用执行了。<br>◎几种行为：<br>    ·献殷勤：<br>        ·使用无懈可击挡下南猪入侵、万箭齐发、决斗。<br>        ·使用无懈可击抵消表敌意。<br>    ·表敌意：<br>        ·对某个角色使用杀、决斗。<br>        ·使用无懈可击抵消献殷勤。<br>    ·跳忠：<br>        ·即通过行动表示自己是忠猪。<br>        ·跳忠行动就是对主猪或对某只已经跳忠的猪献殷勤，或者对某只已经跳反的猪表敌意。<br>    ·跳反：<br>        ·即通过行动表示自己是反猪。<br>        ·跳反行动就是对主猪或对某只已经跳忠的猪表敌意，或者对某只已经跳反的猪献殷勤。<br>    ·忠猪不会跳反，反猪也不会跳忠。<br>    ·不管是忠猪还是反猪，能够跳必然跳。<br>◎行动准则：<br>    ·共性：<br>        ·每个角色如果手里有桃且生命值未满，那么必然吃掉。<br>        ·有南猪入侵、万箭齐发、必然使用。<br>        ·有装备必然装上。<br>        ·受到杀时，有闪必然弃置。<br>        ·响应南猪入侵或者万箭齐发时候，有杀/闪必然弃置。<br>        ·不会对未表明身份的猪献殷勤（包括自己）。<br>    ·特性：<br>        ·主猪：<br>    ·主猪会认为没有跳身份，且用南猪入侵/万箭齐发对自己造成伤害的猪是类反猪（没伤害到不算，注意类反猪并没有表明身份），如果之后跳了，那么主猪会重新认识这只猪。<br>·对于每种表敌意的方式，对逆时针方向能够执行到的第一只类反猪或者已跳反猪表；如果没有，那么就不表敌意。<br>            ·决斗时会不遗余力弃置杀。<br>            ·如果能对已经跳忠的猪或自己献殷勤，那么一定献。<br>            ·如果能够对已经跳反的猪表敌意，那么一定表。<br>        ·忠猪：<br>·对于每种表敌意的方式，对逆时针方向能够执行到的第一只已经跳反的猪表，如果没有，那么就不表敌意。<br>            ·决斗时，如果对方是主猪，那么不会弃置杀，否则，会不遗余力弃置杀。<br>            ·如果有机会对主猪或者已经跳忠的猪献殷勤，那么一定献。<br>        ·反猪：<br>·对于每种表敌意的方式，如果有机会则对主猪表，否则，对逆时针方向能够执行到的第一只已经跳忠的猪表，如果没有，那么就不表敌意。<br>            ·决斗时会不遗余力弃置杀。<br>            ·如果有机会对已经跳反的猪献殷勤，那么一定献。<br>现在，我们已经知道每只猪的角色、手牌，还有牌堆初始情况，并且假设每个角色会按照如下的行为准则进行游戏，你需要做的就是告诉小猪iPig最后的结果。<br>限于iPig只会用P++语言写A+B，他请你用Pigcal(Pascal)、P(C)或P++(C++)语言来帮他预测最后的结果。</p>
<p>输入描述 Input Description<br>输入文件第一行包含两个正整数n(2&lt;=n&lt;=10)和m(m&lt;=2000)，分别代表玩家数和牌堆中牌的数量。数据保证牌的数量够用。<br>接下来n行，每行5个字符串，依次表示对第i只猪的角色和初始4张手牌描述。编号为1的肯定是主猪。<br>再接下来一行，一共m个字符串，按照从牌堆顶部到牌堆底部的顺序描述每张牌。<br>所有的相邻的两个字符串都严格用1个空格隔开，行尾没有多余空格。<br>输出描述 Output Description<br>输出数据第一行包含一个字符串代表游戏结果。如果是主猪胜利，那么输出MP，否则输出FP。数据保证游戏总会结束。<br>接下来n行，第i行是对第i只猪的手牌描述（注意只需要输出手牌），按照手牌从左往右的顺序输出，相邻两张牌用一个空格隔开，行末尾没有多余空格。如果这只猪已阵亡，那么只要输出DEAD即可。注意如果要输出手牌而没有手牌的话，那么只需输出一个空行。</p>
<p>样例数据 Sample Data<br>Sample Input #1<br>3 10<br>MP D D F F<br>ZP N N N D<br>FP J J J J<br>F F D D J J F F K D<br>Sample Output #1<br>FP<br>DEAD<br>DEAD<br>J J J J J J D</p>
<p>数据范围及提示 Data Size &amp; Hint<br>样例1说明：第一回合主猪没有目标可以表敌意；接下来忠猪使用了3张南猪入侵，主猪掉了3点体力，并认为该角色为类反猪，3号角色尽管手里有无懈可击，但是因为自己未表明身份，所以同样不能对自己用，乖乖掉3点体力；下一回合反猪无牌可出；接下来主猪对着类反猪爆发，使用4张决斗，忠猪死亡，结果主猪弃掉所有牌；下来反猪摸到一张杀直接杀死主猪获胜。<br>数据说明：一共20组测试数据，每个点5分。10%的数据没有锦囊牌，另外20%的数据没有无懈可击。</p>
</blockquote>
<p>如果觉得此题面不好看，请戳这里：<a href="https://mubu.com/doc/2707815814591da4" target="_blank" rel="external">https://mubu.com/doc/2707815814591da4</a><br>如果觉得样例太少，请戳这里下载PDF：<a href="http://nan.pdfdo.com/Download/101717061787_0猪国杀.html?t=Math.random(" target="_blank" rel="external">http://nan.pdfdo.com/Download/101717061787_0猪国杀.html?t=Math.random(</a>)</p>
<p>标签：模拟</p>
<p>本题是大模拟，题面很恶心，又长又绕，根本无法概括，不过读懂以后按序操作还是比较容易的。<br>坑点如下：<br>1.如果牌堆中没牌了，那么需要不断的摸取最后一张牌<br>2.无懈可击的使用：可以用来帮助身份已明且和自己一伙的人抵挡南猪入侵、万箭齐发、决杀等效果，或者帮助其抵消对方无懈可击的效果。一旦使出无懈可击即可表明自己的身份，表明身份后类反猪的身份会随之消失。注意无懈可击的使用顺序是从锦囊牌的出牌者开始按照逆时针的顺序进行出牌的。<br>3.一只猪死亡后立刻退场，不会再进行任何操作，所有手牌弃置。如果此时游戏结束，那么一切操作都暂停。<br>4.出完一张牌后（除桃）需要重新扫描所有的手牌，因为每次出牌可能会导致不同的猪身份的改变，进而前面跳过的牌可能有机会打出。<br>5.寻找打出杀得下家时要跳过已经死亡的猪。<br>6.打出决斗，无论最后是否生效，即认为身份表面。对于主猪对忠猪发起的决斗，忠猪乖乖掉血。</p>
<p>附上AC代码：<br>注释版<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 10</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_M 2000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m, Type[MAX_N+<span class="number">5</span>];	<span class="comment">//真实身份（1主公 2忠臣 3反贼）</span></div><div class="line"><span class="keyword">int</span> lft;	<span class="keyword">bool</span> GameOver;	<span class="comment">//剩余反贼、游戏结束标记</span></div><div class="line"><span class="keyword">char</span> Heap[MAX_M*<span class="number">2</span>+<span class="number">5</span>];	<span class="keyword">int</span> CurPos;	<span class="comment">//牌堆</span></div><div class="line"><span class="keyword">int</span> bef[MAX_M*<span class="number">5</span>+<span class="number">5</span>], nxt[MAX_M*<span class="number">5</span>+<span class="number">5</span>], cnt;	<span class="keyword">char</span> c[MAX_M*<span class="number">5</span>+<span class="number">5</span>];	<span class="comment">//手牌</span></div><div class="line"><span class="function"><span class="keyword">char</span> <span class="title">Draw</span><span class="params">()</span> </span>&#123;CurPos = CurPos == m ? m : CurPos+<span class="number">1</span>;	<span class="keyword">return</span> Heap[CurPos];&#125;	<span class="comment">//摸牌</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Attack</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span></span>;	<span class="function"><span class="keyword">void</span> <span class="title">Duel</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span></span>;	<span class="function"><span class="keyword">void</span> <span class="title">Invade</span><span class="params">(<span class="keyword">int</span>)</span></span>;	<span class="function"><span class="keyword">void</span> <span class="title">Arrow</span><span class="params">(<span class="keyword">int</span>)</span></span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Player</span> &#123;</span></div><div class="line">	<span class="keyword">int</span> id, Sta;	<span class="comment">//编号、目前身份（0没跳 1类反 2跳忠 3跳反）</span></div><div class="line">	<span class="keyword">int</span> head, tail, now, tp;	<span class="comment">//手牌链表</span></div><div class="line">	<span class="keyword">int</span> cntWX, cntA, cntP, cntS;	<span class="comment">//手中无懈可击、杀、桃、闪的数量</span></div><div class="line">	<span class="keyword">int</span> blood, atk, pre, suc;	<span class="comment">//血量、首要攻击目标、存活的上一头猪、存活的下一头猪</span></div><div class="line">	<span class="keyword">bool</span> dead, equip;	<span class="comment">//是否死亡、是否装备连弩</span></div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Bonus</span><span class="params">()</span> </span>&#123;	<span class="comment">//奖励</span></div><div class="line">		c[++cnt] = Draw(), bef[cnt] = tail;</div><div class="line">		<span class="keyword">if</span> (head == <span class="number">0</span>)	head = tail = cnt;</div><div class="line">		<span class="keyword">else</span>	nxt[tail] = cnt, tail = cnt;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</div><div class="line">		c[++cnt] = Draw(), bef[cnt] = tail;</div><div class="line">		nxt[tail] = cnt, tail = cnt;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</div><div class="line">		c[++cnt] = Draw(), bef[cnt] = tail;</div><div class="line">		nxt[tail] = cnt, tail = cnt;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Punish</span><span class="params">()</span> </span>&#123;	<span class="comment">//惩罚</span></div><div class="line">		head = tail = now = cntWX = cntA = cntP = cntS = <span class="number">0</span>, equip = <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">DrawSession</span><span class="params">()</span> </span>&#123;	<span class="comment">//摸牌阶段</span></div><div class="line">		c[++cnt] = Draw(), bef[cnt] = tail;</div><div class="line">		<span class="keyword">if</span> (head == <span class="number">0</span>)	head = tail = cnt;</div><div class="line">		<span class="keyword">else</span>	nxt[tail] = cnt, tail = cnt;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</div><div class="line">		c[++cnt] = Draw(), bef[cnt] = tail;</div><div class="line">		nxt[tail] = cnt, tail = cnt;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Use</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;	<span class="comment">//使用一张牌</span></div><div class="line">		<span class="keyword">if</span> (c[x] == <span class="string">'J'</span>)	cntWX--;</div><div class="line">		<span class="keyword">if</span> (c[x] == <span class="string">'K'</span>)	cntA--;</div><div class="line">		<span class="keyword">if</span> (c[x] == <span class="string">'P'</span>)	cntP--;</div><div class="line">		<span class="keyword">if</span> (c[x] == <span class="string">'D'</span>)	cntS--;</div><div class="line">		<span class="keyword">if</span> (x == head &amp;&amp; x == tail)	head = tail = <span class="number">0</span>;</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (x == head)	head = nxt[x], bef[nxt[x]] = <span class="number">0</span>;</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (x == tail)	tail = bef[x], nxt[bef[x]] = <span class="number">0</span>;</div><div class="line">		<span class="keyword">else</span>	bef[nxt[x]] = bef[x], nxt[bef[x]] = nxt[x];</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">char</span> <span class="title">GetNxt</span><span class="params">()</span> </span>&#123;	<span class="comment">//返回下一张牌</span></div><div class="line">		<span class="keyword">if</span> (!now)	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">		tp = now, now = nxt[now];</div><div class="line">		<span class="keyword">return</span> c[tp];</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">findWX</span><span class="params">()</span> </span>&#123;	<span class="comment">//找下一张无懈可击</span></div><div class="line">		now = head;	<span class="keyword">char</span> tmp;</div><div class="line">		<span class="keyword">while</span> (tmp = GetNxt())	<span class="keyword">if</span> (tmp == <span class="string">'J'</span>)	<span class="keyword">return</span> tp;	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">findA</span><span class="params">()</span> </span>&#123;	<span class="comment">//找下一张杀</span></div><div class="line">		now = head;	<span class="keyword">char</span> tmp;</div><div class="line">		<span class="keyword">while</span> (tmp = GetNxt())	<span class="keyword">if</span> (tmp == <span class="string">'K'</span>)	<span class="keyword">return</span> tp;	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">findP</span><span class="params">()</span> </span>&#123;	<span class="comment">//找下一张桃</span></div><div class="line">		now = head;	<span class="keyword">char</span> tmp;</div><div class="line">		<span class="keyword">while</span> (tmp = GetNxt())	<span class="keyword">if</span> (tmp == <span class="string">'P'</span>)	<span class="keyword">return</span> tp;	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">findS</span><span class="params">()</span> </span>&#123;	<span class="comment">//找下一张闪</span></div><div class="line">		now = head;	<span class="keyword">char</span> tmp;</div><div class="line">		<span class="keyword">while</span> (tmp = GetNxt())	<span class="keyword">if</span> (tmp == <span class="string">'D'</span>)	<span class="keyword">return</span> tp;	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">tryWX</span><span class="params">()</span> </span>&#123;	<span class="comment">//尝试出无懈可击</span></div><div class="line">		<span class="keyword">if</span> (cntWX) &#123;Use(findWX());	<span class="keyword">return</span> <span class="literal">true</span>;&#125;</div><div class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">tryA</span><span class="params">()</span> </span>&#123;	<span class="comment">//尝试出杀</span></div><div class="line">		<span class="keyword">if</span> (cntA) &#123;Use(findA());	<span class="keyword">return</span> <span class="literal">true</span>;&#125;</div><div class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">tryS</span><span class="params">()</span> </span>&#123;	<span class="comment">//尝试出闪</span></div><div class="line">		<span class="keyword">if</span> (cntS) &#123;Use(findS());	<span class="keyword">return</span> <span class="literal">true</span>;&#125;</div><div class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">tryP</span><span class="params">()</span> </span>&#123;	<span class="comment">//尝试出桃</span></div><div class="line">		<span class="keyword">if</span> (cntP) &#123;Use(findP());	<span class="keyword">return</span> <span class="literal">true</span>;&#125;</div><div class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Round</span><span class="params">()</span> </span>&#123;</div><div class="line">		DrawSession();	now = head;</div><div class="line">		<span class="keyword">bool</span> atked = <span class="literal">false</span>;	<span class="keyword">char</span> tmp;</div><div class="line">		<span class="keyword">while</span> ((tmp = GetNxt()) &amp;&amp; !GameOver) &#123;</div><div class="line">			<span class="comment">//cout &lt;&lt; tmp &lt;&lt; " ";</span></div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'D'</span> || tmp == <span class="string">'J'</span>)	<span class="keyword">continue</span>;</div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'K'</span> &amp;&amp; atk == suc &amp;&amp; (!atked || equip)) &#123;</div><div class="line">				Use(tp), Attack(id, atk), now = head, atked = <span class="literal">true</span>;</div><div class="line">				<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'P'</span> &amp;&amp; blood != <span class="number">4</span>)	Use(tp), blood++;</div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'F'</span>) &#123;</div><div class="line">				<span class="keyword">if</span> (!atk)	<span class="keyword">continue</span>;</div><div class="line">				Use(tp);</div><div class="line">				<span class="keyword">if</span> (Type[id] == <span class="number">3</span>)	Duel(id, <span class="number">1</span>);</div><div class="line">				<span class="keyword">else</span>	Duel(id, atk);</div><div class="line">				now = head;</div><div class="line">				<span class="keyword">if</span> (GameOver || dead)	<span class="keyword">return</span>;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'N'</span>) &#123;</div><div class="line">				Use(tp), Invade(id), now = head;</div><div class="line">				<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'W'</span>) &#123;</div><div class="line">				Use(tp), Arrow(id), now = head;</div><div class="line">				<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'Z'</span>)	Use(tp), equip = <span class="literal">true</span>, now = head;</div><div class="line">		&#125;</div><div class="line">		<span class="comment">//cout &lt;&lt; endl;</span></div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Output</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (dead) &#123;<span class="built_in">printf</span>(<span class="string">"DEAD\n"</span>);	<span class="keyword">return</span>;&#125;</div><div class="line">		<span class="keyword">for</span> (; head; head = nxt[head])</div><div class="line">			<span class="keyword">if</span> (head == tail)	<span class="built_in">cout</span> &lt;&lt; c[head];</div><div class="line">			<span class="keyword">else</span>	<span class="built_in">cout</span> &lt;&lt; c[head] &lt;&lt; <span class="string">' '</span>;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"\n"</span>);</div><div class="line">	&#125;</div><div class="line">&#125; pig[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">FindAtk</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> y = pig[x].suc;</div><div class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">1</span>) &#123;</div><div class="line">		<span class="keyword">while</span> (y != x) &#123;</div><div class="line">			<span class="keyword">if</span> (pig[y].Sta == <span class="number">1</span> || pig[y].Sta == <span class="number">3</span>) &#123;</div><div class="line">				pig[x].atk = y;	<span class="keyword">return</span>;</div><div class="line">			&#125;</div><div class="line">			y = pig[y].suc;</div><div class="line">		&#125;</div><div class="line">		pig[x].atk = <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">2</span>) &#123;</div><div class="line">		<span class="keyword">while</span> (y != x) &#123;</div><div class="line">			<span class="keyword">if</span> (pig[y].Sta == <span class="number">3</span>) &#123;</div><div class="line">				pig[x].atk = y;	<span class="keyword">return</span>;</div><div class="line">			&#125;</div><div class="line">			y = pig[y].suc;</div><div class="line">		&#125;</div><div class="line">		pig[x].atk = <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">3</span>) &#123;</div><div class="line">		<span class="keyword">while</span> (y != x) &#123;</div><div class="line">			<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta == <span class="number">2</span>) &#123;</div><div class="line">				pig[x].atk = y;	<span class="keyword">return</span>;</div><div class="line">			&#125;</div><div class="line">			y = pig[y].suc;</div><div class="line">		&#125;</div><div class="line">		pig[x].atk = <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Maintain</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> x = pig[<span class="number">1</span>].suc;	FindAtk(<span class="number">1</span>);</div><div class="line">	<span class="keyword">while</span> (x != <span class="number">1</span>)	FindAtk(x), x = pig[x].suc;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Kill</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;	<span class="comment">//杀死对方</span></div><div class="line">	pig[y].dead = <span class="literal">true</span>;</div><div class="line">	<span class="keyword">if</span> (Type[y] == <span class="number">1</span>) &#123;GameOver = <span class="literal">true</span>;	<span class="keyword">return</span>;&#125;</div><div class="line">	<span class="keyword">if</span> (Type[y] == <span class="number">3</span>) &#123;</div><div class="line">		<span class="keyword">if</span> (--lft == <span class="number">0</span>) &#123;GameOver = <span class="literal">true</span>;	<span class="keyword">return</span>;&#125;</div><div class="line">		pig[x].Bonus();</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">1</span> &amp;&amp; Type[y] == <span class="number">2</span>)	pig[x].Punish();</div><div class="line">	<span class="keyword">int</span> PRE = pig[y].pre, SUC = pig[y].suc;</div><div class="line">	pig[PRE].suc = SUC, pig[SUC].pre = PRE;</div><div class="line">	Maintain();</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Hurt</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;	<span class="comment">//命中对方</span></div><div class="line">	<span class="keyword">if</span> (--pig[y].blood == <span class="number">0</span>)</div><div class="line">		<span class="keyword">if</span> (pig[y].tryP())	pig[y].blood++;</div><div class="line">		<span class="keyword">else</span>	Kill(x, y);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Attack</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;	<span class="comment">//杀</span></div><div class="line">	<span class="keyword">if</span> (Type[x] != <span class="number">1</span> &amp;&amp; pig[x].Sta &lt; <span class="number">2</span>) &#123;</div><div class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">3</span>)	pig[x].Sta = <span class="number">2</span>;</div><div class="line">		<span class="keyword">else</span>	pig[x].Sta = <span class="number">3</span>;</div><div class="line">		Maintain();</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (!pig[y].tryS())	Hurt(x, y);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">WXcycle</span><span class="params">(<span class="keyword">int</span> st, <span class="keyword">bool</span> YType)</span> </span>&#123;	<span class="comment">//无懈可击</span></div><div class="line">	<span class="keyword">int</span> last = st, x = st;	<span class="keyword">bool</span> ORI = YType;</div><div class="line">	<span class="keyword">if</span> (YType == (Type[x] == <span class="number">3</span>) &amp;&amp; pig[x].tryWX()) &#123;</div><div class="line">		last = x, YType ^= <span class="number">1</span>;</div><div class="line">		<span class="keyword">if</span> (pig[x].Sta &lt;= <span class="number">2</span>)	pig[x].Sta = <span class="number">3</span>-YType, Maintain();</div><div class="line">	&#125;</div><div class="line">	x = pig[x].suc;</div><div class="line">	<span class="keyword">while</span> (x != last) &#123;</div><div class="line">		<span class="keyword">if</span> (YType == (Type[x] == <span class="number">3</span>) &amp;&amp; pig[x].tryWX()) &#123;</div><div class="line">			last = x, YType ^= <span class="number">1</span>;</div><div class="line">			<span class="keyword">if</span> (pig[x].Sta &lt;= <span class="number">2</span>)	pig[x].Sta = <span class="number">3</span>-YType, Maintain();</div><div class="line">		&#125;</div><div class="line">		x = pig[x].suc;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ORI != YType;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Duel</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;	<span class="comment">//决斗</span></div><div class="line">	<span class="keyword">if</span> (Type[x] != <span class="number">1</span> &amp;&amp; pig[x].Sta &lt; <span class="number">2</span>) &#123;</div><div class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">3</span>)	pig[x].Sta = <span class="number">2</span>;</div><div class="line">		<span class="keyword">else</span>	pig[x].Sta = <span class="number">3</span>;</div><div class="line">		Maintain();</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta &gt;= <span class="number">2</span>)</div><div class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta == <span class="number">2</span>) &#123;</div><div class="line">			<span class="keyword">if</span> (WXcycle(x, <span class="number">0</span>))	<span class="keyword">return</span>;</div><div class="line">		&#125; <span class="keyword">else</span> &#123;</div><div class="line">			<span class="keyword">if</span> (WXcycle(x, <span class="number">1</span>))	<span class="keyword">return</span>;</div><div class="line">		&#125;</div><div class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">1</span> &amp;&amp; Type[y] == <span class="number">2</span>)	Hurt(x, y);</div><div class="line">	<span class="keyword">else</span>	<span class="keyword">for</span> (;;) &#123;</div><div class="line">		<span class="keyword">if</span> (!pig[y].tryA()) &#123;Hurt(x, y);	<span class="keyword">return</span>;&#125;</div><div class="line">		<span class="keyword">if</span> (!pig[x].tryA()) &#123;Hurt(y, x);	<span class="keyword">return</span>;&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Invade</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;	<span class="comment">//南猪入侵</span></div><div class="line">	<span class="keyword">int</span> y = pig[x].suc;</div><div class="line">	<span class="keyword">while</span> (y != x) &#123;</div><div class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta &gt;= <span class="number">2</span>)</div><div class="line">			<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta == <span class="number">2</span>) &#123;</div><div class="line">				<span class="keyword">if</span> (WXcycle(x, <span class="number">0</span>)) &#123;y = pig[y].suc;	<span class="keyword">continue</span>;&#125;</div><div class="line">			&#125; <span class="keyword">else</span> &#123;</div><div class="line">				<span class="keyword">if</span> (WXcycle(x, <span class="number">1</span>)) &#123;y = pig[y].suc;	<span class="keyword">continue</span>;&#125;</div><div class="line">			&#125;</div><div class="line">		<span class="keyword">if</span> (!pig[y].tryA()) &#123;</div><div class="line">			Hurt(x, y);	<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;</div><div class="line">			<span class="keyword">if</span> (y == <span class="number">1</span> &amp;&amp; pig[x].Sta == <span class="number">0</span>)	pig[x].Sta = <span class="number">1</span>, Maintain();</div><div class="line">		&#125;</div><div class="line">		y = pig[y].suc;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Arrow</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;	<span class="comment">//万箭齐发</span></div><div class="line">	<span class="keyword">int</span> y = pig[x].suc;</div><div class="line">	<span class="keyword">while</span> (y != x) &#123;</div><div class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta &gt;= <span class="number">2</span>)</div><div class="line">			<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta == <span class="number">2</span>) &#123;</div><div class="line">				<span class="keyword">if</span> (WXcycle(x, <span class="number">0</span>)) &#123;y = pig[y].suc;	<span class="keyword">continue</span>;&#125;</div><div class="line">			&#125; <span class="keyword">else</span> &#123;</div><div class="line">				<span class="keyword">if</span> (WXcycle(x, <span class="number">1</span>)) &#123;y = pig[y].suc;	<span class="keyword">continue</span>;&#125;</div><div class="line">			&#125;</div><div class="line">		<span class="keyword">if</span> (!pig[y].tryS()) &#123;</div><div class="line">			Hurt(x, y);	<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;</div><div class="line">			<span class="keyword">if</span> (y == <span class="number">1</span> &amp;&amp; pig[x].Sta == <span class="number">0</span>)	pig[x].Sta = <span class="number">1</span>, Maintain();</div><div class="line">		&#125;</div><div class="line">		y = pig[y].suc;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);	<span class="keyword">char</span> s[<span class="number">2</span>];	<span class="keyword">int</span> tot = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt; <span class="number">1</span>; i--)	pig[i].pre = i<span class="number">-1</span>;	pig[<span class="number">1</span>].pre = n;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++)	pig[i].suc = i+<span class="number">1</span>;	pig[n].suc = <span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);</div><div class="line">		<span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'M'</span>)	Type[i] = <span class="number">1</span>;</div><div class="line">		<span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'Z'</span>)	Type[i] = <span class="number">2</span>;</div><div class="line">		<span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'F'</span>)	Type[i] = <span class="number">3</span>, lft++;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);	Heap[++tot] = s[<span class="number">0</span>];</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);	Heap[++tot] = s[<span class="number">0</span>];</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);	Heap[++tot] = s[<span class="number">0</span>];</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);	Heap[++tot] = s[<span class="number">0</span>];</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)	<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s), Heap[++tot] = s[<span class="number">0</span>];	m = tot;	Maintain();</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	pig[i].id = i, pig[i].blood = <span class="number">4</span>, pig[i].DrawSession(), pig[i].DrawSession();</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> cur = <span class="number">1</span>; !GameOver; cur = pig[cur].suc)	pig[cur].Round();</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%s\n"</span>, pig[<span class="number">1</span>].dead ? <span class="string">"FP"</span> : <span class="string">"MP"</span>);	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	pig[i].Output();</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>压行版<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 10</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_M 2000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m, Type[MAX_N+<span class="number">5</span>], lft, CurPos, cnt;	<span class="keyword">bool</span> GameOver;</div><div class="line"><span class="keyword">char</span> Heap[MAX_M*<span class="number">2</span>+<span class="number">5</span>], c[MAX_M*<span class="number">5</span>+<span class="number">5</span>];	<span class="keyword">int</span> bef[MAX_M*<span class="number">5</span>+<span class="number">5</span>], nxt[MAX_M*<span class="number">5</span>+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">char</span> <span class="title">Draw</span><span class="params">()</span> </span>&#123;CurPos = CurPos == m ? m : CurPos+<span class="number">1</span>;	<span class="keyword">return</span> Heap[CurPos];&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Attack</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span></span>;	<span class="function"><span class="keyword">void</span> <span class="title">Duel</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span></span>;	<span class="function"><span class="keyword">void</span> <span class="title">Invade</span><span class="params">(<span class="keyword">int</span>)</span></span>;	<span class="function"><span class="keyword">void</span> <span class="title">Arrow</span><span class="params">(<span class="keyword">int</span>)</span></span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Player</span> &#123;</span></div><div class="line">	<span class="keyword">int</span> id, Sta, head, tail, now, tp, cntWX, cntA, cntP, cntS, blood, atk, pre, suc;	<span class="keyword">bool</span> dead, equip;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Bonus</span><span class="params">()</span> </span>&#123;</div><div class="line">		c[++cnt] = Draw(), bef[cnt] = tail;	<span class="keyword">if</span> (head == <span class="number">0</span>)	head = tail = cnt;	<span class="keyword">else</span>	nxt[tail] = cnt, tail = cnt;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</div><div class="line">		c[++cnt] = Draw(), bef[cnt] = tail;	nxt[tail] = cnt, tail = cnt;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</div><div class="line">		c[++cnt] = Draw(), bef[cnt] = tail;	nxt[tail] = cnt, tail = cnt;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Punish</span><span class="params">()</span> </span>&#123;head = tail = now = cntWX = cntA = cntP = cntS = <span class="number">0</span>, equip = <span class="literal">false</span>;&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">DrawSession</span><span class="params">()</span> </span>&#123;</div><div class="line">		c[++cnt] = Draw(), bef[cnt] = tail;	<span class="keyword">if</span> (head == <span class="number">0</span>)	head = tail = cnt;	<span class="keyword">else</span>	nxt[tail] = cnt, tail = cnt;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</div><div class="line">		c[++cnt] = Draw(), bef[cnt] = tail;	nxt[tail] = cnt, tail = cnt;</div><div class="line">		<span class="keyword">if</span> (c[cnt] == <span class="string">'J'</span>)	cntWX++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'K'</span>)	cntA++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'P'</span>)	cntP++;	<span class="keyword">if</span> (c[cnt] == <span class="string">'D'</span>)	cntS++;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Use</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (c[x] == <span class="string">'J'</span>)	cntWX--;	<span class="keyword">if</span> (c[x] == <span class="string">'K'</span>)	cntA--;	<span class="keyword">if</span> (c[x] == <span class="string">'P'</span>)	cntP--;	<span class="keyword">if</span> (c[x] == <span class="string">'D'</span>)	cntS--;</div><div class="line">		<span class="keyword">if</span> (x == head &amp;&amp; x == tail)	head = tail = <span class="number">0</span>;	<span class="keyword">else</span> <span class="keyword">if</span> (x == head)	head = nxt[x], bef[nxt[x]] = <span class="number">0</span>;</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (x == tail)	tail = bef[x], nxt[bef[x]] = <span class="number">0</span>;	<span class="keyword">else</span>	bef[nxt[x]] = bef[x], nxt[bef[x]] = nxt[x];</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">char</span> <span class="title">GetNxt</span><span class="params">()</span> </span>&#123;<span class="keyword">if</span> (!now)	<span class="keyword">return</span> <span class="number">0</span>;	tp = now, now = nxt[now];	<span class="keyword">return</span> c[tp];&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">findWX</span><span class="params">()</span> </span>&#123;now = head;	<span class="keyword">char</span> tmp;	<span class="keyword">while</span> (tmp = GetNxt())	<span class="keyword">if</span> (tmp == <span class="string">'J'</span>)	<span class="keyword">return</span> tp;	<span class="keyword">return</span> <span class="number">0</span>;&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">findA</span><span class="params">()</span> </span>&#123;now = head;	<span class="keyword">char</span> tmp;	<span class="keyword">while</span> (tmp = GetNxt())	<span class="keyword">if</span> (tmp == <span class="string">'K'</span>)	<span class="keyword">return</span> tp;	<span class="keyword">return</span> <span class="number">0</span>;&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">findP</span><span class="params">()</span> </span>&#123;now = head;	<span class="keyword">char</span> tmp;	<span class="keyword">while</span> (tmp = GetNxt())	<span class="keyword">if</span> (tmp == <span class="string">'P'</span>)	<span class="keyword">return</span> tp;	<span class="keyword">return</span> <span class="number">0</span>;&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">findS</span><span class="params">()</span> </span>&#123;now = head;	<span class="keyword">char</span> tmp;	<span class="keyword">while</span> (tmp = GetNxt())	<span class="keyword">if</span> (tmp == <span class="string">'D'</span>)	<span class="keyword">return</span> tp;	<span class="keyword">return</span> <span class="number">0</span>;&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">tryWX</span><span class="params">()</span> </span>&#123;<span class="keyword">if</span> (cntWX) &#123;Use(findWX());	<span class="keyword">return</span> <span class="literal">true</span>;&#125;	<span class="keyword">return</span> <span class="literal">false</span>;&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">tryA</span><span class="params">()</span> </span>&#123;<span class="keyword">if</span> (cntA) &#123;Use(findA());	<span class="keyword">return</span> <span class="literal">true</span>;&#125;	<span class="keyword">return</span> <span class="literal">false</span>;&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">tryS</span><span class="params">()</span> </span>&#123;<span class="keyword">if</span> (cntS) &#123;Use(findS());	<span class="keyword">return</span> <span class="literal">true</span>;&#125;	<span class="keyword">return</span> <span class="literal">false</span>;&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">tryP</span><span class="params">()</span> </span>&#123;<span class="keyword">if</span> (cntP) &#123;Use(findP());	<span class="keyword">return</span> <span class="literal">true</span>;&#125;	<span class="keyword">return</span> <span class="literal">false</span>;&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Round</span><span class="params">()</span> </span>&#123;</div><div class="line">		DrawSession();	now = head;</div><div class="line">		<span class="keyword">bool</span> atked = <span class="literal">false</span>;	<span class="keyword">char</span> tmp;</div><div class="line">		<span class="keyword">while</span> ((tmp = GetNxt()) &amp;&amp; !GameOver) &#123;</div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'D'</span> || tmp == <span class="string">'J'</span>)	<span class="keyword">continue</span>;</div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'K'</span> &amp;&amp; atk == suc &amp;&amp; (!atked || equip))</div><div class="line">				&#123;Use(tp), Attack(id, atk), now = head, atked = <span class="literal">true</span>;	<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;&#125;</div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'P'</span> &amp;&amp; blood != <span class="number">4</span>)	Use(tp), blood++;</div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'F'</span>) &#123;</div><div class="line">				<span class="keyword">if</span> (!atk)	<span class="keyword">continue</span>;	Use(tp);</div><div class="line">				<span class="keyword">if</span> (Type[id] == <span class="number">3</span>)	Duel(id, <span class="number">1</span>);</div><div class="line">				<span class="keyword">else</span>	Duel(id, atk);	now = head;</div><div class="line">				<span class="keyword">if</span> (GameOver || dead)	<span class="keyword">return</span>;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'N'</span>) &#123;Use(tp), Invade(id), now = head;	<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;&#125;</div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'W'</span>) &#123;Use(tp), Arrow(id), now = head;	<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;&#125;</div><div class="line">			<span class="keyword">if</span> (tmp == <span class="string">'Z'</span>)	Use(tp), equip = <span class="literal">true</span>, now = head;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Output</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (dead) &#123;<span class="built_in">printf</span>(<span class="string">"DEAD\n"</span>);	<span class="keyword">return</span>;&#125;</div><div class="line">		<span class="keyword">for</span> (; head; head = nxt[head])</div><div class="line">			<span class="keyword">if</span> (head == tail)	<span class="built_in">cout</span> &lt;&lt; c[head];</div><div class="line">			<span class="keyword">else</span>	<span class="built_in">cout</span> &lt;&lt; c[head] &lt;&lt; <span class="string">' '</span>;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"\n"</span>);</div><div class="line">	&#125;</div><div class="line">&#125; pig[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">FindAtk</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> y = pig[x].suc;</div><div class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">1</span>) &#123;</div><div class="line">		<span class="keyword">while</span> (y != x) &#123;<span class="keyword">if</span> (pig[y].Sta == <span class="number">1</span> || pig[y].Sta == <span class="number">3</span>) &#123;pig[x].atk = y;	<span class="keyword">return</span>;&#125;	y = pig[y].suc;&#125;</div><div class="line">		pig[x].atk = <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">2</span>) &#123;</div><div class="line">		<span class="keyword">while</span> (y != x) &#123;<span class="keyword">if</span> (pig[y].Sta == <span class="number">3</span>) &#123;pig[x].atk = y;	<span class="keyword">return</span>;&#125;	y = pig[y].suc;&#125;</div><div class="line">		pig[x].atk = <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">3</span>) &#123;</div><div class="line">		<span class="keyword">while</span> (y != x) &#123;<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta == <span class="number">2</span>) &#123;pig[x].atk = y;	<span class="keyword">return</span>;&#125;	y = pig[y].suc;&#125;</div><div class="line">		pig[x].atk = <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Maintain</span><span class="params">()</span> </span>&#123;<span class="keyword">int</span> x = pig[<span class="number">1</span>].suc;	FindAtk(<span class="number">1</span>);	<span class="keyword">while</span> (x != <span class="number">1</span>)	FindAtk(x), x = pig[x].suc;&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Kill</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">	pig[y].dead = <span class="literal">true</span>;</div><div class="line">	<span class="keyword">if</span> (Type[y] == <span class="number">1</span>) &#123;GameOver = <span class="literal">true</span>;	<span class="keyword">return</span>;&#125;</div><div class="line">	<span class="keyword">if</span> (Type[y] == <span class="number">3</span>) &#123;<span class="keyword">if</span> (--lft == <span class="number">0</span>) &#123;GameOver = <span class="literal">true</span>;	<span class="keyword">return</span>;&#125;	pig[x].Bonus();&#125;</div><div class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">1</span> &amp;&amp; Type[y] == <span class="number">2</span>)	pig[x].Punish();</div><div class="line">	<span class="keyword">int</span> PRE = pig[y].pre, SUC = pig[y].suc;	pig[PRE].suc = SUC, pig[SUC].pre = PRE;	Maintain();</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Hurt</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;<span class="keyword">if</span> (--pig[y].blood == <span class="number">0</span>)	<span class="keyword">if</span> (pig[y].tryP())	pig[y].blood++;	<span class="keyword">else</span>	Kill(x, y);&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Attack</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span> (Type[x] != <span class="number">1</span> &amp;&amp; pig[x].Sta &lt; <span class="number">2</span>) &#123;</div><div class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">3</span>)	pig[x].Sta = <span class="number">2</span>;</div><div class="line">		<span class="keyword">else</span>	pig[x].Sta = <span class="number">3</span>;</div><div class="line">		Maintain();</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (!pig[y].tryS())	Hurt(x, y);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">WXcycle</span><span class="params">(<span class="keyword">int</span> st, <span class="keyword">bool</span> YType)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> last = st, x = st;	<span class="keyword">bool</span> ORI = YType;</div><div class="line">	<span class="keyword">if</span> (YType == (Type[x] == <span class="number">3</span>) &amp;&amp; pig[x].tryWX()) &#123;last = x, YType ^= <span class="number">1</span>; <span class="keyword">if</span> (pig[x].Sta &lt;= <span class="number">2</span>) pig[x].Sta = <span class="number">3</span>-YType, Maintain();&#125;</div><div class="line">	x = pig[x].suc;</div><div class="line">	<span class="keyword">while</span> (x != last) &#123;</div><div class="line">		<span class="keyword">if</span> (YType == (Type[x] == <span class="number">3</span>) &amp;&amp; pig[x].tryWX())</div><div class="line">			&#123;last = x, YType ^= <span class="number">1</span>;	<span class="keyword">if</span> (pig[x].Sta &lt;= <span class="number">2</span>)	pig[x].Sta = <span class="number">3</span>-YType, Maintain();&#125;</div><div class="line">		x = pig[x].suc;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ORI != YType;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Duel</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span> (Type[x] != <span class="number">1</span> &amp;&amp; pig[x].Sta &lt; <span class="number">2</span>) &#123;<span class="keyword">if</span> (Type[y] == <span class="number">3</span>)	pig[x].Sta = <span class="number">2</span>;	<span class="keyword">else</span>	pig[x].Sta = <span class="number">3</span>;	Maintain();&#125;</div><div class="line">	<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta &gt;= <span class="number">2</span>)</div><div class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta == <span class="number">2</span>) &#123;<span class="keyword">if</span> (WXcycle(x, <span class="number">0</span>))	<span class="keyword">return</span>;&#125;</div><div class="line">		<span class="keyword">else</span> &#123;<span class="keyword">if</span> (WXcycle(x, <span class="number">1</span>))	<span class="keyword">return</span>;&#125;</div><div class="line">	<span class="keyword">if</span> (Type[x] == <span class="number">1</span> &amp;&amp; Type[y] == <span class="number">2</span>)	Hurt(x, y);</div><div class="line">	<span class="keyword">else</span>	<span class="keyword">for</span> (;;) &#123;<span class="keyword">if</span> (!pig[y].tryA()) &#123;Hurt(x, y);	<span class="keyword">return</span>;&#125;	<span class="keyword">if</span> (!pig[x].tryA()) &#123;Hurt(y, x);	<span class="keyword">return</span>;&#125;&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Invade</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> y = pig[x].suc;</div><div class="line">	<span class="keyword">while</span> (y != x) &#123;</div><div class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta &gt;= <span class="number">2</span>)</div><div class="line">			<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta == <span class="number">2</span>) &#123;<span class="keyword">if</span> (WXcycle(x, <span class="number">0</span>)) &#123;y = pig[y].suc;	<span class="keyword">continue</span>;&#125;&#125;</div><div class="line">			<span class="keyword">else</span> &#123;<span class="keyword">if</span> (WXcycle(x, <span class="number">1</span>)) &#123;y = pig[y].suc;	<span class="keyword">continue</span>;&#125;&#125;</div><div class="line">		<span class="keyword">if</span> (!pig[y].tryA()) &#123;</div><div class="line">			Hurt(x, y);	<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;</div><div class="line">			<span class="keyword">if</span> (y == <span class="number">1</span> &amp;&amp; pig[x].Sta == <span class="number">0</span>)	pig[x].Sta = <span class="number">1</span>, Maintain();</div><div class="line">		&#125;</div><div class="line">		y = pig[y].suc;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Arrow</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> y = pig[x].suc;</div><div class="line">	<span class="keyword">while</span> (y != x) &#123;</div><div class="line">		<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta &gt;= <span class="number">2</span>)</div><div class="line">			<span class="keyword">if</span> (Type[y] == <span class="number">1</span> || pig[y].Sta == <span class="number">2</span>) &#123;<span class="keyword">if</span> (WXcycle(x, <span class="number">0</span>)) &#123;y = pig[y].suc;	<span class="keyword">continue</span>;&#125;&#125;</div><div class="line">			<span class="keyword">else</span> &#123;<span class="keyword">if</span> (WXcycle(x, <span class="number">1</span>)) &#123;y = pig[y].suc;	<span class="keyword">continue</span>;&#125;&#125;</div><div class="line">		<span class="keyword">if</span> (!pig[y].tryS()) &#123;</div><div class="line">			Hurt(x, y);	<span class="keyword">if</span> (GameOver)	<span class="keyword">return</span>;</div><div class="line">			<span class="keyword">if</span> (y == <span class="number">1</span> &amp;&amp; pig[x].Sta == <span class="number">0</span>)	pig[x].Sta = <span class="number">1</span>, Maintain();</div><div class="line">		&#125;</div><div class="line">		y = pig[y].suc;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);	<span class="keyword">char</span> s[<span class="number">2</span>];	<span class="keyword">int</span> tot = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt; <span class="number">1</span>; i--)	pig[i].pre = i<span class="number">-1</span>;	pig[<span class="number">1</span>].pre = n;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++)	pig[i].suc = i+<span class="number">1</span>;	pig[n].suc = <span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);</div><div class="line">		<span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'M'</span>)	Type[i] = <span class="number">1</span>;	<span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'Z'</span>)	Type[i] = <span class="number">2</span>;	<span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'F'</span>)	Type[i] = <span class="number">3</span>, lft++;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);	Heap[++tot] = s[<span class="number">0</span>];	<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);	Heap[++tot] = s[<span class="number">0</span>];</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);	Heap[++tot] = s[<span class="number">0</span>];	<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);	Heap[++tot] = s[<span class="number">0</span>];</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)	<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s), Heap[++tot] = s[<span class="number">0</span>];	m = tot;	Maintain();</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	pig[i].id = i, pig[i].blood = <span class="number">4</span>, pig[i].DrawSession(), pig[i].DrawSession();</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> cur = <span class="number">1</span>; !GameOver; cur = pig[cur].suc)	pig[cur].Round();</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%s\n"</span>, pig[<span class="number">1</span>].dead ? <span class="string">"FP"</span> : <span class="string">"MP"</span>);	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	pig[i].Output();</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/BZOJ/">BZOJ</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/模拟/">模拟</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/省选/">省选</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2017 Azrael_Death
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a>
        </div>
    </div>
  </div>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
  </script>
  <script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  
</footer>

    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="/js/main.js"></script>
<!--
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
-->



  </div>
</body>
</html>