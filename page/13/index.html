<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>NIRVANA</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Blog of a Chinese OIer">
<meta property="og:type" content="website">
<meta property="og:title" content="NIRVANA">
<meta property="og:url" content="http://yoursite.com/page/13/index.html">
<meta property="og:site_name" content="NIRVANA">
<meta property="og:description" content="Blog of a Chinese OIer">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="NIRVANA">
<meta name="twitter:description" content="Blog of a Chinese OIer">
  
    <link rel="alternative" href="/atom.xml" title="NIRVANA" type="application/atom+xml">
  
  
    <link rel="icon" href="http://chuantu.biz/t6/89/1507626502x2728279003.jpg">
  
  <link rel="stylesheet" href="/css/style.css">
  
  

  <script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>
  <script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>

  
</head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="https://i.loli.net/2017/12/08/5a2a79235ac3d.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Azrael_Death</a></h1>
		</hgroup>

		
		<p class="header-subtitle">Veni Vidi Vici</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/AzraelDeath" title="github">github</a>
					        
								<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/azraeldeath" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/2-SAT/" style="font-size: 10.77px;">2-SAT</a> <a href="/tags/AC自动机/" style="font-size: 10.77px;">AC自动机</a> <a href="/tags/AMPPZ/" style="font-size: 13.08px;">AMPPZ</a> <a href="/tags/APIO/" style="font-size: 10px;">APIO</a> <a href="/tags/BZOJ/" style="font-size: 20px;">BZOJ</a> <a href="/tags/CDQ分治/" style="font-size: 10px;">CDQ分治</a> <a href="/tags/DFS序/" style="font-size: 10px;">DFS序</a> <a href="/tags/DP/" style="font-size: 15.38px;">DP</a> <a href="/tags/HDU/" style="font-size: 12.31px;">HDU</a> <a href="/tags/IOI/" style="font-size: 10px;">IOI</a> <a href="/tags/JOI/" style="font-size: 10px;">JOI</a> <a href="/tags/LCA/" style="font-size: 12.31px;">LCA</a> <a href="/tags/LG/" style="font-size: 12.31px;">LG</a> <a href="/tags/MST/" style="font-size: 13.08px;">MST</a> <a href="/tags/Manacher/" style="font-size: 10.77px;">Manacher</a> <a href="/tags/NOI/" style="font-size: 10.77px;">NOI</a> <a href="/tags/NOIp/" style="font-size: 13.85px;">NOIp</a> <a href="/tags/POI/" style="font-size: 10px;">POI</a> <a href="/tags/POJ/" style="font-size: 14.62px;">POJ</a> <a href="/tags/Tarjan/" style="font-size: 10.77px;">Tarjan</a> <a href="/tags/Trie/" style="font-size: 10px;">Trie</a> <a href="/tags/UVa/" style="font-size: 10px;">UVa</a> <a href="/tags/主席树/" style="font-size: 12.31px;">主席树</a> <a href="/tags/二分图/" style="font-size: 10px;">二分图</a> <a href="/tags/二分答案/" style="font-size: 10.77px;">二分答案</a> <a href="/tags/分块/" style="font-size: 10px;">分块</a> <a href="/tags/图论/" style="font-size: 19.23px;">图论</a> <a href="/tags/字符串/" style="font-size: 12.31px;">字符串</a> <a href="/tags/差分/" style="font-size: 10px;">差分</a> <a href="/tags/差分约束系统/" style="font-size: 10px;">差分约束系统</a> <a href="/tags/并查集/" style="font-size: 10.77px;">并查集</a> <a href="/tags/总结/" style="font-size: 16.92px;">总结</a> <a href="/tags/搜索/" style="font-size: 10px;">搜索</a> <a href="/tags/数位DP/" style="font-size: 10.77px;">数位DP</a> <a href="/tags/数据结构/" style="font-size: 17.69px;">数据结构</a> <a href="/tags/数论数学/" style="font-size: 11.54px;">数论数学</a> <a href="/tags/最大团/" style="font-size: 10px;">最大团</a> <a href="/tags/最小割/" style="font-size: 12.31px;">最小割</a> <a href="/tags/最短路/" style="font-size: 10px;">最短路</a> <a href="/tags/最短路径/" style="font-size: 10px;">最短路径</a> <a href="/tags/期望DP/" style="font-size: 10px;">期望DP</a> <a href="/tags/构造/" style="font-size: 10px;">构造</a> <a href="/tags/树分治/" style="font-size: 11.54px;">树分治</a> <a href="/tags/树套树/" style="font-size: 10.77px;">树套树</a> <a href="/tags/树状数组/" style="font-size: 11.54px;">树状数组</a> <a href="/tags/树相关/" style="font-size: 10.77px;">树相关</a> <a href="/tags/树链剖分/" style="font-size: 10px;">树链剖分</a> <a href="/tags/模拟/" style="font-size: 10.77px;">模拟</a> <a href="/tags/状压DP/" style="font-size: 11.54px;">状压DP</a> <a href="/tags/省选/" style="font-size: 18.46px;">省选</a> <a href="/tags/线段树/" style="font-size: 13.08px;">线段树</a> <a href="/tags/组合数学/" style="font-size: 10px;">组合数学</a> <a href="/tags/网络流/" style="font-size: 16.15px;">网络流</a> <a href="/tags/莫队/" style="font-size: 10.77px;">莫队</a> <a href="/tags/补集转换/" style="font-size: 10px;">补集转换</a> <a href="/tags/贪心/" style="font-size: 10px;">贪心</a> <a href="/tags/费用流/" style="font-size: 10px;">费用流</a> <a href="/tags/队列/" style="font-size: 10px;">队列</a> <a href="/tags/随机化/" style="font-size: 10.77px;">随机化</a> <a href="/tags/高斯消元/" style="font-size: 10px;">高斯消元</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.csdn.net/OwenOwl">OwenOwl</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.csdn.net/Joker_69">Joker</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://dangxingyu.com">DXY</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://309459245.lofter.com">YJQ</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/candy99">Candy</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/zig-zag">ZigZag</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://cxjyxx.me">cxjyxx_me</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.shuizilong.com">ShuiZiLong</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/kuangbin">KuangBin</a>
			        
			        </div>
				</section>
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Azrael_Death</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="https://i.loli.net/2017/12/08/5a2a79235ac3d.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">Azrael_Death</h1>
			</hgroup>
			
			<p class="header-subtitle">Veni Vidi Vici</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/AzraelDeath" title="github">github</a>
			        
						<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/azraeldeath" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-POJ1170 Shopping Offers 五维DP" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/POJ1170 Shopping Offers 五维DP/" class="article-date">
  	<time datetime="2017-08-16T16:00:00.000Z" itemprop="datePublished">2017-08-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/POJ1170 Shopping Offers 五维DP/">
        POJ1170 Shopping Offers &lt;五维DP&gt;
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><blockquote>
<h2 id="Shopping-Offers"><a href="#Shopping-Offers" class="headerlink" title="Shopping Offers"></a>Shopping Offers</h2><h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>In a shop each kind of product has a price. For example, the price of a flower is 2 ICU (Informatics Currency Units) and the price of a vase is 5 ICU. In order to attract more customers, the shop introduces some special offers.<br>A special offer consists of one or more product items for a reduced price. Examples: three flowers for 5 ICU instead of 6, or two vases together with one flower for 10 ICU instead of 12.<br>Write a program that calculates the price a customer has to pay for certain items, making optimal use of the special offers. That is, the price should be as low as possible. You are not allowed to add items, even if that would lower the price.<br>For the prices and offers given above, the (lowest) price for three flowers and two vases is 14 ICU: two vases and one flower for the reduced price of 10 ICU and two flowers for the regular price of 4 ICU. </p>
<h3 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h3><p>Your program is to read from standard input. The first line contains the number b of different kinds of products in the basket (0 &lt;= b &lt;= 5). Each of the next b lines contains three values c, k, and p. The value c is the (unique) product code (1 &lt;= c &lt;= 999). The value k indicates how many items of this product are in the basket (1 &lt;= k &lt;= 5). The value p is the regular price per item (1 &lt;= p &lt;= 999). Notice that all together at most 5*5=25 items can be in the basket. The b+2nd line contains the number s of special offers (0 &lt;= s &lt;= 99). Each of the next s lines describes one offer by giving its structure and its reduced price. The first number n on such a line is the number of different kinds of products that are part of the offer (1 &lt;= n &lt;= 5). The next n pairs of numbers (c,k) indicate that k items (1 &lt;= k &lt;= 5) with product code c (1 &lt;= c &lt;= 999) are involved in the offer. The last number p on the line stands for the reduced price (1 &lt;= p &lt;= 9999). The reduced price of an offer is less than the sum of the regular prices. </p>
<h3 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h3><p>Your program is to write to standard output. Output one line with the lowest possible price to be paid. </p>
<h3 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h3><p>2<br>7 3 2<br>8 2 5<br>2<br>1 7 3 5<br>2 7 1 8 2 10</p>
<h3 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h3><p>14</p>
</blockquote>
<p>&#x6807;&#x7B7E;&#xFF1A;&#x4E94;&#x7EF4;DP</p>
<h2 id="Translation"><a href="#Translation" class="headerlink" title="Translation"></a>Translation</h2><p>&#x9898;&#x76EE;&#x5927;&#x610F;&#xFF1A;&#x6709;&#x81F3;&#x591A;&#x4E94;&#x79CD;&#x7269;&#x54C1;&#xFF0C;&#x7ED9;&#x51FA;&#x6BCF;&#x4E00;&#x79CD;&#x7269;&#x54C1;&#x7684;&#x5355;&#x4EF7;&#x548C;&#x51E0;&#x79CD;&#x5957;&#x9910;&#x7684;&#x4EF7;&#x683C;&#xFF0C;&#x6C42;&#x4E70;&#x76EE;&#x6807;&#x7269;&#x54C1;&#x81F3;&#x5C11;&#x9700;&#x8981;&#x591A;&#x5C11;&#x94B1;&#x3002;</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>&#x8FD9;&#x662F;&#x4E00;&#x9053;&#x5927;&#x6C34;&#x9898;&#x3002;&#x56E0;&#x4E3A;&#x53EA;&#x6709;&#x4E94;&#x79CD;&#x7269;&#x54C1;&#xFF0C;&#x53EF;&#x4EE5;&#x7528;&#x4E94;&#x7EF4;&#x7684;dp&#x6765;&#x8868;&#x793A;&#xFF0C;&#x4E94;&#x4E2A;&#x7EF4;&#x5EA6;&#x5206;&#x522B;&#x8868;&#x793A;&#x4E94;&#x79CD;&#x7269;&#x54C1;&#x7684;&#x4E2A;&#x6570;&#xFF0C;&#x5373;f[i][j][p][q][r]&#x8868;&#x793A;&#x7B2C;&#x4E00;&#x79CD;&#x7269;&#x54C1;&#x53D6;i&#x4E2A;&#xFF0C;&#x7B2C;&#x4E8C;&#x79CD;&#x7269;&#x54C1;&#x53D6;j&#x4E2A;&#x2026;&#x2026;&#x7B2C;&#x4E94;&#x79CD;&#x7269;&#x54C1;&#x53D6;r&#x4E2A;&#x81F3;&#x5C11;&#x9700;&#x8981;&#x591A;&#x5C11;&#x94B1;&#x3002;&#x628A;&#x6BCF;&#x79CD;&#x7269;&#x54C1;&#x7684;&#x5355;&#x4EF7;&#x770B;&#x4F5C;&#x4E00;&#x79CD;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x7269;&#x54C1;&#x7684;&#x5957;&#x9910;&#xFF0C;&#x8FD9;&#x6837;&#x679A;&#x4E3E;&#x5957;&#x9910;&#xFF0C;&#x770B;&#x80FD;&#x5426;&#x8F6C;&#x79FB;&#x3002;</p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 5</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_S 100</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_C 1000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2147483647</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m, cnt, basket[MAX_N+<span class="number">5</span>], offer[MAX_S+<span class="number">10</span>][MAX_N+<span class="number">5</span>], v[MAX_S+<span class="number">10</span>], <span class="built_in">map</span>[MAX_C+<span class="number">5</span>];</div><div class="line"><span class="keyword">int</span> f[MAX_N+<span class="number">5</span>][MAX_N+<span class="number">5</span>][MAX_N+<span class="number">5</span>][MAX_N+<span class="number">5</span>][MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) {</div><div class="line">		<span class="keyword">int</span> id, num, p;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;id, &amp;num, &amp;p);</div><div class="line">		<span class="built_in">map</span>[id] = i, basket[i] = num, offer[cnt][i] = <span class="number">1</span>, v[cnt++] = p;</div><div class="line">	}</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;m);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i =<span class="number">0</span>; i &lt; m; i++) {</div><div class="line">		<span class="keyword">int</span> num, id, k, p;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;num);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; num; i++) {</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;id, &amp;k);</div><div class="line">			offer[cnt][<span class="built_in">map</span>[id]] = k;</div><div class="line">		}</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;p);</div><div class="line">		v[cnt++] = p;</div><div class="line">	}</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> a0 = <span class="number">0</span>; a0 &lt;= basket[<span class="number">0</span>]; a0++)</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> a1 = <span class="number">0</span>; a1 &lt;= basket[<span class="number">1</span>]; a1++)</div><div class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> a2 = <span class="number">0</span>; a2 &lt;= basket[<span class="number">2</span>]; a2++)</div><div class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> a3 = <span class="number">0</span>; a3 &lt;= basket[<span class="number">3</span>]; a3++)</div><div class="line">					<span class="keyword">for</span> (<span class="keyword">int</span> a4 = <span class="number">0</span>; a4 &lt;= basket[<span class="number">4</span>]; a4++) {</div><div class="line">						<span class="keyword">if</span> (a0 == <span class="number">0</span> &amp;&amp; a1 == <span class="number">0</span> &amp;&amp; a2 == <span class="number">0</span> &amp;&amp; a3 == <span class="number">0</span> &amp;&amp; a4 == <span class="number">0</span>) {f[a0][a1][a2][a3][a4] = <span class="number">0</span>;	<span class="keyword">continue</span>;}</div><div class="line">						f[a0][a1][a2][a3][a4] = INF;</div><div class="line">						<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; i++) {</div><div class="line">							<span class="keyword">if</span> (a0 &lt; offer[i][<span class="number">0</span>] || a1 &lt; offer[i][<span class="number">1</span>] || a2 &lt; offer[i][<span class="number">2</span>] || a3 &lt; offer[i][<span class="number">3</span>] || a4 &lt; offer[i][<span class="number">4</span>])	<span class="keyword">continue</span>;</div><div class="line">							f[a0][a1][a2][a3][a4] = min(f[a0][a1][a2][a3][a4], f[a0-offer[i][<span class="number">0</span>]][a1-offer[i][<span class="number">1</span>]][a2-offer[i][<span class="number">2</span>]][a3-offer[i][<span class="number">3</span>]][a4-offer[i][<span class="number">4</span>]]+v[i]);</div><div class="line">						}</div><div class="line">					}</div><div class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, f[basket[<span class="number">0</span>]][basket[<span class="number">1</span>]][basket[<span class="number">2</span>]][basket[<span class="number">3</span>]][basket[<span class="number">4</span>]]);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DP/">DP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/POJ/">POJ</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-BZOJ3110 K大数查询 树套树" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/BZOJ3110 K大数查询 树套树/" class="article-date">
  	<time datetime="2017-08-16T16:00:00.000Z" itemprop="datePublished">2017-08-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/BZOJ3110 K大数查询 树套树/">
        BZOJ3110 K大数查询 &lt;树套树&gt;
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><blockquote>
<h2 id="K&#x5927;&#x6570;&#x67E5;&#x8BE2;"><a href="#K&#x5927;&#x6570;&#x67E5;&#x8BE2;" class="headerlink" title="K&#x5927;&#x6570;&#x67E5;&#x8BE2;"></a>K&#x5927;&#x6570;&#x67E5;&#x8BE2;</h2><h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>&#x6709;N&#x4E2A;&#x4F4D;&#x7F6E;&#xFF0C;M&#x4E2A;&#x64CD;&#x4F5C;&#x3002;&#x64CD;&#x4F5C;&#x6709;&#x4E24;&#x79CD;&#xFF0C;&#x6BCF;&#x6B21;&#x64CD;&#x4F5C;&#x5982;&#x679C;&#x662F;1 a b c&#x7684;&#x5F62;&#x5F0F;&#x8868;&#x793A;&#x5728;&#x7B2C;a&#x4E2A;&#x4F4D;&#x7F6E;&#x5230;&#x7B2C;b&#x4E2A;&#x4F4D;&#x7F6E;&#xFF0C;&#x6BCF;&#x4E2A;&#x4F4D;&#x7F6E;&#x52A0;&#x5165;&#x4E00;&#x4E2A;&#x6570;c<br>&#x5982;&#x679C;&#x662F;2 a b c&#x5F62;&#x5F0F;&#xFF0C;&#x8868;&#x793A;&#x8BE2;&#x95EE;&#x4ECE;&#x7B2C;a&#x4E2A;&#x4F4D;&#x7F6E;&#x5230;&#x7B2C;b&#x4E2A;&#x4F4D;&#x7F6E;&#xFF0C;&#x7B2C;C&#x5927;&#x7684;&#x6570;&#x662F;&#x591A;&#x5C11;&#x3002;</p>
<h3 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h3><p>&#x7B2C;&#x4E00;&#x884C;N&#xFF0C;M<br>&#x63A5;&#x4E0B;&#x6765;M&#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x5F62;&#x5982;1 a b c&#x6216;2 a b c</p>
<h3 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h3><p>&#x8F93;&#x51FA;&#x6BCF;&#x4E2A;&#x8BE2;&#x95EE;&#x7684;&#x7ED3;&#x679C;</p>
<h3 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h3><p>2 5<br>1 1 2 1<br>1 1 2 2<br>2 1 1 2<br>2 1 1 1<br>2 1 2 3</p>
<h3 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h3><p>1<br>2<br>1</p>
<h3 id="Hint"><a href="#Hint" class="headerlink" title="Hint"></a>Hint</h3><p>&#x6837;&#x4F8B;&#x8BF4;&#x660E;<br>&#x7B2C;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;&#x540E;&#x4F4D;&#x7F6E;1&#x7684;&#x6570;&#x53EA;&#x6709;1&#xFF0C;&#x4F4D;&#x7F6E;2&#x7684;&#x6570;&#x4E5F;&#x53EA;&#x6709;1&#x3002;&#x7B2C;&#x4E8C;&#x4E2A;&#x64CD;&#x4F5C;&#x540E;&#x4F4D;&#x7F6E;1&#x7684;&#x6570;&#x6709;1&#x3001;2&#xFF0C;&#x4F4D;&#x7F6E;2&#x7684;&#x6570;&#x4E5F;&#x6709;1&#x3001;2&#x3002;&#x7B2C;&#x4E09;&#x6B21;&#x8BE2;&#x95EE;&#x4F4D;&#x7F6E;1&#x5230;&#x4F4D;&#x7F6E;1&#x7B2C;2&#x5927;&#x7684;&#x6570;&#x662F;1&#x3002;&#x7B2C;&#x56DB;&#x6B21;&#x8BE2;&#x95EE;&#x4F4D;&#x7F6E;1&#x5230;&#x4F4D;&#x7F6E;1&#x7B2C;1&#x5927;&#x7684;&#x6570;&#x662F;2&#x3002;&#x7B2C;&#x4E94;&#x6B21;&#x8BE2;&#x95EE;&#x4F4D;&#x7F6E;1&#x5230;&#x4F4D;&#x7F6E;2&#x7B2C;3&#x5927;&#x7684;&#x6570;&#x662F;1&#x3002;<br>N,M&lt;=50000,N,M&lt;=50000<br>a&lt;=b&lt;=N<br>1&#x64CD;&#x4F5C;&#x4E2D;abs(c)&lt;=N<br>2&#x64CD;&#x4F5C;&#x4E2D;c&lt;=Maxlongint</p>
</blockquote>
<p>&#x6807;&#x7B7E;&#xFF1A;&#x503C;&#x57DF;&#x7EBF;&#x6BB5;&#x6811;&#x5957;&#x533A;&#x95F4;&#x7EBF;&#x6BB5;&#x6811;</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>&#x8FD9;&#x9053;&#x9898;&#x4E4D;&#x4E00;&#x770B;&#x65F6;&#x4E3B;&#x5E2D;&#x6811;&#xFF0C;&#x4F46;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x6811;&#x5957;&#x6811;&#x3002;&#x4F46;&#x4E0D;&#x7BA1;&#x600E;&#x6837;&#xFF0C;&#x6B64;&#x9898;&#x90FD;&#x5F88;&#x6C34;&#xFF0C;&#x6545;&#x4E0D;&#x8BE6;&#x7EC6;&#x9610;&#x8FF0;&#x3002;<br>&#x5916;&#x5C42;&#x503C;&#x57DF;&#x7EBF;&#x6BB5;&#x6811;&#xFF0C;&#x5185;&#x5C42;&#x533A;&#x95F4;&#x7EBF;&#x6BB5;&#x6811;&#xFF0C;&#x5916;&#x5C42;&#x53EA;&#x63D0;&#x4F9B;&#x5185;&#x5C42;&#x7684;&#x6839;&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x771F;&#x6B63;&#x53C2;&#x4E0E;&#x8BA1;&#x7B97;&#x7684;&#x662F;&#x5185;&#x5C42;&#x3002;</p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 50000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"><span class="keyword">int</span> n, m, cnt;</div><div class="line"><span class="keyword">int</span> root[(MAX_N&lt;&lt;<span class="number">2</span>)+<span class="number">500</span>], ls[MAX_N*<span class="number">16</span>*<span class="number">16</span>+<span class="number">500</span>], rs[MAX_N*<span class="number">16</span>*<span class="number">16</span>+<span class="number">500</span>];</div><div class="line">ll tr[MAX_N*<span class="number">16</span>*<span class="number">16</span>+<span class="number">500</span>], tag[MAX_N*<span class="number">16</span>*<span class="number">16</span>+<span class="number">500</span>];</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">updata</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>{tr[v] = tr[ls[v]]+tr[rs[v]]+tag[v]*(ll)(t-s+<span class="number">1</span>);}</div><div class="line"><span class="comment">//&#x5185;&#x5C42;&#x4FEE;&#x6539;</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> &amp;v, <span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (!v)	v = ++cnt;</div><div class="line">	<span class="keyword">if</span> (s &gt;= l &amp;&amp; t &lt;= r) {tr[v] += (ll)(t-s+<span class="number">1</span>), tag[v]++; <span class="keyword">return</span>;}</div><div class="line">	<span class="keyword">int</span> mid = s+t&gt;&gt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span> (l &lt;= mid)	modify(ls[v], s, mid, l, r);</div><div class="line">	<span class="keyword">if</span> (r &gt;= mid+<span class="number">1</span>)	modify(rs[v], mid+<span class="number">1</span>, t, l, r);</div><div class="line">	updata(v, s, t);</div><div class="line">}</div><div class="line"><span class="comment">//&#x5916;&#x5C42;&#x4FEE;&#x6539;</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x)</span> </span>{</div><div class="line">	modify(root[v], <span class="number">1</span>, n, l, r);</div><div class="line">	<span class="keyword">if</span> (s == t)	<span class="keyword">return</span>;</div><div class="line">	<span class="keyword">int</span> mid = s+t&gt;&gt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span> (x &lt;= mid)	insert(v&lt;&lt;<span class="number">1</span>, s, mid, l, r, x);</div><div class="line">	<span class="keyword">if</span> (x &gt;= mid+<span class="number">1</span>)	insert(v&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, t, l, r, x);</div><div class="line">}</div><div class="line"><span class="comment">//&#x5185;&#x5C42;&#x67E5;&#x8BE2;</span></div><div class="line"><span class="function">ll <span class="title">calc</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (!v)	<span class="keyword">return</span> <span class="number">0</span>;	</div><div class="line">	<span class="keyword">if</span> (s &gt;= l &amp;&amp; t &lt;= r)	<span class="keyword">return</span> tr[v];</div><div class="line">	<span class="keyword">int</span> mid = s+t&gt;&gt;<span class="number">1</span>;</div><div class="line">	ll ret = tag[v]*(ll)(min(t, r)-max(s, l)+<span class="number">1</span>);</div><div class="line">	<span class="keyword">if</span> (l &lt;= mid)	ret += calc(ls[v], s, mid, l, r);</div><div class="line">	<span class="keyword">if</span> (r &gt;= mid+<span class="number">1</span>)	ret += calc(rs[v], mid+<span class="number">1</span>, t, l, r);</div><div class="line">	<span class="keyword">return</span> ret;</div><div class="line">}</div><div class="line"><span class="comment">//&#x5916;&#x5C42;&#x67E5;&#x8BE2;</span></div><div class="line"><span class="function">ll <span class="title">query</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (s == t)	<span class="keyword">return</span> s;</div><div class="line">	<span class="keyword">int</span> mid = s+t&gt;&gt;<span class="number">1</span>;</div><div class="line">	ll tmp = calc(root[v&lt;&lt;<span class="number">1</span>|<span class="number">1</span>], <span class="number">1</span>, n, l, r);</div><div class="line">	<span class="keyword">if</span> (k &gt;= tmp+<span class="number">1</span>)	<span class="keyword">return</span> query(v&lt;&lt;<span class="number">1</span>, s, mid, l, r, k-tmp);</div><div class="line">	<span class="keyword">if</span> (k &lt;= tmp)	<span class="keyword">return</span> query(v&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, t, l, r, k);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</div><div class="line">	<span class="keyword">while</span> (m--) {</div><div class="line">		<span class="keyword">int</span> opt, a, b, c;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;opt, &amp;a, &amp;b, &amp;c);</div><div class="line">		<span class="keyword">if</span> (opt == <span class="number">1</span>)	insert(<span class="number">1</span>, <span class="number">1</span>, n, a, b, c);</div><div class="line">		<span class="keyword">if</span> (opt == <span class="number">2</span>)	<span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, query(<span class="number">1</span>, <span class="number">1</span>, n, a, b, c));</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/BZOJ/">BZOJ</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据结构/">数据结构</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/树套树/">树套树</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-BZOJ1798【AHOI2009】 seq维护序列 线段树" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/BZOJ1798【AHOI2009】 seq维护序列 线段树/" class="article-date">
  	<time datetime="2017-08-14T16:00:00.000Z" itemprop="datePublished">2017-08-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/BZOJ1798【AHOI2009】 seq维护序列 线段树/">
        BZOJ1798 【AHOI2009】 seq维护序列 &lt;线段树&gt;
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><blockquote>
<h2 id="&#x7EF4;&#x62A4;&#x5E8F;&#x5217;"><a href="#&#x7EF4;&#x62A4;&#x5E8F;&#x5217;" class="headerlink" title="&#x7EF4;&#x62A4;&#x5E8F;&#x5217;"></a>&#x7EF4;&#x62A4;&#x5E8F;&#x5217;</h2><h3 id="&#x9898;&#x76EE;&#x63CF;&#x8FF0;"><a href="#&#x9898;&#x76EE;&#x63CF;&#x8FF0;" class="headerlink" title="&#x9898;&#x76EE;&#x63CF;&#x8FF0;"></a>&#x9898;&#x76EE;&#x63CF;&#x8FF0;</h3><p>&#x8001;&#x5E08;&#x4EA4;&#x7ED9;&#x5C0F;&#x53EF;&#x53EF;&#x4E00;&#x4E2A;&#x7EF4;&#x62A4;&#x6570;&#x5217;&#x7684;&#x4EFB;&#x52A1;&#xFF0C;&#x73B0;&#x5728;&#x5C0F;&#x53EF;&#x53EF;&#x5E0C;&#x671B;&#x4F60;&#x6765;&#x5E2E;&#x4ED6;&#x5B8C;&#x6210;&#x3002; &#x6709;&#x957F;&#x4E3A;N&#x7684;&#x6570;&#x5217;&#xFF0C;&#x4E0D;&#x59A8;&#x8BBE;&#x4E3A;a1,a2,&#x2026;,aN &#x3002;&#x6709;&#x5982;&#x4E0B;&#x4E09;&#x79CD;&#x64CD;&#x4F5C;&#x5F62;&#x5F0F;&#xFF1A; (1)&#x628A;&#x6570;&#x5217;&#x4E2D;&#x7684;&#x4E00;&#x6BB5;&#x6570;&#x5168;&#x90E8;&#x4E58;&#x4E00;&#x4E2A;&#x503C;; (2)&#x628A;&#x6570;&#x5217;&#x4E2D;&#x7684;&#x4E00;&#x6BB5;&#x6570;&#x5168;&#x90E8;&#x52A0;&#x4E00;&#x4E2A;&#x503C;; (3)&#x8BE2;&#x95EE;&#x6570;&#x5217;&#x4E2D;&#x7684;&#x4E00;&#x6BB5;&#x6570;&#x7684;&#x548C;&#xFF0C;&#x7531;&#x4E8E;&#x7B54;&#x6848;&#x53EF;&#x80FD;&#x5F88;&#x5927;&#xFF0C;&#x4F60;&#x53EA;&#x9700;&#x8F93;&#x51FA;&#x8FD9;&#x4E2A;&#x6570;&#x6A21;P&#x7684;&#x503C;&#x3002;</p>
<h3 id="&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;"><a href="#&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;" class="headerlink" title="&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;"></a>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;</h3><p>&#x8F93;&#x5165;&#x683C;&#x5F0F;&#xFF1A;<br>&#x7B2C;&#x4E00;&#x884C;&#x4E24;&#x4E2A;&#x6574;&#x6570;N&#x548C;P(1&#x2264;P&#x2264;1000000000&#xFF09;&#x3002;&#x7B2C;&#x4E8C;&#x884C;&#x542B;&#x6709;N&#x4E2A;&#x975E;&#x8D1F;&#x6574;&#x6570;,&#x4ECE;&#x5DE6;&#x5230;&#x53F3;&#x4F9D;&#x6B21;&#x4E3A;a1,a2,&#x2026;,aN, (0&#x2264;ai&#x2264;1000000000,1&#x2264;i&#x2264;N)&#x3002;&#x7B2C;&#x4E09;&#x884C;&#x6709;&#x4E00;&#x4E2A;&#x6574;&#x6570;M&#xFF0C;&#x8868;&#x793A;&#x64CD;&#x4F5C;&#x603B;&#x6570;&#x3002;&#x4ECE;&#x7B2C;&#x56DB;&#x884C;&#x5F00;&#x59CB;&#x6BCF;&#x884C;&#x63CF;&#x8FF0;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;&#xFF0C;&#x8F93;&#x5165;&#x7684;&#x64CD;&#x4F5C;&#x6709;&#x4EE5;&#x4E0B;&#x4E09;&#x79CD;&#x5F62;&#x5F0F;&#xFF1A; &#x64CD;&#x4F5C;1&#xFF1A;&#x201C;1 t g c&#x201D;(&#x4E0D;&#x542B;&#x53CC;&#x5F15;&#x53F7;)&#x3002;&#x8868;&#x793A;&#x628A;&#x6240;&#x6709;&#x6EE1;&#x8DB3;t&#x2264;i&#x2264;g&#x7684;ai&#x6539;&#x4E3A;ai&#xD7;c (1&#x2264;t&#x2264;g&#x2264;N,0&#x2264;c&#x2264;1000000000)&#x3002; &#x64CD;&#x4F5C;2&#xFF1A;&#x201C;2 t g c&#x201D;(&#x4E0D;&#x542B;&#x53CC;&#x5F15;&#x53F7;)&#x3002;&#x8868;&#x793A;&#x628A;&#x6240;&#x6709;&#x6EE1;&#x8DB3;t&#x2264;i&#x2264;g&#x7684;ai&#x6539;&#x4E3A;ai+c (1&#x2264;t&#x2264;g&#x2264;N,0&#x2264;c&#x2264;1000000000)&#x3002; &#x64CD;&#x4F5C;3&#xFF1A;&#x201C;3 t g&#x201D;(&#x4E0D;&#x542B;&#x53CC;&#x5F15;&#x53F7;)&#x3002;&#x8BE2;&#x95EE;&#x6240;&#x6709;&#x6EE1;&#x8DB3;t&#x2264;i&#x2264;g&#x7684;ai&#x7684;&#x548C;&#x6A21;P&#x7684;&#x503C; (1&#x2264;t&#x2264;g&#x2264;N)&#x3002; &#x540C;&#x4E00;&#x884C;&#x76F8;&#x90BB;&#x4E24;&#x6570;&#x4E4B;&#x95F4;&#x7528;&#x4E00;&#x4E2A;&#x7A7A;&#x683C;&#x9694;&#x5F00;&#xFF0C;&#x6BCF;&#x884C;&#x5F00;&#x5934;&#x548C;&#x672B;&#x5C3E;&#x6CA1;&#x6709;&#x591A;&#x4F59;&#x7A7A;&#x683C;&#x3002;<br>&#x8F93;&#x51FA;&#x683C;&#x5F0F;&#xFF1A;<br>&#x5BF9;&#x6BCF;&#x4E2A;&#x64CD;&#x4F5C;3&#xFF0C;&#x6309;&#x7167;&#x5B83;&#x5728;&#x8F93;&#x5165;&#x4E2D;&#x51FA;&#x73B0;&#x7684;&#x987A;&#x5E8F;&#xFF0C;&#x4F9D;&#x6B21;&#x8F93;&#x51FA;&#x4E00;&#x884C;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x8868;&#x793A;&#x8BE2;&#x95EE;&#x7ED3;&#x679C;&#x3002;</p>
<h3 id="&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;"><a href="#&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;" class="headerlink" title="&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;"></a>&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x6837;&#x4F8B;</h3><p>&#x8F93;&#x5165;&#x6837;&#x4F8B;&#xFF1A;<br>7 43<br>1 2 3 4 5 6 7<br>5<br>1 2 5 5<br>3 2 4<br>2 3 7 9<br>3 1 3<br>3 4 7<br>&#x8F93;&#x51FA;&#x6837;&#x4F8B;&#xFF1A;<br>2<br>35<br>8</p>
<h3 id="&#x8BF4;&#x660E;"><a href="#&#x8BF4;&#x660E;" class="headerlink" title="&#x8BF4;&#x660E;"></a>&#x8BF4;&#x660E;</h3><p>&#x3010;&#x6837;&#x4F8B;&#x8BF4;&#x660E;&#x3011;<br>&#x521D;&#x59CB;&#x65F6;&#x6570;&#x5217;&#x4E3A;(1,2,3,4,5,6,7)&#x3002;<br>&#x7ECF;&#x8FC7;&#x7B2C;1&#x6B21;&#x64CD;&#x4F5C;&#x540E;&#xFF0C;&#x6570;&#x5217;&#x4E3A;(1,10,15,20,25,6,7)&#x3002;<br>&#x5BF9;&#x7B2C;2&#x6B21;&#x64CD;&#x4F5C;&#xFF0C;&#x548C;&#x4E3A;10+15+20=45&#xFF0C;&#x6A21;43&#x7684;&#x7ED3;&#x679C;&#x662F;2&#x3002;<br>&#x7ECF;&#x8FC7;&#x7B2C;3&#x6B21;&#x64CD;&#x4F5C;&#x540E;&#xFF0C;&#x6570;&#x5217;&#x4E3A;(1,10,24,29,34,15,16}<br>&#x5BF9;&#x7B2C;4&#x6B21;&#x64CD;&#x4F5C;&#xFF0C;&#x548C;&#x4E3A;1+10+24=35&#xFF0C;&#x6A21;43&#x7684;&#x7ED3;&#x679C;&#x662F;35&#x3002;<br>&#x5BF9;&#x7B2C;5&#x6B21;&#x64CD;&#x4F5C;&#xFF0C;&#x548C;&#x4E3A;29+34+15+16=94,&#x6A21;43&#x7684;&#x7ED3;&#x679C;&#x662F;8&#x3002;</p>
<p>&#x6D4B;&#x8BD5;&#x6570;&#x636E;&#x89C4;&#x6A21;&#x5982;&#x4E0B;&#x8868;&#x6240;&#x793A;<br>&#x6570;&#x636E;&#x7F16;&#x53F7; 1 2 3 4 5 6 7 8 9 10<br>N= 10 1000 1000 10000 60000 70000 80000 90000 100000 100000<br>M= 10 1000 1000 10000 60000 70000 80000 90000 100000 100000</p>
</blockquote>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>&#x8FD9;&#x9898;&#x5C31;&#x662F;&#x4E2A;&#x7EBF;&#x6BB5;&#x6811;&#x7684;&#x677F;&#x9898;&#xFF0C;&#x548C;&#x6D1B;&#x8C37;&#x7684;&#x7EBF;&#x6BB5;&#x6811;&#x6A21;&#x677F;2&#x6CA1;&#x4EC0;&#x4E48;&#x533A;&#x522B;&#x3002;<br>&#x533A;&#x95F4;&#x52A0;&#x3001;&#x4E58;&#xFF0C;&#x533A;&#x95F4;&#x6C42;&#x548C;<br>&#x6CE8;&#x610F;downtag&#x65F6;&#x52A0;&#x548C;&#x4E58;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#xFF0C;&#x5E94;&#x8BE5;&#x5148;&#x628A;&#x4E58;&#x6CD5;tag&#x4E58;&#x4E0A;&#x52A0;&#x6CD5;tag&#x4F20;&#x5230;&#x5B50;&#x7ED3;&#x70B9;&#xFF0C;&#x7136;&#x540E;&#x4F20;&#x4E58;&#x6CD5;tag&#x3002;<br><strong><em>&#x7279;&#x522B;&#x6CE8;&#x610F;&#xFF1A;&#x4E58;&#x6CD5;tag&#x4E0B;&#x4F20;&#x540E;&#x5E94;&#x6539;&#x4E3A;1&#xFF0C;&#x800C;&#x4E0D;&#x662F;0&#xFF01;</em></strong></p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 100000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m;</div><div class="line">ll p;</div><div class="line">ll tree[MAX_N*<span class="number">4</span>+<span class="number">5</span>], mul[MAX_N*<span class="number">4</span>+<span class="number">5</span>], add[MAX_N*<span class="number">4</span>+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">updata</span><span class="params">(<span class="keyword">int</span> v)</span> </span>{</div><div class="line">    tree[v] = (tree[v&lt;&lt;<span class="number">1</span>]+tree[v&lt;&lt;<span class="number">1</span>|<span class="number">1</span>])%p;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">downtag</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> mid)</span> </span>{</div><div class="line">    <span class="keyword">if</span> (mul[v] == <span class="number">1</span> &amp;&amp; add[v] == <span class="number">0</span>)    <span class="keyword">return</span>;</div><div class="line">    mul[v*<span class="number">2</span>] = mul[v*<span class="number">2</span>]*mul[v]%p;</div><div class="line">    add[v*<span class="number">2</span>] = (add[v*<span class="number">2</span>]*mul[v]%p+add[v])%p;</div><div class="line">    tree[v*<span class="number">2</span>] = (tree[v*<span class="number">2</span>]*mul[v]%p+add[v]*(ll)(mid-s+<span class="number">1</span>)%p)%p;</div><div class="line">    mul[v*<span class="number">2</span>+<span class="number">1</span>] = mul[v*<span class="number">2</span>+<span class="number">1</span>]*mul[v]%p;</div><div class="line">    add[v*<span class="number">2</span>+<span class="number">1</span>] = (add[v*<span class="number">2</span>+<span class="number">1</span>]*mul[v]%p+add[v])%p;</div><div class="line">    tree[v*<span class="number">2</span>+<span class="number">1</span>] = (tree[v*<span class="number">2</span>+<span class="number">1</span>]*mul[v]%p+add[v]*(ll)(t-mid)%p)%p;</div><div class="line">    mul[v] = <span class="number">1</span>;</div><div class="line">    add[v] = <span class="number">0</span>;</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">create</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>{</div><div class="line">    mul[v] = <span class="number">1</span>;</div><div class="line">    add[v] = <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span> (s == t) {</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;tree[v]);</div><div class="line">        tree[v] %= p;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    }</div><div class="line">    <span class="keyword">int</span> mid = s+t&gt;&gt;<span class="number">1</span>;</div><div class="line">    create(v&lt;&lt;<span class="number">1</span>, s, mid);</div><div class="line">    create(v&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, t);</div><div class="line">    updata(v);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify1</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x)</span> </span>{</div><div class="line">    <span class="keyword">if</span> (s &gt;= l &amp;&amp; t &lt;= r) {</div><div class="line">        add[v] = (add[v]+(ll)x)%p;</div><div class="line">        tree[v] = (tree[v]+(ll)x*(ll)(t-s+<span class="number">1</span>)%p)%p;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    }</div><div class="line">    <span class="keyword">int</span> mid = s+t&gt;&gt;<span class="number">1</span>;</div><div class="line">    downtag(v, s, t, mid);</div><div class="line">    <span class="keyword">if</span> (l &lt;= mid) {</div><div class="line">        modify1(v&lt;&lt;<span class="number">1</span>, s, mid, l, r, x);</div><div class="line">    }</div><div class="line">    <span class="keyword">if</span> (r &gt;= mid+<span class="number">1</span>) {</div><div class="line">        modify1(v&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, t, l, r, x);</div><div class="line">    }</div><div class="line">    updata(v);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify2</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x)</span> </span>{</div><div class="line">    <span class="keyword">if</span> (s &gt;= l &amp;&amp; t &lt;= r) {</div><div class="line">        mul[v] = mul[v]*(ll)x%p;</div><div class="line">        add[v] = add[v]*(ll)x%p;</div><div class="line">        tree[v] = tree[v]*(ll)x%p;</div><div class="line">        <span class="keyword">return</span>; </div><div class="line">    }</div><div class="line">    <span class="keyword">int</span> mid = s+t&gt;&gt;<span class="number">1</span>;</div><div class="line">    downtag(v, s, t, mid);</div><div class="line">    <span class="keyword">if</span> (l &lt;= mid) {</div><div class="line">        modify2(v&lt;&lt;<span class="number">1</span>, s, mid, l, r, x);</div><div class="line">    }</div><div class="line">    <span class="keyword">if</span> (r &gt;= mid+<span class="number">1</span>) {</div><div class="line">        modify2(v&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, t, l, r, x);</div><div class="line">    }</div><div class="line">    updata(v);</div><div class="line">}</div><div class="line"><span class="function">ll <span class="title">query</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>{</div><div class="line">    <span class="keyword">if</span> (s &gt;= l &amp;&amp; t &lt;= r) {</div><div class="line">        <span class="keyword">return</span> tree[v];</div><div class="line">    }</div><div class="line">    <span class="keyword">int</span> mid = s+t&gt;&gt;<span class="number">1</span>;</div><div class="line">    ll ret = <span class="number">0</span>;</div><div class="line">    downtag(v, s, t, mid);</div><div class="line">    <span class="keyword">if</span> (l &lt;= mid) {</div><div class="line">        ret = (ret+query(v&lt;&lt;<span class="number">1</span>, s, mid, l, r))%p;</div><div class="line">    }</div><div class="line">    <span class="keyword">if</span> (r &gt;= mid+<span class="number">1</span>) {</div><div class="line">        ret = (ret+query(v&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, t, l, r))%p;</div><div class="line">    }</div><div class="line">    updata(v);</div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;p);</div><div class="line">    create(<span class="number">1</span>, <span class="number">1</span>, n);</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;m);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) {</div><div class="line">        <span class="keyword">int</span> f;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;f);</div><div class="line">        <span class="keyword">if</span> (f == <span class="number">1</span>) {</div><div class="line">            <span class="keyword">int</span> l, r, x;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;l, &amp;r, &amp;x);</div><div class="line">            modify2(<span class="number">1</span>, <span class="number">1</span>, n, l, r, x%p);</div><div class="line">        } <span class="keyword">else</span> <span class="keyword">if</span> (f == <span class="number">2</span>) {</div><div class="line">            <span class="keyword">int</span> l, r, x;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;l, &amp;r, &amp;x);</div><div class="line">            modify1(<span class="number">1</span>, <span class="number">1</span>, n, l, r, x%p);</div><div class="line">        } <span class="keyword">else</span> {</div><div class="line">            <span class="keyword">int</span> l, r;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;l, &amp;r);</div><div class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, query(<span class="number">1</span>, <span class="number">1</span>, n, l, r));</div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
<p>BZOJ&#x4E0A;&#x6709;&#x4E2A;BUG&#xFF0C;&#x7528;cincout&#x8F93;&#x51FA;&#x6D41;&#x4F1A;RE&#xFF0C;&#x5982;&#x679C;&#x65E0;&#x7AEF;RE&#x8BF7;&#x6CE8;&#x610F;&#x8F93;&#x5165;&#x8F93;&#x51FA;!</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/BZOJ/">BZOJ</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据结构/">数据结构</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/省选/">省选</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/线段树/">线段树</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-BZOJ3673 可持久化并查集 by zky 可持久化数组+主席树" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/BZOJ3673 可持久化并查集 by zky 可持久化数组+主席树/" class="article-date">
  	<time datetime="2017-08-14T16:00:00.000Z" itemprop="datePublished">2017-08-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/BZOJ3673 可持久化并查集 by zky 可持久化数组+主席树/">
        BZOJ3673 可持久化并查集 by zky &lt;可持久化数组+主席树&gt;
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><blockquote>
<h2 id="&#x53EF;&#x6301;&#x4E45;&#x5316;&#x5E76;&#x67E5;&#x96C6;-by-zky"><a href="#&#x53EF;&#x6301;&#x4E45;&#x5316;&#x5E76;&#x67E5;&#x96C6;-by-zky" class="headerlink" title="&#x53EF;&#x6301;&#x4E45;&#x5316;&#x5E76;&#x67E5;&#x96C6; by zky"></a>&#x53EF;&#x6301;&#x4E45;&#x5316;&#x5E76;&#x67E5;&#x96C6; by zky</h2><h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>n&#x4E2A;&#x96C6;&#x5408; m&#x4E2A;&#x64CD;&#x4F5C;<br>&#x64CD;&#x4F5C;&#xFF1A;<br>1 a b &#x5408;&#x5E76;a,b&#x6240;&#x5728;&#x96C6;&#x5408;<br>2 k &#x56DE;&#x5230;&#x7B2C;k&#x6B21;&#x64CD;&#x4F5C;&#x4E4B;&#x540E;&#x7684;&#x72B6;&#x6001;(&#x67E5;&#x8BE2;&#x7B97;&#x4F5C;&#x64CD;&#x4F5C;)<br>3 a b &#x8BE2;&#x95EE;a,b&#x662F;&#x5426;&#x5C5E;&#x4E8E;&#x540C;&#x4E00;&#x96C6;&#x5408;&#xFF0C;&#x662F;&#x5219;&#x8F93;&#x51FA;1&#x5426;&#x5219;&#x8F93;&#x51FA;0</p>
<h3 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h3><p>5 6<br>1 1 2<br>3 1 2<br>2 0<br>3 1 2<br>2 1<br>3 1 2</p>
<h3 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h3><p>1<br>0<br>1</p>
<h3 id="Hint"><a href="#Hint" class="headerlink" title="Hint"></a>Hint</h3><p>0 &lt; n,m &lt;= 2*10^4</p>
</blockquote>
<p>&#x6807;&#x7B7E;&#xFF1A;&#x4E3B;&#x5E2D;&#x6811;&#x7EF4;&#x62A4;&#x53EF;&#x6301;&#x4E45;&#x5316;&#x6570;&#x7EC4;</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>&#x672C;&#x9898;&#x7684;&#x505A;&#x6CD5;&#x5176;&#x5B9E;&#x548C;&#x5E76;&#x67E5;&#x96C6;&#x6CA1;&#x592A;&#x5927;&#x5173;&#x8054;&#x3002;<br>&#x5982;&#x679C;&#x662F;&#x64A4;&#x9500;&#xFF0C;&#x90A3;&#x53EF;&#x4EE5;&#x7528;&#x4E0D;&#x52A0;&#x8DEF;&#x5F84;&#x538B;&#x7F29;&#x7684;&#x5E76;&#x67E5;&#x96C6;&#x5B8C;&#x6210;&#xFF0C;&#x4F46;&#x662F;&#x5982;&#x679C;&#x56DE;&#x5230;&#x67D0;&#x65F6;&#x95F4;&#xFF0C;&#x5219;&#x4E0D;&#x592A;&#x597D;&#x5199;&#x3002;<br>&#x8FD9;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#x5E76;&#x67E5;&#x96C6;&#x8FD9;&#x4E2A;&#x4E1C;&#x897F;&#x6784;&#x9020;&#x5176;&#x5B9E;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x4E00;&#x4E2A;fa&#x6570;&#x7EC4;&#x5C31;&#x884C;&#x4E86;&#x3002;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x81EA;&#x7136;&#x53EF;&#x4EE5;&#x60F3;&#x5230;&#x76F4;&#x63A5;&#x7528;&#x4E00;&#x4E2A;&#x4E8C;&#x7EF4;&#x6570;&#x7EC4;&#x5B58;&#x50A8;&#x6BCF;&#x4E2A;&#x65F6;&#x95F4;&#x7684;fa&#x6570;&#x7EC4;&#xFF0C;&#x5373;&#x7528;&#x589E;&#x52A0;&#x7684;&#x4E00;&#x7EF4;&#x8868;&#x793A;&#x65F6;&#x95F4;&#x3002;<br>&#x4F46;&#x662F;&#xFF0C;n&#x3001;m&#x662F;2e4&#x7EA7;&#x522B;&#xFF0C;&#x6240;&#x4EE5;&#x80AF;&#x5B9A;&#x4F1A;MLE&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x5C31;&#x9700;&#x8981;&#x7528;&#x5230;&#x4E3B;&#x5E2D;&#x6811;&#xFF0C;&#x628A;fa&#x6570;&#x7EC4;&#x53EF;&#x6301;&#x4E45;&#x5316;&#x3002;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x6211;&#x4EEC;&#x4E0D;&#x80FD;&#x7528;&#x8DEF;&#x5F84;&#x538B;&#x7F29;&#x4F18;&#x5316;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x56DE;&#x5230;&#x524D;&#x9762;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x4E3A;&#x4E86;&#x8BA9;&#x5B83;&#x8DD1;&#x5F97;&#x66F4;&#x5FEB;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x7528;&#x6309;&#x79E9;&#x5408;&#x5E76;&#x4F18;&#x5316;&#x3002;</p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 20000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m, cnt, now, root[MAX_N*<span class="number">10</span>+<span class="number">5</span>];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> {</span><span class="keyword">int</span> fa, dep, ls, rs;} tr[MAX_N*<span class="number">100</span>+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (l == r) {tr[v].fa = l;	<span class="keyword">return</span>;}</div><div class="line">	<span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</div><div class="line">	tr[v].ls = ++cnt, tr[v].rs = ++cnt;</div><div class="line">	build(tr[v].ls, l, mid);</div><div class="line">	build(tr[v].rs, mid+<span class="number">1</span>, r);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">modifyfa</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> o, <span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> pos, <span class="keyword">int</span> x)</span> </span>{</div><div class="line">	tr[v] = tr[o];</div><div class="line">	<span class="keyword">if</span> (s == t)	{tr[v].fa = x;	<span class="keyword">return</span>;}</div><div class="line">	<span class="keyword">int</span> mid = s+t&gt;&gt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span> (pos &lt;= mid)	modifyfa(tr[v].ls = ++cnt, tr[o].ls, s, mid, pos, x);</div><div class="line">	<span class="keyword">else</span>	modifyfa(tr[v].rs = ++cnt, tr[o].rs, mid+<span class="number">1</span>, t, pos, x);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">modifydep</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> pos)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (s == t)	{tr[v].dep++;	<span class="keyword">return</span>;}</div><div class="line">	<span class="keyword">int</span> mid = s+t&gt;&gt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span> (pos &lt;= mid)	modifydep(tr[v].ls, s, mid, pos);</div><div class="line">	<span class="keyword">else</span>	modifydep(tr[v].rs, mid+<span class="number">1</span>, t, pos);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> pos)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (s == t)	<span class="keyword">return</span> v;</div><div class="line">	<span class="keyword">int</span> mid = s+t&gt;&gt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span> (pos &lt;= mid)	<span class="keyword">return</span> find(tr[v].ls, s, mid, pos);</div><div class="line">	<span class="keyword">else</span>	<span class="keyword">return</span> find(tr[v].rs, mid+<span class="number">1</span>, t, pos);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">getf</span><span class="params">(<span class="keyword">int</span> r, <span class="keyword">int</span> x)</span> </span>{</div><div class="line">	<span class="keyword">int</span> pos = find(r, <span class="number">1</span>, n, x);</div><div class="line">	<span class="keyword">if</span> (tr[pos].fa != x)	<span class="keyword">return</span> getf(r, tr[pos].fa);</div><div class="line">	<span class="keyword">return</span> pos;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</div><div class="line">	cnt = <span class="number">0</span>, root[<span class="number">0</span>] = ++cnt;</div><div class="line">	build(root[<span class="number">0</span>], <span class="number">1</span>, n);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> now = <span class="number">1</span>; now &lt;= m; now++) {</div><div class="line">		<span class="keyword">int</span> opt;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;opt);</div><div class="line">		<span class="keyword">if</span> (opt == <span class="number">1</span>) {</div><div class="line">			root[now] = root[now<span class="number">-1</span>];</div><div class="line">			<span class="keyword">int</span> a, b;</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);</div><div class="line">			<span class="keyword">int</span> posa = getf(root[now], a), posb = getf(root[now], b);</div><div class="line">			<span class="keyword">if</span> (tr[posa].fa == tr[posb].fa)	<span class="keyword">continue</span>;</div><div class="line">			<span class="keyword">if</span> (tr[posa].dep &gt; tr[posb].dep)	swap(posa, posb);</div><div class="line">			root[now] = ++cnt;</div><div class="line">			modifyfa(root[now], root[now<span class="number">-1</span>], <span class="number">1</span>, n, tr[posa].fa, tr[posb].fa);</div><div class="line">			<span class="keyword">if</span> (tr[posa].dep == tr[posb].dep)	modifydep(root[now], <span class="number">1</span>, n, tr[posb].fa);</div><div class="line">		}</div><div class="line">		<span class="keyword">if</span> (opt == <span class="number">2</span>) {</div><div class="line">			<span class="keyword">int</span> k;</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;k);</div><div class="line">			root[now] = root[k];</div><div class="line">		}</div><div class="line">		<span class="keyword">if</span> (opt == <span class="number">3</span>) {</div><div class="line">			root[now] = root[now<span class="number">-1</span>];</div><div class="line">			<span class="keyword">int</span> a, b;</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);</div><div class="line">			<span class="keyword">if</span> (tr[getf(root[now], a)].fa == tr[getf(root[now], b)].fa)	<span class="built_in">printf</span>(<span class="string">&quot;1\n&quot;</span>);</div><div class="line">			<span class="keyword">else</span>	<span class="built_in">printf</span>(<span class="string">&quot;0\n&quot;</span>);</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/BZOJ/">BZOJ</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/主席树/">主席树</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据结构/">数据结构</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-POJ1201 Intervals 差分约束系统" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/POJ1201 Intervals 差分约束系统/" class="article-date">
  	<time datetime="2017-08-14T16:00:00.000Z" itemprop="datePublished">2017-08-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/POJ1201 Intervals 差分约束系统/">
        POJ1201 Intervals &lt;差分约束系统&gt;
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><blockquote>
<h2 id="Intervals"><a href="#Intervals" class="headerlink" title="Intervals"></a>Intervals</h2><h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>You are given n closed, integer intervals [ai, bi] and n integers c1, &#x2026;, cn.<br>Write a program that:<br>reads the number of intervals, their end points and integers c1, &#x2026;, cn from the standard input, computes the minimal size of a set Z of integers which has at least ci common elements with interval [ai, bi], for each i=1,2,&#x2026;,n, writes the answer to the standard output. </p>
<h3 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h3><p>The first line of the input contains an integer n (1 &lt;= n &lt;= 50000) &#x2013; the number of intervals. The following n lines describe the intervals. The (i+1)-th line of the input contains three integers ai, bi and ci separated by single spaces and such that 0 &lt;= ai &lt;= bi &lt;= 50000 and 1 &lt;= ci &lt;= bi - ai+1.<br>Output<br>The output contains exactly one integer equal to the minimal size of set Z sharing at least ci elements with interval [ai, bi], for each i=1,2,&#x2026;,n. </p>
<h3 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h3><p>5<br>3 7 3<br>8 10 3<br>6 8 1<br>1 3 1<br>10 11 1</p>
<h3 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h3><p>6</p>
</blockquote>
<p>&#x6807;&#x7B7E;&#xFF1A;&#x5DEE;&#x5206;&#x7EA6;&#x675F;&#x7CFB;&#x7EDF;</p>
<h2 id="Translation"><a href="#Translation" class="headerlink" title="Translation"></a>Translation</h2><p>&#x9898;&#x76EE;&#x5927;&#x610F;&#xFF1A;&#x7ED9;&#x51FA;n&#x4E2A;&#x533A;&#x95F4;&#xFF0C;&#x8BD5;&#x786E;&#x5B9A;&#x4E00;&#x4E2A;&#x96C6;&#x5408;&#x4F7F;&#x5F97;&#x5BF9;&#x4E8E;i=1..n&#xFF0C;&#x7B2C;i&#x4E2A;&#x533A;&#x95F4;&#x5185;&#x81F3;&#x5C11;&#x6709;ci&#x4E2A;&#x6570;&#xFF0C;&#x5E76;&#x4F7F;&#x5F97;&#x6B64;&#x96C6;&#x5408;&#x5C3D;&#x91CF;&#x5C0F;&#xFF0C;&#x8F93;&#x51FA;&#x6700;&#x5C0F;&#x5927;&#x5C0F;&#x3002;</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>&#x9996;&#x5148;&#x7528;&#x524D;&#x7F00;&#x548C;&#x3002;sum[i]&#x8868;&#x793A;&#x4ECE;1&#x5230;i&#x4E2D;&#x5171;&#x9009;&#x51FA;&#x591A;&#x5C11;&#x4E2A;&#x6570;&#x5230;&#x96C6;&#x5408;&#x4E2D;&#x3002;&#x8FD9;&#x6837;&#x5BF9;&#x4E8E;&#x96C6;&#x5408;[ai,bi]&#xFF0C;&#x6709;sum[bi]-sum[ai-1]&gt;=ci&#xFF0C;&#x4E8E;&#x662F;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4ECE;&#x70B9;ai-1&#x5230;bi&#x8FDE;&#x4E00;&#x6761;&#x6743;&#x503C;&#x4E3A;ci&#x7684;&#x8FB9;&#x3002;&#x56E0;&#x4E3A;&#x9898;&#x610F;&#x662F;&#x8981;&#x6EE1;&#x8DB3;&#x6240;&#x6709;&#x7684;&#x8FB9;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x627E;&#x6700;&#x957F;&#x8DEF;&#x3002;<br>&#x6B64;&#x9898;&#x6709;&#x4E00;&#x4E9B;&#x7EC6;&#x8282;&#x95EE;&#x9898;&#x3002;&#x9996;&#x5148;&#xFF0C;&#x627E;&#x6700;&#x957F;&#x8DEF;&#x9700;&#x8981;&#x8D77;&#x70B9;&#x548C;&#x7EC8;&#x70B9;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x627E;&#x5230;&#x8FD9;&#x4E9B;&#x96C6;&#x5408;&#x8986;&#x76D6;&#x7684;&#x8303;&#x56F4;&#xFF0C;&#x5373;&#x627E;&#x5230;&#x5DE6;&#x7AEF;&#x70B9;&#xFF08;&#x5176;&#x5B9E;&#x5E94;&#x8BE5;&#x662F;&#x5DE6;&#x7AEF;&#x70B9;-1&#xFF09;&#x7684;&#x6700;&#x5C0F;&#x503C;s&#x548C;&#x53F3;&#x7AEF;&#x70B9;&#x7684;&#x6700;&#x5927;&#x503C;t&#xFF0C;&#x627E;s&#x5230;t&#x7684;&#x6700;&#x5927;&#x503C;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x5149;&#x6709;&#x4E0A;&#x8FF0;&#x7684;&#x90A3;&#x4E9B;&#x8FB9;&#x65F6;&#x65E0;&#x6CD5;&#x6784;&#x6210;&#x4E00;&#x4E2A;&#x8FDE;&#x901A;&#x56FE;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x627E;&#x4E00;&#x4E9B;&#x9690;&#x542B;&#x6761;&#x4EF6;&#x3002;&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#x6709;sum[i]-sum[i-1]&gt;=0&#xFF0C;sum[i]-sum[i-1]&lt;=1&#xFF0C;&#x4E3A;&#x4E86;&#x4FDD;&#x6301;&#x4E00;&#x81F4;&#xFF0C;&#x5E94;&#x5C06;&#x540E;&#x9762;&#x7684;&#x5F0F;&#x5B50;&#x8F6C;&#x5316;&#x4E3A;&#x5927;&#x4E8E;&#x7B49;&#x4E8E;&#xFF0C;&#x5373;sum[i-1]-sum[i]&gt;=-1&#xFF0C;&#x8FD9;&#x6837;&#x5BF9;&#x4E8E;i=s+1~t&#xFF0C;&#x4ECE;i-1&#x5230;i&#x8FDE;&#x63A5;&#x4E00;&#x6761;&#x6743;&#x503C;&#x4E3A;0&#x7684;&#x8DEF;&#xFF0C;&#x4ECE;i&#x5230;i-1&#x8FDE;&#x63A5;&#x4E00;&#x6761;&#x6743;&#x503C;&#x4E3A;-1&#x7684;&#x8DEF;&#xFF0C;&#x4E4B;&#x540E;&#x5C31;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x7528;SPFA&#x627E;&#x6700;&#x957F;&#x8DEF;&#x4E86;&#x3002;</p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 50000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, cnt, s, t, pre[MAX_N+<span class="number">5</span>], dis[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> {</span><span class="keyword">int</span> v, c, nxt;} E[MAX_N*<span class="number">3</span>+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> c)</span> </span>{</div><div class="line">	E[++cnt].v = v, E[cnt].c = c;</div><div class="line">	E[cnt].nxt = pre[u], pre[u] = cnt;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">SPFA</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; que;</div><div class="line">	<span class="keyword">bool</span> inque[MAX_N+<span class="number">5</span>];</div><div class="line">	<span class="built_in">memset</span>(dis, <span class="number">128</span>, <span class="keyword">sizeof</span>(dis));</div><div class="line">	<span class="built_in">memset</span>(inque, <span class="number">0</span>, <span class="keyword">sizeof</span>(inque));</div><div class="line">	dis[s] = <span class="number">0</span>;</div><div class="line">	que.push(s), inque[s] = <span class="literal">true</span>;</div><div class="line">	<span class="keyword">while</span> (!que.empty()) {</div><div class="line">		<span class="keyword">int</span> u = que.front();</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = pre[u]; i; i = E[i].nxt) {</div><div class="line">			<span class="keyword">int</span> v = E[i].v, c = E[i].c;</div><div class="line">			<span class="keyword">if</span> (dis[u]+c &gt; dis[v]) {</div><div class="line">				dis[v] = dis[u]+c;</div><div class="line">				<span class="keyword">if</span> (!inque[v])	que.push(v), inque[v] = <span class="literal">true</span>;</div><div class="line">			}</div><div class="line">		}</div><div class="line">		que.pop(), inque[u] = <span class="literal">false</span>;</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n) != EOF) {</div><div class="line">		cnt = <span class="number">0</span>, s = <span class="number">50000</span>, t = <span class="number">0</span>;</div><div class="line">		<span class="built_in">memset</span>(pre, <span class="number">0</span>, <span class="keyword">sizeof</span>(pre));</div><div class="line">		<span class="built_in">memset</span>(E, <span class="number">0</span>, <span class="keyword">sizeof</span>(E));</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) {</div><div class="line">			<span class="keyword">int</span> u, v, c;</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;c);</div><div class="line">			insert(u, v+<span class="number">1</span>, c);</div><div class="line">			s = min(s, u);</div><div class="line">			t = max(t, v+<span class="number">1</span>);</div><div class="line">		}</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = s; i &lt; t; i++)	insert(i, i+<span class="number">1</span>, <span class="number">0</span>), insert(i+<span class="number">1</span>, i, <span class="number">-1</span>);</div><div class="line">		SPFA();</div><div class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, dis[t]);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/POJ/">POJ</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/图论/">图论</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/差分约束系统/">差分约束系统</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/12/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><a class="page-number" href="/page/12/">12</a><span class="page-number current">13</span><a class="page-number" href="/page/14/">14</a><a class="page-number" href="/page/15/">15</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/14/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2017 Azrael_Death
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a>
        </div>
    </div>
  </div>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
  </script>
  <script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  
</footer>

    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="/js/main.js"></script>
<!--
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
-->



<!--
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.js"></script>
-->

  </div>
</body>
</html>