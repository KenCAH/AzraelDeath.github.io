<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>NIRVANA</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Blog of a Chinese OIer">
<meta property="og:type" content="website">
<meta property="og:title" content="NIRVANA">
<meta property="og:url" content="http://yoursite.com/page/15/index.html">
<meta property="og:site_name" content="NIRVANA">
<meta property="og:description" content="Blog of a Chinese OIer">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="NIRVANA">
<meta name="twitter:description" content="Blog of a Chinese OIer">
  
    <link rel="alternative" href="/atom.xml" title="NIRVANA" type="application/atom+xml">
  
  
    <link rel="icon" href="http://chuantu.biz/t6/89/1507626502x2728279003.jpg">
  
  <link rel="stylesheet" href="/css/style.css">
  
  

  <script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>
  <script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>

  
</head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="https://i.loli.net/2017/12/08/5a2a79235ac3d.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Azrael_Death</a></h1>
		</hgroup>

		
		<p class="header-subtitle">Veni Vidi Vici</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/AzraelDeath" title="github">github</a>
					        
								<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/azraeldeath" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/2-SAT/" style="font-size: 10.77px;">2-SAT</a> <a href="/tags/AC自动机/" style="font-size: 10.77px;">AC自动机</a> <a href="/tags/AMPPZ/" style="font-size: 13.08px;">AMPPZ</a> <a href="/tags/APIO/" style="font-size: 10px;">APIO</a> <a href="/tags/BZOJ/" style="font-size: 20px;">BZOJ</a> <a href="/tags/CDQ分治/" style="font-size: 10px;">CDQ分治</a> <a href="/tags/DFS序/" style="font-size: 10px;">DFS序</a> <a href="/tags/DP/" style="font-size: 15.38px;">DP</a> <a href="/tags/HDU/" style="font-size: 12.31px;">HDU</a> <a href="/tags/IOI/" style="font-size: 10px;">IOI</a> <a href="/tags/JOI/" style="font-size: 10px;">JOI</a> <a href="/tags/LCA/" style="font-size: 12.31px;">LCA</a> <a href="/tags/LG/" style="font-size: 12.31px;">LG</a> <a href="/tags/MST/" style="font-size: 13.08px;">MST</a> <a href="/tags/Manacher/" style="font-size: 10.77px;">Manacher</a> <a href="/tags/NOI/" style="font-size: 10.77px;">NOI</a> <a href="/tags/NOIp/" style="font-size: 13.85px;">NOIp</a> <a href="/tags/POI/" style="font-size: 10px;">POI</a> <a href="/tags/POJ/" style="font-size: 14.62px;">POJ</a> <a href="/tags/Tarjan/" style="font-size: 10.77px;">Tarjan</a> <a href="/tags/Trie/" style="font-size: 10px;">Trie</a> <a href="/tags/UVa/" style="font-size: 10px;">UVa</a> <a href="/tags/主席树/" style="font-size: 12.31px;">主席树</a> <a href="/tags/二分图/" style="font-size: 10px;">二分图</a> <a href="/tags/二分答案/" style="font-size: 10.77px;">二分答案</a> <a href="/tags/分块/" style="font-size: 10px;">分块</a> <a href="/tags/图论/" style="font-size: 19.23px;">图论</a> <a href="/tags/字符串/" style="font-size: 12.31px;">字符串</a> <a href="/tags/差分/" style="font-size: 10px;">差分</a> <a href="/tags/差分约束系统/" style="font-size: 10px;">差分约束系统</a> <a href="/tags/并查集/" style="font-size: 10.77px;">并查集</a> <a href="/tags/总结/" style="font-size: 16.92px;">总结</a> <a href="/tags/搜索/" style="font-size: 10px;">搜索</a> <a href="/tags/数位DP/" style="font-size: 10.77px;">数位DP</a> <a href="/tags/数据结构/" style="font-size: 17.69px;">数据结构</a> <a href="/tags/数论数学/" style="font-size: 11.54px;">数论数学</a> <a href="/tags/最大团/" style="font-size: 10px;">最大团</a> <a href="/tags/最小割/" style="font-size: 12.31px;">最小割</a> <a href="/tags/最短路/" style="font-size: 10px;">最短路</a> <a href="/tags/最短路径/" style="font-size: 10px;">最短路径</a> <a href="/tags/期望DP/" style="font-size: 10px;">期望DP</a> <a href="/tags/构造/" style="font-size: 10px;">构造</a> <a href="/tags/树分治/" style="font-size: 11.54px;">树分治</a> <a href="/tags/树套树/" style="font-size: 10.77px;">树套树</a> <a href="/tags/树状数组/" style="font-size: 11.54px;">树状数组</a> <a href="/tags/树相关/" style="font-size: 10.77px;">树相关</a> <a href="/tags/树链剖分/" style="font-size: 10px;">树链剖分</a> <a href="/tags/模拟/" style="font-size: 10.77px;">模拟</a> <a href="/tags/状压DP/" style="font-size: 11.54px;">状压DP</a> <a href="/tags/省选/" style="font-size: 18.46px;">省选</a> <a href="/tags/线段树/" style="font-size: 13.08px;">线段树</a> <a href="/tags/组合数学/" style="font-size: 10px;">组合数学</a> <a href="/tags/网络流/" style="font-size: 16.15px;">网络流</a> <a href="/tags/莫队/" style="font-size: 10.77px;">莫队</a> <a href="/tags/补集转换/" style="font-size: 10px;">补集转换</a> <a href="/tags/贪心/" style="font-size: 10px;">贪心</a> <a href="/tags/费用流/" style="font-size: 10px;">费用流</a> <a href="/tags/队列/" style="font-size: 10px;">队列</a> <a href="/tags/随机化/" style="font-size: 10.77px;">随机化</a> <a href="/tags/高斯消元/" style="font-size: 10px;">高斯消元</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.csdn.net/OwenOwl">OwenOwl</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.csdn.net/Joker_69">Joker</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://dangxingyu.com">DXY</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://309459245.lofter.com">YJQ</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/candy99">Candy</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/zig-zag">ZigZag</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://cxjyxx.me">cxjyxx_me</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.shuizilong.com">ShuiZiLong</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/kuangbin">KuangBin</a>
			        
			        </div>
				</section>
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Azrael_Death</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="https://i.loli.net/2017/12/08/5a2a79235ac3d.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">Azrael_Death</h1>
			</hgroup>
			
			<p class="header-subtitle">Veni Vidi Vici</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/AzraelDeath" title="github">github</a>
			        
						<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/azraeldeath" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-BZOJ2434【NOI2011】阿狸的打字机 AC自动机+Fail树+树状数组" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/BZOJ2434【NOI2011】阿狸的打字机 AC自动机+Fail树+树状数组/" class="article-date">
  	<time datetime="2017-08-14T16:00:00.000Z" itemprop="datePublished">2017-08-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/BZOJ2434【NOI2011】阿狸的打字机 AC自动机+Fail树+树状数组/">
        BZOJ2434【NOI2011】阿狸的打字机 &lt;AC自动机+Fail树+树状数组&gt;
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><blockquote>
<h2 id="BZOJ2434-&#x963F;&#x72F8;&#x7684;&#x6253;&#x5B57;&#x673A;"><a href="#BZOJ2434-&#x963F;&#x72F8;&#x7684;&#x6253;&#x5B57;&#x673A;" class="headerlink" title="BZOJ2434 &#x963F;&#x72F8;&#x7684;&#x6253;&#x5B57;&#x673A;"></a>BZOJ2434 &#x963F;&#x72F8;&#x7684;&#x6253;&#x5B57;&#x673A;</h2><h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>&#x963F;&#x72F8;&#x559C;&#x6B22;&#x6536;&#x85CF;&#x5404;&#x79CD;&#x7A00;&#x5947;&#x53E4;&#x602A;&#x7684;&#x4E1C;&#x897F;&#xFF0C;&#x6700;&#x8FD1;&#x4ED6;&#x6DD8;&#x5230;&#x4E00;&#x53F0;&#x8001;&#x5F0F;&#x7684;&#x6253;&#x5B57;&#x673A;&#x3002;&#x6253;&#x5B57;&#x673A;&#x4E0A;&#x53EA;&#x6709;28&#x4E2A;&#x6309;&#x952E;&#xFF0C;&#x5206;&#x522B;&#x5370;&#x6709;26&#x4E2A;&#x5C0F;&#x5199;&#x82F1;&#x6587;&#x5B57;&#x6BCD;&#x548C;&#x2019;B&#x2019;&#x3001;&#x2019;P&#x2019;&#x4E24;&#x4E2A;&#x5B57;&#x6BCD;&#x3002;<br>&#x7ECF;&#x963F;&#x72F8;&#x7814;&#x7A76;&#x53D1;&#x73B0;&#xFF0C;&#x8FD9;&#x4E2A;&#x6253;&#x5B57;&#x673A;&#x662F;&#x8FD9;&#x6837;&#x5DE5;&#x4F5C;&#x7684;&#xFF1A;<br>&#xB7;&#x8F93;&#x5165;&#x5C0F;&#x5199;&#x5B57;&#x6BCD;&#xFF0C;&#x6253;&#x5B57;&#x673A;&#x7684;&#x4E00;&#x4E2A;&#x51F9;&#x69FD;&#x4E2D;&#x4F1A;&#x52A0;&#x5165;&#x8FD9;&#x4E2A;&#x5B57;&#x6BCD;(&#x8FD9;&#x4E2A;&#x5B57;&#x6BCD;&#x52A0;&#x5728;&#x51F9;&#x69FD;&#x7684;&#x6700;&#x540E;)&#x3002;<br>&#xB7;&#x6309;&#x4E00;&#x4E0B;&#x5370;&#x6709;&#x2019;B&#x2019;&#x7684;&#x6309;&#x952E;&#xFF0C;&#x6253;&#x5B57;&#x673A;&#x51F9;&#x69FD;&#x4E2D;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5B57;&#x6BCD;&#x4F1A;&#x6D88;&#x5931;&#x3002;<br>&#xB7;&#x6309;&#x4E00;&#x4E0B;&#x5370;&#x6709;&#x2019;P&#x2019;&#x7684;&#x6309;&#x952E;&#xFF0C;&#x6253;&#x5B57;&#x673A;&#x4F1A;&#x5728;&#x7EB8;&#x4E0A;&#x6253;&#x5370;&#x51FA;&#x51F9;&#x69FD;&#x4E2D;&#x73B0;&#x6709;&#x7684;&#x6240;&#x6709;&#x5B57;&#x6BCD;&#x5E76;&#x6362;&#x884C;&#xFF0C;&#x4F46;&#x51F9;&#x69FD;&#x4E2D;&#x7684;&#x5B57;&#x6BCD;&#x4E0D;&#x4F1A;&#x6D88;&#x5931;&#x3002;<br>&#x4F8B;&#x5982;&#xFF0C;&#x963F;&#x72F8;&#x8F93;&#x5165;aPaPBbP&#xFF0C;&#x7EB8;&#x4E0A;&#x88AB;&#x6253;&#x5370;&#x7684;&#x5B57;&#x7B26;&#x5982;&#x4E0B;&#xFF1A;<br>a<br>aa<br>ab<br>&#x6211;&#x4EEC;&#x628A;&#x7EB8;&#x4E0A;&#x6253;&#x5370;&#x51FA;&#x6765;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x4ECE;1&#x5F00;&#x59CB;&#x987A;&#x5E8F;&#x7F16;&#x53F7;&#xFF0C;&#x4E00;&#x76F4;&#x5230;n&#x3002;&#x6253;&#x5B57;&#x673A;&#x6709;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x6709;&#x8DA3;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x5728;&#x6253;&#x5B57;&#x673A;&#x4E2D;&#x6697;&#x85CF;&#x4E00;&#x4E2A;&#x5E26;&#x6570;&#x5B57;&#x7684;&#x5C0F;&#x952E;&#x76D8;&#xFF0C;&#x5728;&#x5C0F;&#x952E;&#x76D8;&#x4E0A;&#x8F93;&#x5165;&#x4E24;&#x4E2A;&#x6570;(x,y)&#xFF08;&#x5176;&#x4E2D;1&#x2264;x,y&#x2264;n&#xFF09;&#xFF0C;&#x6253;&#x5B57;&#x673A;&#x4F1A;&#x663E;&#x793A;&#x7B2C;x&#x4E2A;&#x6253;&#x5370;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x5728;&#x7B2C;y&#x4E2A;&#x6253;&#x5370;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x51FA;&#x73B0;&#x4E86;&#x591A;&#x5C11;&#x6B21;&#x3002;<br>&#x963F;&#x72F8;&#x53D1;&#x73B0;&#x4E86;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#x4EE5;&#x540E;&#x5F88;&#x5174;&#x594B;&#xFF0C;&#x4ED6;&#x60F3;&#x5199;&#x4E2A;&#x7A0B;&#x5E8F;&#x5B8C;&#x6210;&#x540C;&#x6837;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x4F60;&#x80FD;&#x5E2E;&#x52A9;&#x4ED6;&#x4E48;&#xFF1F;</p>
<h3 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h3><p>&#x8F93;&#x5165;&#x7684;&#x7B2C;&#x4E00;&#x884C;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x6309;&#x963F;&#x72F8;&#x7684;&#x8F93;&#x5165;&#x987A;&#x5E8F;&#x7ED9;&#x51FA;&#x6240;&#x6709;&#x963F;&#x72F8;&#x8F93;&#x5165;&#x7684;&#x5B57;&#x7B26;&#x3002;<br>&#x7B2C;&#x4E8C;&#x884C;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x6574;&#x6570;m&#xFF0C;&#x8868;&#x793A;&#x8BE2;&#x95EE;&#x4E2A;&#x6570;&#x3002;<br>&#x63A5;&#x4E0B;&#x6765;m&#x884C;&#x63CF;&#x8FF0;&#x6240;&#x6709;&#x7531;&#x5C0F;&#x952E;&#x76D8;&#x8F93;&#x5165;&#x7684;&#x8BE2;&#x95EE;&#x3002;&#x5176;&#x4E2D;&#x7B2C;i&#x884C;&#x5305;&#x542B;&#x4E24;&#x4E2A;&#x6574;&#x6570;x, y&#xFF0C;&#x8868;&#x793A;&#x7B2C;i&#x4E2A;&#x8BE2;&#x95EE;&#x4E3A;(x, y)&#x3002;</p>
<h3 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h3><p>&#x8F93;&#x51FA;m&#x884C;&#xFF0C;&#x5176;&#x4E2D;&#x7B2C;i&#x884C;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#xFF0C;&#x8868;&#x793A;&#x7B2C;i&#x4E2A;&#x8BE2;&#x95EE;&#x7684;&#x7B54;&#x6848;&#x3002;</p>
<h3 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h3><p>aPaPBbP<br>3<br>1 2<br>1 3<br>2 3</p>
<h3 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h3><p>2<br>1<br>0</p>
<h3 id="Hint"><a href="#Hint" class="headerlink" title="Hint"></a>Hint</h3><p>1&lt;=N&lt;=10^5<br>1&lt;=M&lt;=10^5<br>&#x8F93;&#x5165;&#x603B;&#x957F;&lt;=10^5</p>
</blockquote>
<p>&#x6807;&#x7B7E;&#xFF1A;AC&#x81EA;&#x52A8;&#x673A; Fail&#x6811; &#x6811;&#x72B6;&#x6570;&#x7EC4;</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>&#x8FD9;&#x9053;&#x9898;&#x7684;&#x63D0;&#x793A;&#x8FD8;&#x662F;&#x5F88;&#x660E;&#x663E;&#x7684;&#x3002;<br>&#x8BFB;&#x5B8C;&#x9898;&#x76EE;&#xFF0C;&#x5F88;&#x5BB9;&#x6613;&#x53D1;&#x73B0;&#x6B64;&#x9898;&#x6253;&#x5B57;&#x7684;&#x90E8;&#x5206;&#x5C31;&#x662F;&#x5728;&#x5EFA;&#x4E00;&#x68F5;Trie&#x6811;&#x3002;<br>&#x8F93;&#x5165;&#x5C0F;&#x5199;&#x5B57;&#x6BCD;&#x5373;&#x5728;Trie&#x4E2D;&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x5B50;&#x7ED3;&#x70B9;&#x5E76;&#x5411;&#x513F;&#x5B50;&#x7ED3;&#x70B9;&#x8D70;&#xFF0C;&#x8F93;&#x5165;&#x2018;B&#x2019;&#x5373;&#x9000;&#x56DE;&#x5230;&#x7236;&#x7ED3;&#x70B9;&#xFF0C;&#x8F93;&#x5165;&#x2019;P&#x2018;&#x5373;&#x5728;&#x5F53;&#x524D;&#x7ED3;&#x70B9;&#x6253;&#x6807;&#x8BB0;&#x3002;<br>&#x56E0;&#x800C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6784;&#x5EFA;Trie&#x6811;&#x5982;&#x4E0B;&#xFF1A;<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>{</div><div class="line">    <span class="comment">//&#x6211;&#x5199;Trie&#x6811;&#x7684;&#x4E60;&#x60EF;&#xFF1A;&#x628A;&#x6839;&#x8282;&#x70B9;&#x5B9A;&#x4E3A;1</span></div><div class="line">	cnt = <span class="number">0</span>, root = <span class="number">1</span>, fa[root] = <span class="number">0</span>;</div><div class="line">	<span class="comment">//0&#x53F7;&#x8282;&#x70B9;&#x6240;&#x6709;&#x513F;&#x5B50;&#x90FD;&#x7EC3;&#x5230;&#x6839;&#xFF0C;&#x8FD9;&#x6837;AC&#x81EA;&#x52A8;&#x673A;CalcFail&#x65F6;&#x66F4;&#x65B9;&#x4FBF;</span></div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++)	trie[<span class="number">0</span>][i] = root;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span> </span>{</div><div class="line">	init();</div><div class="line">	n = <span class="built_in">strlen</span>(s);</div><div class="line">	ind = <span class="number">1</span>;<span class="comment">//ind&#x8BB0;&#x5F55;&#x5F53;&#x524D;&#x7ED3;&#x70B9;&#x6570;</span></div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, cur = root; i &lt; n; i++) {</div><div class="line">		<span class="keyword">if</span> (s[i] == <span class="string">&apos;B&apos;</span>) {</div><div class="line">			<span class="comment">//&#x9000;&#x5230;&#x7236;&#x7ED3;&#x70B9;</span></div><div class="line">			cur = fa[cur];</div><div class="line">		} <span class="keyword">else</span> <span class="keyword">if</span> (s[i] == <span class="string">&apos;P&apos;</span>) {</div><div class="line">			<span class="comment">//&#x6253;&#x6807;&#x8BB0;&#xFF0C;&#x6807;&#x8BB0;&#x4E3A;&#x7B2C;cnt&#x4E2A;&#x5B57;&#x7B26;&#x4E32;</span></div><div class="line">			pos[++cnt] = cur;</div><div class="line">		} <span class="keyword">else</span> {</div><div class="line">			<span class="comment">//&#x65B0;&#x5EFA;&#x5B50;&#x7ED3;&#x70B9;</span></div><div class="line">			trie[cur][s[i]-<span class="string">&apos;a&apos;</span>] = ++ind;</div><div class="line">			fa[ind] =cur, cur = ind;`</div><div class="line">		}&#x3002;</div><div class="line">&#x3002;</div><div class="line">	}</div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x5BF9;&#x4ED8;&#x8FD9;&#x9898;&#x7684;&#x8BE2;&#x95EE;&#x3002;<br>&#x9996;&#x5148;&#xFF0C;&#x5B83;&#x8981;&#x6C42;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x5728;&#x53E6;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x51FA;&#x73B0;&#x591A;&#x5C11;&#x6B21;&#xFF0C;&#x8FD9;&#x663E;&#x7136;&#x662F;AC&#x81EA;&#x52A8;&#x673A;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x5EFA;&#x7ACB;fail&#x6570;&#x7EC4;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">CalcFail</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; que;</div><div class="line">	que.push(root);</div><div class="line">	<span class="keyword">while</span> (!que.empty()) {</div><div class="line">		<span class="keyword">int</span> u = que.front();</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; DICNUM; i++) {</div><div class="line">			<span class="keyword">if</span> (trie[u][i]) {</div><div class="line">				fail[trie[u][i]] = trie[fail[u]][i];</div><div class="line">				que.push(trie[u][i]);</div><div class="line">			} <span class="keyword">else</span> {</div><div class="line">				trie[u][i] = trie[fail[u]][i];</div><div class="line">			}</div><div class="line">		}</div><div class="line">		que.pop();</div><div class="line">	}</div><div class="line">}</div></pre></td></tr></table></figure>
<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x8003;&#x8651;fail&#x6570;&#x7EC4;&#x7684;&#x5B9E;&#x8D28;&#x3002;&#x5982;&#x679C;A&#x7ED3;&#x70B9;&#x7684;fail&#x6307;&#x5411;B&#x7ED3;&#x70B9;&#xFF0C;&#x5219;B&#x7ED3;&#x70B9;&#x4EE3;&#x8868;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x4E00;&#x5B9A;&#x662F;A&#x7ED3;&#x70B9;&#x4EE3;&#x8868;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x540E;&#x7F00;&#xFF0C;&#x5373;&#x7ECF;&#x8FC7;A&#x7684;&#x6240;&#x6709;&#x8DEF;&#x5F84;&#x7EC4;&#x6210;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x90FD;&#x5305;&#x542B;B&#x7ED3;&#x70B9;&#x4EE3;&#x8868;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002;&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5B83;&#x7684;&#x6240;&#x6709;&#x5B57;&#x4E32;&#x4E3A;&#x5B83;&#x6240;&#x6709;&#x524D;&#x7F00;&#x7684;&#x6240;&#x6709;&#x540E;&#x7F00;&#xFF0C;&#x6240;&#x4EE5;&#x5BF9;&#x4E8E;&#x8BE2;&#x95EE;(x,y)&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x627E;&#x51FA;&#x4ECE;&#x6839;&#x8282;&#x70B9;&#x5230;y&#x7684;&#x8DEF;&#x5F84;&#x4E2D;&#x6709;&#x591A;&#x5C11;&#x7ED3;&#x70B9;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;fail&#x6307;&#x9488;&#x8F6C;&#x79FB;&#x5230;x&#x3002;<br>&#x8FD9;&#x65F6;&#x6211;&#x4EEC;&#x5C31;&#x9700;&#x8981;&#x8003;&#x8651;Fail&#x6811;&#x4E86;&#x3002;&#x5BF9;&#x4E8E;&#x4EFB;&#x610F;&#x7ED3;&#x70B9;p&#xFF0C;&#x6211;&#x4EEC;&#x628A;&#x6240;&#x6709;&#x901A;&#x8FC7;fail&#x6307;&#x9488;&#x80FD;<strong>&#x76F4;&#x63A5;</strong>&#x8F6C;&#x79FB;&#x5230;p&#x7684;&#x7ED3;&#x70B9;&#x4F5C;&#x4E3A;p&#x7684;&#x5B50;&#x7ED3;&#x70B9;&#xFF0C;&#x800C;p&#x901A;&#x8FC7;fail&#x6307;&#x9488;&#x8F6C;&#x79FB;&#x5230;&#x7684;&#x7ED3;&#x70B9;&#x4F5C;&#x4E3A;p&#x7684;&#x7236;&#x7ED3;&#x70B9;&#x3002;&#x8FD9;&#x6837;&#x6211;&#x4EEC;&#x5C31;&#x80FD;&#x6784;&#x5EFA;&#x4E00;&#x68F5;&#x6811;&#x3002;&#x8FD9;&#x6837;&#x4E00;&#x6765;&#xFF0C;&#x5BF9;&#x4E8E;&#x8BE2;&#x95EE;(x,y)&#xFF0C;&#x95EE;&#x9898;&#x7B49;&#x4EF7;&#x4E8E;&#x4ECE;&#x6839;&#x5230;y&#x7684;&#x7ED3;&#x70B9;&#x4E2D;&#x6709;&#x591A;&#x5C11;&#x8282;&#x70B9;&#x662F;&#x5728;x&#x7684;&#x5B50;&#x6811;&#x4E2D;&#x3002;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x7528;DFS&#x5E8F;&#x64CD;&#x4F5C;&#x3002;&#x7136;&#x540E;&#x7528;&#x6811;&#x72B6;&#x6570;&#x7EC4;&#x7EF4;&#x62A4;&#xFF08;&#x7EBF;&#x6BB5;&#x6811;&#x592A;&#x9EBB;&#x70E6;&#xFF09;&#x3002;<br>&#x4E3A;&#x4E86;&#x4F7F;&#x8BE2;&#x95EE;&#x53D8;&#x5F97;&#x66F4;&#x597D;&#x64CD;&#x4F5C;&#xFF0C;&#x6211;&#x4EEC;&#x8003;&#x8651;&#x628A;&#x8BE2;&#x95EE;&#x6309;y&#x503C;&#x6392;&#x5E8F;&#xFF0C;&#x8FD9;&#x6837;&#x6211;&#x4EEC;&#x5C31;&#x53EA;&#x9700;&#x4E00;&#x76F4;&#x5F80;&#x4E0B;&#x8D70;&#xFF0C;&#x7136;&#x540E;&#x6807;&#x8BB0;&#x7ECF;&#x8FC7;&#x7684;&#x7ED3;&#x70B9;&#xFF0C;&#x7136;&#x540E;&#x7EDF;&#x8BA1;x&#x5B50;&#x6811;&#x5373;&#x53EF;&#x3002;</p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 100000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> DICNUM 26</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m, cnt, ind;</div><div class="line"><span class="keyword">int</span> root, trie[MAX_N+<span class="number">5</span>][DICNUM], fa[MAX_N+<span class="number">5</span>], fail[MAX_N+<span class="number">5</span>], pos[MAX_N+<span class="number">5</span>], ans[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="keyword">char</span> s[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; G[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="keyword">int</span> into[MAX_N+<span class="number">5</span>], outo[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="keyword">int</span> tr[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Query</span> {</span><span class="keyword">int</span> x, y, id;} q[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span> <span class="params">(<span class="keyword">const</span> Query &amp;a, <span class="keyword">const</span> Query &amp;b)</span> </span>{<span class="keyword">return</span> a.y &lt; b.y;}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>{</div><div class="line">	cnt = <span class="number">0</span>, root = <span class="number">1</span>, fa[root] = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; DICNUM; i++)	trie[<span class="number">0</span>][i] = root;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">CalcFail</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; que;</div><div class="line">	que.push(root);</div><div class="line">	<span class="keyword">while</span> (!que.empty()) {</div><div class="line">		<span class="keyword">int</span> u = que.front();</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; DICNUM; i++) {</div><div class="line">			<span class="keyword">if</span> (trie[u][i]) {</div><div class="line">				fail[trie[u][i]] = trie[fail[u]][i];</div><div class="line">				que.push(trie[u][i]);</div><div class="line">			} <span class="keyword">else</span> {</div><div class="line">				trie[u][i] = trie[fail[u]][i];</div><div class="line">			}</div><div class="line">		}</div><div class="line">		que.pop();</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span><span class="params">(<span class="keyword">int</span> u)</span> </span>{</div><div class="line">	into[u] = ++ind;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[u].size(); i++)	DFS(G[u][i]);</div><div class="line">	outo[u] = ind;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span> </span>{</div><div class="line">	init();</div><div class="line">	n = <span class="built_in">strlen</span>(s);	ind = <span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, cur = root; i &lt; n; i++) {</div><div class="line">		<span class="keyword">if</span> (s[i] == <span class="string">&apos;B&apos;</span>) {</div><div class="line">			cur = fa[cur];</div><div class="line">		} <span class="keyword">else</span> <span class="keyword">if</span> (s[i] == <span class="string">&apos;P&apos;</span>) {</div><div class="line">			pos[++cnt] = cur;</div><div class="line">		} <span class="keyword">else</span> {</div><div class="line">			trie[cur][s[i]-<span class="string">&apos;a&apos;</span>] = ++ind;</div><div class="line">			fa[ind] = cur, cur = ind;</div><div class="line">		}</div><div class="line">	}</div><div class="line">	CalcFail();</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= ind; i++)	G[fail[i]].push_back(i);</div><div class="line">	ind = <span class="number">0</span>;</div><div class="line">	DFS(root);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">inc</span><span class="params">(<span class="keyword">int</span> pos)</span> </span>{<span class="keyword">for</span> (; pos &lt;= ind; pos += pos&amp;(-pos))	tr[pos]++;}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> pos)</span> </span>{<span class="keyword">for</span> (; pos &lt;= ind; pos += pos&amp;(-pos))	tr[pos]--;}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> pos)</span> </span>{<span class="keyword">int</span> ret = <span class="number">0</span>; <span class="keyword">for</span> (; pos; pos -= pos&amp;(-pos))	ret += tr[pos]; <span class="keyword">return</span> ret;}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>{</div><div class="line">	sort(q, q+m, cmp);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, cur = root, now = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">		<span class="keyword">if</span> (s[i] == <span class="string">&apos;B&apos;</span>) {</div><div class="line">			dec(into[cur]);</div><div class="line">			cur = fa[cur];</div><div class="line">		} <span class="keyword">else</span> <span class="keyword">if</span> (s[i] == <span class="string">&apos;P&apos;</span>) {</div><div class="line">			now++;</div><div class="line">			<span class="keyword">for</span> (; j &lt; m &amp;&amp; q[j].y == now; j++)</div><div class="line">				ans[q[j].id] = sum(outo[pos[q[j].x]])-sum(into[pos[q[j].x]]<span class="number">-1</span>);</div><div class="line">		} <span class="keyword">else</span> {</div><div class="line">			cur = trie[cur][s[i]-<span class="string">&apos;a&apos;</span>];</div><div class="line">			inc(into[cur]);</div><div class="line">		}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s);</div><div class="line">	build();</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;m);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;q[i].x, &amp;q[i].y), q[i].id = i;</div><div class="line">	solve();</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans[i]);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AC自动机/">AC自动机</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/BZOJ/">BZOJ</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NOI/">NOI</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/字符串/">字符串</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据结构/">数据结构</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/树状数组/">树状数组</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-BZOJ2002 Bounce 弹飞绵羊 分块" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/BZOJ2002 Bounce 弹飞绵羊 分块/" class="article-date">
  	<time datetime="2017-08-14T16:00:00.000Z" itemprop="datePublished">2017-08-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/BZOJ2002 Bounce 弹飞绵羊 分块/">
        BZOJ2002 Bounce 弹飞绵羊 &lt;分块&gt;
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><blockquote>
<h2 id="Bounce-&#x5F39;&#x98DE;&#x7EF5;&#x7F8A;"><a href="#Bounce-&#x5F39;&#x98DE;&#x7EF5;&#x7F8A;" class="headerlink" title="Bounce &#x5F39;&#x98DE;&#x7EF5;&#x7F8A;"></a>Bounce &#x5F39;&#x98DE;&#x7EF5;&#x7F8A;</h2><h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>&#x67D0;&#x5929;&#xFF0C;Lostmonkey&#x53D1;&#x660E;&#x4E86;&#x4E00;&#x79CD;&#x8D85;&#x7EA7;&#x5F39;&#x529B;&#x88C5;&#x7F6E;&#xFF0C;&#x4E3A;&#x4E86;&#x5728;&#x4ED6;&#x7684;&#x7EF5;&#x7F8A;&#x670B;&#x53CB;&#x9762;&#x524D;&#x663E;&#x6446;&#xFF0C;&#x4ED6;&#x9080;&#x8BF7;&#x5C0F;&#x7EF5;&#x7F8A;&#x4E00;&#x8D77;&#x73A9;&#x4E2A;&#x6E38;&#x620F;&#x3002;&#x6E38;&#x620F;&#x4E00;&#x5F00;&#x59CB;&#xFF0C;Lostmonkey&#x5728;&#x5730;&#x4E0A;&#x6CBF;&#x7740;&#x4E00;&#x6761;&#x76F4;&#x7EBF;&#x6446;&#x4E0A;n&#x4E2A;&#x88C5;&#x7F6E;&#xFF0C;&#x6BCF;&#x4E2A;&#x88C5;&#x7F6E;&#x8BBE;&#x5B9A;&#x521D;&#x59CB;&#x5F39;&#x529B;&#x7CFB;&#x6570;ki&#xFF0C;&#x5F53;&#x7EF5;&#x7F8A;&#x8FBE;&#x5230;&#x7B2C;i&#x4E2A;&#x88C5;&#x7F6E;&#x65F6;&#xFF0C;&#x5B83;&#x4F1A;&#x5F80;&#x540E;&#x5F39;ki&#x6B65;&#xFF0C;&#x8FBE;&#x5230;&#x7B2C;i+ki&#x4E2A;&#x88C5;&#x7F6E;&#xFF0C;&#x82E5;&#x4E0D;&#x5B58;&#x5728;&#x7B2C;i+ki&#x4E2A;&#x88C5;&#x7F6E;&#xFF0C;&#x5219;&#x7EF5;&#x7F8A;&#x88AB;&#x5F39;&#x98DE;&#x3002;&#x7EF5;&#x7F8A;&#x60F3;&#x77E5;&#x9053;&#x5F53;&#x5B83;&#x4ECE;&#x7B2C;i&#x4E2A;&#x88C5;&#x7F6E;&#x8D77;&#x6B65;&#x65F6;&#xFF0C;&#x88AB;&#x5F39;&#x51E0;&#x6B21;&#x540E;&#x4F1A;&#x88AB;&#x5F39;&#x98DE;&#x3002;&#x4E3A;&#x4E86;&#x4F7F;&#x5F97;&#x6E38;&#x620F;&#x66F4;&#x6709;&#x8DA3;&#xFF0C;Lostmonkey&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#x67D0;&#x4E2A;&#x5F39;&#x529B;&#x88C5;&#x7F6E;&#x7684;&#x5F39;&#x529B;&#x7CFB;&#x6570;&#xFF0C;&#x4EFB;&#x4F55;&#x65F6;&#x5019;&#x5F39;&#x529B;&#x7CFB;&#x6570;&#x5747;&#x4E3A;&#x6B63;&#x6574;&#x6570;&#x3002;</p>
<h3 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h3><p>&#x7B2C;&#x4E00;&#x884C;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x6574;&#x6570;n&#xFF0C;&#x8868;&#x793A;&#x5730;&#x4E0A;&#x6709;n&#x4E2A;&#x88C5;&#x7F6E;&#xFF0C;&#x88C5;&#x7F6E;&#x7684;&#x7F16;&#x53F7;&#x4ECE;0&#x5230;n-1,&#x63A5;&#x4E0B;&#x6765;&#x4E00;&#x884C;&#x6709;n&#x4E2A;&#x6B63;&#x6574;&#x6570;&#xFF0C;&#x4F9D;&#x6B21;&#x4E3A;&#x90A3;n&#x4E2A;&#x88C5;&#x7F6E;&#x7684;&#x521D;&#x59CB;&#x5F39;&#x529B;&#x7CFB;&#x6570;&#x3002;&#x7B2C;&#x4E09;&#x884C;&#x6709;&#x4E00;&#x4E2A;&#x6B63;&#x6574;&#x6570;m&#xFF0C;&#x63A5;&#x4E0B;&#x6765;m&#x884C;&#x6BCF;&#x884C;&#x81F3;&#x5C11;&#x6709;&#x4E24;&#x4E2A;&#x6570;i&#x3001;j&#xFF0C;&#x82E5;i=1&#xFF0C;&#x4F60;&#x8981;&#x8F93;&#x51FA;&#x4ECE;j&#x51FA;&#x53D1;&#x88AB;&#x5F39;&#x51E0;&#x6B21;&#x540E;&#x88AB;&#x5F39;&#x98DE;&#xFF0C;&#x82E5;i=2&#x5219;&#x8FD8;&#x4F1A;&#x518D;&#x8F93;&#x5165;&#x4E00;&#x4E2A;&#x6B63;&#x6574;&#x6570;k&#xFF0C;&#x8868;&#x793A;&#x7B2C;j&#x4E2A;&#x5F39;&#x529B;&#x88C5;&#x7F6E;&#x7684;&#x7CFB;&#x6570;&#x88AB;&#x4FEE;&#x6539;&#x6210;k&#x3002;&#x5BF9;&#x4E8E;20%&#x7684;&#x6570;&#x636E;n,m&lt;=10000&#xFF0C;&#x5BF9;&#x4E8E;100%&#x7684;&#x6570;&#x636E;n&lt;=200000,m&lt;=100000</p>
<h3 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h3><p>&#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;i=1&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x4F60;&#x90FD;&#x8981;&#x8F93;&#x51FA;&#x4E00;&#x4E2A;&#x9700;&#x8981;&#x7684;&#x6B65;&#x6570;&#xFF0C;&#x5360;&#x4E00;&#x884C;&#x3002;</p>
<h3 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h3><p>4<br>1 2 1 1<br>3<br>1 1<br>2 1 1<br>1 1</p>
<h3 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h3><p>2<br>3</p>
</blockquote>
<p>&#x6807;&#x7B7E;&#xFF1A;LCT&#xFF0C;&#x5206;&#x5757;</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>&#x672C;&#x9898;&#x5176;&#x5B9E;&#x5E94;&#x8BE5;&#x662F;LCT&#x7684;&#x57FA;&#x7840;&#x9898;&#xFF0C;&#x4F46;&#x662F;&#x56E0;&#x4E3A;&#x6211;&#x8EAB;&#x4E3A;&#x849F;&#x84BB;&#x5199;&#x4E0D;&#x6765;LCT&#xFF0C;&#x5C31;&#x7528;&#x5206;&#x5757;&#x505A;&#x4E86;&#x3002;<br>&#x201C;&#x5206;&#x5757;&#x8005;&#xFF0C;&#x597D;&#x5199;&#x597D;&#x8C03;&#x8FD8;&#x5F88;&#x4F18;&#x201D;               &#x2014;&#x2014;&#x67D0;&#x795E;&#x7287;<br>&#x628A;&#x539F;&#x6570;&#x5217;&#x5206;&#x4E3A;sqrt(n)&#x4E2A;&#x5757;&#xFF0C;&#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;&#x5757;&#xFF0C;&#x7EF4;&#x62A4;&#x5757;&#x5185;&#x7684;&#x6BCF;&#x4E2A;&#x4F4D;&#x7F6E;&#x9700;&#x8981;&#x591A;&#x5C11;&#x6B65;&#x624D;&#x80FD;&#x8DF3;&#x5230;&#x5757;&#x5916;&#xFF0C;&#x4EE5;&#x53CA;&#x8DF3;&#x5230;&#x5757;&#x5916;&#x540E;&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x5BF9;&#x4E8E;&#x4FEE;&#x6539;&#x64CD;&#x4F5C;&#xFF0C;&#x91CD;&#x7B97;&#x90A3;&#x4E2A;&#x5757;&#x5185;&#x7684;&#x6240;&#x6709;&#x4F4D;&#x7F6E;&#x7684;&#x4E24;&#x4E2A;&#x503C;&#xFF0C;&#x8FD9;&#x6837;&#x5355;&#x6B21;&#x8BE2;&#x95EE;&#x6216;&#x4FEE;&#x6539;&#x590D;&#x6742;&#x5EA6;O(sqrt(n))&#x3002;&#x53EF;&#x4EE5;&#x8FC7;&#x3002;</p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 200000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m, magic, k[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="keyword">int</span> pos[MAX_N+<span class="number">5</span>], times[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>{</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = r; i &gt;= l; i--)</div><div class="line">		<span class="keyword">if</span> (i+k[i] &gt;= n)	pos[i] = <span class="number">-1</span>, times[i] = <span class="number">1</span>;</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (i+k[i] &gt;= (i/magic+<span class="number">1</span>)*magic)	pos[i] = i+k[i], times[i] = <span class="number">1</span>;</div><div class="line">		<span class="keyword">else</span>	pos[i] = pos[i+k[i]], times[i] = times[i+k[i]]+<span class="number">1</span>;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n), magic = <span class="built_in">sqrt</span>(n);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;k[i]);	update(<span class="number">0</span>, n<span class="number">-1</span>);</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;m);</div><div class="line">	<span class="keyword">while</span> (m--) {</div><div class="line">		<span class="keyword">int</span> opt;	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;opt);</div><div class="line">		<span class="keyword">if</span> (opt == <span class="number">1</span>) {</div><div class="line">			<span class="keyword">int</span> x, ans = <span class="number">0</span>;</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</div><div class="line">			<span class="keyword">while</span> (x != <span class="number">-1</span>)	ans += times[x], x = pos[x];</div><div class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</div><div class="line">		}</div><div class="line">		<span class="keyword">if</span> (opt == <span class="number">2</span>) {<span class="keyword">int</span> x, y;	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;x, &amp;y), k[x] = y;	update(x/magic*magic, x);}</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
<p>&#x8FD9;&#x9898;&#x5199;&#x5206;&#x5757;&#x7B80;&#x76F4;&#x8D5A;&#x4E86;&#xFF0C;&#x8FD9;&#x4E48;&#x77ED;&#x7684;&#x4EE3;&#x7801;&#x8FD8;&#x53EF;&#x4EE5;A&#x6389;&#x6B64;&#x9898;&#xFF0C;LCT&#x9EBB;&#x70E6;&#x5F97;&#x591A;&#x3002;<br>&#x5206;&#x5757;&#x5927;&#x53D1;&#x597D;</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/BZOJ/">BZOJ</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/分块/">分块</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据结构/">数据结构</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-主席树原理与基础例题" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/主席树原理与基础例题/" class="article-date">
  	<time datetime="2017-07-24T16:00:00.000Z" itemprop="datePublished">2017-07-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/主席树原理与基础例题/">
        主席树原理与基础例题
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>&#x58F0;&#x660E;&#xFF1A;&#x56E0;&#x53EF;&#x6301;&#x4E45;&#x5316;&#x7EBF;&#x6BB5;&#x6811;&#x7684;&#x56FE;&#x7247;&#x4E0D;&#x597D;&#x627E;&#xFF0C;&#x6545;&#x8F6C;&#x8F7D;&#x4F7F;&#x7528;JK&#x91D1;&#x5764;&#x7684;&#x56FE;&#x7247;&#x8F85;&#x52A9;&#x8BF4;&#x660E;&#xFF0C;&#x5404;&#x4F4D;&#x8BFB;&#x8005;&#x6709;&#x5174;&#x8DA3;&#x53EF;&#x4EE5;&#x53BB;&#x770B;JK&#x91D1;&#x5764;&#x7684;&#x6C42;&#x533A;&#x95F4;&#x7B2C;K&#x5C0F;&#x7684;&#x9898;&#x89E3;&#xFF0C;&#x4E5F;&#x8BB2;&#x7684;&#x5F88;&#x6E05;&#x695A;&#x3002;</p>
<p>&#x53EF;&#x6301;&#x4E45;&#x5316;&#x7EBF;&#x6BB5;&#x6811;&#xFF0C;&#x770B;&#x5230;&#x540D;&#x5B57;&#xFF0C;&#x5C31;&#x77E5;&#x9053;&#x4E00;&#x5B9A;&#x548C;&#x7EBF;&#x6BB5;&#x6811;&#x76F8;&#x5173;&#xFF0C;&#x5728;&#x6B64;&#xFF0C;&#x5BF9;&#x4E8E;&#x7EBF;&#x6BB5;&#x6811;&#x7684;&#x539F;&#x7406;&#x5C31;&#x4E0D;&#x518D;&#x8D58;&#x8FF0;&#xFF0C;&#x8BFB;&#x8005;&#x82E5;&#x4E0D;&#x61C2;&#x53EF;&#x81EA;&#x884C;&#x767E;&#x5EA6;&#x3002;&#x53EF;&#x6301;&#x4E45;&#x5316;&#xFF0C;&#x5C31;&#x662F;&#x8BA9;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x505A;&#x5230;&#x80FD;&#x591F;&#x8BBF;&#x95EE;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x5386;&#x53F2;&#x72B6;&#x6001;&#x3002;&#x603B;&#x4F53;&#x8BF4;&#x6765;&#xFF0C;&#x8BA9;&#x7EBF;&#x6BB5;&#x6811;&#x6301;&#x4E45;&#x5316;&#x5E76;&#x4E0D;&#x7B97;&#x592A;&#x590D;&#x6742;&#x3002;&#x63A5;&#x4E0B;&#x6765;&#xFF0C;&#x8BA9;&#x6211;&#x4EEC;&#x4ECE;&#x4E00;&#x9053;&#x4F8B;&#x9898;&#x5165;&#x624B;&#x3002;</p>
<blockquote>
<p>&#x3010;OpenJudge1001&#x3011;Challenge 1<br>&#x603B;&#x65F6;&#x95F4;&#x9650;&#x5236;: 10000ms<br>&#x5355;&#x4E2A;&#x6D4B;&#x8BD5;&#x70B9;&#x65F6;&#x95F4;&#x9650;&#x5236;: 1000ms<br>&#x5185;&#x5B58;&#x9650;&#x5236;: 262144kB</p>
<p>&#x63CF;&#x8FF0; &#x7ED9;&#x4E00;&#x4E2A;&#x957F;&#x4E3A;N&#x7684;&#x6570;&#x5217;&#xFF0C;&#x6709;M&#x6B21;&#x64CD;&#x4F5C;&#xFF0C;&#x6BCF;&#x6B21;&#x64CD;&#x4F5C;&#x662F;&#x4EE5;&#x4E0B;&#x4E24;&#x79CD;&#x4E4B;&#x4E00;&#xFF1A; &#xFF08;1&#xFF09;&#x4FEE;&#x6539;&#x6570;&#x5217;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x6570; &#xFF08;2&#xFF09;&#x6C42;&#x6570;&#x5217;&#x4E2D;&#x67D0;&#x4F4D;&#x7F6E;&#x5728;&#x67D0;&#x6B21;&#x64CD;&#x4F5C;&#x540E;&#x7684;&#x503C;</p>
<p>&#x8F93;&#x5165; &#x7B2C;&#x4E00;&#x884C;&#x4E24;&#x4E2A;&#x6B63;&#x6574;&#x6570;N&#x548C;M&#x3002; &#x7B2C;&#x4E8C;&#x884C;N&#x4E2A;&#x6574;&#x6570;&#x8868;&#x793A;&#x8FD9;&#x4E2A;&#x6570;&#x5217;&#x3002;<br>&#x63A5;&#x4E0B;&#x6765;M&#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x5F00;&#x5934;&#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#xFF0C;&#x82E5;&#x8BE5;&#x5B57;&#x7B26;&#x4E3A;&#x2019;M&#x2019;&#xFF0C;&#x5219;&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x4FEE;&#x6539;&#x64CD;&#x4F5C;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x4E24;&#x4E2A;&#x6574;&#x6570;x&#x548C;y&#xFF0C;&#x8868;&#x793A;&#x628A;x&#x4F4D;&#x7F6E;&#x7684;&#x503C;&#x4FEE;&#x6539;&#x4E3A;y&#xFF1B;&#x82E5;&#x8BE5;&#x5B57;&#x7B26;&#x4E3A;&#x2019;Q&#x2019;&#xFF0C;&#x5219;&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x8BE2;&#x95EE;&#x64CD;&#x4F5C;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x4E24;&#x4E2A;&#x6574;&#x6570;x&#x548C;y&#xFF0C;&#x8868;&#x793A;&#x6C42;x&#x4F4D;&#x7F6E;&#x5728;&#x7B2C;y&#x6B21;&#x64CD;&#x4F5C;&#x540E;&#x7684;&#x503C;&#x3002;<br>&#x8F93;&#x51FA; &#x5BF9;&#x6BCF;&#x4E00;&#x4E2A;&#x8BE2;&#x95EE;&#x64CD;&#x4F5C;&#x5355;&#x72EC;&#x8F93;&#x51FA;&#x4E00;&#x884C;&#xFF0C;&#x8868;&#x793A;&#x7B54;&#x6848;&#x3002;</p>
<p>&#x6837;&#x4F8B;&#x8F93;&#x5165;<br>5 3<br>1 2 3 4 5<br>Q 1 0<br>M 1 3<br>Q 1 2<br>&#x6837;&#x4F8B;&#x8F93;&#x51FA;<br>1<br>3<br>&#x63D0;&#x793A;<br>1&lt;=N&lt;=1e5&#xFF0C;1&lt;=M&lt;=1e5&#xFF0C;&#x8F93;&#x5165;&#x4FDD;&#x8BC1;&#x5408;&#x6CD5;&#xFF0C;&#x4E14;&#x6240;&#x6709;&#x6574;&#x6570;&#x53EF;&#x7528;&#x5E26;&#x7B26;&#x53F7;32&#x4F4D;&#x6574;&#x578B;&#x5B58;&#x50A8;&#x3002;</p>
</blockquote>
<p> &#x8FD9;&#x9053;&#x9898;&#x5F88;&#x6C34;&#xFF0C;&#x64CD;&#x4F5C;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x5355;&#x70B9;&#x4FEE;&#x6539;&#xFF0C;&#x5386;&#x53F2;&#x5355;&#x70B9;&#x67E5;&#x8BE2;&#xFF0C;&#x751A;&#x81F3;&#x8FDE;&#x533A;&#x95F4;&#x90FD;&#x6D89;&#x53CA;&#x4E0D;&#x5230;&#x3002;&#x5404;&#x4F4D;&#x8BFB;&#x8005;&#x53EF;&#x80FD;&#x9A6C;&#x4E0A;&#x60F3;&#x5230;&#x53EF;&#x4EE5;&#x79BB;&#x7EBF;&#x64CD;&#x4F5C;&#xFF0C;&#x5148;&#x628A;&#x6240;&#x6709;&#x64CD;&#x4F5C;&#x8BFB;&#x5165;&#xFF0C;&#x5728;&#x6309;&#x65F6;&#x95F4;&#x4ECE;&#x524D;&#x5F80;&#x540E;&#x64CD;&#x4F5C;&#xFF0C;&#x6BCF;&#x6B21;&#x64CD;&#x4F5C;&#x540E;&#x770B;&#x662F;&#x5426;&#x6709;&#x8BE2;&#x95EE;&#x5728;&#x6B64;&#x65F6;&#x8FDB;&#x884C;&#xFF0C;&#x8BB0;&#x5F55;&#x7B54;&#x6848;&#xFF0C;&#x6700;&#x540E;&#x6309;&#x8BE2;&#x95EE;&#x987A;&#x5E8F;&#x8F93;&#x51FA;&#x3002;&#x8FD9;&#x6837;&#x505A;&#x65E0;&#x7591;&#x662F;&#x80FD;A&#x6389;&#x8FD9;&#x9053;&#x7B80;&#x5355;&#x9898;&#x7684;&#xFF0C;&#x4F46;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x8981;&#x5728;&#x7EBF;&#x505A;&#x5462;&#xFF1F;</p>
<p>1.&#x8BB0;&#x5F55;&#x5386;&#x53F2;&#x7248;&#x672C;<br>&#x5728;&#x7EBF;&#x505A;&#x7684;&#x8BDD;&#xFF0C;&#x5404;&#x4F4D;&#x8BFB;&#x8005;&#x53EF;&#x80FD;&#x4F1A;&#x9996;&#x5148;&#x60F3;&#x5230;&#xFF0C;&#x5BF9;&#x4E8E;&#x6BCF;&#x6B21;&#x4FEE;&#x6539;&#xFF0C;&#x628A;&#x4FEE;&#x6539;&#x524D;&#x540E;&#x7684;&#x5217;&#x90FD;&#x5B58;&#x4E0B;&#x6765;&#xFF0C;&#x5E76;&#x6807;&#x8BB0;&#x662F;&#x54EA;&#x6B21;&#x64CD;&#x4F5C;&#x540E;&#x7684;&#x6570;&#x5217;&#xFF0C;&#x8BE2;&#x95EE;&#x7684;&#x65F6;&#x5019;&#x6309;&#x65F6;&#x95F4;&#x67E5;&#x8BE2;&#x5373;&#x53EF;&#x3002;&#x4F46;&#x8FD9;&#x65F6;&#x5C31;&#x51FA;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#xFF1A;&#x9898;&#x76EE;&#x4E2D;&#x539F;&#x6570;&#x5217;&#x6700;&#x957F;&#x6709;1e5&#x4E2A;&#x6570;&#xFF0C;1e5&#x6B21;&#x8BE2;&#x95EE;&#xFF0C;&#x5982;&#x679C;&#x524D;1e5-1&#x6B21;&#x8BE2;&#x95EE;&#x90FD;&#x662F;&#x66F4;&#x6539;&#x67D0;&#x4E2A;&#x6570;&#xFF0C;&#x6700;&#x540E;&#x4E00;&#x6B21;&#x624D;&#x662F;&#x8BE2;&#x95EE;&#x67D0;&#x4F4D;&#x7F6E;&#x7684;&#x6570;&#x5728;t&#x65F6;&#x95F4;&#x7684;&#x503C;&#xFF0C;&#x90A3;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5B58;&#x50A8;1e5*1e5&#x4E2A;&#x6570;&#xFF0C;&#x80AF;&#x5B9A;&#x4F1A;&#x7206;&#x7A7A;&#x95F4;&#x3002;<br>&#x5230;&#x8FD9;&#x91CC;&#xFF0C;&#x5404;&#x4F4D;&#x806A;&#x660E;&#x7684;&#x8BFB;&#x8005;&#x4E00;&#x5B9A;&#x53C8;&#x60F3;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#xFF1A;&#x6BCF;&#x6B21;&#x53EA;&#x8BB0;&#x5F55;&#x66F4;&#x6539;&#x7684;&#x503C;&#xFF0C;&#x4E0D;&#x8BB0;&#x5F55;&#x4E0D;&#x53D8;&#x7684;&#x6570;&#x503C;&#xFF0C;&#x8FD9;&#x6837;&#x53EF;&#x4EE5;&#x5C11;&#x6D88;&#x8017;&#x5927;&#x91CF;&#x7A7A;&#x95F4;&#x3002;&#x4E3A;&#x4E86;&#x5FEB;&#x901F;&#x5B9E;&#x73B0;&#x8FD9;&#x4E00;&#x8FC7;&#x7A0B;&#xFF0C;&#x907F;&#x514D;&#x9EBB;&#x70E6;&#xFF0C;&#x6211;&#x4EEC;&#x60F3;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x6570;&#x5217;&#x64CD;&#x4F5C;&#x7684;&#x65B9;&#x4FBF;&#x6570;&#x636E;&#x7ED3;&#x6784;&#xFF0C;&#x7EBF;&#x6BB5;&#x6811;&#x3002;</p>
<p>2.&#x90E8;&#x5206;&#x4FEE;&#x6539;&#x7684;&#x7EBF;&#x6BB5;&#x6811;<br>&#x5BF9;&#x4E8E;&#x6BCF;&#x6B21;&#x4FEE;&#x6539;&#xFF0C;&#x6211;&#x4EEC;&#x90FD;&#x53EA;&#x4F1A;&#x5B58;&#x50A8;&#x4FEE;&#x6539;&#x7684;&#x503C;&#xFF0C;&#x800C;&#x5BF9;&#x4E8E;&#x4E00;&#x9897;&#x7EBF;&#x6BB5;&#x6811;&#x6765;&#x8BF4;&#xFF0C;&#x6211;&#x4EEC;&#x5219;&#x5B58;&#x50A8;&#x4ECE;&#x8FD9;&#x4E2A;&#x53F6;&#x5B50;&#x7ED3;&#x70B9;&#x5230;&#x6811;&#x6839;&#x7684;&#x8FD9;&#x6761;&#x94FE;&#x4E0A;&#x7684;&#x8282;&#x70B9;&#x3002;<br>&#x5982;&#x679C;&#x6211;&#x4EEC;&#x8981;&#x4FEE;&#x6539;&#x7B2C;4&#x4E2A;&#x6570;&#xFF0C;&#x5373;&#x4FEE;&#x6539;[4,4]&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x4F1A;&#x65B0;&#x5EFA;&#x4E09;&#x4E2A;&#x8282;&#x70B9;&#xFF1A;[4,4][3,4][1,4]&#xFF0C;&#x5E76;&#x628A;&#x8FD9;&#x4E9B;&#x8282;&#x70B9;&#x7684;&#x5B50;&#x8282;&#x70B9;&#x4E2D;&#x6CA1;&#x6709;&#x4FEE;&#x6539;&#x7684;&#x8282;&#x70B9;&#x6307;&#x5411;&#x539F;&#x6765;&#x5BF9;&#x5E94;&#x7684;&#x5B50;&#x8282;&#x70B9;&#xFF0C;&#x5373;[1,4]&#x6307;&#x5411;&#x539F;&#x6811;&#x4E2D;&#x7684;[1,2]&#x548C;&#x65B0;&#x5EFA;&#x7684;[3,4]&#xFF0C;[3,4]&#x6307;&#x5411;&#x539F;&#x6811;&#x4E2D;&#x7684;[3,3]&#x548C;&#x65B0;&#x5EFA;&#x7684;[4,4]&#x3002;<br>&#x8FD9;&#x6837;&#x4E00;&#x6765;&#xFF0C;&#x5BF9;&#x4E8E;&#x6BCF;&#x6B21;&#x4FEE;&#x6539;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x7528;&#x65B0;&#x5EFA;logn&#x4E2A;&#x8282;&#x70B9;&#xFF0C;&#x7A7A;&#x95F4;&#x591F;&#x4E86;&#x3002;</p>
<p>3.&#x51FD;&#x6570;&#x5F0F;&#x7EBF;&#x6BB5;&#x6811;<br>&#x6211;&#x4EEC;&#x89E3;&#x51B3;&#x4E86;&#x7A7A;&#x95F4;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x4F46;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#xFF0C;&#x6211;&#x4EEC;&#x53C8;&#x6709;&#x4E86;&#x4E00;&#x4E2A;&#x7EC6;&#x8282;&#x4E0A;&#x7684;&#x95EE;&#x9898;&#xFF1A;&#x65B0;&#x5EFA;&#x8282;&#x70B9;&#x7684;&#x7F16;&#x53F7;&#x600E;&#x4E48;&#x5B9A;&#xFF1F;&#x80AF;&#x5B9A;&#x4E0D;&#x80FD;&#x50CF;&#x4EE5;&#x524D;&#x5199;&#x666E;&#x901A;&#x7684;&#x5806;&#x5F0F;&#x7EBF;&#x6BB5;&#x6811;&#x4E00;&#x6837;&#xFF0C;&#x5DE6;&#x513F;&#x5B50;&#x7F16;&#x53F7;&#x662F;&#x8282;&#x70B9;&#x7F16;&#x53F7;&#x4E58;&#x4E8C;&#xFF0C;&#x53F3;&#x513F;&#x5B50;&#x7F16;&#x53F7;&#x662F;&#x8282;&#x70B9;&#x7F16;&#x53F7;&#x4E58;&#x4E8C;&#x52A0;&#x4E00;&#x3002;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x53EA;&#x6DFB;&#x52A0;&#x4E00;&#x6761;&#x94FE;&#xFF0C;&#x4E0D;&#x80FD;&#x90A3;&#x6837;&#x7F16;&#x53F7;&#x3002;&#x5982;&#x679C;&#x6709;&#x5199;&#x8FC7;&#x5B57;&#x5178;&#x6811;&#x6216;AC&#x81EA;&#x52A8;&#x673A;&#x7684;&#x8BFB;&#x8005;&#xFF0C;&#x53EF;&#x4EE5;&#x7C7B;&#x6BD4;&#x5F97;&#x51FA;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x51FD;&#x6570;&#x5F0F;&#x5EFA;&#x6811;&#xFF0C;&#x5373;&#x8BB0;&#x5F55;&#x4E00;&#x4E2A;&#x5F53;&#x524D;&#x7684;&#x603B;&#x8282;&#x70B9;&#x6570;cnt&#xFF0C;&#x6BCF;&#x589E;&#x52A0;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#xFF0C;&#x8FD9;&#x4E2A;&#x65B0;&#x8282;&#x70B9;&#x7684;&#x7F16;&#x53F7;&#x4E3A;cnt+1&#xFF0C;&#x968F;&#x540E;cnt++&#x3002;<br>&#x9664;&#x6B64;&#x4E4B;&#x5916;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x77E5;&#x9053;&#xFF0C;&#x7B2C;t&#x65F6;&#x523B;&#x7684;&#x6570;&#x5217;&#xFF0C;&#x5BF9;&#x5E94;&#x5230;&#x7EBF;&#x6BB5;&#x6811;&#x4E2D;&#x5C31;&#x662F;&#x4EE5;&#x7B2C;t&#x4E2A;&#x6811;&#x6839;&#x4E3A;&#x6811;&#x6839;&#x7684;&#x90A3;&#x9897;&#x7EBF;&#x6BB5;&#x6811;&#xFF0C;&#x56E0;&#x800C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x8BB0;&#x5F55;&#x6BCF;&#x4E2A;&#x65F6;&#x523B;&#x5BF9;&#x5E94;&#x7EBF;&#x6BB5;&#x6811;&#x7684;&#x6839;&#xFF0C;&#x5373;root[]&#x3002;</p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x7ED9;&#x51FA;&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#xFF1A;<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 100000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> {</span><span class="keyword">int</span> ls, rs, val;} tr[<span class="number">2000000</span>];	<span class="comment">//&#x6BCF;&#x4E2A;&#x8282;&#x70B9;&#x4E09;&#x4E2A;&#x503C;&#xFF0C;ls&#x4E3A;&#x5DE6;&#x513F;&#x5B50;&#x7F16;&#x53F7;&#xFF0C;rs&#x4E3A;&#x53F3;&#x513F;&#x5B50;&#x7F16;&#x53F7;&#xFF0C;val&#x4E3A;&#x8BE5;&#x8282;&#x70B9;&#x6743;&#x503C;</span></div><div class="line"><span class="keyword">int</span> n, m, cnt, now;</div><div class="line"><span class="keyword">int</span> root[MAX_N+<span class="number">5</span>];	<span class="comment">//root&#x6570;&#x7EC4;&#x8BB0;&#x5F55;&#x6BCF;&#x4E2A;&#x65F6;&#x523B;&#x5BF9;&#x5E94;&#x90A3;&#x9897;&#x7EBF;&#x6BB5;&#x6811;&#x7684;&#x6811;&#x6839;</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (s == t) {</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;tr[v].val);</div><div class="line">		<span class="comment">//&#x82E5;&#x5DF2;&#x5230;&#x53F6;&#x5B50;&#x7ED3;&#x70B9;&#xFF0C;&#x5219;&#x8BFB;&#x5165;</span></div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	}</div><div class="line">	tr[v].ls = ++cnt;	<span class="comment">//&#x65B0;&#x5EFA;&#x5DE6;&#x513F;&#x5B50;&#xFF0C;&#x7F16;&#x53F7;&#x4E3A;&#x8282;&#x70B9;&#x603B;&#x6570;+1</span></div><div class="line">	tr[v].rs = ++cnt;	<span class="comment">//&#x65B0;&#x5EFA;&#x53F3;&#x513F;&#x5B50;&#xFF0C;&#x7F16;&#x53F7;&#x4E3A;&#x8282;&#x70B9;&#x603B;&#x6570;+1</span></div><div class="line">	<span class="keyword">int</span> mid = s+t&gt;&gt;<span class="number">1</span>;</div><div class="line">	<span class="comment">//&#x9012;&#x5F52;&#x65B0;&#x5EFA;&#x4E24;&#x4E2A;&#x5B50;&#x533A;&#x95F4;</span></div><div class="line">	build(tr[v].ls, s, mid);</div><div class="line">	build(tr[v].rs, mid+<span class="number">1</span>, t);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> ori, <span class="keyword">int</span> pos, <span class="keyword">int</span> x)</span> </span>{</div><div class="line">	<span class="comment">//ori&#x4E3A;&#x539F;&#x6811;&#x4E0A;v&#x8282;&#x70B9;&#x5BF9;&#x5E94;&#x7684;&#x539F;&#x8282;&#x70B9;</span></div><div class="line">	tr[v] = tr[ori];	</div><div class="line">	<span class="comment">//&#x5148;&#x5C06;ori&#x7684;&#x5404;&#x9879;&#x6210;&#x5458;&#x53C2;&#x6570;&#x8D4B;&#x7ED9;v&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x4F1A;&#x9009;ori&#x5DE6;&#x53F3;&#x513F;&#x5B50;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#x548C;&#x65B0;&#x5EFA;&#xFF0C;&#x5B83;&#x7684;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x513F;&#x5B50;&#x4F1A;&#x4FDD;&#x7559;</span></div><div class="line">	<span class="keyword">if</span> (s == t) {</div><div class="line">		tr[v].val = x;</div><div class="line">		<span class="comment">//&#x82E5;&#x5DF2;&#x5230;&#x53F6;&#x5B50;&#x7ED3;&#x70B9;&#xFF0C;&#x5219;&#x4FEE;&#x6539;&#x5E76;&#x8FD4;&#x56DE;</span></div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	}</div><div class="line">	<span class="keyword">int</span> mid = s+t&gt;&gt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span> (pos &lt;= mid) {</div><div class="line">		<span class="comment">//&#x82E5;pos&#x5728;&#x5DE6;&#x533A;&#x95F4;&#xFF0C;&#x6211;&#x4EEC;&#x8981;&#x4FEE;&#x6539;&#x5DE6;&#x513F;&#x5B50;&#xFF0C;&#x5728;&#x8FD9;&#x91CC;&#x5373;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;&#x5DE6;&#x513F;&#x5B50;&#xFF0C;&#x548C;&#x5EFA;&#x6811;&#x4E00;&#x6837;&#xFF0C;&#x8981;++cnt</span></div><div class="line">		tr[v].ls = ++cnt;</div><div class="line">		modify(tr[v].ls, s, mid, tr[ori].ls, pos, x);</div><div class="line">	} <span class="keyword">else</span> {</div><div class="line">		<span class="comment">//&#x539F;&#x7406;&#x540C;&#x4E0A;</span></div><div class="line">		tr[v].rs = ++cnt;</div><div class="line">		modify(tr[v].rs, mid+<span class="number">1</span>, t, tr[ori].rs, pos, x);</div><div class="line">	}</div><div class="line">	<span class="comment">//&#x6CE8;&#xFF1A;&#x4E0A;&#x9762;&#x9012;&#x5F52;modify&#x4FEE;&#x6539;&#x65F6;&#xFF0C;&#x4F20;&#x53C2;&#x6570;&#x8981;&#x5C0F;&#x5FC3;&#xFF0C;&#x5BF9;&#x4E8E;ori&#x8FD9;&#x9879;&#x53C2;&#x6570;&#xFF0C;&#x5DE6;&#x5B50;&#x8282;&#x70B9;&#x7684;&#x539F;&#x8282;&#x70B9;&#x662F;tr[ori].ls&#xFF0C;&#x4E0D;&#x8BE5;&#x76F4;&#x63A5;&#x4F20;ori&#xFF0C;&#x53F3;&#x8FB9;&#x540C;&#x7406;</span></div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> pos)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (s == t)	<span class="keyword">return</span> tr[v].val;</div><div class="line">	<span class="keyword">int</span> mid = s+t&gt;&gt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span> (pos &lt;= mid) <span class="keyword">return</span> query(tr[v].ls, s, mid, pos);</div><div class="line">	<span class="keyword">else</span>	<span class="keyword">return</span> query(tr[v].rs, mid+<span class="number">1</span>, t, pos);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</div><div class="line">	now = <span class="number">0</span>, cnt = <span class="number">0</span>;</div><div class="line">	root[now] = ++cnt;	<span class="comment">//&#x539F;&#x6811;&#x6839;&#x4E3A;1</span></div><div class="line">	build(root[now], <span class="number">1</span>, n);</div><div class="line">	<span class="keyword">while</span> (m--) {</div><div class="line">		<span class="keyword">char</span> ch;	<span class="keyword">int</span> a, b;</div><div class="line">		<span class="built_in">cin</span> &gt;&gt; ch &gt;&gt; a &gt;&gt; b;</div><div class="line">		<span class="keyword">if</span> (ch == <span class="string">&apos;Q&apos;</span>) {</div><div class="line">			now++;	<span class="comment">//&#x65F6;&#x95F4;&#x6233;++</span></div><div class="line">			root[now] = root[now<span class="number">-1</span>];	<span class="comment">//&#x6811;&#x6839;&#x6CA1;&#x53D8;&#xFF0C;&#x6240;&#x4EE5;&#x7528;&#x4E0A;&#x4E00;&#x4E2A;&#x6811;&#x6839;</span></div><div class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, query(root[b], <span class="number">1</span>, n, a));</div><div class="line">			<span class="comment">//&#x4ECE;root[b]&#xFF0C;&#x5373;b&#x65F6;&#x523B;&#x7684;&#x6811;&#x6839;&#x5F00;&#x59CB;query</span></div><div class="line">		}</div><div class="line">		<span class="keyword">if</span> (ch == <span class="string">&apos;M&apos;</span>) {</div><div class="line">			now++;	<span class="comment">//&#x65F6;&#x95F4;&#x6233;++</span></div><div class="line">			root[now] = ++cnt;	<span class="comment">//&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;&#x6811;&#x6839;&#xFF0C;&#x5E76;&#x4ECE;&#x5B83;&#x5F00;&#x59CB;&#x4FEE;&#x6539;</span></div><div class="line">			modify(root[now], <span class="number">1</span>, n, root[now<span class="number">-1</span>], a, b);</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>&#x5404;&#x4F4D;&#x8BFB;&#x8005;&#x5E94;&#x8BE5;&#x770B;&#x61C2;&#x4E86;&#x5427;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#xFF0C;&#x6211;&#x4EEC;&#x518D;&#x6765;&#x505A;&#x4E00;&#x9053;&#x7B80;&#x5355;&#x9898;&#x7EC3;&#x624B;</p>
<blockquote>
<p>&#x3010;OpenJudge1002&#x3011;Challenge 2 &#x603B;&#x65F6;&#x95F4;&#x9650;&#x5236;: 10000ms &#x5355;&#x4E2A;&#x6D4B;&#x8BD5;&#x70B9;&#x65F6;&#x95F4;&#x9650;&#x5236;: 1000ms &#x5185;&#x5B58;&#x9650;&#x5236;:<br>262144kB</p>
<p>&#x63CF;&#x8FF0; &#x7ED9;&#x4E00;&#x4E2A;&#x7A7A;&#x6570;&#x5217;&#xFF0C;&#x6709;M&#x6B21;&#x64CD;&#x4F5C;&#xFF0C;&#x6BCF;&#x6B21;&#x64CD;&#x4F5C;&#x662F;&#x4EE5;&#x4E0B;&#x4E09;&#x79CD;&#x4E4B;&#x4E00;&#xFF1A; &#xFF08;1&#xFF09;&#x5728;&#x6570;&#x5217;&#x540E;&#x52A0;&#x4E00;&#x4E2A;&#x6570; &#xFF08;2&#xFF09;&#x6C42;&#x6570;&#x5217;&#x4E2D;&#x67D0;&#x4F4D;&#x7F6E;&#x7684;&#x503C;<br>&#xFF08;3&#xFF09;&#x64A4;&#x9500;&#x6389;&#x6700;&#x540E;&#x8FDB;&#x884C;&#x7684;&#x82E5;&#x5E72;&#x6B21;&#x64CD;&#x4F5C;&#xFF08;1&#x548C;3&#xFF09;</p>
<p>&#x8F93;&#x5165; &#x7B2C;&#x4E00;&#x884C;&#x4E00;&#x4E2A;&#x6B63;&#x6574;&#x6570;M&#x3002;<br>&#x63A5;&#x4E0B;&#x6765;M&#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x5F00;&#x5934;&#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#xFF0C;&#x82E5;&#x8BE5;&#x5B57;&#x7B26;&#x4E3A;&#x2019;A&#x2019;&#xFF0C;&#x5219;&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x52A0;&#x6570;&#x64CD;&#x4F5C;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x4E00;&#x4E2A;&#x6574;&#x6570;x&#xFF0C;&#x8868;&#x793A;&#x5728;&#x6570;&#x5217;&#x540E;&#x52A0;&#x4E00;&#x4E2A;&#x6574;&#x6570;x&#xFF1B;&#x82E5;&#x8BE5;&#x5B57;&#x7B26;&#x4E3A;&#x2019;Q&#x2019;&#xFF0C;&#x5219;&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x8BE2;&#x95EE;&#x64CD;&#x4F5C;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x4E00;&#x4E2A;&#x6574;&#x6570;x&#xFF0C;&#x8868;&#x793A;&#x6C42;x&#x4F4D;&#x7F6E;&#x7684;&#x503C;&#xFF1B;&#x82E5;&#x8BE5;&#x5B57;&#x7B26;&#x4E3A;&#x2019;U&#x2019;&#xFF0C;&#x5219;&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x64A4;&#x9500;&#x64CD;&#x4F5C;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x4E00;&#x4E2A;&#x6574;&#x6570;x&#xFF0C;&#x8868;&#x793A;&#x64A4;&#x9500;&#x6389;&#x6700;&#x540E;&#x8FDB;&#x884C;&#x7684;&#x82E5;&#x5E72;&#x6B21;&#x64CD;&#x4F5C;&#x3002;<br>&#x8F93;&#x51FA; &#x5BF9;&#x6BCF;&#x4E00;&#x4E2A;&#x8BE2;&#x95EE;&#x64CD;&#x4F5C;&#x5355;&#x72EC;&#x8F93;&#x51FA;&#x4E00;&#x884C;&#xFF0C;&#x8868;&#x793A;&#x7B54;&#x6848;&#x3002;</p>
<p>&#x6837;&#x4F8B;&#x8F93;&#x5165;<br>9<br>A 1<br>A 2<br>A 3<br>Q 3<br>U 1<br>A 4<br>Q 3<br>U 2<br>Q 3<br>&#x6837;&#x4F8B;&#x8F93;&#x51FA;<br>3<br>4<br>3</p>
<p>&#x63D0;&#x793A; 1&lt;=M&lt;=10^5&#xFF0C;&#x8F93;&#x5165;&#x4FDD;&#x8BC1;&#x5408;&#x6CD5;&#xFF0C;&#x4E14;&#x6240;&#x6709;&#x6574;&#x6570;&#x53EF;&#x7528;&#x5E26;&#x7B26;&#x53F7;32&#x4F4D;&#x6574;&#x578B;&#x5B58;&#x50A8;&#x3002;</p>
</blockquote>
<p>&#x8BFB;&#x8005;&#x8BF7;&#x5148;&#x81EA;&#x5DF1;&#x60F3;&#x60F3;&#xFF0C;&#x518D;&#x7EE7;&#x7EED;&#x770B;&#x3002;<br>&#x56E0;&#x4E3A;&#x672C;&#x9898;&#x548C;&#x4E0A;&#x9898;&#x5DEE;&#x4E0D;&#x591A;&#xFF0C;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x518D;&#x8D58;&#x8FF0;&#xFF0C;&#x5404;&#x4F4D;&#x8BFB;&#x8005;&#x53EF;&#x76F4;&#x63A5;&#x770B;&#x4EE3;&#x7801;</p>
<p>&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 100000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> {</span><span class="keyword">int</span> ls, rs, val;} tr[<span class="number">2000000</span>+<span class="number">5</span>];</div><div class="line"><span class="keyword">int</span> n, cnt, now;</div><div class="line"><span class="keyword">int</span> num[MAX_N+<span class="number">5</span>], root[MAX_N+<span class="number">5</span>];	<span class="comment">//num&#x6570;&#x7EC4;&#x7528;&#x4E8E;&#x5B58;&#x50A8;&#x6BCF;&#x4E2A;&#x65F6;&#x523B;&#x6570;&#x5217;&#x7684;&#x957F;&#x5EA6;&#xFF0C;&#x4EE5;&#x4FBF;&#x77E5;&#x9053;&#x8BE5;&#x4ECE;&#x54EA;&#x91CC;&#x4FEE;&#x6539;</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (l == r)	<span class="keyword">return</span>;</div><div class="line">	<span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</div><div class="line">	tr[v].ls = ++cnt;</div><div class="line">	tr[v].rs = ++cnt;</div><div class="line">	build(tr[v].ls, l, mid);</div><div class="line">	build(tr[v].rs, mid+<span class="number">1</span>, r);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ori, <span class="keyword">int</span> pos, <span class="keyword">int</span> x)</span> </span>{</div><div class="line">	tr[v] = tr[ori];</div><div class="line">	<span class="keyword">if</span> (l == r) {</div><div class="line">		tr[v].val = x;</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	}</div><div class="line">	<span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span> (pos &lt;= mid) {</div><div class="line">		tr[v].ls = ++cnt;</div><div class="line">		modify(tr[v].ls, l, mid, tr[ori].ls, pos, x);</div><div class="line">	} <span class="keyword">else</span> {</div><div class="line">		tr[v].rs = ++cnt;</div><div class="line">		modify(tr[v].rs, mid+<span class="number">1</span>, r, tr[ori].rs, pos, x);</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> pos)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (l == r)	<span class="keyword">return</span> tr[v].val;</div><div class="line">	<span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span> (pos &lt;= mid)	<span class="keyword">return</span> query(tr[v].ls, l, mid, pos);</div><div class="line">	<span class="keyword">else</span>	<span class="keyword">return</span> query(tr[v].rs, mid+<span class="number">1</span>, r, pos);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</div><div class="line">	now = <span class="number">0</span>;</div><div class="line">	num[now] = <span class="number">0</span>;</div><div class="line">	root[now] = ++cnt;</div><div class="line">	build(root[now], <span class="number">1</span>, n);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) {</div><div class="line">		<span class="keyword">char</span> ch;	<span class="keyword">int</span> x;</div><div class="line">		<span class="built_in">cin</span> &gt;&gt; ch &gt;&gt; x;</div><div class="line">		<span class="keyword">if</span> (ch == <span class="string">&apos;A&apos;</span>) {</div><div class="line">			now++;</div><div class="line">			num[now] = num[now<span class="number">-1</span>]+<span class="number">1</span>;</div><div class="line">			root[now] = ++cnt;</div><div class="line">			modify(root[now], <span class="number">1</span>, n, root[now<span class="number">-1</span>], num[now], x);</div><div class="line">		}</div><div class="line">		<span class="keyword">if</span> (ch == <span class="string">&apos;Q&apos;</span>) {</div><div class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, query(root[now], <span class="number">1</span>, n, x));</div><div class="line">		}</div><div class="line">		<span class="keyword">if</span> (ch == <span class="string">&apos;U&apos;</span>) {</div><div class="line">			now++;</div><div class="line">			num[now] = num[now<span class="number">-1</span>-x];</div><div class="line">			root[now] = root[now<span class="number">-1</span>-x];</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>&#x4E0A;&#x9762;&#x662F;&#x6700;&#x6700;&#x57FA;&#x7840;&#x7684;&#x53EF;&#x6301;&#x4E45;&#x5316;&#x7EBF;&#x6BB5;&#x6811;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x4E00;&#x4E2A;&#x57FA;&#x7840;&#x7684;&#x5E94;&#x7528;&#xFF1A;&#x533A;&#x95F4;&#x7B2C;k&#x5C0F;</p>
<blockquote>
<p>&#x3010;POJ2104&#x3011;K-th Number Time Limit: 20000MS        Memory Limit: 65536K</p>
<p>Description You are working for Macrohard company in data structures<br>department. After failing your previous task about key insertion you<br>were asked to write a new data structure that would be able to return<br>quickly k-th order statistics in the array segment.  That is, given an<br>array a[1&#x2026;n] of different integer numbers, your program must answer<br>a series of questions Q(i, j, k) in the form: &#x201C;What would be the k-th<br>number in a[i&#x2026;j] segment, if this segment was sorted?&#x201D;  For example,<br>consider the array a = (1, 5, 2, 6, 3, 7, 4). Let the question be Q(2,<br>5, 3). The segment a[2&#x2026;5] is (5, 2, 6, 3). If we sort this segment,<br>we get (2, 3, 5, 6), the third number is 5, and therefore the answer<br>to the question is 5.</p>
<p>Input The first line of the input file contains n &#x2014; the size of the<br>array, and m &#x2014; the number of questions to answer (1 &lt;= n &lt;= 100 000,<br>1 &lt;= m &lt;= 5 000).  The second line contains n different integer<br>numbers not exceeding 109 by their absolute values &#x2014; the array for<br>which the answers should be given.  The following m lines contain<br>question descriptions, each description consists of three numbers: i,<br>j, and k (1 &lt;= i &lt;= j &lt;= n, 1 &lt;= k &lt;= j - i + 1) and represents the<br>question Q(i, j, k). Output For each question output the answer to it<br>&#x2014; the k-th number in sorted a[i&#x2026;j] segment.</p>
<p>Sample Input<br>7 3<br>1 5 2 6 3 7 4<br>2 5 3<br>4 4 1<br>1 7 3<br>Sample Output<br>5<br>6<br>3</p>
</blockquote>
<p>&#x9898;&#x76EE;&#x5927;&#x610F;&#xFF1A;&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;&#x957F;&#x5EA6;&#x4E3A;n&#x7684;&#x5E8F;&#x5217;&#xFF0C;&#x9488;&#x5BF9;&#x6BCF;&#x6B21;&#x8BE2;&#x95EE;&#xFF0C;&#x8BFB;&#x5165;a&#xFF0C;b&#xFF0C;k&#xFF0C;&#x6C42;&#x7B2C;a&#x4E2A;&#x6570;&#x5230;&#x7B2C;b&#x4E2A;&#x6570;&#x4E2D;&#x7B2C;k&#x5C0F;&#x7684;&#x6570;</p>
<p>&#x540C;&#x6837;&#xFF0C;&#x8BF7;&#x5404;&#x4F4D;&#x8BFB;&#x8005;&#x5148;&#x81EA;&#x884C;&#x601D;&#x8003;&#xFF0C;&#x518D;&#x7EE7;&#x7EED;&#x9605;&#x8BFB;</p>
<p>&#x9898;&#x89E3;&#xFF1A;<br>1.&#x503C;&#x57DF;&#x7EBF;&#x6BB5;&#x6811;<br>&#x8FD9;&#x9053;&#x9898;&#x65E2;&#x7136;&#x548C;&#x7EBF;&#x6BB5;&#x6811;&#x6709;&#x5173;&#x7CFB;&#xFF0C;&#x80AF;&#x5B9A;&#x5148;&#x5F97;&#x628A;&#x8FD9;&#x4E2A;&#x6570;&#x5217;&#x5B58;&#x5230;&#x7EBF;&#x6BB5;&#x6811;&#x91CC;&#x3002;&#x4F46;&#x6211;&#x4EEC;&#x6CE8;&#x610F;&#x5230;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x6C42;&#x7684;&#x662F;&#x7B2C;k&#x5C0F;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x4E0D;&#x80FD;&#x7528;&#x666E;&#x901A;&#x7EBF;&#x6BB5;&#x6811;&#xFF0C;&#x800C;&#x5E94;&#x8BE5;&#x662F;&#x80FD;&#x4F53;&#x73B0;&#x51FA;&#x6570;&#x4E0E;&#x6570;&#x4E4B;&#x95F4;&#x5927;&#x5C0F;&#x5173;&#x7CFB;&#x7684;&#x7EBF;&#x6BB5;&#x6811;&#xFF0C;&#x4E8E;&#x662F;&#x6211;&#x4EEC;&#x4E0D;&#x96BE;&#x60F3;&#x5230;&#x503C;&#x57DF;&#x7EBF;&#x6BB5;&#x6811;&#x3002;&#x8282;&#x70B9;v&#x7684;&#x8303;&#x56F4;&#x662F;[l,r]&#xFF0C;&#x5219;&#x5B58;&#x50A8;&#x6570;&#x5217;&#x5728;[l,r]&#x8303;&#x56F4;&#x5185;&#x7684;&#x6570;&#x7684;&#x4E2A;&#x6570;&#x3002;&#x627E;&#x7B2C;k&#x5C0F;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5BF9;&#x4E8E;&#x8282;&#x70B9;v&#xFF0C;&#x5DE6;&#x53F3;&#x513F;&#x5B50;&#x8303;&#x56F4;&#x5206;&#x522B;&#x662F;[l,mid]&#x548C;[mid+1,r]&#xFF0C;&#x82E5;v.ls.size&lt;=k&#xFF0C;&#x5219;&#x7B2C;k&#x5C0F;&#x5728;[l,mid]&#x8303;&#x56F4;&#x5185;&#xFF0C;&#x6240;&#x4EE5;&#x9012;&#x5F52;&#x8BE2;&#x95EE;&#x5DE6;&#x5B50;&#x8282;&#x70B9;&#xFF0C;&#x53F3;&#x8FB9;&#x540C;&#x7406;&#xFF0C;&#x53EA;&#x662F;&#x8BE2;&#x95EE;&#x7684;&#x662F;&#x53F3;&#x5B50;&#x8282;&#x70B9;&#x4E2D;&#x7684;&#x7B2C;k-v.ls.size&#x5C0F;&#xFF0C;&#x6CE8;&#x610F;&#x4E0D;&#x518D;&#x662F;&#x7B2C;k&#x5C0F;&#x3002;</p>
<p>2.&#x79BB;&#x6563;&#x5316;<br>&#x60F3;&#x5230;&#x4E86;&#x503C;&#x57DF;&#x7EBF;&#x6BB5;&#x6811;&#xFF0C;&#x5219;&#x8981;&#x6CE8;&#x610F;&#x503C;&#x57DF;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x6211;&#x4EEC;&#x770B;&#x5230;&#x9898;&#x76EE;&#x4E2D;&#x503C;&#x57DF;&#x4E3A;int32&#xFF0C;&#x76F4;&#x63A5;&#x5B58;&#x80AF;&#x5B9A;&#x7206;&#x7A7A;&#x95F4;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x79BB;&#x6563;&#x5316;&#xFF0C;&#x5373;&#x7ED9;&#x6BCF;&#x4E2A;&#x6570;&#x6392;&#x5E8F;&#x540E;&#x7528;&#x5E8F;&#x53F7;&#x4EE3;&#x66FF;&#x6BCF;&#x4E2A;&#x6570;&#x3002;&#x8FD9;&#x6837;&#x5927;&#x5C0F;&#x5173;&#x7CFB;&#x6CA1;&#x6709;&#x53D8;&#x5316;&#xFF0C;&#x800C;&#x503C;&#x57DF;&#x53D8;&#x6210;1e5&#x4E86;<br>&#x79BB;&#x6563;&#x5316;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;pre[i].val), pre[i].id = i;</div><div class="line">sort(pre+<span class="number">1</span>, pre+n+<span class="number">1</span>, cmp);</div><div class="line">tot = <span class="number">0</span>;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) {</div><div class="line">	<span class="keyword">if</span> (pre[i].val != pre[i<span class="number">-1</span>].val) {</div><div class="line">		hash[++tot] = pre[i].val;	<span class="comment">//hash[p]&#x5B58;&#x50A8;&#x5E8F;&#x53F7;p&#x4EE3;&#x66FF;&#x7684;&#x662F;&#x54EA;&#x4E2A;&#x6570;</span></div><div class="line">	}</div><div class="line">	num[pre[i].id] = tot;	<span class="comment">//num[p]&#x5B58;&#x50A8;&#x539F;&#x6765;&#x7684;&#x7B2C;p&#x4E2A;&#x6570;&#x88AB;&#x4EE3;&#x66FF;&#x4E3A;&#x4EC0;&#x4E48;&#x6570;</span></div><div class="line">}</div></pre></td></tr></table></figure>
<p>3.&#x524D;&#x7F00;&#x548C;&#x601D;&#x60F3;</p>
<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x7684;&#x96BE;&#x9898;&#x662F;&#xFF1A;&#x5982;&#x4F55;&#x628A;&#x5168;&#x5C40;&#x7B2C;k&#x5C0F;&#x53D8;&#x4E3A;&#x533A;&#x95F4;&#x7B2C;k&#x5C0F;&#x3002;<br>&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x7528;&#x5230;&#x524D;&#x7F00;&#x548C;&#x7684;&#x601D;&#x60F3;&#x3002;&#x6211;&#x4EEC;&#x5206;&#x522B;&#x5B58;&#x50A8;&#x7B2C;1-i&#x4E2A;&#x6570;&#x4E2D;&#x8303;&#x56F4;&#x5728;[l,r]&#x7684;&#x6570;&#x7684;&#x4E2A;&#x6570;&#x548C;&#x7B2C;1-j&#x4E2A;&#x6570;&#x4E2D;&#x8303;&#x56F4;&#x5728;[l,r]&#x7684;&#x6570;&#x7684;&#x4E2A;&#x6570;&#xFF0C;&#x8FD9;&#x6837;&#x6211;&#x4EEC;&#x82E5;&#x9700;&#x8981;&#x7B2C;i+1&#x5230;&#x7B2C;j&#x4E2A;&#x6570;&#x4E2D;[l,r]&#x7684;&#x4E2A;&#x6570;&#xFF0C;&#x5C31;&#x53EA;&#x7528;sum[j][l,r]-sum[i][l,r]&#x5373;&#x53EF;&#x3002;&#x6240;&#x4EE5;&#xFF0C;&#x6211;&#x4EEC;&#x5B58;n&#x9897;&#x7EBF;&#x6BB5;&#x6811;&#xFF0C;&#x7B2C;p&#x9897;&#x5B58;&#x50A8;&#x7B2C;1-p&#x4E2A;&#x6570;&#x4E2D;&#x7684;&#x503C;&#x57DF;&#x60C5;&#x51B5;&#x3002;<br>&#x4F8B;&#x5982;&#xFF1A;&#x5BF9;&#x4E8E;&#x5E8F;&#x5217;7&#xFF0C;2&#xFF0C;3&#xFF0C;5&#xFF0C;1&#xFF0C;4&#xFF0C;3&#xFF0C;&#x7B2C;4&#x9897;&#x6811;&#x7684;[2,4]&#x8282;&#x70B9;&#x5B58;&#x50A8;&#x90FD;&#x662F;&#x4ECE;&#x7B2C;&#x4E00;&#x4E2A;&#x6570;&#x5230;&#x7B2C;&#x56DB;&#x4E2A;&#x6570;&#x4E2D;&#x503C;&#x5728;[2,4]&#x4E2D;&#x7684;&#x6570;&#x7684;&#x4E2A;&#x6570;&#x3002;7&#xFF0C;2&#xFF0C;3&#xFF0C;5&#x4E2D;&#x5728;[2,4]&#x7684;&#x6570;&#x4E3A;2&#x548C;3&#xFF0C;&#x6545;&#x6B64;&#x8282;&#x70B9;&#x7684;&#x503C;&#x4E3A;2&#x3002;</p>
<p>4.&#x53EF;&#x6301;&#x4E45;&#x5316;&#x7EBF;&#x6BB5;&#x6811;<br>&#x6709;&#x4E86;&#x4EE5;&#x4E0A;&#x601D;&#x8DEF;&#xFF0C;&#x5269;&#x4E0B;&#x7684;&#x95EE;&#x9898;&#x5C31;&#x662F;&#x5982;&#x4F55;&#x628A;&#x8FD9;n&#x9897;&#x7EBF;&#x6BB5;&#x6811;&#x5B58;&#x8FDB;&#x53BB;&#x3002;&#x76F4;&#x63A5;&#x5B58;&#x4E00;&#x5B9A;&#x4F1A;&#x7206;&#x7A7A;&#x95F4;&#xFF0C;&#x800C;&#x6CE8;&#x610F;&#x5230;&#x6BCF;&#x6B21;&#x52A0;&#x4E00;&#x4E2A;&#x6570;&#x540E;&#xFF0C;&#x4E0D;&#x662F;&#x6240;&#x6709;&#x8282;&#x70B9;&#x90FD;&#x53D1;&#x751F;&#x4E86;&#x6539;&#x53D8;&#xFF0C;&#x56E0;&#x800C;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x5B58;&#x50A8;&#x6709;&#x6539;&#x52A8;&#x7684;&#x8282;&#x70B9;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x53EF;&#x6301;&#x4E45;&#x5316;&#x7EBF;&#x6BB5;&#x6811;&#x3002;&#x548C;&#x4E0A;&#x9762;&#x7684;&#x9898;&#x4E00;&#x6837;&#xFF0C;&#x6211;&#x4EEC;&#x628A;&#x65B0;&#x5EFA;&#x7684;&#x8282;&#x70B9;&#x6307;&#x56DE;&#x539F;&#x6765;&#x7684;&#x5B50;&#x8282;&#x70B9;&#xFF0C;&#x53EF;&#x4EE5;&#x53C2;&#x7167;&#x524D;&#x9762;&#x7684;&#x8BF4;&#x660E;&#x3002;</p>
<p>AC&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 100000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> {</span><span class="keyword">int</span> ls, rs, val;} tr[MAX_N*<span class="number">20</span>+<span class="number">5</span>];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">p</span> {</span><span class="keyword">int</span> val, id;} pre[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">const</span> p &amp;a, <span class="keyword">const</span> p &amp;b)</span> </span>{<span class="keyword">return</span> a.val &lt; b.val;}</div><div class="line"><span class="keyword">int</span> n, m;</div><div class="line"><span class="keyword">int</span> num[MAX_N+<span class="number">5</span>], hash[MAX_N+<span class="number">5</span>], tot;</div><div class="line"><span class="keyword">int</span> cnt, root[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">updata</span><span class="params">(<span class="keyword">int</span> v)</span> </span>{tr[v].val = tr[tr[v].ls].val+tr[tr[v].rs].val;}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (s == t)	<span class="keyword">return</span>;</div><div class="line">	tr[v].ls = ++cnt;</div><div class="line">	tr[v].rs = ++cnt;</div><div class="line">	<span class="keyword">int</span> mid = s+t&gt;&gt;<span class="number">1</span>;</div><div class="line">	build(tr[v].ls, s, mid);</div><div class="line">	build(tr[v].rs, mid+<span class="number">1</span>, t);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> ori, <span class="keyword">int</span> pos, <span class="keyword">int</span> x)</span> </span>{</div><div class="line">	tr[v] = tr[ori];</div><div class="line">	<span class="keyword">if</span> (s == t) {</div><div class="line">		tr[v].val += x;</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	}</div><div class="line">	<span class="keyword">int</span> mid = s+t&gt;&gt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span> (pos &lt;= mid) {</div><div class="line">		tr[v].ls = ++cnt;</div><div class="line">		modify(tr[v].ls, s, mid, tr[ori].ls, pos, x);</div><div class="line">	} <span class="keyword">else</span>{</div><div class="line">		tr[v].rs = ++cnt;</div><div class="line">		modify(tr[v].rs, mid+<span class="number">1</span>, t, tr[ori].rs, pos, x);</div><div class="line">	}</div><div class="line">	updata(v);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> v1, <span class="keyword">int</span> v2, <span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> k)</span> </span>{</div><div class="line">	<span class="keyword">if</span> (s == t)	<span class="keyword">return</span> s;</div><div class="line">	<span class="keyword">int</span> mid = s+t&gt;&gt;<span class="number">1</span>, tmp = tr[tr[v2].ls].val-tr[tr[v1].ls].val;</div><div class="line">	<span class="keyword">if</span> (tmp &gt;= k)	<span class="keyword">return</span> query(tr[v1].ls, tr[v2].ls, s, mid, k);</div><div class="line">	<span class="keyword">else</span>	<span class="keyword">return</span> query(tr[v1].rs, tr[v2].rs, mid+<span class="number">1</span>, t, k-tmp);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;pre[i].val), pre[i].id = i;</div><div class="line">	sort(pre+<span class="number">1</span>, pre+n+<span class="number">1</span>, cmp);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) {</div><div class="line">		<span class="keyword">if</span> (pre[i].val != pre[i<span class="number">-1</span>].val) {</div><div class="line">			hash[++tot] = pre[i].val;</div><div class="line">		}</div><div class="line">		num[pre[i].id] = tot;</div><div class="line">	}</div><div class="line">	root[<span class="number">0</span>] = ++cnt;</div><div class="line">	build(root[<span class="number">0</span>], <span class="number">1</span>, n);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) {</div><div class="line">		root[i] = ++cnt;</div><div class="line">		modify(root[i], <span class="number">1</span>, n, root[i<span class="number">-1</span>], num[i], <span class="number">1</span>);</div><div class="line">	}</div><div class="line">	<span class="keyword">while</span> (m--) {</div><div class="line">		<span class="keyword">int</span> l, r, k;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;l, &amp;r, &amp;k);</div><div class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, hash[query(root[l<span class="number">-1</span>], root[r], <span class="number">1</span>, n, k)]);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
<p>&#x6CE8;&#xFF1A;&#x672C;&#x9898;&#x662F;&#x53EF;&#x6301;&#x4E45;&#x5316;&#x7EBF;&#x6BB5;&#x6811;&#x7684;&#x5FC5;&#x5199;&#x9898;&#xFF0C;&#x60F3;&#x5B66;&#x53EF;&#x6301;&#x4E45;&#x5316;&#x7EBF;&#x6BB5;&#x6811;&#x7684;&#x8BFB;&#x8005;&#x4E00;&#x5B9A;&#x8981;&#x5199;&#x8FD9;&#x9053;&#x9898;&#xFF0C;&#x4E00;&#x5B9A;&#xFF01;&#xFF01;&#xFF01;</p>
<p>&#x4E0A;&#x9762;&#x7684;&#x4E09;&#x9053;&#x9898;&#x90FD;&#x662F;&#x6700;&#x4E3A;&#x7B80;&#x5355;&#x57FA;&#x7840;&#x7684;&#x53EF;&#x6301;&#x4E45;&#x5316;</p>
<p>&#x7EBF;&#x6BB5;&#x6811;&#x9898;&#x76EE;&#xFF0C;&#x53EF;&#x6301;&#x4E45;&#x5316;&#x7EBF;&#x6BB5;&#x6811;&#x662F;&#x53EF;&#x4EE5;&#x533A;&#x95F4;&#x4FEE;&#x6539;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x4E3A;&#x907F;&#x514D;&#x65B0;&#x5EFA;&#x8FC7;&#x591A;&#x8282;&#x70B9;&#xFF0C;&#x4E0D;&#x80FD;downtag&#xFF0C;&#x9700;&#x8981;&#x6807;&#x8BB0;&#x6C38;&#x4E45;&#x5316;&#xFF0C;&#x8BE2;&#x95EE;&#x7684;&#x65F6;&#x5019;&#x4E00;&#x8DEF;&#x7D2F;&#x52A0;&#x4E0B;&#x53BB;&#x5C31;&#x884C;&#x4E86;&#xFF0C;&#x60C5;&#x51B5;&#x53EF;&#x80FD;&#x7A0D;&#x5FAE;&#x591A;&#x4E00;&#x4E9B;&#xFF0C;&#x6709;&#x610F;&#x7684;&#x8BFB;&#x8005;&#x8BF7;&#x53BB;&#x505A;&#x4E00;&#x9053;&#x53EB;To The Moon&#x7684;&#x9898;&#x3002;</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/主席树/">主席树</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据结构/">数据结构</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-AC自动机基础例题" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/AC自动机基础例题/" class="article-date">
  	<time datetime="2017-07-13T16:00:00.000Z" itemprop="datePublished">2017-07-14</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/AC自动机基础例题/">
        AC自动机基础例题
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>AC&#x81EA;&#x52A8;&#x673A;(Aho-Corasick Automation)&#x7528;&#x4E8E;&#x89E3;&#x51B3;&#x591A;&#x6A21;&#x5F0F;&#x4E32;&#x5339;&#x914D;&#x4E3B;&#x4E32;&#x7684;&#x95EE;&#x9898;<br>&#x7ED9;&#x6240;&#x6709;&#x6A21;&#x5F0F;&#x4E32;&#x5199;&#x4E00;&#x4E2A;Trie&#xFF0C;&#x5728;Trie&#x4E0A;&#x8DD1;KMP&#xFF0C;&#x5176;&#x4E2D;KMP&#x7684;next&#x6570;&#x7EC4;&#x53D8;&#x6210;&#x4E86;AC&#x81EA;&#x52A8;&#x673A;&#x7684;Fail&#x6307;&#x9488;<br>&#x8BA1;&#x7B97;fail&#x548C;&#x8BA1;&#x7B97;next&#x4E00;&#x6837;&#xFF0C;&#x7528;dp&#xFF0C;&#x53EA;&#x4E0D;&#x8FC7;&#x8FD9;&#x91CC;&#x662F;&#x6811;&#x4E0A;dp<br>&#x539F;&#x7406;&#x4E0D;&#x518D;&#x8D58;&#x8FF0;&#xFF0C;&#x4E0A;&#x6A21;&#x677F;</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ACautomation</span> {</span></div><div class="line"><span class="keyword">private</span>:</div><div class="line">	<span class="keyword">int</span> cnt, root;</div><div class="line">	<span class="keyword">int</span> **child, *sta, *fail;</div><div class="line">	<span class="keyword">bool</span> *flag;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">	ACautomation(<span class="keyword">int</span> tot) {</div><div class="line">		cnt = root = <span class="number">1</span>;</div><div class="line">		sta = <span class="keyword">new</span> <span class="keyword">int</span>[tot+<span class="number">1</span>];</div><div class="line">		<span class="built_in">memset</span>(sta, <span class="number">0</span>, <span class="keyword">sizeof</span>(<span class="keyword">int</span>)*(tot+<span class="number">1</span>));</div><div class="line">		fail = <span class="keyword">new</span> <span class="keyword">int</span>[tot+<span class="number">1</span>];</div><div class="line">		<span class="built_in">memset</span>(fail, <span class="number">0</span>, <span class="keyword">sizeof</span>(<span class="keyword">int</span>)*(tot+<span class="number">1</span>));</div><div class="line">		flag = <span class="keyword">new</span> <span class="keyword">bool</span>[tot+<span class="number">1</span>];</div><div class="line">		<span class="built_in">memset</span>(flag, <span class="number">0</span>, <span class="keyword">sizeof</span>(<span class="keyword">bool</span>)*(tot+<span class="number">1</span>));</div><div class="line">		child = <span class="keyword">new</span> <span class="keyword">int</span>*[tot+<span class="number">1</span>];</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= tot; i++) {</div><div class="line">			child[i] = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">26</span>];</div><div class="line">			<span class="built_in">memset</span>(child[i], <span class="number">0</span>, <span class="keyword">sizeof</span>(<span class="keyword">int</span>)*<span class="number">26</span>);</div><div class="line">		}</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++)	child[<span class="number">0</span>][i] = <span class="number">1</span>;</div><div class="line">	}</div><div class="line">	~ACautomation() {</div><div class="line">		<span class="keyword">delete</span>[] sta;</div><div class="line">		<span class="keyword">delete</span>[] fail;</div><div class="line">		<span class="keyword">delete</span>[] flag;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= cnt; i++)</div><div class="line">			<span class="keyword">delete</span>[] child[i];</div><div class="line">		<span class="keyword">delete</span>[] child;</div><div class="line">	}</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="built_in">string</span>&amp; s)</span> </span>{</div><div class="line">		<span class="keyword">int</span> cur = <span class="number">1</span>, i;</div><div class="line">		<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; s.length(); cur = child[cur][s[i++]-<span class="string">&apos;a&apos;</span>])</div><div class="line">			<span class="keyword">if</span> (!child[cur][s[i]-<span class="string">&apos;a&apos;</span>])	child[cur][s[i]-<span class="string">&apos;a&apos;</span>] = ++cnt;</div><div class="line">		sta[cur]++;</div><div class="line">	}</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">setFail</span><span class="params">()</span> </span>{</div><div class="line">		<span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; que;</div><div class="line">		que.push(<span class="number">1</span>);</div><div class="line">		<span class="keyword">while</span> (!que.empty()) {</div><div class="line">			<span class="keyword">int</span> u = que.front();</div><div class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) {</div><div class="line">				<span class="keyword">if</span> (child[u][i]) {</div><div class="line">					fail[child[u][i]] = child[fail[u]][i];</div><div class="line">					que.push(child[u][i]);</div><div class="line">				} <span class="keyword">else</span> {</div><div class="line">					child[u][i] = child[fail[u]][i];</div><div class="line">				}</div><div class="line">			}</div><div class="line">			que.pop();</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="built_in">string</span>&amp; s)</span> </span>{</div><div class="line">		<span class="keyword">int</span> ret = <span class="number">0</span>, cur = <span class="number">1</span>, index;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.length(); i++) {</div><div class="line">			flag[cur] = <span class="literal">true</span>;</div><div class="line">			index = s[i]-<span class="string">&apos;a&apos;</span>;</div><div class="line">			<span class="keyword">while</span> (!child[cur][index])	cur = fail[cur];</div><div class="line">			cur = child[cur][index];</div><div class="line">			<span class="keyword">if</span> (flag[cur])	<span class="keyword">continue</span>;</div><div class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = cur; j; j = fail[j]) {</div><div class="line">				ret += sta[j];</div><div class="line">				sta[j] = <span class="number">0</span>;</div><div class="line">			}</div><div class="line">		}</div><div class="line">		<span class="keyword">return</span> ret;</div><div class="line">	}</div><div class="line">};</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">int</span> n;</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; n;</div><div class="line">	<span class="function">ACautomation <span class="title">T</span><span class="params">(n*<span class="number">50</span>)</span></span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) {</div><div class="line">		<span class="built_in">string</span> s;</div><div class="line">		<span class="built_in">cin</span> &gt;&gt; s;</div><div class="line">		T.insert(s);</div><div class="line">	}</div><div class="line">	T.setFail();</div><div class="line">	<span class="built_in">string</span> str;</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; str;</div><div class="line">	<span class="built_in">cout</span> &lt;&lt; T.query(str);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
<p>&#x8FD9;&#x662F;&#x672C;&#x4EBA;&#x7B2C;&#x4E00;&#x6B21;&#x5199;AC&#x81EA;&#x52A8;&#x673A;&#x5C01;&#x88C5;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x5F88;&#x62D9;&#x52A3;&#x3002;&#x7531;&#x4E8E;&#x6211;&#x5199;Trie&#x6811;&#x4E00;&#x76F4;&#x628A;&#x6839;&#x8282;&#x70B9;&#x8BBE;&#x4E3A;1&#x53F7;&#xFF0C;&#x6240;&#x4EE5;&#x60F3;&#x51FA;&#x628A;0&#x53F7;&#x8282;&#x70B9;&#x6240;&#x6709;&#x513F;&#x5B50;&#x90FD;&#x6307;&#x5411;1&#xFF0C;&#x8FD9;&#x6837;&#x5982;&#x679C;fail&#x6307;&#x56DE;&#x5230;0&#x7684;&#x65F6;&#x5019;&#xFF0C;child[u][i]&#x90FD;&#x4F1A;&#x5C06;&#x5176;&#x91CD;&#x65B0;&#x6307;&#x5411;&#x6839;&#x8282;&#x70B9;1&#xFF0C;&#x8FD9;&#x6837;&#x601D;&#x8003;&#x4F1A;&#x7B80;&#x5355;&#x4E00;&#x4E9B;&#x3002;&#x4F46;&#x662F;&#x6709;&#x65F6;&#x5019;&#x8981;TLE</p>
<p>&#x6211;&#x505A;&#x7684;&#x7B2C;&#x4E00;&#x9053;AC&#x81EA;&#x52A8;&#x673A;&#x9898;&#x76EE;&#x662F;HDU2222&#xFF0C;&#x8FD9;&#x662F;&#x88F8;&#x7684;&#x6A21;&#x677F;&#xFF0C;&#x6570;&#x636E;&#x4E5F;&#x5F88;&#x6C34;</p>
<blockquote>
<p>&#x3010;HDU2222&#x3011; Keywords Search<br>Time Limit: 2000/1000 MS (Java/Others)<br>Memory Limit: 131072/131072 K (Java/Others)</p>
<p>Problem Description<br>In the modern time, Search engine came into the life of everybody like Google, Baidu, etc.<br>Wiskey also wants to bring this feature to his image retrieval system.<br>Every image have a long description, when users type some keywords to find the image, the system will match the keywords with description of image and show the image which the most keywords be matched.<br>To simplify the problem, giving you a description of image, and some keywords, you should tell me how many keywords will be match.</p>
<p>Input<br>First line will contain one integer means how many cases will follow by.<br>Each case will contain two integers N means the number of keywords and N keywords follow. (N &lt;= 10000)<br>Each keyword will only contains characters &#x2018;a&#x2019;-&#x2018;z&#x2019;, and the length will be not longer than 50.<br>The last line is the description, and the length will be not longer than 1000000.<br>Output<br>Print how many keywords are contained in the description.</p>
<p>Sample Input<br>1<br>5<br>she<br>he<br>say<br>shr<br>her<br>yasherhs<br>Sample Output<br>3</p>
</blockquote>
<p>AC&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_LETTER 500000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> trie[MAX_LETTER+<span class="number">5</span>][<span class="number">26</span>], tag[MAX_LETTER+<span class="number">5</span>], cnt;</div><div class="line"><span class="keyword">int</span> fail[MAX_LETTER+<span class="number">5</span>], flag[MAX_LETTER+<span class="number">5</span>], que[MAX_LETTER+<span class="number">5</span>];</div><div class="line"><span class="keyword">char</span> s[<span class="number">55</span>], str[<span class="number">1000005</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">()</span> </span>{</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s);</div><div class="line">	<span class="keyword">int</span> cur, i, l = <span class="built_in">strlen</span>(s);</div><div class="line">	<span class="keyword">for</span> (cur = <span class="number">1</span>, i = <span class="number">0</span>; i &lt; l; cur = trie[cur][s[i++]-<span class="string">&apos;a&apos;</span>])</div><div class="line">		<span class="keyword">if</span> (!trie[cur][s[i]-<span class="string">&apos;a&apos;</span>])	trie[cur][s[i]-<span class="string">&apos;a&apos;</span>] = ++cnt;</div><div class="line">	tag[cur]++;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">BFS</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">int</span> head = <span class="number">0</span>, tail = <span class="number">1</span>;</div><div class="line">	que[head] = <span class="number">1</span>;</div><div class="line">	<span class="keyword">while</span> (head &lt; tail) {</div><div class="line">		<span class="keyword">int</span> u = que[head++];</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) {</div><div class="line">			<span class="keyword">if</span> (trie[u][i]) {</div><div class="line">				que[tail++] = trie[u][i];</div><div class="line">				fail[trie[u][i]] = trie[fail[u]][i];</div><div class="line">			} <span class="keyword">else</span> {</div><div class="line">				trie[u][i] = trie[fail[u]][i];</div><div class="line">			}</div><div class="line">		}</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">query</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">int</span> ret = <span class="number">0</span>, cur = <span class="number">1</span>, index;</div><div class="line">	<span class="keyword">int</span> len = <span class="built_in">strlen</span>(str);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) {</div><div class="line">		flag[cur] = <span class="number">1</span>;</div><div class="line">		index = str[i]-<span class="string">&apos;a&apos;</span>;</div><div class="line">		<span class="keyword">while</span> (!trie[cur][index])	cur = fail[cur];</div><div class="line">		cur = trie[cur][index];</div><div class="line">		<span class="keyword">if</span> (flag[cur])	<span class="keyword">continue</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = cur; j; j = fail[j]) {</div><div class="line">			ret += tag[j];</div><div class="line">			tag[j] = <span class="number">0</span>;</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ret);</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">int</span> T, n;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++)	trie[<span class="number">0</span>][i] = <span class="number">1</span>;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</div><div class="line">	<span class="keyword">while</span> (T--) {</div><div class="line">		cnt = <span class="number">1</span>;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)	insert();</div><div class="line">		BFS();</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, str);</div><div class="line">		query();</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= cnt; i++) {</div><div class="line">			tag[i] = fail[i] = flag[i] = <span class="number">0</span>;</div><div class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">26</span>; j++)</div><div class="line">				trie[i][j] = <span class="number">0</span>;</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
<p>HDU3065&#x548C;&#x8FD9;&#x9053;&#x9898;&#x5F88;&#x50CF;&#xFF0C;&#x4E5F;&#x662F;&#x51E0;&#x4E4E;&#x88F8;&#x7684;&#x6A21;&#x677F;<br>&gt;<br>&#x3010;HDU3065&#x3011;&#x75C5;&#x6BD2;&#x4FB5;&#x88AD;&#x6301;&#x7EED;&#x4E2D;<br>Time Limit: 2000/1000 MS (Java/Others)<br>Memory Limit: 32768/32768 K (Java/Others)<br>&gt;<br>Problem Description<br>&#x5C0F;t&#x975E;&#x5E38;&#x611F;&#x8C22;&#x5927;&#x5BB6;&#x5E2E;&#x5FD9;&#x89E3;&#x51B3;&#x4E86;&#x4ED6;&#x7684;&#x4E0A;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x3002;&#x7136;&#x800C;&#x75C5;&#x6BD2;&#x4FB5;&#x88AD;&#x6301;&#x7EED;&#x4E2D;&#x3002;&#x5728;&#x5C0F;t&#x7684;&#x4E0D;&#x61C8;&#x52AA;&#x529B;&#x4E0B;&#xFF0C;&#x4ED6;&#x53D1;&#x73B0;&#x4E86;&#x7F51;&#x8DEF;&#x4E2D;&#x7684;&#x201C;&#x4E07;&#x6076;&#x4E4B;&#x6E90;&#x201D;&#x3002;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x5E9E;&#x5927;&#x7684;&#x75C5;&#x6BD2;&#x7F51;&#x7AD9;&#xFF0C;&#x4ED6;&#x6709;&#x7740;&#x597D;&#x591A;&#x597D;&#x591A;&#x7684;&#x75C5;&#x6BD2;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x4E2A;&#x7F51;&#x7AD9;&#x5305;&#x542B;&#x7684;&#x75C5;&#x6BD2;&#x5F88;&#x5947;&#x602A;&#xFF0C;&#x8FD9;&#x4E9B;&#x75C5;&#x6BD2;&#x7684;&#x7279;&#x5F81;&#x7801;&#x5F88;&#x77ED;&#xFF0C;&#x800C;&#x4E14;&#x53EA;&#x5305;&#x542B;&#x201C;&#x82F1;&#x6587;&#x5927;&#x5199;&#x5B57;&#x7B26;&#x201D;&#x3002;&#x5F53;&#x7136;&#x5C0F;t&#x597D;&#x60F3;&#x597D;&#x60F3;&#x4E3A;&#x6C11;&#x9664;&#x5BB3;&#xFF0C;&#x4F46;&#x662F;&#x5C0F;t&#x4ECE;&#x6765;&#x4E0D;&#x6253;&#x6CA1;&#x6709;&#x51C6;&#x5907;&#x7684;&#x6218;&#x4E89;&#x3002;&#x77E5;&#x5DF1;&#x77E5;&#x5F7C;&#xFF0C;&#x767E;&#x6218;&#x4E0D;&#x6B86;&#xFF0C;&#x5C0F;t&#x9996;&#x5148;&#x8981;&#x505A;&#x7684;&#x662F;&#x77E5;&#x9053;&#x8FD9;&#x4E2A;&#x75C5;&#x6BD2;&#x7F51;&#x7AD9;&#x7279;&#x5F81;&#xFF1A;&#x5305;&#x542B;&#x591A;&#x5C11;&#x4E0D;&#x540C;&#x7684;&#x75C5;&#x6BD2;&#xFF0C;&#x6BCF;&#x79CD;&#x75C5;&#x6BD2;&#x51FA;&#x73B0;&#x4E86;&#x591A;&#x5C11;&#x6B21;&#x3002;&#x5927;&#x5BB6;&#x80FD;&#x518D;&#x5E2E;&#x5E2E;&#x4ED6;&#x5417;&#xFF1F;<br>&gt;<br>Input<br>&#x7B2C;&#x4E00;&#x884C;&#xFF0C;&#x4E00;&#x4E2A;&#x6574;&#x6570;N&#xFF08;1&lt;=N&lt;=1000&#xFF09;&#xFF0C;&#x8868;&#x793A;&#x75C5;&#x6BD2;&#x7279;&#x5F81;&#x7801;&#x7684;&#x4E2A;&#x6570;&#x3002;<br>&#x63A5;&#x4E0B;&#x6765;N&#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x75C5;&#x6BD2;&#x7279;&#x5F81;&#x7801;&#xFF0C;&#x7279;&#x5F81;&#x7801;&#x5B57;&#x7B26;&#x4E32;&#x957F;&#x5EA6;&#x5728;1&#x2014;50&#x4E4B;&#x95F4;&#xFF0C;&#x5E76;&#x4E14;&#x53EA;&#x5305;&#x542B;&#x201C;&#x82F1;&#x6587;&#x5927;&#x5199;&#x5B57;&#x7B26;&#x201D;&#x3002;&#x4EFB;&#x610F;&#x4E24;&#x4E2A;&#x75C5;&#x6BD2;&#x7279;&#x5F81;&#x7801;&#xFF0C;&#x4E0D;&#x4F1A;&#x5B8C;&#x5168;&#x76F8;&#x540C;&#x3002;<br>&#x5728;&#x8FD9;&#x4E4B;&#x540E;&#x4E00;&#x884C;&#xFF0C;&#x8868;&#x793A;&#x201C;&#x4E07;&#x6076;&#x4E4B;&#x6E90;&#x201D;&#x7F51;&#x7AD9;&#x6E90;&#x7801;&#xFF0C;&#x6E90;&#x7801;&#x5B57;&#x7B26;&#x4E32;&#x957F;&#x5EA6;&#x5728;2000000&#x4E4B;&#x5185;&#x3002;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x5B57;&#x7B26;&#x90FD;&#x662F;ASCII&#x7801;&#x53EF;&#x89C1;&#x5B57;&#x7B26;&#xFF08;&#x4E0D;&#x5305;&#x62EC;&#x56DE;&#x8F66;&#xFF09;&#x3002;<br>Output<br>&#x6309;&#x4EE5;&#x4E0B;&#x683C;&#x5F0F;&#x6BCF;&#x884C;&#x4E00;&#x4E2A;&#xFF0C;&#x8F93;&#x51FA;&#x6BCF;&#x4E2A;&#x75C5;&#x6BD2;&#x51FA;&#x73B0;&#x6B21;&#x6570;&#x3002;&#x672A;&#x51FA;&#x73B0;&#x7684;&#x75C5;&#x6BD2;&#x4E0D;&#x9700;&#x8981;&#x8F93;&#x51FA;&#x3002;<br>&#x75C5;&#x6BD2;&#x7279;&#x5F81;&#x7801;: &#x51FA;&#x73B0;&#x6B21;&#x6570;<br>&#x5192;&#x53F7;&#x540E;&#x6709;&#x4E00;&#x4E2A;&#x7A7A;&#x683C;&#xFF0C;&#x6309;&#x75C5;&#x6BD2;&#x7279;&#x5F81;&#x7801;&#x7684;&#x8F93;&#x5165;&#x987A;&#x5E8F;&#x8FDB;&#x884C;&#x8F93;&#x51FA;&#x3002;<br>&gt;<br>Sample Input<br>3<br>AA<br>BB<br>CC<br>ooxxCC%dAAAoen&#x2026;.END<br>Sample Output<br>AA: 2<br>CC: 1<br>&gt;<br>Hint<br>&#x9898;&#x76EE;&#x63CF;&#x8FF0;&#x4E2D;&#x6CA1;&#x6709;&#x88AB;&#x63D0;&#x53CA;&#x7684;&#x6240;&#x6709;&#x60C5;&#x51B5;&#x90FD;&#x5E94;&#x8BE5;&#x8FDB;&#x884C;&#x8003;&#x8651;&#x3002;&#x6BD4;&#x5982;&#x4E24;&#x4E2A;&#x75C5;&#x6BD2;&#x7279;&#x5F81;&#x7801;&#x53EF;&#x80FD;&#x6709;&#x76F8;&#x4E92;&#x5305;&#x542B;&#x6216;&#x8005;&#x6709;&#x91CD;&#x53E0;&#x7684;&#x7279;&#x5F81;&#x7801;&#x6BB5;&#x3002;<br>&#x8BA1;&#x6570;&#x7B56;&#x7565;&#x4E5F;&#x53EF;&#x4E00;&#x5B9A;&#x7A0B;&#x5EA6;&#x4E0A;&#x4ECE;Sample&#x4E2D;&#x63A8;&#x6D4B;&#x3002;</p>
<p>AC&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 1000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_LETTER 100000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> DICNUM 26</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, cnt;</div><div class="line"><span class="keyword">int</span> child[MAX_LETTER+<span class="number">5</span>][DICNUM], id[MAX_LETTER+<span class="number">5</span>], fail[MAX_LETTER+<span class="number">5</span>], ans[MAX_N+<span class="number">5</span>];</div><div class="line"><span class="keyword">int</span> que[MAX_LETTER+<span class="number">5</span>];</div><div class="line"><span class="keyword">char</span> s[<span class="number">2000005</span>], dic[<span class="number">1005</span>][<span class="number">55</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>{</div><div class="line">	cnt = <span class="number">1</span>;</div><div class="line">	<span class="built_in">memset</span>(child, <span class="number">0</span>, <span class="keyword">sizeof</span>(child));</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; DICNUM; i++)	child[<span class="number">0</span>][i] = <span class="number">1</span>;</div><div class="line">	<span class="built_in">memset</span>(id, <span class="number">0</span>, <span class="keyword">sizeof</span>(id));</div><div class="line">	<span class="built_in">memset</span>(fail, <span class="number">0</span>, <span class="keyword">sizeof</span>(fail));</div><div class="line">	<span class="built_in">memset</span>(ans, <span class="number">0</span>, <span class="keyword">sizeof</span>(ans));</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) {</div><div class="line">		<span class="keyword">int</span> cur = <span class="number">1</span>, l = <span class="built_in">strlen</span>(dic[j]);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; l; cur = child[cur][dic[j][i++]-<span class="string">&apos;A&apos;</span>])</div><div class="line">			<span class="keyword">if</span> (!child[cur][dic[j][i]-<span class="string">&apos;A&apos;</span>])	child[cur][dic[j][i]-<span class="string">&apos;A&apos;</span>] = ++cnt;</div><div class="line">		id[cur] = j;</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">setFail</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">int</span> head = <span class="number">0</span>, tail = <span class="number">1</span>;</div><div class="line">	que[head] = <span class="number">1</span>;</div><div class="line">	<span class="keyword">while</span> (head &lt; tail) {</div><div class="line">		<span class="keyword">int</span> u = que[head++];</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; DICNUM; i++) {</div><div class="line">			<span class="keyword">if</span> (child[u][i]) {</div><div class="line">				que[tail++] = child[u][i];</div><div class="line">				<span class="keyword">int</span> cur = fail[u];</div><div class="line">				<span class="keyword">while</span> (!child[cur][i])	cur = fail[cur];</div><div class="line">				fail[child[u][i]] = child[cur][i];</div><div class="line">			} <span class="keyword">else</span> {</div><div class="line">				child[u][i] = child[fail[u]][i];</div><div class="line">			}</div><div class="line">		}</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">query</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">int</span> cur = <span class="number">1</span>, index, l = <span class="built_in">strlen</span>(s);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; l; i++) {</div><div class="line">		index = s[i]-<span class="string">&apos;A&apos;</span>;</div><div class="line">		<span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt; <span class="number">25</span>) {</div><div class="line">			cur = <span class="number">1</span>;</div><div class="line">		} <span class="keyword">else</span> {</div><div class="line">			<span class="keyword">while</span> (!child[cur][index])	cur = fail[cur];</div><div class="line">			cur = child[cur][index];</div><div class="line">		}</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = cur; j; j = fail[j])</div><div class="line">			<span class="keyword">if</span> (id[j])</div><div class="line">				ans[id[j]]++;</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n) != EOF) {</div><div class="line">		init();</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, dic[i]);</div><div class="line">		insert();</div><div class="line">		setFail();</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s);</div><div class="line">		query();</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">			<span class="keyword">if</span> (ans[i])</div><div class="line">				<span class="built_in">printf</span>(<span class="string">&quot;%s: %d\n&quot;</span>, dic[i], ans[i]);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
<p>&#x8FD9;&#x4E24;&#x9053;&#x9898;&#x7528;&#x6211;&#x62D9;&#x52A3;&#x7684;&#x5199;&#x6CD5;&#x8FD8;&#x53EF;&#x4EE5;&#x8FC7;&#xFF0C;&#x4F46;&#x662F;HDU2896&#x5C31;&#x8FC7;&#x4E0D;&#x4E86;</p>
<blockquote>
<p>&#x3010;HDU2896&#x3011;&#x75C5;&#x6BD2;&#x4FB5;&#x88AD;<br>Time Limit: 2000/1000 MS (Java/Others)<br>Memory Limit: 32768/32768 K (Java/Others)</p>
<p>Problem Description<br>&#x5F53;&#x592A;&#x9633;&#x7684;&#x5149;&#x8F89;&#x9010;&#x6E10;&#x88AB;&#x6708;&#x4EAE;&#x906E;&#x853D;&#xFF0C;&#x4E16;&#x754C;&#x5931;&#x53BB;&#x4E86;&#x5149;&#x660E;&#xFF0C;&#x5927;&#x5730;&#x8FCE;&#x6765;&#x6700;&#x9ED1;&#x6697;&#x7684;&#x65F6;&#x523B;&#x3002;&#x3002;&#x3002;&#x3002;&#x5728;&#x8FD9;&#x6837;&#x7684;&#x65F6;&#x523B;&#xFF0C;&#x4EBA;&#x4EEC;&#x5374;&#x5F02;&#x5E38;&#x5174;&#x594B;&#x2014;&#x2014;&#x6211;&#x4EEC;&#x80FD;&#x5728;&#x6709;&#x751F;&#x4E4B;&#x5E74;&#x770B;&#x5230;500&#x5E74;&#x4E00;&#x9047;&#x7684;&#x4E16;&#x754C;&#x5947;&#x89C2;&#xFF0C;&#x90A3;&#x662F;&#x591A;&#x4E48;&#x5E78;&#x798F;&#x7684;&#x4E8B;&#x513F;&#x554A;~~<br>&#x4F46;&#x7F51;&#x8DEF;&#x4E0A;&#x603B;&#x6709;&#x90A3;&#x4E48;&#x4E9B;&#x7F51;&#x7AD9;&#xFF0C;&#x5F00;&#x59CB;&#x501F;&#x7740;&#x6C11;&#x4F17;&#x7684;&#x597D;&#x5947;&#x5FC3;&#xFF0C;&#x6253;&#x7740;&#x4ECB;&#x7ECD;&#x65E5;&#x98DF;&#x7684;&#x65D7;&#x53F7;&#xFF0C;&#x5927;&#x8086;&#x4F20;&#x64AD;&#x75C5;&#x6BD2;&#x3002;&#x5C0F;t&#x4E0D;&#x5E78;&#x6210;&#x4E3A;&#x53D7;&#x5BB3;&#x8005;&#x4E4B;&#x4E00;&#x3002;&#x5C0F;t&#x5982;&#x6B64;&#x751F;&#x6C14;&#xFF0C;&#x4ED6;&#x51B3;&#x5B9A;&#x8981;&#x628A;&#x4E16;&#x754C;&#x4E0A;&#x6240;&#x6709;&#x5E26;&#x75C5;&#x6BD2;&#x7684;&#x7F51;&#x7AD9;&#x90FD;&#x627E;&#x51FA;&#x6765;&#x3002;&#x5F53;&#x7136;&#xFF0C;&#x8C01;&#x90FD;&#x77E5;&#x9053;&#x8FD9;&#x662F;&#x4E0D;&#x53EF;&#x80FD;&#x7684;&#x3002;&#x5C0F;t&#x5374;&#x6267;&#x610F;&#x8981;&#x5B8C;&#x6210;&#x8FD9;&#x4E0D;&#x80FD;&#x7684;&#x4EFB;&#x52A1;&#xFF0C;&#x4ED6;&#x8BF4;&#xFF1A;&#x201C;&#x5B50;&#x5B50;&#x5B59;&#x5B59;&#x65E0;&#x7A77;&#x532E;&#x4E5F;&#xFF01;&#x201D;&#xFF08;&#x611A;&#x516C;&#x540E;&#x7EE7;&#x6709;&#x4EBA;&#x4E86;&#xFF09;&#x3002;<br>&#x4E07;&#x4E8B;&#x5F00;&#x5934;&#x96BE;&#xFF0C;&#x5C0F;t&#x6536;&#x96C6;&#x4E86;&#x597D;&#x591A;&#x75C5;&#x6BD2;&#x7684;&#x7279;&#x5F81;&#x7801;&#xFF0C;&#x53C8;&#x6536;&#x96C6;&#x4E86;&#x4E00;&#x6279;&#x8BE1;&#x5F02;&#x7F51;&#x7AD9;&#x7684;&#x6E90;&#x7801;&#xFF0C;&#x4ED6;&#x60F3;&#x77E5;&#x9053;&#x8FD9;&#x4E9B;&#x7F51;&#x7AD9;&#x4E2D;&#x54EA;&#x4E9B;&#x662F;&#x6709;&#x75C5;&#x6BD2;&#x7684;&#xFF0C;&#x53C8;&#x662F;&#x5E26;&#x4E86;&#x600E;&#x6837;&#x7684;&#x75C5;&#x6BD2;&#x5462;&#xFF1F;&#x987A;&#x4FBF;&#x8FD8;&#x60F3;&#x77E5;&#x9053;&#x4ED6;&#x5230;&#x5E95;&#x6536;&#x96C6;&#x4E86;&#x591A;&#x5C11;&#x5E26;&#x75C5;&#x6BD2;&#x7684;&#x7F51;&#x7AD9;&#x3002;&#x8FD9;&#x65F6;&#x5019;&#x4ED6;&#x5374;&#x4E0D;&#x77E5;&#x9053;&#x4F55;&#x4ECE;&#x4E0B;&#x624B;&#x4E86;&#x3002;&#x6240;&#x4EE5;&#x60F3;&#x8BF7;&#x5927;&#x5BB6;&#x5E2E;&#x5E2E;&#x5FD9;&#x3002;&#x5C0F;t&#x53C8;&#x662F;&#x4E2A;&#x6025;&#x6027;&#x5B50;&#x54E6;&#xFF0C;&#x6240;&#x4EE5;&#x89E3;&#x51B3;&#x95EE;&#x9898;&#x8D8A;&#x5FEB;&#x8D8A;&#x597D;&#x54E6;~~</p>
<p>Input<br>&#x7B2C;&#x4E00;&#x884C;&#xFF0C;&#x4E00;&#x4E2A;&#x6574;&#x6570;N&#xFF08;1&lt;=N&lt;=500&#xFF09;&#xFF0C;&#x8868;&#x793A;&#x75C5;&#x6BD2;&#x7279;&#x5F81;&#x7801;&#x7684;&#x4E2A;&#x6570;&#x3002;<br>&#x63A5;&#x4E0B;&#x6765;N&#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x75C5;&#x6BD2;&#x7279;&#x5F81;&#x7801;&#xFF0C;&#x7279;&#x5F81;&#x7801;&#x5B57;&#x7B26;&#x4E32;&#x957F;&#x5EA6;&#x5728;20&#x2014;200&#x4E4B;&#x95F4;&#x3002;<br>&#x6BCF;&#x4E2A;&#x75C5;&#x6BD2;&#x90FD;&#x6709;&#x4E00;&#x4E2A;&#x7F16;&#x53F7;&#xFF0C;&#x4F9D;&#x6B64;&#x4E3A;1&#x2014;N&#x3002;<br>&#x4E0D;&#x540C;&#x7F16;&#x53F7;&#x7684;&#x75C5;&#x6BD2;&#x7279;&#x5F81;&#x7801;&#x4E0D;&#x4F1A;&#x76F8;&#x540C;&#x3002;<br>&#x5728;&#x8FD9;&#x4E4B;&#x540E;&#x4E00;&#x884C;&#xFF0C;&#x6709;&#x4E00;&#x4E2A;&#x6574;&#x6570;M&#xFF08;1&lt;=M&lt;=1000&#xFF09;&#xFF0C;&#x8868;&#x793A;&#x7F51;&#x7AD9;&#x6570;&#x3002;<br>&#x63A5;&#x4E0B;&#x6765;M&#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x7F51;&#x7AD9;&#x6E90;&#x7801;&#xFF0C;&#x6E90;&#x7801;&#x5B57;&#x7B26;&#x4E32;&#x957F;&#x5EA6;&#x5728;7000&#x2014;10000&#x4E4B;&#x95F4;&#x3002;<br>&#x6BCF;&#x4E2A;&#x7F51;&#x7AD9;&#x90FD;&#x6709;&#x4E00;&#x4E2A;&#x7F16;&#x53F7;&#xFF0C;&#x4F9D;&#x6B64;&#x4E3A;1&#x2014;M&#x3002;<br>&#x4EE5;&#x4E0A;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x5B57;&#x7B26;&#x90FD;&#x662F;ASCII&#x7801;&#x53EF;&#x89C1;&#x5B57;&#x7B26;&#xFF08;&#x4E0D;&#x5305;&#x62EC;&#x56DE;&#x8F66;&#xFF09;&#x3002;<br>Output<br>&#x4F9D;&#x6B21;&#x6309;&#x5982;&#x4E0B;&#x683C;&#x5F0F;&#x8F93;&#x51FA;&#x6309;&#x7F51;&#x7AD9;&#x7F16;&#x53F7;&#x4ECE;&#x5C0F;&#x5230;&#x5927;&#x8F93;&#x51FA;&#xFF0C;&#x5E26;&#x75C5;&#x6BD2;&#x7684;&#x7F51;&#x7AD9;&#x7F16;&#x53F7;&#x548C;&#x5305;&#x542B;&#x75C5;&#x6BD2;&#x7F16;&#x53F7;&#xFF0C;&#x6BCF;&#x884C;&#x4E00;&#x4E2A;&#x542B;&#x6BD2;&#x7F51;&#x7AD9;&#x4FE1;&#x606F;&#x3002;<br>web &#x7F51;&#x7AD9;&#x7F16;&#x53F7;: &#x75C5;&#x6BD2;&#x7F16;&#x53F7; &#x75C5;&#x6BD2;&#x7F16;&#x53F7; &#x2026;<br>&#x5192;&#x53F7;&#x540E;&#x6709;&#x4E00;&#x4E2A;&#x7A7A;&#x683C;&#xFF0C;&#x75C5;&#x6BD2;&#x7F16;&#x53F7;&#x6309;&#x4ECE;&#x5C0F;&#x5230;&#x5927;&#x6392;&#x5217;&#xFF0C;&#x4E24;&#x4E2A;&#x75C5;&#x6BD2;&#x7F16;&#x53F7;&#x4E4B;&#x95F4;&#x7528;&#x4E00;&#x4E2A;&#x7A7A;&#x683C;&#x9694;&#x5F00;&#xFF0C;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x7F51;&#x7AD9;&#x5305;&#x542B;&#x75C5;&#x6BD2;&#xFF0C;&#x75C5;&#x6BD2;&#x6570;&#x4E0D;&#x4F1A;&#x8D85;&#x8FC7;3&#x4E2A;&#x3002;<br>&#x6700;&#x540E;&#x4E00;&#x884C;&#x8F93;&#x51FA;&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;&#xFF0C;&#x5982;&#x4E0B;&#x683C;&#x5F0F;<br>total: &#x5E26;&#x75C5;&#x6BD2;&#x7F51;&#x7AD9;&#x6570;<br>&#x5192;&#x53F7;&#x540E;&#x6709;&#x4E00;&#x4E2A;&#x7A7A;&#x683C;&#x3002;</p>
<p>Sample Input<br>3<br>aaa<br>bbb<br>ccc<br>2<br>aaabbbccc<br>bbaacc<br>Sample Output<br>web 1: 1 2 3<br>total: 1</p>
</blockquote>
<p>AC&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">AC</span> {</span></div><div class="line">	<span class="keyword">int</span> child[<span class="number">200</span>*<span class="number">500</span>+<span class="number">500</span>][<span class="number">128</span>], fail[<span class="number">200</span>*<span class="number">500</span>+<span class="number">500</span>], end[<span class="number">200</span>*<span class="number">500</span>+<span class="number">500</span>];</div><div class="line">	<span class="keyword">int</span> root, cnt;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">newnode</span><span class="params">()</span> </span>{</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">128</span>; i++)	child[cnt][i] = <span class="number">-1</span>;</div><div class="line">		end[cnt++] = <span class="number">-1</span>;</div><div class="line">		<span class="keyword">return</span> cnt<span class="number">-1</span>;</div><div class="line">	}</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>{</div><div class="line">		cnt = <span class="number">0</span>;</div><div class="line">		root = newnode();</div><div class="line">	}</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">char</span> s[])</span> </span>{</div><div class="line">		<span class="keyword">int</span> len = <span class="built_in">strlen</span>(s), cur = root;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; cur = child[cur][s[i++]])</div><div class="line">			<span class="keyword">if</span> (child[cur][s[i]] == <span class="number">-1</span>)	child[cur][s[i]] = newnode();</div><div class="line">		end[cur] = id;</div><div class="line">	}</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">setFail</span><span class="params">()</span> </span>{</div><div class="line">		<span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; que;</div><div class="line">		fail[root] = root;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">128</span>; i++) {</div><div class="line">			<span class="keyword">if</span> (child[root][i] == <span class="number">-1</span>) {</div><div class="line">				child[root][i] = root;</div><div class="line">			} <span class="keyword">else</span> {</div><div class="line">				fail[child[root][i]] = root;</div><div class="line">				que.push(child[root][i]);</div><div class="line">			}</div><div class="line">		}</div><div class="line">		<span class="keyword">while</span> (!que.empty()) {</div><div class="line">			<span class="keyword">int</span> u = que.front();</div><div class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">128</span>; i++) {</div><div class="line">				<span class="keyword">if</span> (child[u][i] != <span class="number">-1</span>) {</div><div class="line">					fail[child[u][i]] = child[fail[u]][i];</div><div class="line">					que.push(child[u][i]);</div><div class="line">				} <span class="keyword">else</span> {</div><div class="line">					child[u][i] = child[fail[u]][i];</div><div class="line">				}</div><div class="line">			}</div><div class="line">			que.pop();</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">bool</span> flag[<span class="number">505</span>];</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> id, <span class="keyword">char</span> s[])</span> </span>{</div><div class="line">		<span class="keyword">int</span> len = <span class="built_in">strlen</span>(s);</div><div class="line">		<span class="keyword">int</span> cur = root;</div><div class="line">		<span class="keyword">bool</span> mark = <span class="literal">false</span>;</div><div class="line">		<span class="built_in">memset</span>(flag, <span class="number">0</span>, <span class="keyword">sizeof</span>(flag));</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) {</div><div class="line">			cur = child[cur][s[i]];</div><div class="line">			<span class="keyword">int</span> tmp = cur;</div><div class="line">			<span class="keyword">while</span> (tmp != root) {</div><div class="line">				<span class="keyword">if</span> (end[tmp] != <span class="number">-1</span>)	flag[end[tmp]] = mark = <span class="literal">true</span>;</div><div class="line">				tmp = fail[tmp];</div><div class="line">			}</div><div class="line">		}</div><div class="line">		<span class="keyword">if</span> (!mark)	<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">&quot;web %d:&quot;</span>, id);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">			<span class="keyword">if</span> (flag[i])</div><div class="line">				<span class="built_in">printf</span>(<span class="string">&quot; %d&quot;</span>, i);</div><div class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</div><div class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">	}</div><div class="line">} ac;</div><div class="line"><span class="keyword">char</span> str[<span class="number">10005</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">int</span> n, m, ans;</div><div class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n) != EOF) {</div><div class="line">		ac.init();</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) {</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, str);</div><div class="line">			ac.insert(i, str);</div><div class="line">		}</div><div class="line">		ac.setFail();</div><div class="line">		ans = <span class="number">0</span>;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;m);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) {</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, str);</div><div class="line">			ans += ac.query(n, i, str);</div><div class="line">		}</div><div class="line">		<span class="built_in">printf</span>(<span class="string">&quot;total: %d\n&quot;</span>, ans);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
<p>&#x63A5;&#x4E0B;&#x6765;&#x770B;&#x4E00;&#x9053;&#x7A0D;&#x5FAE;&#x6709;&#x4E9B;&#x53D8;&#x5316;&#x7684;&#x9898;&#xFF08;&#x867D;&#x7136;&#x8FD8;&#x662F;&#x57FA;&#x7840;&#x6C34;&#x9898;&#xFF09;</p>
<blockquote>
<p>&#x3010;ZOJ3034&#x3011; Detect the Virus<br>One day, Nobita found that his computer is extremely slow. After several hours&#x2019; work, he finally found that it was a virus that made his poor computer slow and the virus was activated by a misoperation of opening an attachment of an email.<br>Nobita did use an outstanding anti-virus software, however, for some strange reason, this software did not check email attachments. Now Nobita decide to detect viruses in emails by himself.<br>To detect an virus, a virus sample (several binary bytes) is needed. If these binary bytes can be found in the email attachment (binary data), then the attachment contains the virus.<br>Note that attachments (binary data) in emails are usually encoded in base64. To encode a binary stream in base64, first write the binary stream into bits. Then take 6 bits from the stream in turn, encode these 6 bits into a base64 character according the following table:<br>That is, translate every 3 bytes into 4 base64 characters. If the original binary stream contains 3k + 1 bytes, where k is an integer, fill last bits using zero when encoding and append &#x2018;==&#x2019; as padding. If the original binary stream contains 3k + 2 bytes, fill last bits using zero when encoding and append &#x2018;=&#x2019; as padding. No padding is needed when the original binary stream contains 3k bytes. </p>
<p>Value    Encoding    Value    Encoding<br>0        A            32        g<br>1        B            33        h<br>2        C            34        i<br>3        D            35        j<br>4        E            36        k<br>5        F            37        l<br>6        G             38        m<br>7        H            39        n<br>8        I            40        o<br>9        J            41        p<br>10        K            42        q<br>11        L            43        r<br>12        M            44        s<br>13        N            45        t<br>14        O            46        u<br>15        P            47        v<br>16        Q            48        w<br>17        R            49        x<br>18        S            50        y<br>19        T            51        z<br>20        U            52        0<br>21        V            53        1<br>22        W            54        2<br>23        X            55        3<br>24        Y            56        4<br>25        Z            57        5<br>26        a            58        6<br>27        b            59        7<br>28        c            60        8<br>29        d            61        9<br>30        e            62        +<br>31        f            63        /</p>
<p>For example, to encode &#x2018;hello&#x2019; into base64, first write &#x2018;hello&#x2019; as binary bits, that is: 01101000 01100101 01101100 01101100 01101111<br>Then, take 6 bits in turn and fill last bits as zero as padding (zero padding bits are marked in bold): 011010 000110 010101 101100 011011 000110 111100<br>They are 26 6 21 44 27 6 60 in decimal. Look up the table above and use corresponding characters: aGVsbG8<br>Since original binary data contains 1 * 3 + 2 bytes, padding is needed, append &#x2018;=&#x2019; and &#x2018;hello&#x2019; is finally encoded in base64: aGVsbG8=<br>Section 5.2 of RFC 1521 describes how to encode a binary stream in base64 much more detailedly:<br>Here is a piece of ANSI C code that can encode binary data in base64. It contains a function, encode (infile, outfile), to encode binary file infile in base64 and output result to outfile.</p>
<p>Input<br>Input contains multiple cases (about 15, of which most are small ones). The first line of each case contains an integer N (0 &lt;= N &lt;= 512). In the next N distinct lines, each line contains a sample of a kind of virus, which is not empty, has not more than 64 bytes in binary and is encoded in base64. Then, the next line contains an integer M (1 &lt;= M &lt;= 128). In the following M lines, each line contains the content of a file to be detected, which is not empty, has no more than 2048 bytes in binary and is encoded in base64.<br>There is a blank line after each case.<br>Output<br>For each case, output M lines. The ith line contains the number of kinds of virus detected in the ith file.<br>Output a blank line after each case.</p>
<p>Sample Input<br>3<br>YmFzZTY0<br>dmlydXM=<br>dDog<br>1<br>dGVzdDogdmlydXMu</p>
<p>1<br>QA==<br>2<br>QA==<br>ICAgICAgICA=<br>Sample Output<br>2</p>
<p>1<br>0</p>
<p>Hint<br>In the first sample case, there are three virus samples: base64, virus and t: , the data to be checked is test: virus., which contains the second and the third, two virus samples.</p>
</blockquote>
<p>&#x601D;&#x8DEF;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x5148;&#x89E3;&#x7801;&#xFF0C;&#x7136;&#x540E;&#x5C31;&#x662F;&#x6A21;&#x677F;&#x9898;&#x4E86;</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> DICNUM 256</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ACautomation</span> {</span></div><div class="line">	<span class="keyword">int</span> cnt, root;</div><div class="line">	<span class="keyword">int</span> child[<span class="number">50000</span>+<span class="number">50</span>][DICNUM], end[<span class="number">50000</span>+<span class="number">50</span>], fail[<span class="number">50000</span>+<span class="number">50</span>];</div><div class="line">	<span class="keyword">int</span> Map[<span class="number">256</span>];</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">newnode</span><span class="params">()</span> </span>{</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; DICNUM; i++)	child[cnt][i] = <span class="number">-1</span>;</div><div class="line">		end[cnt++] = <span class="number">-1</span>;</div><div class="line">		<span class="keyword">return</span> cnt<span class="number">-1</span>;</div><div class="line">	}</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>{</div><div class="line">		cnt = <span class="number">0</span>;</div><div class="line">		root = newnode();</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++)	Map[i+<span class="string">&apos;A&apos;</span>] = i;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">26</span>; i &lt; <span class="number">52</span>; i++)	Map[i<span class="number">-26</span>+<span class="string">&apos;a&apos;</span>] = i;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">52</span>; i &lt; <span class="number">62</span>; i++)	Map[i<span class="number">-52</span>+<span class="string">&apos;0&apos;</span>] = i;</div><div class="line">		Map[<span class="string">&apos;+&apos;</span>] = <span class="number">62</span>, Map[<span class="string">&apos;/&apos;</span>] = <span class="number">63</span>;</div><div class="line">	}</div><div class="line">	<span class="keyword">int</span> tmp[<span class="number">5000</span>+<span class="number">5</span>], tmpl;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">ReEncode</span><span class="params">(<span class="keyword">char</span> s[])</span> </span>{</div><div class="line">		<span class="built_in">memset</span>(tmp, <span class="number">0</span>, <span class="keyword">sizeof</span>(tmp));</div><div class="line">		tmpl = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, len = <span class="number">0</span>, x = <span class="number">0</span>; s[i] &amp;&amp; s[i] != <span class="string">&apos;=&apos;</span>; i++) {</div><div class="line">			len += <span class="number">6</span>, x = (x&lt;&lt;<span class="number">6</span>)|Map[s[i]];</div><div class="line">			<span class="keyword">if</span> (len &gt;= <span class="number">8</span>) {</div><div class="line">				tmp[tmpl++] = (x&gt;&gt;(len<span class="number">-8</span>))&amp;<span class="number">0xff</span>;</div><div class="line">				len -= <span class="number">8</span>;</div><div class="line">			}</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">char</span> s[])</span> </span>{</div><div class="line">		ReEncode(s);</div><div class="line">		<span class="keyword">int</span> cur = root;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tmpl; cur = child[cur][tmp[i++]])</div><div class="line">			<span class="keyword">if</span> (child[cur][tmp[i]] == <span class="number">-1</span>)	child[cur][tmp[i]] = newnode();</div><div class="line">		end[cur] = id;</div><div class="line">	}</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">setFail</span><span class="params">()</span> </span>{</div><div class="line">		<span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; que;</div><div class="line">		fail[root] = root;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; DICNUM; i++) {</div><div class="line">			<span class="keyword">if</span> (child[root][i] == <span class="number">-1</span>) {</div><div class="line">				child[root][i] = root;</div><div class="line">			} <span class="keyword">else</span> {</div><div class="line">				fail[child[root][i]] = root;</div><div class="line">				que.push(child[root][i]);</div><div class="line">			}</div><div class="line">		}</div><div class="line">		<span class="keyword">while</span> (!que.empty()) {</div><div class="line">			<span class="keyword">int</span> cur = que.front();</div><div class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; DICNUM; i++) {</div><div class="line">				<span class="keyword">if</span> (child[cur][i] == <span class="number">-1</span>) {</div><div class="line">					child[cur][i] = child[fail[cur]][i];</div><div class="line">				} <span class="keyword">else</span> {</div><div class="line">					fail[child[cur][i]] = child[fail[cur]][i];</div><div class="line">					que.push(child[cur][i]);</div><div class="line">				}</div><div class="line">			}</div><div class="line">			que.pop();</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">bool</span> flag[<span class="number">50000</span>+<span class="number">50</span>];</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">char</span> s[])</span> </span>{</div><div class="line">		ReEncode(s);</div><div class="line">		<span class="keyword">int</span> cur = root, ret = <span class="number">0</span>;</div><div class="line">		<span class="built_in">memset</span>(flag, <span class="number">0</span>, <span class="keyword">sizeof</span>(flag));</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tmpl; i++) {</div><div class="line">			cur = child[cur][tmp[i]];</div><div class="line">			<span class="keyword">int</span> t = cur;</div><div class="line">			<span class="keyword">while</span> (t != root) {</div><div class="line">				<span class="keyword">if</span> (end[t] != <span class="number">-1</span> &amp;&amp; !flag[end[t]])	ret++, flag[end[t]] = <span class="literal">true</span>;</div><div class="line">				t = fail[t];</div><div class="line">			}</div><div class="line">		}</div><div class="line">		<span class="keyword">return</span> ret;</div><div class="line">	} </div><div class="line">} ACauto;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</div><div class="line">	<span class="keyword">int</span> n, m;</div><div class="line">	<span class="keyword">char</span> str[<span class="number">5000</span>+<span class="number">5</span>];</div><div class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n) != EOF) {</div><div class="line">		ACauto.init();</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) {</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, str);</div><div class="line">			ACauto.insert(i, str);</div><div class="line">		}</div><div class="line">		ACauto.setFail();</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;m);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) {</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, str);</div><div class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ACauto.query(i, str));</div><div class="line">		}</div><div class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
<p>AC&#x81EA;&#x52A8;&#x673A;&#x7684;&#x7384;&#x5B66;&#x535A;&#x5927;&#x7CBE;&#x6DF1;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x548C;dp&#x626F;&#x4E0A;&#x5173;&#x7CFB;&#xFF0C;&#x8FD8;&#x662F;&#x591A;&#x7EC3;&#x9898;&#x4E3A;&#x597D;</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AC自动机/">AC自动机</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据结构/">数据结构</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-20170710总结" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/20170710总结/" class="article-date">
  	<time datetime="2017-07-09T16:00:00.000Z" itemprop="datePublished">2017-07-10</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/20170710总结/">
        20170710总结
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>&#x4ECA;&#x5929;&#x662F;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x7684;&#x6700;&#x540E;&#x4E00;&#x5929;&#x3002;&#x4E0A;&#x5348;&#x8003;&#x8BD5;&#x4E00;&#x53CD;&#x5E38;&#x6001;&#xFF0C;&#x82B1;&#x5F0F;&#x7FFB;&#x8F66;&#x3002;T1&#x662F;&#x7B7E;&#x5230;&#x6C34;&#x9898;&#xFF0C;&#x5C45;&#x7136;&#x6CA1;&#x5F00;longlong&#xFF0C;int&#x7206;&#x6210;&#x8D1F;&#xFF1B;T2T3&#x7528;&#x7684;&#x662F;I64d&#xFF08;&#x8C03;&#x8BD5;&#x4E3A;windows&#x4E0B;&#xFF09;&#xFF0C;&#x8003;&#x8BD5;&#x4E3A;linux&#x4E0B;&#xFF0C;&#x5E94;&#x8BE5;&#x7528;lld&#xFF0C;&#x7206;&#x96F6;&#x4E86;&#x3002;T2&#x662F;&#x4E00;&#x4E2A;splay&#x7684;&#x7248;&#x9898;&#xFF0C;&#x4F46;&#x662F;&#x56E0;&#x4E3A;&#x5BF9;&#x7FFB;&#x8F6C;&#x64CD;&#x4F5C;&#x4E0D;&#x719F;&#x6089;&#xFF0C;&#x6CA1;&#x6709;&#x5199;&#x6B63;&#x89E3;&#x3002;&#x770B;&#x6765;&#x5F97;&#x591A;&#x5199;&#x5199;splay&#xFF0C;&#x56E0;&#x4E3A;&#x6BD4;&#x8F83;&#x597D;&#x5199;&#x53C8;&#x7075;&#x6D3B;&#x7684;&#x5E73;&#x8861;&#x6811;&#x5C31;&#x662F;splay&#x4E86;&#xFF08;&#x5F53;&#x7136;&#xFF0C;treap&#x4E5F;&#x7B97;&#xFF09;&#x3002;T3&#x5199;&#x4E86;&#x4E00;&#x4E2A;&#x7384;&#x5B66;&#x7684;&#x503C;&#x57DF;&#x4E3B;&#x5E2D;&#x6811;&#x4F18;&#x5316;&#xFF0C;&#x867D;&#x7136;&#x6700;&#x574F;&#x590D;&#x6742;&#x5EA6;&#x8FD8;&#x662F;O(n^2)&#xFF0C;&#x4F46;&#x662F;&#x5982;&#x679C;&#x503C;&#x57DF;&#x8303;&#x56F4;&#x5C0F;&#xFF0C;&#x5728;10000&#x4EE5;&#x5185;&#x90FD;&#x80FD;&#x8FC7;&#xFF0C;&#x56E0;&#x800C;&#x6211;Task3&#x548C;Task4&#x90FD;&#x8FC7;&#x4E86;&#x4E00;&#x534A;&#x4EE5;&#x4E0A;&#xFF0C;&#x53EF;&#x60DC;&#x662F;&#x5B50;&#x4EFB;&#x52A1;&#xFF0C;&#x4E0D;&#x7136;&#x5C31;&#x8D5A;&#x4E86;&#x3002;T3&#x6B63;&#x89E3;&#x662F;&#x5206;&#x5757;&#xFF0C;&#x4E0D;&#x592A;&#x597D;&#x5199;&#x3002;&#x9694;&#x58C1;&#x5C0F;&#x80D6;&#x5B66;&#x957F;&#x8BF4;&#x662F;&#x83AB;&#x961F;&#xFF0C;&#x800C;&#x4E14;&#x4ED6;&#x7684;&#x7A0B;&#x5E8F;&#x78BE;&#x538B;&#x6807;&#x7A0B;&#xFF0C;&#x4E09;&#x9879;&#x90FD;&#x6BD4;&#x6807;&#x7A0B;&#x597D;,,&#x53E;&#x3142;&#x53E;,,&#x2026;&#x83AB;&#x961F;&#x5927;&#x6CD5;&#x597D;<br>&#x4E0B;&#x5348;&#x5148;&#x8BB2;&#x4E86;&#x6811;&#x94FE;&#x5256;&#x5206;&#xFF0C;&#x7136;&#x540E;&#x8BB2;&#x4E86;&#x4E00;&#x4E9B;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x6742;&#x9898;&#x3002;&#x6742;&#x9898;&#x7684;&#x601D;&#x7EF4;&#x96BE;&#x5EA6;&#x90FD;&#x6BD4;&#x8F83;&#x9AD8;&#xFF0C;&#x800C;&#x4E14;&#x6839;&#x672C;&#x770B;&#x4E0D;&#x51FA;&#x548C;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x6709;&#x4EC0;&#x4E48;&#x8054;&#x7CFB;&#x3002;&#x4E2A;&#x4EBA;&#x8BA4;&#x4E3A;&#xFF0C;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x5DE5;&#x5177;&#xFF0C;&#x548C;&#x89E3;&#x9898;&#x65B9;&#x6CD5;&#x65E0;&#x5173;&#xFF0C;&#x65B9;&#x6CD5;&#x5F52;&#x65B9;&#x6CD5;&#xFF0C;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x53EA;&#x662F;&#x5728;&#x89E3;&#x9898;&#x7684;&#x65F6;&#x5019;&#x8FDB;&#x884C;&#x4F18;&#x5316;&#x3002;&#x9664;&#x4E86;&#x7248;&#x9898;&#x4EE5;&#x5916;&#xFF0C;&#x5BF9;&#x4E8E;&#x5176;&#x4ED6;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x9898;&#xFF0C;&#x60F3;&#x7684;&#x65F6;&#x5019;&#x8FD8;&#x662F;&#x4E0D;&#x8981;&#x4F7F;&#x52B2;&#x5F80;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x4E0A;&#x9760;&#xFF0C;&#x5E94;&#x8BE5;&#x5148;&#x5168;&#x9762;&#x60F3;&#xFF0C;&#x518D;&#x5728;&#x5C40;&#x90E8;&#x7528;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x4F18;&#x5316;&#xFF0C;&#x8FD9;&#x6837;&#x624D;&#x80FD;&#x6253;&#x5F00;&#x601D;&#x7EF4;&#x3002;</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/总结/">总结</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/14/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="page-number" href="/page/14/">14</a><span class="page-number current">15</span><a class="page-number" href="/page/16/">16</a><a class="page-number" href="/page/17/">17</a><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/16/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2017 Azrael_Death
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a>
        </div>
    </div>
  </div>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
  </script>
  <script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  
</footer>

    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="/js/main.js"></script>
<!--
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
-->



<!--
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.js"></script>
-->

  </div>
</body>
</html>